import{c as y,a as v,r,x as N,m as w,b as p,z as E,C as z,j as e,d as k,n as u,q as S,t as C}from"./index-D4SRrvyr.js";import{C as R}from"./calendar-BDaGB8yE.js";import{C as D,E as L}from"./external-link-BAyQxZZp.js";import{U as P}from"./users-B-ZBNedW.js";const U=y("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);function M(){const{currentUser:i}=v(),[c,g]=r.useState([]),[f,j]=r.useState(!0);r.useEffect(()=>{l()},[]);async function l(){try{const s=N(w(p,"events"),E("date","asc")),t=(await z(s)).docs.map(a=>({id:a.id,...a.data()}));g(t)}catch(s){console.error("Error fetching events:",s)}finally{j(!1)}}async function b(s,n){if(i)try{const t=k(p,"events",s);n?await u(t,{attendees:S(i.uid)}):await u(t,{attendees:C(i.uid)}),await l()}catch(t){console.error("Error updating RSVP:",t),alert("Failed to update RSVP")}}const d=Date.now(),o=c.filter(s=>s.date>d),x=c.filter(s=>s.date<=d);if(f)return e.jsx("section",{className:"mx-auto max-w-7xl px-4 py-12",children:e.jsx("div",{className:"text-zinc-400",children:"Loading events..."})});const m=({event:s,isPast:n=!1})=>{const t=s.attendees?.includes(i?.uid),a=s.attendees?.length>=s.maxAttendees,h=new Date(s.date);return e.jsxs("div",{className:`glass p-5 rounded-2xl ${n?"opacity-60":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-xl font-semibold",children:s.title}),t&&!n&&e.jsx("span",{className:"px-3 py-1 rounded-full bg-green-400/20 text-green-400 text-xs",children:"Attending"})]}),e.jsx("p",{className:"text-zinc-300 mb-4",children:s.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-zinc-400",children:[e.jsx(R,{size:16}),e.jsx("span",{children:h.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-zinc-400",children:[e.jsx(D,{size:16}),e.jsxs("span",{children:[h.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})," Â· ",s.duration," minutes"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-zinc-400",children:[e.jsx(P,{size:16}),e.jsxs("span",{children:[s.attendees?.length||0," / ",s.maxAttendees," attending"]})]}),s.link&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-brand-400",children:[e.jsx(U,{size:16}),e.jsxs("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"hover:underline flex items-center gap-1",children:["Join Link",e.jsx(L,{size:12})]})]})]}),!n&&e.jsx("button",{onClick:()=>b(s.id,t),disabled:!t&&a,className:`w-full py-2 rounded-lg transition ${t?"bg-white/10 border border-white/20 hover:bg-red-500/20 hover:border-red-500/20":a?"bg-white/5 border border-white/10 opacity-50 cursor-not-allowed":"btn-primary"}`,children:t?"Cancel RSVP":a?"Event Full":"RSVP"})]})};return e.jsxs("section",{className:"mx-auto max-w-7xl px-4 py-12",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6",children:"Community Events"}),e.jsx("p",{className:"text-zinc-300 mb-8",children:"Join live sessions, workshops, and community calls"}),e.jsxs("div",{className:"mb-12",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-4",children:"Upcoming Events"}),o.length===0?e.jsx("div",{className:"glass p-8 rounded-2xl text-center text-zinc-400",children:"No upcoming events scheduled"}):e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-5",children:o.map(s=>e.jsx(m,{event:s},s.id))})]}),x.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-semibold mb-4",children:"Past Events"}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-5",children:x.map(s=>e.jsx(m,{event:s,isPast:!0},s.id))})]})]})}export{M as default};
