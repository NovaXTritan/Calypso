const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PodForum-LifyRU_o.js","assets/lock-_3AXRtUS.js","assets/circle-alert-JXPpvSJj.js","assets/upload-BRZd2zSQ.js","assets/send-DeZiNyi9.js","assets/trending-up-Vq24Oeey.js","assets/message-circle-CzO6Ds0t.js","assets/external-link-CW3Hc4C5.js","assets/Matches-BVqLxO7O.js","assets/Avatar-BT8Fqc4U.js","assets/chat-VpU7-JHb.js","assets/target-twTTPLSF.js","assets/zap-CT4i9PvB.js","assets/Journal-DiW88g3Q.js","assets/trash-2-DjSNPS4n.js","assets/Events-n93L1l6I.js","assets/Analytics-CL6Mj3qe.js","assets/Analytics-DOnzI3fN.css","assets/Profile-DFq4Paqs.js","assets/Settings-Df_Yz60E.js","assets/shield-D7z6iHt_.js","assets/Constitution-Dq32d_Uz.js","assets/Chat-CZfngCHM.js"])))=>i.map(i=>d[i]);
function BO(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const HO="modulepreload",GO=function(n){return"/"+n},$w={},to=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=a?.nonce||a?.getAttribute("nonce");i=u(t.map(h=>{if(h=GO(h),h in $w)return;$w[h]=!0;const f=h.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const _=document.createElement("link");if(_.rel=f?"stylesheet":HO,f||(_.as="script"),_.crossOrigin="",_.href=h,c&&_.setAttribute("nonce",c),document.head.appendChild(_),f)return new Promise((v,T)=>{_.addEventListener("load",v),_.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return i.then(a=>{for(const c of a||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})};var Ep=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function PE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Bv={exports:{}},Gh={},Hv={exports:{}},Bt={};var qw;function jO(){if(qw)return Bt;qw=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator;function _($){return $===null||typeof $!="object"?null:($=m&&$[m]||$["@@iterator"],typeof $=="function"?$:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,A={};function E($,ne,te){this.props=$,this.context=ne,this.refs=A,this.updater=te||v}E.prototype.isReactComponent={},E.prototype.setState=function($,ne){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,ne,"setState")},E.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function S(){}S.prototype=E.prototype;function D($,ne,te){this.props=$,this.context=ne,this.refs=A,this.updater=te||v}var b=D.prototype=new S;b.constructor=D,T(b,E.prototype),b.isPureReactComponent=!0;var k=Array.isArray,V=Object.prototype.hasOwnProperty,H={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function I($,ne,te){var _e,Ee={},Pe=null,we=null;if(ne!=null)for(_e in ne.ref!==void 0&&(we=ne.ref),ne.key!==void 0&&(Pe=""+ne.key),ne)V.call(ne,_e)&&!P.hasOwnProperty(_e)&&(Ee[_e]=ne[_e]);var ke=arguments.length-2;if(ke===1)Ee.children=te;else if(1<ke){for(var We=Array(ke),Ye=0;Ye<ke;Ye++)We[Ye]=arguments[Ye+2];Ee.children=We}if($&&$.defaultProps)for(_e in ke=$.defaultProps,ke)Ee[_e]===void 0&&(Ee[_e]=ke[_e]);return{$$typeof:n,type:$,key:Pe,ref:we,props:Ee,_owner:H.current}}function M($,ne){return{$$typeof:n,type:$.type,key:ne,ref:$.ref,props:$.props,_owner:$._owner}}function C($){return typeof $=="object"&&$!==null&&$.$$typeof===n}function N($){var ne={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(te){return ne[te]})}var W=/\/+/g;function F($,ne){return typeof $=="object"&&$!==null&&$.key!=null?N(""+$.key):ne.toString(36)}function Y($,ne,te,_e,Ee){var Pe=typeof $;(Pe==="undefined"||Pe==="boolean")&&($=null);var we=!1;if($===null)we=!0;else switch(Pe){case"string":case"number":we=!0;break;case"object":switch($.$$typeof){case n:case e:we=!0}}if(we)return we=$,Ee=Ee(we),$=_e===""?"."+F(we,0):_e,k(Ee)?(te="",$!=null&&(te=$.replace(W,"$&/")+"/"),Y(Ee,ne,te,"",function(Ye){return Ye})):Ee!=null&&(C(Ee)&&(Ee=M(Ee,te+(!Ee.key||we&&we.key===Ee.key?"":(""+Ee.key).replace(W,"$&/")+"/")+$)),ne.push(Ee)),1;if(we=0,_e=_e===""?".":_e+":",k($))for(var ke=0;ke<$.length;ke++){Pe=$[ke];var We=_e+F(Pe,ke);we+=Y(Pe,ne,te,We,Ee)}else if(We=_($),typeof We=="function")for($=We.call($),ke=0;!(Pe=$.next()).done;)Pe=Pe.value,We=_e+F(Pe,ke++),we+=Y(Pe,ne,te,We,Ee);else if(Pe==="object")throw ne=String($),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.");return we}function ue($,ne,te){if($==null)return $;var _e=[],Ee=0;return Y($,_e,"","",function(Pe){return ne.call(te,Pe,Ee++)}),_e}function ye($){if($._status===-1){var ne=$._result;ne=ne(),ne.then(function(te){($._status===0||$._status===-1)&&($._status=1,$._result=te)},function(te){($._status===0||$._status===-1)&&($._status=2,$._result=te)}),$._status===-1&&($._status=0,$._result=ne)}if($._status===1)return $._result.default;throw $._result}var ge={current:null},Q={transition:null},re={ReactCurrentDispatcher:ge,ReactCurrentBatchConfig:Q,ReactCurrentOwner:H};function ie(){throw Error("act(...) is not supported in production builds of React.")}return Bt.Children={map:ue,forEach:function($,ne,te){ue($,function(){ne.apply(this,arguments)},te)},count:function($){var ne=0;return ue($,function(){ne++}),ne},toArray:function($){return ue($,function(ne){return ne})||[]},only:function($){if(!C($))throw Error("React.Children.only expected to receive a single React element child.");return $}},Bt.Component=E,Bt.Fragment=t,Bt.Profiler=i,Bt.PureComponent=D,Bt.StrictMode=r,Bt.Suspense=u,Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=re,Bt.act=ie,Bt.cloneElement=function($,ne,te){if($==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+$+".");var _e=T({},$.props),Ee=$.key,Pe=$.ref,we=$._owner;if(ne!=null){if(ne.ref!==void 0&&(Pe=ne.ref,we=H.current),ne.key!==void 0&&(Ee=""+ne.key),$.type&&$.type.defaultProps)var ke=$.type.defaultProps;for(We in ne)V.call(ne,We)&&!P.hasOwnProperty(We)&&(_e[We]=ne[We]===void 0&&ke!==void 0?ke[We]:ne[We])}var We=arguments.length-2;if(We===1)_e.children=te;else if(1<We){ke=Array(We);for(var Ye=0;Ye<We;Ye++)ke[Ye]=arguments[Ye+2];_e.children=ke}return{$$typeof:n,type:$.type,key:Ee,ref:Pe,props:_e,_owner:we}},Bt.createContext=function($){return $={$$typeof:a,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},$.Provider={$$typeof:s,_context:$},$.Consumer=$},Bt.createElement=I,Bt.createFactory=function($){var ne=I.bind(null,$);return ne.type=$,ne},Bt.createRef=function(){return{current:null}},Bt.forwardRef=function($){return{$$typeof:c,render:$}},Bt.isValidElement=C,Bt.lazy=function($){return{$$typeof:f,_payload:{_status:-1,_result:$},_init:ye}},Bt.memo=function($,ne){return{$$typeof:h,type:$,compare:ne===void 0?null:ne}},Bt.startTransition=function($){var ne=Q.transition;Q.transition={};try{$()}finally{Q.transition=ne}},Bt.unstable_act=ie,Bt.useCallback=function($,ne){return ge.current.useCallback($,ne)},Bt.useContext=function($){return ge.current.useContext($)},Bt.useDebugValue=function(){},Bt.useDeferredValue=function($){return ge.current.useDeferredValue($)},Bt.useEffect=function($,ne){return ge.current.useEffect($,ne)},Bt.useId=function(){return ge.current.useId()},Bt.useImperativeHandle=function($,ne,te){return ge.current.useImperativeHandle($,ne,te)},Bt.useInsertionEffect=function($,ne){return ge.current.useInsertionEffect($,ne)},Bt.useLayoutEffect=function($,ne){return ge.current.useLayoutEffect($,ne)},Bt.useMemo=function($,ne){return ge.current.useMemo($,ne)},Bt.useReducer=function($,ne,te){return ge.current.useReducer($,ne,te)},Bt.useRef=function($){return ge.current.useRef($)},Bt.useState=function($){return ge.current.useState($)},Bt.useSyncExternalStore=function($,ne,te){return ge.current.useSyncExternalStore($,ne,te)},Bt.useTransition=function(){return ge.current.useTransition()},Bt.version="18.3.1",Bt}var Xw;function Yd(){return Xw||(Xw=1,Hv.exports=jO()),Hv.exports}var Kw;function WO(){if(Kw)return Gh;Kw=1;var n=Yd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(c,u,h){var f,m={},_=null,v=null;h!==void 0&&(_=""+h),u.key!==void 0&&(_=""+u.key),u.ref!==void 0&&(v=u.ref);for(f in u)r.call(u,f)&&!s.hasOwnProperty(f)&&(m[f]=u[f]);if(c&&c.defaultProps)for(f in u=c.defaultProps,u)m[f]===void 0&&(m[f]=u[f]);return{$$typeof:e,type:c,key:_,ref:v,props:m,_owner:i.current}}return Gh.Fragment=t,Gh.jsx=a,Gh.jsxs=a,Gh}var Yw;function $O(){return Yw||(Yw=1,Bv.exports=WO()),Bv.exports}var B=$O(),X=Yd();const Eg=PE(X),qO=BO({__proto__:null,default:Eg},[X]);var Sp={},Gv={exports:{}},si={},jv={exports:{}},Wv={};var Zw;function XO(){return Zw||(Zw=1,(function(n){function e(Q,re){var ie=Q.length;Q.push(re);e:for(;0<ie;){var $=ie-1>>>1,ne=Q[$];if(0<i(ne,re))Q[$]=re,Q[ie]=ne,ie=$;else break e}}function t(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var re=Q[0],ie=Q.pop();if(ie!==re){Q[0]=ie;e:for(var $=0,ne=Q.length,te=ne>>>1;$<te;){var _e=2*($+1)-1,Ee=Q[_e],Pe=_e+1,we=Q[Pe];if(0>i(Ee,ie))Pe<ne&&0>i(we,Ee)?(Q[$]=we,Q[Pe]=ie,$=Pe):(Q[$]=Ee,Q[_e]=ie,$=_e);else if(Pe<ne&&0>i(we,ie))Q[$]=we,Q[Pe]=ie,$=Pe;else break e}}return re}function i(Q,re){var ie=Q.sortIndex-re.sortIndex;return ie!==0?ie:Q.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();n.unstable_now=function(){return a.now()-c}}var u=[],h=[],f=1,m=null,_=3,v=!1,T=!1,A=!1,E=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(Q){for(var re=t(h);re!==null;){if(re.callback===null)r(h);else if(re.startTime<=Q)r(h),re.sortIndex=re.expirationTime,e(u,re);else break;re=t(h)}}function k(Q){if(A=!1,b(Q),!T)if(t(u)!==null)T=!0,ye(V);else{var re=t(h);re!==null&&ge(k,re.startTime-Q)}}function V(Q,re){T=!1,A&&(A=!1,S(I),I=-1),v=!0;var ie=_;try{for(b(re),m=t(u);m!==null&&(!(m.expirationTime>re)||Q&&!N());){var $=m.callback;if(typeof $=="function"){m.callback=null,_=m.priorityLevel;var ne=$(m.expirationTime<=re);re=n.unstable_now(),typeof ne=="function"?m.callback=ne:m===t(u)&&r(u),b(re)}else r(u);m=t(u)}if(m!==null)var te=!0;else{var _e=t(h);_e!==null&&ge(k,_e.startTime-re),te=!1}return te}finally{m=null,_=ie,v=!1}}var H=!1,P=null,I=-1,M=5,C=-1;function N(){return!(n.unstable_now()-C<M)}function W(){if(P!==null){var Q=n.unstable_now();C=Q;var re=!0;try{re=P(!0,Q)}finally{re?F():(H=!1,P=null)}}else H=!1}var F;if(typeof D=="function")F=function(){D(W)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,ue=Y.port2;Y.port1.onmessage=W,F=function(){ue.postMessage(null)}}else F=function(){E(W,0)};function ye(Q){P=Q,H||(H=!0,F())}function ge(Q,re){I=E(function(){Q(n.unstable_now())},re)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_continueExecution=function(){T||v||(T=!0,ye(V))},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(Q){switch(_){case 1:case 2:case 3:var re=3;break;default:re=_}var ie=_;_=re;try{return Q()}finally{_=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Q,re){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ie=_;_=Q;try{return re()}finally{_=ie}},n.unstable_scheduleCallback=function(Q,re,ie){var $=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?$+ie:$):ie=$,Q){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=ie+ne,Q={id:f++,callback:re,priorityLevel:Q,startTime:ie,expirationTime:ne,sortIndex:-1},ie>$?(Q.sortIndex=ie,e(h,Q),t(u)===null&&Q===t(h)&&(A?(S(I),I=-1):A=!0,ge(k,ie-$))):(Q.sortIndex=ne,e(u,Q),T||v||(T=!0,ye(V))),Q},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(Q){var re=_;return function(){var ie=_;_=re;try{return Q.apply(this,arguments)}finally{_=ie}}}})(Wv)),Wv}var Qw;function KO(){return Qw||(Qw=1,jv.exports=XO()),jv.exports}var Jw;function YO(){if(Jw)return si;Jw=1;var n=Yd(),e=KO();function t(o){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+o,d=1;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(o,l){a(o,l),a(o+"Capture",l)}function a(o,l){for(i[o]=l,o=0;o<l.length;o++)r.add(l[o])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function _(o){return u.call(m,o)?!0:u.call(f,o)?!1:h.test(o)?m[o]=!0:(f[o]=!0,!1)}function v(o,l,d,g){if(d!==null&&d.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return g?!1:d!==null?!d.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function T(o,l,d,g){if(l===null||typeof l>"u"||v(o,l,d,g))return!0;if(g)return!1;if(d!==null)switch(d.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function A(o,l,d,g,y,x,L){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=g,this.attributeNamespace=y,this.mustUseProperty=d,this.propertyName=o,this.type=l,this.sanitizeURL=x,this.removeEmptyString=L}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){E[o]=new A(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var l=o[0];E[l]=new A(l,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){E[o]=new A(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){E[o]=new A(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){E[o]=new A(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){E[o]=new A(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){E[o]=new A(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){E[o]=new A(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){E[o]=new A(o,5,!1,o.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function D(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var l=o.replace(S,D);E[l]=new A(l,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var l=o.replace(S,D);E[l]=new A(l,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var l=o.replace(S,D);E[l]=new A(l,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){E[o]=new A(o,1,!1,o.toLowerCase(),null,!1,!1)}),E.xlinkHref=new A("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){E[o]=new A(o,1,!1,o.toLowerCase(),null,!0,!0)});function b(o,l,d,g){var y=E.hasOwnProperty(l)?E[l]:null;(y!==null?y.type!==0:g||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(T(l,d,y,g)&&(d=null),g||y===null?_(l)&&(d===null?o.removeAttribute(l):o.setAttribute(l,""+d)):y.mustUseProperty?o[y.propertyName]=d===null?y.type===3?!1:"":d:(l=y.attributeName,g=y.attributeNamespace,d===null?o.removeAttribute(l):(y=y.type,d=y===3||y===4&&d===!0?"":""+d,g?o.setAttributeNS(g,l,d):o.setAttribute(l,d))))}var k=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,V=Symbol.for("react.element"),H=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),N=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),ue=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),ge=Symbol.for("react.offscreen"),Q=Symbol.iterator;function re(o){return o===null||typeof o!="object"?null:(o=Q&&o[Q]||o["@@iterator"],typeof o=="function"?o:null)}var ie=Object.assign,$;function ne(o){if($===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);$=l&&l[1]||""}return`
`+$+o}var te=!1;function _e(o,l){if(!o||te)return"";te=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(me){var g=me}Reflect.construct(o,[],l)}else{try{l.call()}catch(me){g=me}o.call(l.prototype)}else{try{throw Error()}catch(me){g=me}o()}}catch(me){if(me&&g&&typeof me.stack=="string"){for(var y=me.stack.split(`
`),x=g.stack.split(`
`),L=y.length-1,q=x.length-1;1<=L&&0<=q&&y[L]!==x[q];)q--;for(;1<=L&&0<=q;L--,q--)if(y[L]!==x[q]){if(L!==1||q!==1)do if(L--,q--,0>q||y[L]!==x[q]){var Z=`
`+y[L].replace(" at new "," at ");return o.displayName&&Z.includes("<anonymous>")&&(Z=Z.replace("<anonymous>",o.displayName)),Z}while(1<=L&&0<=q);break}}}finally{te=!1,Error.prepareStackTrace=d}return(o=o?o.displayName||o.name:"")?ne(o):""}function Ee(o){switch(o.tag){case 5:return ne(o.type);case 16:return ne("Lazy");case 13:return ne("Suspense");case 19:return ne("SuspenseList");case 0:case 2:case 15:return o=_e(o.type,!1),o;case 11:return o=_e(o.type.render,!1),o;case 1:return o=_e(o.type,!0),o;default:return""}}function Pe(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case P:return"Fragment";case H:return"Portal";case M:return"Profiler";case I:return"StrictMode";case F:return"Suspense";case Y:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case N:return(o.displayName||"Context")+".Consumer";case C:return(o._context.displayName||"Context")+".Provider";case W:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case ue:return l=o.displayName||null,l!==null?l:Pe(o.type)||"Memo";case ye:l=o._payload,o=o._init;try{return Pe(o(l))}catch{}}return null}function we(o){var l=o.type;switch(o.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=l.render,o=o.displayName||o.name||"",l.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pe(l);case 8:return l===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ke(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function We(o){var l=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ye(o){var l=We(o)?"checked":"value",d=Object.getOwnPropertyDescriptor(o.constructor.prototype,l),g=""+o[l];if(!o.hasOwnProperty(l)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,x=d.set;return Object.defineProperty(o,l,{configurable:!0,get:function(){return y.call(this)},set:function(L){g=""+L,x.call(this,L)}}),Object.defineProperty(o,l,{enumerable:d.enumerable}),{getValue:function(){return g},setValue:function(L){g=""+L},stopTracking:function(){o._valueTracker=null,delete o[l]}}}}function It(o){o._valueTracker||(o._valueTracker=Ye(o))}function fe(o){if(!o)return!1;var l=o._valueTracker;if(!l)return!0;var d=l.getValue(),g="";return o&&(g=We(o)?o.checked?"true":"false":o.value),o=g,o!==d?(l.setValue(o),!0):!1}function nn(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function st(o,l){var d=l.checked;return ie({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??o._wrapperState.initialChecked})}function ft(o,l){var d=l.defaultValue==null?"":l.defaultValue,g=l.checked!=null?l.checked:l.defaultChecked;d=ke(l.value!=null?l.value:d),o._wrapperState={initialChecked:g,initialValue:d,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function Qe(o,l){l=l.checked,l!=null&&b(o,"checked",l,!1)}function Xt(o,l){Qe(o,l);var d=ke(l.value),g=l.type;if(d!=null)g==="number"?(d===0&&o.value===""||o.value!=d)&&(o.value=""+d):o.value!==""+d&&(o.value=""+d);else if(g==="submit"||g==="reset"){o.removeAttribute("value");return}l.hasOwnProperty("value")?G(o,l.type,d):l.hasOwnProperty("defaultValue")&&G(o,l.type,ke(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(o.defaultChecked=!!l.defaultChecked)}function mt(o,l,d){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var g=l.type;if(!(g!=="submit"&&g!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+o._wrapperState.initialValue,d||l===o.value||(o.value=l),o.defaultValue=l}d=o.name,d!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,d!==""&&(o.name=d)}function G(o,l,d){(l!=="number"||nn(o.ownerDocument)!==o)&&(d==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+d&&(o.defaultValue=""+d))}var U=Array.isArray;function de(o,l,d,g){if(o=o.options,l){l={};for(var y=0;y<d.length;y++)l["$"+d[y]]=!0;for(d=0;d<o.length;d++)y=l.hasOwnProperty("$"+o[d].value),o[d].selected!==y&&(o[d].selected=y),y&&g&&(o[d].defaultSelected=!0)}else{for(d=""+ke(d),l=null,y=0;y<o.length;y++){if(o[y].value===d){o[y].selected=!0,g&&(o[y].defaultSelected=!0);return}l!==null||o[y].disabled||(l=o[y])}l!==null&&(l.selected=!0)}}function Ie(o,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return ie({},l,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function Re(o,l){var d=l.value;if(d==null){if(d=l.children,l=l.defaultValue,d!=null){if(l!=null)throw Error(t(92));if(U(d)){if(1<d.length)throw Error(t(93));d=d[0]}l=d}l==null&&(l=""),d=l}o._wrapperState={initialValue:ke(d)}}function De(o,l){var d=ke(l.value),g=ke(l.defaultValue);d!=null&&(d=""+d,d!==o.value&&(o.value=d),l.defaultValue==null&&o.defaultValue!==d&&(o.defaultValue=d)),g!=null&&(o.defaultValue=""+g)}function Xe(o){var l=o.textContent;l===o._wrapperState.initialValue&&l!==""&&l!==null&&(o.value=l)}function ze(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ge(o,l){return o==null||o==="http://www.w3.org/1999/xhtml"?ze(l):o==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var ot,xt=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,d,g,y){MSApp.execUnsafeLocalFunction(function(){return o(l,d,g,y)})}:o})(function(o,l){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=l;else{for(ot=ot||document.createElement("div"),ot.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=ot.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;l.firstChild;)o.appendChild(l.firstChild)}});function Ae(o,l){if(l){var d=o.firstChild;if(d&&d===o.lastChild&&d.nodeType===3){d.nodeValue=l;return}}o.textContent=l}var Nt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bt=["Webkit","ms","Moz","O"];Object.keys(Nt).forEach(function(o){bt.forEach(function(l){l=l+o.charAt(0).toUpperCase()+o.substring(1),Nt[l]=Nt[o]})});function ut(o,l,d){return l==null||typeof l=="boolean"||l===""?"":d||typeof l!="number"||l===0||Nt.hasOwnProperty(o)&&Nt[o]?(""+l).trim():l+"px"}function rt(o,l){o=o.style;for(var d in l)if(l.hasOwnProperty(d)){var g=d.indexOf("--")===0,y=ut(d,l[d],g);d==="float"&&(d="cssFloat"),g?o.setProperty(d,y):o[d]=y}}var $e=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ct(o,l){if(l){if($e[o]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function Ot(o,l){if(o.indexOf("-")===-1)return typeof l.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kt=null;function wt(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Oe=null,K=null,Le=null;function Ve(o){if(o=Rh(o)){if(typeof Oe!="function")throw Error(t(280));var l=o.stateNode;l&&(l=Of(l),Oe(o.stateNode,o.type,l))}}function ht(o){K?Le?Le.push(o):Le=[o]:K=o}function at(){if(K){var o=K,l=Le;if(Le=K=null,Ve(o),l)for(o=0;o<l.length;o++)Ve(l[o])}}function vt(o,l){return o(l)}function Vt(){}var rn=!1;function xn(o,l,d){if(rn)return o(l,d);rn=!0;try{return vt(o,l,d)}finally{rn=!1,(K!==null||Le!==null)&&(Vt(),at())}}function zt(o,l){var d=o.stateNode;if(d===null)return null;var g=Of(d);if(g===null)return null;d=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break e;default:o=!1}if(o)return null;if(d&&typeof d!="function")throw Error(t(231,l,typeof d));return d}var cn=!1;if(c)try{var Dn={};Object.defineProperty(Dn,"passive",{get:function(){cn=!0}}),window.addEventListener("test",Dn,Dn),window.removeEventListener("test",Dn,Dn)}catch{cn=!1}function so(o,l,d,g,y,x,L,q,Z){var me=Array.prototype.slice.call(arguments,3);try{l.apply(d,me)}catch(Ce){this.onError(Ce)}}var Ln=!1,wn=null,Pi=!1,jn=null,Yi={onError:function(o){Ln=!0,wn=o}};function vs(o,l,d,g,y,x,L,q,Z){Ln=!1,wn=null,so.apply(Yi,arguments)}function pr(o,l,d,g,y,x,L,q,Z){if(vs.apply(this,arguments),Ln){if(Ln){var me=wn;Ln=!1,wn=null}else throw Error(t(198));Pi||(Pi=!0,jn=me)}}function Mr(o){var l=o,d=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,(l.flags&4098)!==0&&(d=l.return),o=l.return;while(o)}return l.tag===3?d:null}function ys(o){if(o.tag===13){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function j(o){if(Mr(o)!==o)throw Error(t(188))}function se(o){var l=o.alternate;if(!l){if(l=Mr(o),l===null)throw Error(t(188));return l!==o?null:o}for(var d=o,g=l;;){var y=d.return;if(y===null)break;var x=y.alternate;if(x===null){if(g=y.return,g!==null){d=g;continue}break}if(y.child===x.child){for(x=y.child;x;){if(x===d)return j(y),o;if(x===g)return j(y),l;x=x.sibling}throw Error(t(188))}if(d.return!==g.return)d=y,g=x;else{for(var L=!1,q=y.child;q;){if(q===d){L=!0,d=y,g=x;break}if(q===g){L=!0,g=y,d=x;break}q=q.sibling}if(!L){for(q=x.child;q;){if(q===d){L=!0,d=x,g=y;break}if(q===g){L=!0,g=x,d=y;break}q=q.sibling}if(!L)throw Error(t(189))}}if(d.alternate!==g)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?o:l}function pe(o){return o=se(o),o!==null?J(o):null}function J(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var l=J(o);if(l!==null)return l;o=o.sibling}return null}var O=e.unstable_scheduleCallback,ae=e.unstable_cancelCallback,Se=e.unstable_shouldYield,Be=e.unstable_requestPaint,Fe=e.unstable_now,et=e.unstable_getCurrentPriorityLevel,tt=e.unstable_ImmediatePriority,dt=e.unstable_UserBlockingPriority,jt=e.unstable_NormalPriority,An=e.unstable_LowPriority,Dt=e.unstable_IdlePriority,Wn=null,kt=null;function Lt(o){if(kt&&typeof kt.onCommitFiberRoot=="function")try{kt.onCommitFiberRoot(Wn,o,void 0,(o.current.flags&128)===128)}catch{}}var mr=Math.clz32?Math.clz32:Es,Qt=Math.log,$n=Math.LN2;function Es(o){return o>>>=0,o===0?32:31-(Qt(o)/$n|0)|0}var br=64,Ii=4194304;function Tt(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function gr(o,l){var d=o.pendingLanes;if(d===0)return 0;var g=0,y=o.suspendedLanes,x=o.pingedLanes,L=d&268435455;if(L!==0){var q=L&~y;q!==0?g=Tt(q):(x&=L,x!==0&&(g=Tt(x)))}else L=d&~y,L!==0?g=Tt(L):x!==0&&(g=Tt(x));if(g===0)return 0;if(l!==0&&l!==g&&(l&y)===0&&(y=g&-g,x=l&-l,y>=x||y===16&&(x&4194240)!==0))return l;if((g&4)!==0&&(g|=d&16),l=o.entangledLanes,l!==0)for(o=o.entanglements,l&=g;0<l;)d=31-mr(l),y=1<<d,g|=o[d],l&=~y;return g}function Zi(o,l){switch(o){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qn(o,l){for(var d=o.suspendedLanes,g=o.pingedLanes,y=o.expirationTimes,x=o.pendingLanes;0<x;){var L=31-mr(x),q=1<<L,Z=y[L];Z===-1?((q&d)===0||(q&g)!==0)&&(y[L]=Zi(q,l)):Z<=l&&(o.expiredLanes|=q),x&=~q}}function oo(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function ol(){var o=br;return br<<=1,(br&4194240)===0&&(br=64),o}function Yo(o){for(var l=[],d=0;31>d;d++)l.push(o);return l}function al(o,l,d){o.pendingLanes|=l,l!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,l=31-mr(l),o[l]=d}function y_(o,l){var d=o.pendingLanes&~l;o.pendingLanes=l,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=l,o.mutableReadLanes&=l,o.entangledLanes&=l,l=o.entanglements;var g=o.eventTimes;for(o=o.expirationTimes;0<d;){var y=31-mr(d),x=1<<y;l[y]=0,g[y]=-1,o[y]=-1,d&=~x}}function uh(o,l){var d=o.entangledLanes|=l;for(o=o.entanglements;d;){var g=31-mr(d),y=1<<g;y&l|o[g]&l&&(o[g]|=l),d&=~y}}var Yt=0;function Ss(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var hh,gc,dh,fh,ph,Ts=!1,_c=[],xs=null,ws=null,_r=null,ll=new Map,ao=new Map,mi=[],yf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zo(o,l){switch(o){case"focusin":case"focusout":xs=null;break;case"dragenter":case"dragleave":ws=null;break;case"mouseover":case"mouseout":_r=null;break;case"pointerover":case"pointerout":ll.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":ao.delete(l.pointerId)}}function Qi(o,l,d,g,y,x){return o===null||o.nativeEvent!==x?(o={blockedOn:l,domEventName:d,eventSystemFlags:g,nativeEvent:x,targetContainers:[y]},l!==null&&(l=Rh(l),l!==null&&gc(l)),o):(o.eventSystemFlags|=g,l=o.targetContainers,y!==null&&l.indexOf(y)===-1&&l.push(y),o)}function Ef(o,l,d,g,y){switch(l){case"focusin":return xs=Qi(xs,o,l,d,g,y),!0;case"dragenter":return ws=Qi(ws,o,l,d,g,y),!0;case"mouseover":return _r=Qi(_r,o,l,d,g,y),!0;case"pointerover":var x=y.pointerId;return ll.set(x,Qi(ll.get(x)||null,o,l,d,g,y)),!0;case"gotpointercapture":return x=y.pointerId,ao.set(x,Qi(ao.get(x)||null,o,l,d,g,y)),!0}return!1}function vc(o){var l=dl(o.target);if(l!==null){var d=Mr(l);if(d!==null){if(l=d.tag,l===13){if(l=ys(d),l!==null){o.blockedOn=l,ph(o.priority,function(){dh(d)});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){o.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}o.blockedOn=null}function un(o){if(o.blockedOn!==null)return!1;for(var l=o.targetContainers;0<l.length;){var d=yc(o.domEventName,o.eventSystemFlags,l[0],o.nativeEvent);if(d===null){d=o.nativeEvent;var g=new d.constructor(d.type,d);Kt=g,d.target.dispatchEvent(g),Kt=null}else return l=Rh(d),l!==null&&gc(l),o.blockedOn=d,!1;l.shift()}return!0}function Sf(o,l,d){un(o)&&d.delete(l)}function E_(){Ts=!1,xs!==null&&un(xs)&&(xs=null),ws!==null&&un(ws)&&(ws=null),_r!==null&&un(_r)&&(_r=null),ll.forEach(Sf),ao.forEach(Sf)}function Qo(o,l){o.blockedOn===l&&(o.blockedOn=null,Ts||(Ts=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,E_)))}function Jo(o){function l(y){return Qo(y,o)}if(0<_c.length){Qo(_c[0],o);for(var d=1;d<_c.length;d++){var g=_c[d];g.blockedOn===o&&(g.blockedOn=null)}}for(xs!==null&&Qo(xs,o),ws!==null&&Qo(ws,o),_r!==null&&Qo(_r,o),ll.forEach(l),ao.forEach(l),d=0;d<mi.length;d++)g=mi[d],g.blockedOn===o&&(g.blockedOn=null);for(;0<mi.length&&(d=mi[0],d.blockedOn===null);)vc(d),d.blockedOn===null&&mi.shift()}var lo=k.ReactCurrentBatchConfig,co=!0;function As(o,l,d,g){var y=Yt,x=lo.transition;lo.transition=null;try{Yt=1,mh(o,l,d,g)}finally{Yt=y,lo.transition=x}}function Tf(o,l,d,g){var y=Yt,x=lo.transition;lo.transition=null;try{Yt=4,mh(o,l,d,g)}finally{Yt=y,lo.transition=x}}function mh(o,l,d,g){if(co){var y=yc(o,l,d,g);if(y===null)I_(o,l,g,Ms,d),Zo(o,g);else if(Ef(y,o,l,d,g))g.stopPropagation();else if(Zo(o,g),l&4&&-1<yf.indexOf(o)){for(;y!==null;){var x=Rh(y);if(x!==null&&hh(x),x=yc(o,l,d,g),x===null&&I_(o,l,g,Ms,d),x===y)break;y=x}y!==null&&g.stopPropagation()}else I_(o,l,g,null,d)}}var Ms=null;function yc(o,l,d,g){if(Ms=null,o=wt(g),o=dl(o),o!==null)if(l=Mr(o),l===null)o=null;else if(d=l.tag,d===13){if(o=ys(l),o!==null)return o;o=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;o=null}else l!==o&&(o=null);return Ms=o,null}function Ec(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(et()){case tt:return 1;case dt:return 4;case jt:case An:return 16;case Dt:return 536870912;default:return 16}default:return 16}}var gi=null,Sc=null,uo=null;function xf(){if(uo)return uo;var o,l=Sc,d=l.length,g,y="value"in gi?gi.value:gi.textContent,x=y.length;for(o=0;o<d&&l[o]===y[o];o++);var L=d-o;for(g=1;g<=L&&l[d-g]===y[x-g];g++);return uo=y.slice(o,1<g?1-g:void 0)}function cl(o){var l=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&l===13&&(o=13)):o=l,o===10&&(o=13),32<=o||o===13?o:0}function bs(){return!0}function gh(){return!1}function Rr(o){function l(d,g,y,x,L){this._reactName=d,this._targetInst=y,this.type=g,this.nativeEvent=x,this.target=L,this.currentTarget=null;for(var q in o)o.hasOwnProperty(q)&&(d=o[q],this[q]=d?d(x):x[q]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?bs:gh,this.isPropagationStopped=gh,this}return ie(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=bs)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=bs)},persist:function(){},isPersistent:bs}),l}var Rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ul=Rr(Rs),ea=ie({},Rs,{view:0,detail:0}),Tc=Rr(ea),xc,wc,_i,hl=ie({},ea,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ct,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==_i&&(_i&&o.type==="mousemove"?(xc=o.screenX-_i.screenX,wc=o.screenY-_i.screenY):wc=xc=0,_i=o),xc)},movementY:function(o){return"movementY"in o?o.movementY:wc}}),_h=Rr(hl),wf=ie({},hl,{dataTransfer:0}),Af=Rr(wf),Ac=ie({},ea,{relatedTarget:0}),vr=Rr(Ac),Mf=ie({},Rs,{animationName:0,elapsedTime:0,pseudoElement:0}),bf=Rr(Mf),ta=ie({},Rs,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),p=Rr(ta),w=ie({},Rs,{data:0}),R=Rr(w),z={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ce={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ve={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function He(o){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(o):(o=ve[o])?!!l[o]:!1}function Ct(){return He}var zn=ie({},ea,{key:function(o){if(o.key){var l=z[o.key]||o.key;if(l!=="Unidentified")return l}return o.type==="keypress"?(o=cl(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?ce[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ct,charCode:function(o){return o.type==="keypress"?cl(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?cl(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),an=Rr(zn),Xn=ie({},hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vi=Rr(Xn),ho=ie({},ea,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ct}),Cs=Rr(ho),Ps=ie({},Rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mc=Rr(Ps),vh=ie({},hl,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),ON=Rr(vh),kN=[9,13,27,32],S_=c&&"CompositionEvent"in window,yh=null;c&&"documentMode"in document&&(yh=document.documentMode);var UN=c&&"TextEvent"in window&&!yh,FT=c&&(!S_||yh&&8<yh&&11>=yh),VT=" ",zT=!1;function BT(o,l){switch(o){case"keyup":return kN.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function HT(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var bc=!1;function FN(o,l){switch(o){case"compositionend":return HT(l);case"keypress":return l.which!==32?null:(zT=!0,VT);case"textInput":return o=l.data,o===VT&&zT?null:o;default:return null}}function VN(o,l){if(bc)return o==="compositionend"||!S_&&BT(o,l)?(o=xf(),uo=Sc=gi=null,bc=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return FT&&l.locale!=="ko"?null:l.data;default:return null}}var zN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function GT(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l==="input"?!!zN[o.type]:l==="textarea"}function jT(o,l,d,g){ht(g),l=Df(l,"onChange"),0<l.length&&(d=new ul("onChange","change",null,d,g),o.push({event:d,listeners:l}))}var Eh=null,Sh=null;function BN(o){lx(o,0)}function Rf(o){var l=Dc(o);if(fe(l))return o}function HN(o,l){if(o==="change")return l}var WT=!1;if(c){var T_;if(c){var x_="oninput"in document;if(!x_){var $T=document.createElement("div");$T.setAttribute("oninput","return;"),x_=typeof $T.oninput=="function"}T_=x_}else T_=!1;WT=T_&&(!document.documentMode||9<document.documentMode)}function qT(){Eh&&(Eh.detachEvent("onpropertychange",XT),Sh=Eh=null)}function XT(o){if(o.propertyName==="value"&&Rf(Sh)){var l=[];jT(l,Sh,o,wt(o)),xn(BN,l)}}function GN(o,l,d){o==="focusin"?(qT(),Eh=l,Sh=d,Eh.attachEvent("onpropertychange",XT)):o==="focusout"&&qT()}function jN(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Rf(Sh)}function WN(o,l){if(o==="click")return Rf(l)}function $N(o,l){if(o==="input"||o==="change")return Rf(l)}function qN(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var Ji=typeof Object.is=="function"?Object.is:qN;function Th(o,l){if(Ji(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var d=Object.keys(o),g=Object.keys(l);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var y=d[g];if(!u.call(l,y)||!Ji(o[y],l[y]))return!1}return!0}function KT(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function YT(o,l){var d=KT(o);o=0;for(var g;d;){if(d.nodeType===3){if(g=o+d.textContent.length,o<=l&&g>=l)return{node:d,offset:l-o};o=g}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=KT(d)}}function ZT(o,l){return o&&l?o===l?!0:o&&o.nodeType===3?!1:l&&l.nodeType===3?ZT(o,l.parentNode):"contains"in o?o.contains(l):o.compareDocumentPosition?!!(o.compareDocumentPosition(l)&16):!1:!1}function QT(){for(var o=window,l=nn();l instanceof o.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)o=l.contentWindow;else break;l=nn(o.document)}return l}function w_(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l&&(l==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||l==="textarea"||o.contentEditable==="true")}function XN(o){var l=QT(),d=o.focusedElem,g=o.selectionRange;if(l!==d&&d&&d.ownerDocument&&ZT(d.ownerDocument.documentElement,d)){if(g!==null&&w_(d)){if(l=g.start,o=g.end,o===void 0&&(o=l),"selectionStart"in d)d.selectionStart=l,d.selectionEnd=Math.min(o,d.value.length);else if(o=(l=d.ownerDocument||document)&&l.defaultView||window,o.getSelection){o=o.getSelection();var y=d.textContent.length,x=Math.min(g.start,y);g=g.end===void 0?x:Math.min(g.end,y),!o.extend&&x>g&&(y=g,g=x,x=y),y=YT(d,x);var L=YT(d,g);y&&L&&(o.rangeCount!==1||o.anchorNode!==y.node||o.anchorOffset!==y.offset||o.focusNode!==L.node||o.focusOffset!==L.offset)&&(l=l.createRange(),l.setStart(y.node,y.offset),o.removeAllRanges(),x>g?(o.addRange(l),o.extend(L.node,L.offset)):(l.setEnd(L.node,L.offset),o.addRange(l)))}}for(l=[],o=d;o=o.parentNode;)o.nodeType===1&&l.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<l.length;d++)o=l[d],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var KN=c&&"documentMode"in document&&11>=document.documentMode,Rc=null,A_=null,xh=null,M_=!1;function JT(o,l,d){var g=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;M_||Rc==null||Rc!==nn(g)||(g=Rc,"selectionStart"in g&&w_(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),xh&&Th(xh,g)||(xh=g,g=Df(A_,"onSelect"),0<g.length&&(l=new ul("onSelect","select",null,l,d),o.push({event:l,listeners:g}),l.target=Rc)))}function Cf(o,l){var d={};return d[o.toLowerCase()]=l.toLowerCase(),d["Webkit"+o]="webkit"+l,d["Moz"+o]="moz"+l,d}var Cc={animationend:Cf("Animation","AnimationEnd"),animationiteration:Cf("Animation","AnimationIteration"),animationstart:Cf("Animation","AnimationStart"),transitionend:Cf("Transition","TransitionEnd")},b_={},ex={};c&&(ex=document.createElement("div").style,"AnimationEvent"in window||(delete Cc.animationend.animation,delete Cc.animationiteration.animation,delete Cc.animationstart.animation),"TransitionEvent"in window||delete Cc.transitionend.transition);function Pf(o){if(b_[o])return b_[o];if(!Cc[o])return o;var l=Cc[o],d;for(d in l)if(l.hasOwnProperty(d)&&d in ex)return b_[o]=l[d];return o}var tx=Pf("animationend"),nx=Pf("animationiteration"),rx=Pf("animationstart"),ix=Pf("transitionend"),sx=new Map,ox="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function na(o,l){sx.set(o,l),s(l,[o])}for(var R_=0;R_<ox.length;R_++){var C_=ox[R_],YN=C_.toLowerCase(),ZN=C_[0].toUpperCase()+C_.slice(1);na(YN,"on"+ZN)}na(tx,"onAnimationEnd"),na(nx,"onAnimationIteration"),na(rx,"onAnimationStart"),na("dblclick","onDoubleClick"),na("focusin","onFocus"),na("focusout","onBlur"),na(ix,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QN=new Set("cancel close invalid load scroll toggle".split(" ").concat(wh));function ax(o,l,d){var g=o.type||"unknown-event";o.currentTarget=d,pr(g,l,void 0,o),o.currentTarget=null}function lx(o,l){l=(l&4)!==0;for(var d=0;d<o.length;d++){var g=o[d],y=g.event;g=g.listeners;e:{var x=void 0;if(l)for(var L=g.length-1;0<=L;L--){var q=g[L],Z=q.instance,me=q.currentTarget;if(q=q.listener,Z!==x&&y.isPropagationStopped())break e;ax(y,q,me),x=Z}else for(L=0;L<g.length;L++){if(q=g[L],Z=q.instance,me=q.currentTarget,q=q.listener,Z!==x&&y.isPropagationStopped())break e;ax(y,q,me),x=Z}}}if(Pi)throw o=jn,Pi=!1,jn=null,o}function gn(o,l){var d=l[U_];d===void 0&&(d=l[U_]=new Set);var g=o+"__bubble";d.has(g)||(cx(l,o,2,!1),d.add(g))}function P_(o,l,d){var g=0;l&&(g|=4),cx(d,o,g,l)}var If="_reactListening"+Math.random().toString(36).slice(2);function Ah(o){if(!o[If]){o[If]=!0,r.forEach(function(d){d!=="selectionchange"&&(QN.has(d)||P_(d,!1,o),P_(d,!0,o))});var l=o.nodeType===9?o:o.ownerDocument;l===null||l[If]||(l[If]=!0,P_("selectionchange",!1,l))}}function cx(o,l,d,g){switch(Ec(l)){case 1:var y=As;break;case 4:y=Tf;break;default:y=mh}d=y.bind(null,l,d,o),y=void 0,!cn||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(y=!0),g?y!==void 0?o.addEventListener(l,d,{capture:!0,passive:y}):o.addEventListener(l,d,!0):y!==void 0?o.addEventListener(l,d,{passive:y}):o.addEventListener(l,d,!1)}function I_(o,l,d,g,y){var x=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var L=g.tag;if(L===3||L===4){var q=g.stateNode.containerInfo;if(q===y||q.nodeType===8&&q.parentNode===y)break;if(L===4)for(L=g.return;L!==null;){var Z=L.tag;if((Z===3||Z===4)&&(Z=L.stateNode.containerInfo,Z===y||Z.nodeType===8&&Z.parentNode===y))return;L=L.return}for(;q!==null;){if(L=dl(q),L===null)return;if(Z=L.tag,Z===5||Z===6){g=x=L;continue e}q=q.parentNode}}g=g.return}xn(function(){var me=x,Ce=wt(d),Ne=[];e:{var be=sx.get(o);if(be!==void 0){var Ke=ul,nt=o;switch(o){case"keypress":if(cl(d)===0)break e;case"keydown":case"keyup":Ke=an;break;case"focusin":nt="focus",Ke=vr;break;case"focusout":nt="blur",Ke=vr;break;case"beforeblur":case"afterblur":Ke=vr;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ke=_h;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ke=Af;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ke=Cs;break;case tx:case nx:case rx:Ke=bf;break;case ix:Ke=Mc;break;case"scroll":Ke=Tc;break;case"wheel":Ke=ON;break;case"copy":case"cut":case"paste":Ke=p;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ke=vi}var it=(l&4)!==0,Bn=!it&&o==="scroll",le=it?be!==null?be+"Capture":null:be;it=[];for(var ee=me,he;ee!==null;){he=ee;var Ue=he.stateNode;if(he.tag===5&&Ue!==null&&(he=Ue,le!==null&&(Ue=zt(ee,le),Ue!=null&&it.push(Mh(ee,Ue,he)))),Bn)break;ee=ee.return}0<it.length&&(be=new Ke(be,nt,null,d,Ce),Ne.push({event:be,listeners:it}))}}if((l&7)===0){e:{if(be=o==="mouseover"||o==="pointerover",Ke=o==="mouseout"||o==="pointerout",be&&d!==Kt&&(nt=d.relatedTarget||d.fromElement)&&(dl(nt)||nt[fo]))break e;if((Ke||be)&&(be=Ce.window===Ce?Ce:(be=Ce.ownerDocument)?be.defaultView||be.parentWindow:window,Ke?(nt=d.relatedTarget||d.toElement,Ke=me,nt=nt?dl(nt):null,nt!==null&&(Bn=Mr(nt),nt!==Bn||nt.tag!==5&&nt.tag!==6)&&(nt=null)):(Ke=null,nt=me),Ke!==nt)){if(it=_h,Ue="onMouseLeave",le="onMouseEnter",ee="mouse",(o==="pointerout"||o==="pointerover")&&(it=vi,Ue="onPointerLeave",le="onPointerEnter",ee="pointer"),Bn=Ke==null?be:Dc(Ke),he=nt==null?be:Dc(nt),be=new it(Ue,ee+"leave",Ke,d,Ce),be.target=Bn,be.relatedTarget=he,Ue=null,dl(Ce)===me&&(it=new it(le,ee+"enter",nt,d,Ce),it.target=he,it.relatedTarget=Bn,Ue=it),Bn=Ue,Ke&&nt)t:{for(it=Ke,le=nt,ee=0,he=it;he;he=Pc(he))ee++;for(he=0,Ue=le;Ue;Ue=Pc(Ue))he++;for(;0<ee-he;)it=Pc(it),ee--;for(;0<he-ee;)le=Pc(le),he--;for(;ee--;){if(it===le||le!==null&&it===le.alternate)break t;it=Pc(it),le=Pc(le)}it=null}else it=null;Ke!==null&&ux(Ne,be,Ke,it,!1),nt!==null&&Bn!==null&&ux(Ne,Bn,nt,it,!0)}}e:{if(be=me?Dc(me):window,Ke=be.nodeName&&be.nodeName.toLowerCase(),Ke==="select"||Ke==="input"&&be.type==="file")var lt=HN;else if(GT(be))if(WT)lt=$N;else{lt=jN;var gt=GN}else(Ke=be.nodeName)&&Ke.toLowerCase()==="input"&&(be.type==="checkbox"||be.type==="radio")&&(lt=WN);if(lt&&(lt=lt(o,me))){jT(Ne,lt,d,Ce);break e}gt&&gt(o,be,me),o==="focusout"&&(gt=be._wrapperState)&&gt.controlled&&be.type==="number"&&G(be,"number",be.value)}switch(gt=me?Dc(me):window,o){case"focusin":(GT(gt)||gt.contentEditable==="true")&&(Rc=gt,A_=me,xh=null);break;case"focusout":xh=A_=Rc=null;break;case"mousedown":M_=!0;break;case"contextmenu":case"mouseup":case"dragend":M_=!1,JT(Ne,d,Ce);break;case"selectionchange":if(KN)break;case"keydown":case"keyup":JT(Ne,d,Ce)}var _t;if(S_)e:{switch(o){case"compositionstart":var At="onCompositionStart";break e;case"compositionend":At="onCompositionEnd";break e;case"compositionupdate":At="onCompositionUpdate";break e}At=void 0}else bc?BT(o,d)&&(At="onCompositionEnd"):o==="keydown"&&d.keyCode===229&&(At="onCompositionStart");At&&(FT&&d.locale!=="ko"&&(bc||At!=="onCompositionStart"?At==="onCompositionEnd"&&bc&&(_t=xf()):(gi=Ce,Sc="value"in gi?gi.value:gi.textContent,bc=!0)),gt=Df(me,At),0<gt.length&&(At=new R(At,o,null,d,Ce),Ne.push({event:At,listeners:gt}),_t?At.data=_t:(_t=HT(d),_t!==null&&(At.data=_t)))),(_t=UN?FN(o,d):VN(o,d))&&(me=Df(me,"onBeforeInput"),0<me.length&&(Ce=new R("onBeforeInput","beforeinput",null,d,Ce),Ne.push({event:Ce,listeners:me}),Ce.data=_t))}lx(Ne,l)})}function Mh(o,l,d){return{instance:o,listener:l,currentTarget:d}}function Df(o,l){for(var d=l+"Capture",g=[];o!==null;){var y=o,x=y.stateNode;y.tag===5&&x!==null&&(y=x,x=zt(o,d),x!=null&&g.unshift(Mh(o,x,y)),x=zt(o,l),x!=null&&g.push(Mh(o,x,y))),o=o.return}return g}function Pc(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function ux(o,l,d,g,y){for(var x=l._reactName,L=[];d!==null&&d!==g;){var q=d,Z=q.alternate,me=q.stateNode;if(Z!==null&&Z===g)break;q.tag===5&&me!==null&&(q=me,y?(Z=zt(d,x),Z!=null&&L.unshift(Mh(d,Z,q))):y||(Z=zt(d,x),Z!=null&&L.push(Mh(d,Z,q)))),d=d.return}L.length!==0&&o.push({event:l,listeners:L})}var JN=/\r\n?/g,eO=/\u0000|\uFFFD/g;function hx(o){return(typeof o=="string"?o:""+o).replace(JN,`
`).replace(eO,"")}function Lf(o,l,d){if(l=hx(l),hx(o)!==l&&d)throw Error(t(425))}function Nf(){}var D_=null,L_=null;function N_(o,l){return o==="textarea"||o==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var O_=typeof setTimeout=="function"?setTimeout:void 0,tO=typeof clearTimeout=="function"?clearTimeout:void 0,dx=typeof Promise=="function"?Promise:void 0,nO=typeof queueMicrotask=="function"?queueMicrotask:typeof dx<"u"?function(o){return dx.resolve(null).then(o).catch(rO)}:O_;function rO(o){setTimeout(function(){throw o})}function k_(o,l){var d=l,g=0;do{var y=d.nextSibling;if(o.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(g===0){o.removeChild(y),Jo(l);return}g--}else d!=="$"&&d!=="$?"&&d!=="$!"||g++;d=y}while(d);Jo(l)}function ra(o){for(;o!=null;o=o.nextSibling){var l=o.nodeType;if(l===1||l===3)break;if(l===8){if(l=o.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return o}function fx(o){o=o.previousSibling;for(var l=0;o;){if(o.nodeType===8){var d=o.data;if(d==="$"||d==="$!"||d==="$?"){if(l===0)return o;l--}else d==="/$"&&l++}o=o.previousSibling}return null}var Ic=Math.random().toString(36).slice(2),Is="__reactFiber$"+Ic,bh="__reactProps$"+Ic,fo="__reactContainer$"+Ic,U_="__reactEvents$"+Ic,iO="__reactListeners$"+Ic,sO="__reactHandles$"+Ic;function dl(o){var l=o[Is];if(l)return l;for(var d=o.parentNode;d;){if(l=d[fo]||d[Is]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(o=fx(o);o!==null;){if(d=o[Is])return d;o=fx(o)}return l}o=d,d=o.parentNode}return null}function Rh(o){return o=o[Is]||o[fo],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Dc(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function Of(o){return o[bh]||null}var F_=[],Lc=-1;function ia(o){return{current:o}}function _n(o){0>Lc||(o.current=F_[Lc],F_[Lc]=null,Lc--)}function fn(o,l){Lc++,F_[Lc]=o.current,o.current=l}var sa={},Cr=ia(sa),ei=ia(!1),fl=sa;function Nc(o,l){var d=o.type.contextTypes;if(!d)return sa;var g=o.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===l)return g.__reactInternalMemoizedMaskedChildContext;var y={},x;for(x in d)y[x]=l[x];return g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=l,o.__reactInternalMemoizedMaskedChildContext=y),y}function ti(o){return o=o.childContextTypes,o!=null}function kf(){_n(ei),_n(Cr)}function px(o,l,d){if(Cr.current!==sa)throw Error(t(168));fn(Cr,l),fn(ei,d)}function mx(o,l,d){var g=o.stateNode;if(l=l.childContextTypes,typeof g.getChildContext!="function")return d;g=g.getChildContext();for(var y in g)if(!(y in l))throw Error(t(108,we(o)||"Unknown",y));return ie({},d,g)}function Uf(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||sa,fl=Cr.current,fn(Cr,o),fn(ei,ei.current),!0}function gx(o,l,d){var g=o.stateNode;if(!g)throw Error(t(169));d?(o=mx(o,l,fl),g.__reactInternalMemoizedMergedChildContext=o,_n(ei),_n(Cr),fn(Cr,o)):_n(ei),fn(ei,d)}var po=null,Ff=!1,V_=!1;function _x(o){po===null?po=[o]:po.push(o)}function oO(o){Ff=!0,_x(o)}function oa(){if(!V_&&po!==null){V_=!0;var o=0,l=Yt;try{var d=po;for(Yt=1;o<d.length;o++){var g=d[o];do g=g(!0);while(g!==null)}po=null,Ff=!1}catch(y){throw po!==null&&(po=po.slice(o+1)),O(tt,oa),y}finally{Yt=l,V_=!1}}return null}var Oc=[],kc=0,Vf=null,zf=0,Di=[],Li=0,pl=null,mo=1,go="";function ml(o,l){Oc[kc++]=zf,Oc[kc++]=Vf,Vf=o,zf=l}function vx(o,l,d){Di[Li++]=mo,Di[Li++]=go,Di[Li++]=pl,pl=o;var g=mo;o=go;var y=32-mr(g)-1;g&=~(1<<y),d+=1;var x=32-mr(l)+y;if(30<x){var L=y-y%5;x=(g&(1<<L)-1).toString(32),g>>=L,y-=L,mo=1<<32-mr(l)+y|d<<y|g,go=x+o}else mo=1<<x|d<<y|g,go=o}function z_(o){o.return!==null&&(ml(o,1),vx(o,1,0))}function B_(o){for(;o===Vf;)Vf=Oc[--kc],Oc[kc]=null,zf=Oc[--kc],Oc[kc]=null;for(;o===pl;)pl=Di[--Li],Di[Li]=null,go=Di[--Li],Di[Li]=null,mo=Di[--Li],Di[Li]=null}var yi=null,Ei=null,En=!1,es=null;function yx(o,l){var d=Ui(5,null,null,0);d.elementType="DELETED",d.stateNode=l,d.return=o,l=o.deletions,l===null?(o.deletions=[d],o.flags|=16):l.push(d)}function Ex(o,l){switch(o.tag){case 5:var d=o.type;return l=l.nodeType!==1||d.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(o.stateNode=l,yi=o,Ei=ra(l.firstChild),!0):!1;case 6:return l=o.pendingProps===""||l.nodeType!==3?null:l,l!==null?(o.stateNode=l,yi=o,Ei=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(d=pl!==null?{id:mo,overflow:go}:null,o.memoizedState={dehydrated:l,treeContext:d,retryLane:1073741824},d=Ui(18,null,null,0),d.stateNode=l,d.return=o,o.child=d,yi=o,Ei=null,!0):!1;default:return!1}}function H_(o){return(o.mode&1)!==0&&(o.flags&128)===0}function G_(o){if(En){var l=Ei;if(l){var d=l;if(!Ex(o,l)){if(H_(o))throw Error(t(418));l=ra(d.nextSibling);var g=yi;l&&Ex(o,l)?yx(g,d):(o.flags=o.flags&-4097|2,En=!1,yi=o)}}else{if(H_(o))throw Error(t(418));o.flags=o.flags&-4097|2,En=!1,yi=o}}}function Sx(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;yi=o}function Bf(o){if(o!==yi)return!1;if(!En)return Sx(o),En=!0,!1;var l;if((l=o.tag!==3)&&!(l=o.tag!==5)&&(l=o.type,l=l!=="head"&&l!=="body"&&!N_(o.type,o.memoizedProps)),l&&(l=Ei)){if(H_(o))throw Tx(),Error(t(418));for(;l;)yx(o,l),l=ra(l.nextSibling)}if(Sx(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,l=0;o;){if(o.nodeType===8){var d=o.data;if(d==="/$"){if(l===0){Ei=ra(o.nextSibling);break e}l--}else d!=="$"&&d!=="$!"&&d!=="$?"||l++}o=o.nextSibling}Ei=null}}else Ei=yi?ra(o.stateNode.nextSibling):null;return!0}function Tx(){for(var o=Ei;o;)o=ra(o.nextSibling)}function Uc(){Ei=yi=null,En=!1}function j_(o){es===null?es=[o]:es.push(o)}var aO=k.ReactCurrentBatchConfig;function Ch(o,l,d){if(o=d.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var g=d.stateNode}if(!g)throw Error(t(147,o));var y=g,x=""+o;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===x?l.ref:(l=function(L){var q=y.refs;L===null?delete q[x]:q[x]=L},l._stringRef=x,l)}if(typeof o!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,o))}return o}function Hf(o,l){throw o=Object.prototype.toString.call(l),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o))}function xx(o){var l=o._init;return l(o._payload)}function wx(o){function l(le,ee){if(o){var he=le.deletions;he===null?(le.deletions=[ee],le.flags|=16):he.push(ee)}}function d(le,ee){if(!o)return null;for(;ee!==null;)l(le,ee),ee=ee.sibling;return null}function g(le,ee){for(le=new Map;ee!==null;)ee.key!==null?le.set(ee.key,ee):le.set(ee.index,ee),ee=ee.sibling;return le}function y(le,ee){return le=pa(le,ee),le.index=0,le.sibling=null,le}function x(le,ee,he){return le.index=he,o?(he=le.alternate,he!==null?(he=he.index,he<ee?(le.flags|=2,ee):he):(le.flags|=2,ee)):(le.flags|=1048576,ee)}function L(le){return o&&le.alternate===null&&(le.flags|=2),le}function q(le,ee,he,Ue){return ee===null||ee.tag!==6?(ee=Ov(he,le.mode,Ue),ee.return=le,ee):(ee=y(ee,he),ee.return=le,ee)}function Z(le,ee,he,Ue){var lt=he.type;return lt===P?Ce(le,ee,he.props.children,Ue,he.key):ee!==null&&(ee.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===ye&&xx(lt)===ee.type)?(Ue=y(ee,he.props),Ue.ref=Ch(le,ee,he),Ue.return=le,Ue):(Ue=dp(he.type,he.key,he.props,null,le.mode,Ue),Ue.ref=Ch(le,ee,he),Ue.return=le,Ue)}function me(le,ee,he,Ue){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==he.containerInfo||ee.stateNode.implementation!==he.implementation?(ee=kv(he,le.mode,Ue),ee.return=le,ee):(ee=y(ee,he.children||[]),ee.return=le,ee)}function Ce(le,ee,he,Ue,lt){return ee===null||ee.tag!==7?(ee=xl(he,le.mode,Ue,lt),ee.return=le,ee):(ee=y(ee,he),ee.return=le,ee)}function Ne(le,ee,he){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=Ov(""+ee,le.mode,he),ee.return=le,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case V:return he=dp(ee.type,ee.key,ee.props,null,le.mode,he),he.ref=Ch(le,null,ee),he.return=le,he;case H:return ee=kv(ee,le.mode,he),ee.return=le,ee;case ye:var Ue=ee._init;return Ne(le,Ue(ee._payload),he)}if(U(ee)||re(ee))return ee=xl(ee,le.mode,he,null),ee.return=le,ee;Hf(le,ee)}return null}function be(le,ee,he,Ue){var lt=ee!==null?ee.key:null;if(typeof he=="string"&&he!==""||typeof he=="number")return lt!==null?null:q(le,ee,""+he,Ue);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case V:return he.key===lt?Z(le,ee,he,Ue):null;case H:return he.key===lt?me(le,ee,he,Ue):null;case ye:return lt=he._init,be(le,ee,lt(he._payload),Ue)}if(U(he)||re(he))return lt!==null?null:Ce(le,ee,he,Ue,null);Hf(le,he)}return null}function Ke(le,ee,he,Ue,lt){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number")return le=le.get(he)||null,q(ee,le,""+Ue,lt);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case V:return le=le.get(Ue.key===null?he:Ue.key)||null,Z(ee,le,Ue,lt);case H:return le=le.get(Ue.key===null?he:Ue.key)||null,me(ee,le,Ue,lt);case ye:var gt=Ue._init;return Ke(le,ee,he,gt(Ue._payload),lt)}if(U(Ue)||re(Ue))return le=le.get(he)||null,Ce(ee,le,Ue,lt,null);Hf(ee,Ue)}return null}function nt(le,ee,he,Ue){for(var lt=null,gt=null,_t=ee,At=ee=0,cr=null;_t!==null&&At<he.length;At++){_t.index>At?(cr=_t,_t=null):cr=_t.sibling;var tn=be(le,_t,he[At],Ue);if(tn===null){_t===null&&(_t=cr);break}o&&_t&&tn.alternate===null&&l(le,_t),ee=x(tn,ee,At),gt===null?lt=tn:gt.sibling=tn,gt=tn,_t=cr}if(At===he.length)return d(le,_t),En&&ml(le,At),lt;if(_t===null){for(;At<he.length;At++)_t=Ne(le,he[At],Ue),_t!==null&&(ee=x(_t,ee,At),gt===null?lt=_t:gt.sibling=_t,gt=_t);return En&&ml(le,At),lt}for(_t=g(le,_t);At<he.length;At++)cr=Ke(_t,le,At,he[At],Ue),cr!==null&&(o&&cr.alternate!==null&&_t.delete(cr.key===null?At:cr.key),ee=x(cr,ee,At),gt===null?lt=cr:gt.sibling=cr,gt=cr);return o&&_t.forEach(function(ma){return l(le,ma)}),En&&ml(le,At),lt}function it(le,ee,he,Ue){var lt=re(he);if(typeof lt!="function")throw Error(t(150));if(he=lt.call(he),he==null)throw Error(t(151));for(var gt=lt=null,_t=ee,At=ee=0,cr=null,tn=he.next();_t!==null&&!tn.done;At++,tn=he.next()){_t.index>At?(cr=_t,_t=null):cr=_t.sibling;var ma=be(le,_t,tn.value,Ue);if(ma===null){_t===null&&(_t=cr);break}o&&_t&&ma.alternate===null&&l(le,_t),ee=x(ma,ee,At),gt===null?lt=ma:gt.sibling=ma,gt=ma,_t=cr}if(tn.done)return d(le,_t),En&&ml(le,At),lt;if(_t===null){for(;!tn.done;At++,tn=he.next())tn=Ne(le,tn.value,Ue),tn!==null&&(ee=x(tn,ee,At),gt===null?lt=tn:gt.sibling=tn,gt=tn);return En&&ml(le,At),lt}for(_t=g(le,_t);!tn.done;At++,tn=he.next())tn=Ke(_t,le,At,tn.value,Ue),tn!==null&&(o&&tn.alternate!==null&&_t.delete(tn.key===null?At:tn.key),ee=x(tn,ee,At),gt===null?lt=tn:gt.sibling=tn,gt=tn);return o&&_t.forEach(function(zO){return l(le,zO)}),En&&ml(le,At),lt}function Bn(le,ee,he,Ue){if(typeof he=="object"&&he!==null&&he.type===P&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case V:e:{for(var lt=he.key,gt=ee;gt!==null;){if(gt.key===lt){if(lt=he.type,lt===P){if(gt.tag===7){d(le,gt.sibling),ee=y(gt,he.props.children),ee.return=le,le=ee;break e}}else if(gt.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===ye&&xx(lt)===gt.type){d(le,gt.sibling),ee=y(gt,he.props),ee.ref=Ch(le,gt,he),ee.return=le,le=ee;break e}d(le,gt);break}else l(le,gt);gt=gt.sibling}he.type===P?(ee=xl(he.props.children,le.mode,Ue,he.key),ee.return=le,le=ee):(Ue=dp(he.type,he.key,he.props,null,le.mode,Ue),Ue.ref=Ch(le,ee,he),Ue.return=le,le=Ue)}return L(le);case H:e:{for(gt=he.key;ee!==null;){if(ee.key===gt)if(ee.tag===4&&ee.stateNode.containerInfo===he.containerInfo&&ee.stateNode.implementation===he.implementation){d(le,ee.sibling),ee=y(ee,he.children||[]),ee.return=le,le=ee;break e}else{d(le,ee);break}else l(le,ee);ee=ee.sibling}ee=kv(he,le.mode,Ue),ee.return=le,le=ee}return L(le);case ye:return gt=he._init,Bn(le,ee,gt(he._payload),Ue)}if(U(he))return nt(le,ee,he,Ue);if(re(he))return it(le,ee,he,Ue);Hf(le,he)}return typeof he=="string"&&he!==""||typeof he=="number"?(he=""+he,ee!==null&&ee.tag===6?(d(le,ee.sibling),ee=y(ee,he),ee.return=le,le=ee):(d(le,ee),ee=Ov(he,le.mode,Ue),ee.return=le,le=ee),L(le)):d(le,ee)}return Bn}var Fc=wx(!0),Ax=wx(!1),Gf=ia(null),jf=null,Vc=null,W_=null;function $_(){W_=Vc=jf=null}function q_(o){var l=Gf.current;_n(Gf),o._currentValue=l}function X_(o,l,d){for(;o!==null;){var g=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),o===d)break;o=o.return}}function zc(o,l){jf=o,W_=Vc=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&l)!==0&&(ni=!0),o.firstContext=null)}function Ni(o){var l=o._currentValue;if(W_!==o)if(o={context:o,memoizedValue:l,next:null},Vc===null){if(jf===null)throw Error(t(308));Vc=o,jf.dependencies={lanes:0,firstContext:o}}else Vc=Vc.next=o;return l}var gl=null;function K_(o){gl===null?gl=[o]:gl.push(o)}function Mx(o,l,d,g){var y=l.interleaved;return y===null?(d.next=d,K_(l)):(d.next=y.next,y.next=d),l.interleaved=d,_o(o,g)}function _o(o,l){o.lanes|=l;var d=o.alternate;for(d!==null&&(d.lanes|=l),d=o,o=o.return;o!==null;)o.childLanes|=l,d=o.alternate,d!==null&&(d.childLanes|=l),d=o,o=o.return;return d.tag===3?d.stateNode:null}var aa=!1;function Y_(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bx(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function vo(o,l){return{eventTime:o,lane:l,tag:0,payload:null,callback:null,next:null}}function la(o,l,d){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(Jt&2)!==0){var y=g.pending;return y===null?l.next=l:(l.next=y.next,y.next=l),g.pending=l,_o(o,d)}return y=g.interleaved,y===null?(l.next=l,K_(g)):(l.next=y.next,y.next=l),g.interleaved=l,_o(o,d)}function Wf(o,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194240)!==0)){var g=l.lanes;g&=o.pendingLanes,d|=g,l.lanes=d,uh(o,d)}}function Rx(o,l){var d=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var y=null,x=null;if(d=d.firstBaseUpdate,d!==null){do{var L={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};x===null?y=x=L:x=x.next=L,d=d.next}while(d!==null);x===null?y=x=l:x=x.next=l}else y=x=l;d={baseState:g.baseState,firstBaseUpdate:y,lastBaseUpdate:x,shared:g.shared,effects:g.effects},o.updateQueue=d;return}o=d.lastBaseUpdate,o===null?d.firstBaseUpdate=l:o.next=l,d.lastBaseUpdate=l}function $f(o,l,d,g){var y=o.updateQueue;aa=!1;var x=y.firstBaseUpdate,L=y.lastBaseUpdate,q=y.shared.pending;if(q!==null){y.shared.pending=null;var Z=q,me=Z.next;Z.next=null,L===null?x=me:L.next=me,L=Z;var Ce=o.alternate;Ce!==null&&(Ce=Ce.updateQueue,q=Ce.lastBaseUpdate,q!==L&&(q===null?Ce.firstBaseUpdate=me:q.next=me,Ce.lastBaseUpdate=Z))}if(x!==null){var Ne=y.baseState;L=0,Ce=me=Z=null,q=x;do{var be=q.lane,Ke=q.eventTime;if((g&be)===be){Ce!==null&&(Ce=Ce.next={eventTime:Ke,lane:0,tag:q.tag,payload:q.payload,callback:q.callback,next:null});e:{var nt=o,it=q;switch(be=l,Ke=d,it.tag){case 1:if(nt=it.payload,typeof nt=="function"){Ne=nt.call(Ke,Ne,be);break e}Ne=nt;break e;case 3:nt.flags=nt.flags&-65537|128;case 0:if(nt=it.payload,be=typeof nt=="function"?nt.call(Ke,Ne,be):nt,be==null)break e;Ne=ie({},Ne,be);break e;case 2:aa=!0}}q.callback!==null&&q.lane!==0&&(o.flags|=64,be=y.effects,be===null?y.effects=[q]:be.push(q))}else Ke={eventTime:Ke,lane:be,tag:q.tag,payload:q.payload,callback:q.callback,next:null},Ce===null?(me=Ce=Ke,Z=Ne):Ce=Ce.next=Ke,L|=be;if(q=q.next,q===null){if(q=y.shared.pending,q===null)break;be=q,q=be.next,be.next=null,y.lastBaseUpdate=be,y.shared.pending=null}}while(!0);if(Ce===null&&(Z=Ne),y.baseState=Z,y.firstBaseUpdate=me,y.lastBaseUpdate=Ce,l=y.shared.interleaved,l!==null){y=l;do L|=y.lane,y=y.next;while(y!==l)}else x===null&&(y.shared.lanes=0);yl|=L,o.lanes=L,o.memoizedState=Ne}}function Cx(o,l,d){if(o=l.effects,l.effects=null,o!==null)for(l=0;l<o.length;l++){var g=o[l],y=g.callback;if(y!==null){if(g.callback=null,g=d,typeof y!="function")throw Error(t(191,y));y.call(g)}}}var Ph={},Ds=ia(Ph),Ih=ia(Ph),Dh=ia(Ph);function _l(o){if(o===Ph)throw Error(t(174));return o}function Z_(o,l){switch(fn(Dh,l),fn(Ih,o),fn(Ds,Ph),o=l.nodeType,o){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:Ge(null,"");break;default:o=o===8?l.parentNode:l,l=o.namespaceURI||null,o=o.tagName,l=Ge(l,o)}_n(Ds),fn(Ds,l)}function Bc(){_n(Ds),_n(Ih),_n(Dh)}function Px(o){_l(Dh.current);var l=_l(Ds.current),d=Ge(l,o.type);l!==d&&(fn(Ih,o),fn(Ds,d))}function Q_(o){Ih.current===o&&(_n(Ds),_n(Ih))}var Mn=ia(0);function qf(o){for(var l=o;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var J_=[];function ev(){for(var o=0;o<J_.length;o++)J_[o]._workInProgressVersionPrimary=null;J_.length=0}var Xf=k.ReactCurrentDispatcher,tv=k.ReactCurrentBatchConfig,vl=0,bn=null,er=null,ar=null,Kf=!1,Lh=!1,Nh=0,lO=0;function Pr(){throw Error(t(321))}function nv(o,l){if(l===null)return!1;for(var d=0;d<l.length&&d<o.length;d++)if(!Ji(o[d],l[d]))return!1;return!0}function rv(o,l,d,g,y,x){if(vl=x,bn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Xf.current=o===null||o.memoizedState===null?dO:fO,o=d(g,y),Lh){x=0;do{if(Lh=!1,Nh=0,25<=x)throw Error(t(301));x+=1,ar=er=null,l.updateQueue=null,Xf.current=pO,o=d(g,y)}while(Lh)}if(Xf.current=Qf,l=er!==null&&er.next!==null,vl=0,ar=er=bn=null,Kf=!1,l)throw Error(t(300));return o}function iv(){var o=Nh!==0;return Nh=0,o}function Ls(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ar===null?bn.memoizedState=ar=o:ar=ar.next=o,ar}function Oi(){if(er===null){var o=bn.alternate;o=o!==null?o.memoizedState:null}else o=er.next;var l=ar===null?bn.memoizedState:ar.next;if(l!==null)ar=l,er=o;else{if(o===null)throw Error(t(310));er=o,o={memoizedState:er.memoizedState,baseState:er.baseState,baseQueue:er.baseQueue,queue:er.queue,next:null},ar===null?bn.memoizedState=ar=o:ar=ar.next=o}return ar}function Oh(o,l){return typeof l=="function"?l(o):l}function sv(o){var l=Oi(),d=l.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=o;var g=er,y=g.baseQueue,x=d.pending;if(x!==null){if(y!==null){var L=y.next;y.next=x.next,x.next=L}g.baseQueue=y=x,d.pending=null}if(y!==null){x=y.next,g=g.baseState;var q=L=null,Z=null,me=x;do{var Ce=me.lane;if((vl&Ce)===Ce)Z!==null&&(Z=Z.next={lane:0,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),g=me.hasEagerState?me.eagerState:o(g,me.action);else{var Ne={lane:Ce,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null};Z===null?(q=Z=Ne,L=g):Z=Z.next=Ne,bn.lanes|=Ce,yl|=Ce}me=me.next}while(me!==null&&me!==x);Z===null?L=g:Z.next=q,Ji(g,l.memoizedState)||(ni=!0),l.memoizedState=g,l.baseState=L,l.baseQueue=Z,d.lastRenderedState=g}if(o=d.interleaved,o!==null){y=o;do x=y.lane,bn.lanes|=x,yl|=x,y=y.next;while(y!==o)}else y===null&&(d.lanes=0);return[l.memoizedState,d.dispatch]}function ov(o){var l=Oi(),d=l.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=o;var g=d.dispatch,y=d.pending,x=l.memoizedState;if(y!==null){d.pending=null;var L=y=y.next;do x=o(x,L.action),L=L.next;while(L!==y);Ji(x,l.memoizedState)||(ni=!0),l.memoizedState=x,l.baseQueue===null&&(l.baseState=x),d.lastRenderedState=x}return[x,g]}function Ix(){}function Dx(o,l){var d=bn,g=Oi(),y=l(),x=!Ji(g.memoizedState,y);if(x&&(g.memoizedState=y,ni=!0),g=g.queue,av(Ox.bind(null,d,g,o),[o]),g.getSnapshot!==l||x||ar!==null&&ar.memoizedState.tag&1){if(d.flags|=2048,kh(9,Nx.bind(null,d,g,y,l),void 0,null),lr===null)throw Error(t(349));(vl&30)!==0||Lx(d,l,y)}return y}function Lx(o,l,d){o.flags|=16384,o={getSnapshot:l,value:d},l=bn.updateQueue,l===null?(l={lastEffect:null,stores:null},bn.updateQueue=l,l.stores=[o]):(d=l.stores,d===null?l.stores=[o]:d.push(o))}function Nx(o,l,d,g){l.value=d,l.getSnapshot=g,kx(l)&&Ux(o)}function Ox(o,l,d){return d(function(){kx(l)&&Ux(o)})}function kx(o){var l=o.getSnapshot;o=o.value;try{var d=l();return!Ji(o,d)}catch{return!0}}function Ux(o){var l=_o(o,1);l!==null&&is(l,o,1,-1)}function Fx(o){var l=Ls();return typeof o=="function"&&(o=o()),l.memoizedState=l.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oh,lastRenderedState:o},l.queue=o,o=o.dispatch=hO.bind(null,bn,o),[l.memoizedState,o]}function kh(o,l,d,g){return o={tag:o,create:l,destroy:d,deps:g,next:null},l=bn.updateQueue,l===null?(l={lastEffect:null,stores:null},bn.updateQueue=l,l.lastEffect=o.next=o):(d=l.lastEffect,d===null?l.lastEffect=o.next=o:(g=d.next,d.next=o,o.next=g,l.lastEffect=o)),o}function Vx(){return Oi().memoizedState}function Yf(o,l,d,g){var y=Ls();bn.flags|=o,y.memoizedState=kh(1|l,d,void 0,g===void 0?null:g)}function Zf(o,l,d,g){var y=Oi();g=g===void 0?null:g;var x=void 0;if(er!==null){var L=er.memoizedState;if(x=L.destroy,g!==null&&nv(g,L.deps)){y.memoizedState=kh(l,d,x,g);return}}bn.flags|=o,y.memoizedState=kh(1|l,d,x,g)}function zx(o,l){return Yf(8390656,8,o,l)}function av(o,l){return Zf(2048,8,o,l)}function Bx(o,l){return Zf(4,2,o,l)}function Hx(o,l){return Zf(4,4,o,l)}function Gx(o,l){if(typeof l=="function")return o=o(),l(o),function(){l(null)};if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function jx(o,l,d){return d=d!=null?d.concat([o]):null,Zf(4,4,Gx.bind(null,l,o),d)}function lv(){}function Wx(o,l){var d=Oi();l=l===void 0?null:l;var g=d.memoizedState;return g!==null&&l!==null&&nv(l,g[1])?g[0]:(d.memoizedState=[o,l],o)}function $x(o,l){var d=Oi();l=l===void 0?null:l;var g=d.memoizedState;return g!==null&&l!==null&&nv(l,g[1])?g[0]:(o=o(),d.memoizedState=[o,l],o)}function qx(o,l,d){return(vl&21)===0?(o.baseState&&(o.baseState=!1,ni=!0),o.memoizedState=d):(Ji(d,l)||(d=ol(),bn.lanes|=d,yl|=d,o.baseState=!0),l)}function cO(o,l){var d=Yt;Yt=d!==0&&4>d?d:4,o(!0);var g=tv.transition;tv.transition={};try{o(!1),l()}finally{Yt=d,tv.transition=g}}function Xx(){return Oi().memoizedState}function uO(o,l,d){var g=da(o);if(d={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null},Kx(o))Yx(l,d);else if(d=Mx(o,l,d,g),d!==null){var y=Gr();is(d,o,g,y),Zx(d,l,g)}}function hO(o,l,d){var g=da(o),y={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null};if(Kx(o))Yx(l,y);else{var x=o.alternate;if(o.lanes===0&&(x===null||x.lanes===0)&&(x=l.lastRenderedReducer,x!==null))try{var L=l.lastRenderedState,q=x(L,d);if(y.hasEagerState=!0,y.eagerState=q,Ji(q,L)){var Z=l.interleaved;Z===null?(y.next=y,K_(l)):(y.next=Z.next,Z.next=y),l.interleaved=y;return}}catch{}d=Mx(o,l,y,g),d!==null&&(y=Gr(),is(d,o,g,y),Zx(d,l,g))}}function Kx(o){var l=o.alternate;return o===bn||l!==null&&l===bn}function Yx(o,l){Lh=Kf=!0;var d=o.pending;d===null?l.next=l:(l.next=d.next,d.next=l),o.pending=l}function Zx(o,l,d){if((d&4194240)!==0){var g=l.lanes;g&=o.pendingLanes,d|=g,l.lanes=d,uh(o,d)}}var Qf={readContext:Ni,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useInsertionEffect:Pr,useLayoutEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useMutableSource:Pr,useSyncExternalStore:Pr,useId:Pr,unstable_isNewReconciler:!1},dO={readContext:Ni,useCallback:function(o,l){return Ls().memoizedState=[o,l===void 0?null:l],o},useContext:Ni,useEffect:zx,useImperativeHandle:function(o,l,d){return d=d!=null?d.concat([o]):null,Yf(4194308,4,Gx.bind(null,l,o),d)},useLayoutEffect:function(o,l){return Yf(4194308,4,o,l)},useInsertionEffect:function(o,l){return Yf(4,2,o,l)},useMemo:function(o,l){var d=Ls();return l=l===void 0?null:l,o=o(),d.memoizedState=[o,l],o},useReducer:function(o,l,d){var g=Ls();return l=d!==void 0?d(l):l,g.memoizedState=g.baseState=l,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:l},g.queue=o,o=o.dispatch=uO.bind(null,bn,o),[g.memoizedState,o]},useRef:function(o){var l=Ls();return o={current:o},l.memoizedState=o},useState:Fx,useDebugValue:lv,useDeferredValue:function(o){return Ls().memoizedState=o},useTransition:function(){var o=Fx(!1),l=o[0];return o=cO.bind(null,o[1]),Ls().memoizedState=o,[l,o]},useMutableSource:function(){},useSyncExternalStore:function(o,l,d){var g=bn,y=Ls();if(En){if(d===void 0)throw Error(t(407));d=d()}else{if(d=l(),lr===null)throw Error(t(349));(vl&30)!==0||Lx(g,l,d)}y.memoizedState=d;var x={value:d,getSnapshot:l};return y.queue=x,zx(Ox.bind(null,g,x,o),[o]),g.flags|=2048,kh(9,Nx.bind(null,g,x,d,l),void 0,null),d},useId:function(){var o=Ls(),l=lr.identifierPrefix;if(En){var d=go,g=mo;d=(g&~(1<<32-mr(g)-1)).toString(32)+d,l=":"+l+"R"+d,d=Nh++,0<d&&(l+="H"+d.toString(32)),l+=":"}else d=lO++,l=":"+l+"r"+d.toString(32)+":";return o.memoizedState=l},unstable_isNewReconciler:!1},fO={readContext:Ni,useCallback:Wx,useContext:Ni,useEffect:av,useImperativeHandle:jx,useInsertionEffect:Bx,useLayoutEffect:Hx,useMemo:$x,useReducer:sv,useRef:Vx,useState:function(){return sv(Oh)},useDebugValue:lv,useDeferredValue:function(o){var l=Oi();return qx(l,er.memoizedState,o)},useTransition:function(){var o=sv(Oh)[0],l=Oi().memoizedState;return[o,l]},useMutableSource:Ix,useSyncExternalStore:Dx,useId:Xx,unstable_isNewReconciler:!1},pO={readContext:Ni,useCallback:Wx,useContext:Ni,useEffect:av,useImperativeHandle:jx,useInsertionEffect:Bx,useLayoutEffect:Hx,useMemo:$x,useReducer:ov,useRef:Vx,useState:function(){return ov(Oh)},useDebugValue:lv,useDeferredValue:function(o){var l=Oi();return er===null?l.memoizedState=o:qx(l,er.memoizedState,o)},useTransition:function(){var o=ov(Oh)[0],l=Oi().memoizedState;return[o,l]},useMutableSource:Ix,useSyncExternalStore:Dx,useId:Xx,unstable_isNewReconciler:!1};function ts(o,l){if(o&&o.defaultProps){l=ie({},l),o=o.defaultProps;for(var d in o)l[d]===void 0&&(l[d]=o[d]);return l}return l}function cv(o,l,d,g){l=o.memoizedState,d=d(g,l),d=d==null?l:ie({},l,d),o.memoizedState=d,o.lanes===0&&(o.updateQueue.baseState=d)}var Jf={isMounted:function(o){return(o=o._reactInternals)?Mr(o)===o:!1},enqueueSetState:function(o,l,d){o=o._reactInternals;var g=Gr(),y=da(o),x=vo(g,y);x.payload=l,d!=null&&(x.callback=d),l=la(o,x,y),l!==null&&(is(l,o,y,g),Wf(l,o,y))},enqueueReplaceState:function(o,l,d){o=o._reactInternals;var g=Gr(),y=da(o),x=vo(g,y);x.tag=1,x.payload=l,d!=null&&(x.callback=d),l=la(o,x,y),l!==null&&(is(l,o,y,g),Wf(l,o,y))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var d=Gr(),g=da(o),y=vo(d,g);y.tag=2,l!=null&&(y.callback=l),l=la(o,y,g),l!==null&&(is(l,o,g,d),Wf(l,o,g))}};function Qx(o,l,d,g,y,x,L){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,x,L):l.prototype&&l.prototype.isPureReactComponent?!Th(d,g)||!Th(y,x):!0}function Jx(o,l,d){var g=!1,y=sa,x=l.contextType;return typeof x=="object"&&x!==null?x=Ni(x):(y=ti(l)?fl:Cr.current,g=l.contextTypes,x=(g=g!=null)?Nc(o,y):sa),l=new l(d,x),o.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Jf,o.stateNode=l,l._reactInternals=o,g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=y,o.__reactInternalMemoizedMaskedChildContext=x),l}function ew(o,l,d,g){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,g),l.state!==o&&Jf.enqueueReplaceState(l,l.state,null)}function uv(o,l,d,g){var y=o.stateNode;y.props=d,y.state=o.memoizedState,y.refs={},Y_(o);var x=l.contextType;typeof x=="object"&&x!==null?y.context=Ni(x):(x=ti(l)?fl:Cr.current,y.context=Nc(o,x)),y.state=o.memoizedState,x=l.getDerivedStateFromProps,typeof x=="function"&&(cv(o,l,x,d),y.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(l=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),l!==y.state&&Jf.enqueueReplaceState(y,y.state,null),$f(o,d,y,g),y.state=o.memoizedState),typeof y.componentDidMount=="function"&&(o.flags|=4194308)}function Hc(o,l){try{var d="",g=l;do d+=Ee(g),g=g.return;while(g);var y=d}catch(x){y=`
Error generating stack: `+x.message+`
`+x.stack}return{value:o,source:l,stack:y,digest:null}}function hv(o,l,d){return{value:o,source:null,stack:d??null,digest:l??null}}function dv(o,l){try{console.error(l.value)}catch(d){setTimeout(function(){throw d})}}var mO=typeof WeakMap=="function"?WeakMap:Map;function tw(o,l,d){d=vo(-1,d),d.tag=3,d.payload={element:null};var g=l.value;return d.callback=function(){op||(op=!0,bv=g),dv(o,l)},d}function nw(o,l,d){d=vo(-1,d),d.tag=3;var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var y=l.value;d.payload=function(){return g(y)},d.callback=function(){dv(o,l)}}var x=o.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(d.callback=function(){dv(o,l),typeof g!="function"&&(ua===null?ua=new Set([this]):ua.add(this));var L=l.stack;this.componentDidCatch(l.value,{componentStack:L!==null?L:""})}),d}function rw(o,l,d){var g=o.pingCache;if(g===null){g=o.pingCache=new mO;var y=new Set;g.set(l,y)}else y=g.get(l),y===void 0&&(y=new Set,g.set(l,y));y.has(d)||(y.add(d),o=CO.bind(null,o,l,d),l.then(o,o))}function iw(o){do{var l;if((l=o.tag===13)&&(l=o.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return o;o=o.return}while(o!==null);return null}function sw(o,l,d,g,y){return(o.mode&1)===0?(o===l?o.flags|=65536:(o.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(l=vo(-1,1),l.tag=2,la(d,l,1))),d.lanes|=1),o):(o.flags|=65536,o.lanes=y,o)}var gO=k.ReactCurrentOwner,ni=!1;function Hr(o,l,d,g){l.child=o===null?Ax(l,null,d,g):Fc(l,o.child,d,g)}function ow(o,l,d,g,y){d=d.render;var x=l.ref;return zc(l,y),g=rv(o,l,d,g,x,y),d=iv(),o!==null&&!ni?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~y,yo(o,l,y)):(En&&d&&z_(l),l.flags|=1,Hr(o,l,g,y),l.child)}function aw(o,l,d,g,y){if(o===null){var x=d.type;return typeof x=="function"&&!Nv(x)&&x.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(l.tag=15,l.type=x,lw(o,l,x,g,y)):(o=dp(d.type,null,g,l,l.mode,y),o.ref=l.ref,o.return=l,l.child=o)}if(x=o.child,(o.lanes&y)===0){var L=x.memoizedProps;if(d=d.compare,d=d!==null?d:Th,d(L,g)&&o.ref===l.ref)return yo(o,l,y)}return l.flags|=1,o=pa(x,g),o.ref=l.ref,o.return=l,l.child=o}function lw(o,l,d,g,y){if(o!==null){var x=o.memoizedProps;if(Th(x,g)&&o.ref===l.ref)if(ni=!1,l.pendingProps=g=x,(o.lanes&y)!==0)(o.flags&131072)!==0&&(ni=!0);else return l.lanes=o.lanes,yo(o,l,y)}return fv(o,l,d,g,y)}function cw(o,l,d){var g=l.pendingProps,y=g.children,x=o!==null?o.memoizedState:null;if(g.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},fn(jc,Si),Si|=d;else{if((d&1073741824)===0)return o=x!==null?x.baseLanes|d:d,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:o,cachePool:null,transitions:null},l.updateQueue=null,fn(jc,Si),Si|=o,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=x!==null?x.baseLanes:d,fn(jc,Si),Si|=g}else x!==null?(g=x.baseLanes|d,l.memoizedState=null):g=d,fn(jc,Si),Si|=g;return Hr(o,l,y,d),l.child}function uw(o,l){var d=l.ref;(o===null&&d!==null||o!==null&&o.ref!==d)&&(l.flags|=512,l.flags|=2097152)}function fv(o,l,d,g,y){var x=ti(d)?fl:Cr.current;return x=Nc(l,x),zc(l,y),d=rv(o,l,d,g,x,y),g=iv(),o!==null&&!ni?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~y,yo(o,l,y)):(En&&g&&z_(l),l.flags|=1,Hr(o,l,d,y),l.child)}function hw(o,l,d,g,y){if(ti(d)){var x=!0;Uf(l)}else x=!1;if(zc(l,y),l.stateNode===null)tp(o,l),Jx(l,d,g),uv(l,d,g,y),g=!0;else if(o===null){var L=l.stateNode,q=l.memoizedProps;L.props=q;var Z=L.context,me=d.contextType;typeof me=="object"&&me!==null?me=Ni(me):(me=ti(d)?fl:Cr.current,me=Nc(l,me));var Ce=d.getDerivedStateFromProps,Ne=typeof Ce=="function"||typeof L.getSnapshotBeforeUpdate=="function";Ne||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(q!==g||Z!==me)&&ew(l,L,g,me),aa=!1;var be=l.memoizedState;L.state=be,$f(l,g,L,y),Z=l.memoizedState,q!==g||be!==Z||ei.current||aa?(typeof Ce=="function"&&(cv(l,d,Ce,g),Z=l.memoizedState),(q=aa||Qx(l,d,q,g,be,Z,me))?(Ne||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(l.flags|=4194308)):(typeof L.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=Z),L.props=g,L.state=Z,L.context=me,g=q):(typeof L.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{L=l.stateNode,bx(o,l),q=l.memoizedProps,me=l.type===l.elementType?q:ts(l.type,q),L.props=me,Ne=l.pendingProps,be=L.context,Z=d.contextType,typeof Z=="object"&&Z!==null?Z=Ni(Z):(Z=ti(d)?fl:Cr.current,Z=Nc(l,Z));var Ke=d.getDerivedStateFromProps;(Ce=typeof Ke=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(q!==Ne||be!==Z)&&ew(l,L,g,Z),aa=!1,be=l.memoizedState,L.state=be,$f(l,g,L,y);var nt=l.memoizedState;q!==Ne||be!==nt||ei.current||aa?(typeof Ke=="function"&&(cv(l,d,Ke,g),nt=l.memoizedState),(me=aa||Qx(l,d,me,g,be,nt,Z)||!1)?(Ce||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(g,nt,Z),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(g,nt,Z)),typeof L.componentDidUpdate=="function"&&(l.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof L.componentDidUpdate!="function"||q===o.memoizedProps&&be===o.memoizedState||(l.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||q===o.memoizedProps&&be===o.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=nt),L.props=g,L.state=nt,L.context=Z,g=me):(typeof L.componentDidUpdate!="function"||q===o.memoizedProps&&be===o.memoizedState||(l.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||q===o.memoizedProps&&be===o.memoizedState||(l.flags|=1024),g=!1)}return pv(o,l,d,g,x,y)}function pv(o,l,d,g,y,x){uw(o,l);var L=(l.flags&128)!==0;if(!g&&!L)return y&&gx(l,d,!1),yo(o,l,x);g=l.stateNode,gO.current=l;var q=L&&typeof d.getDerivedStateFromError!="function"?null:g.render();return l.flags|=1,o!==null&&L?(l.child=Fc(l,o.child,null,x),l.child=Fc(l,null,q,x)):Hr(o,l,q,x),l.memoizedState=g.state,y&&gx(l,d,!0),l.child}function dw(o){var l=o.stateNode;l.pendingContext?px(o,l.pendingContext,l.pendingContext!==l.context):l.context&&px(o,l.context,!1),Z_(o,l.containerInfo)}function fw(o,l,d,g,y){return Uc(),j_(y),l.flags|=256,Hr(o,l,d,g),l.child}var mv={dehydrated:null,treeContext:null,retryLane:0};function gv(o){return{baseLanes:o,cachePool:null,transitions:null}}function pw(o,l,d){var g=l.pendingProps,y=Mn.current,x=!1,L=(l.flags&128)!==0,q;if((q=L)||(q=o!==null&&o.memoizedState===null?!1:(y&2)!==0),q?(x=!0,l.flags&=-129):(o===null||o.memoizedState!==null)&&(y|=1),fn(Mn,y&1),o===null)return G_(l),o=l.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((l.mode&1)===0?l.lanes=1:o.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(L=g.children,o=g.fallback,x?(g=l.mode,x=l.child,L={mode:"hidden",children:L},(g&1)===0&&x!==null?(x.childLanes=0,x.pendingProps=L):x=fp(L,g,0,null),o=xl(o,g,d,null),x.return=l,o.return=l,x.sibling=o,l.child=x,l.child.memoizedState=gv(d),l.memoizedState=mv,o):_v(l,L));if(y=o.memoizedState,y!==null&&(q=y.dehydrated,q!==null))return _O(o,l,L,g,q,y,d);if(x){x=g.fallback,L=l.mode,y=o.child,q=y.sibling;var Z={mode:"hidden",children:g.children};return(L&1)===0&&l.child!==y?(g=l.child,g.childLanes=0,g.pendingProps=Z,l.deletions=null):(g=pa(y,Z),g.subtreeFlags=y.subtreeFlags&14680064),q!==null?x=pa(q,x):(x=xl(x,L,d,null),x.flags|=2),x.return=l,g.return=l,g.sibling=x,l.child=g,g=x,x=l.child,L=o.child.memoizedState,L=L===null?gv(d):{baseLanes:L.baseLanes|d,cachePool:null,transitions:L.transitions},x.memoizedState=L,x.childLanes=o.childLanes&~d,l.memoizedState=mv,g}return x=o.child,o=x.sibling,g=pa(x,{mode:"visible",children:g.children}),(l.mode&1)===0&&(g.lanes=d),g.return=l,g.sibling=null,o!==null&&(d=l.deletions,d===null?(l.deletions=[o],l.flags|=16):d.push(o)),l.child=g,l.memoizedState=null,g}function _v(o,l){return l=fp({mode:"visible",children:l},o.mode,0,null),l.return=o,o.child=l}function ep(o,l,d,g){return g!==null&&j_(g),Fc(l,o.child,null,d),o=_v(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function _O(o,l,d,g,y,x,L){if(d)return l.flags&256?(l.flags&=-257,g=hv(Error(t(422))),ep(o,l,L,g)):l.memoizedState!==null?(l.child=o.child,l.flags|=128,null):(x=g.fallback,y=l.mode,g=fp({mode:"visible",children:g.children},y,0,null),x=xl(x,y,L,null),x.flags|=2,g.return=l,x.return=l,g.sibling=x,l.child=g,(l.mode&1)!==0&&Fc(l,o.child,null,L),l.child.memoizedState=gv(L),l.memoizedState=mv,x);if((l.mode&1)===0)return ep(o,l,L,null);if(y.data==="$!"){if(g=y.nextSibling&&y.nextSibling.dataset,g)var q=g.dgst;return g=q,x=Error(t(419)),g=hv(x,g,void 0),ep(o,l,L,g)}if(q=(L&o.childLanes)!==0,ni||q){if(g=lr,g!==null){switch(L&-L){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(g.suspendedLanes|L))!==0?0:y,y!==0&&y!==x.retryLane&&(x.retryLane=y,_o(o,y),is(g,o,y,-1))}return Lv(),g=hv(Error(t(421))),ep(o,l,L,g)}return y.data==="$?"?(l.flags|=128,l.child=o.child,l=PO.bind(null,o),y._reactRetry=l,null):(o=x.treeContext,Ei=ra(y.nextSibling),yi=l,En=!0,es=null,o!==null&&(Di[Li++]=mo,Di[Li++]=go,Di[Li++]=pl,mo=o.id,go=o.overflow,pl=l),l=_v(l,g.children),l.flags|=4096,l)}function mw(o,l,d){o.lanes|=l;var g=o.alternate;g!==null&&(g.lanes|=l),X_(o.return,l,d)}function vv(o,l,d,g,y){var x=o.memoizedState;x===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:y}:(x.isBackwards=l,x.rendering=null,x.renderingStartTime=0,x.last=g,x.tail=d,x.tailMode=y)}function gw(o,l,d){var g=l.pendingProps,y=g.revealOrder,x=g.tail;if(Hr(o,l,g.children,d),g=Mn.current,(g&2)!==0)g=g&1|2,l.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&mw(o,d,l);else if(o.tag===19)mw(o,d,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break e;for(;o.sibling===null;){if(o.return===null||o.return===l)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}if(fn(Mn,g),(l.mode&1)===0)l.memoizedState=null;else switch(y){case"forwards":for(d=l.child,y=null;d!==null;)o=d.alternate,o!==null&&qf(o)===null&&(y=d),d=d.sibling;d=y,d===null?(y=l.child,l.child=null):(y=d.sibling,d.sibling=null),vv(l,!1,y,d,x);break;case"backwards":for(d=null,y=l.child,l.child=null;y!==null;){if(o=y.alternate,o!==null&&qf(o)===null){l.child=y;break}o=y.sibling,y.sibling=d,d=y,y=o}vv(l,!0,d,null,x);break;case"together":vv(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function tp(o,l){(l.mode&1)===0&&o!==null&&(o.alternate=null,l.alternate=null,l.flags|=2)}function yo(o,l,d){if(o!==null&&(l.dependencies=o.dependencies),yl|=l.lanes,(d&l.childLanes)===0)return null;if(o!==null&&l.child!==o.child)throw Error(t(153));if(l.child!==null){for(o=l.child,d=pa(o,o.pendingProps),l.child=d,d.return=l;o.sibling!==null;)o=o.sibling,d=d.sibling=pa(o,o.pendingProps),d.return=l;d.sibling=null}return l.child}function vO(o,l,d){switch(l.tag){case 3:dw(l),Uc();break;case 5:Px(l);break;case 1:ti(l.type)&&Uf(l);break;case 4:Z_(l,l.stateNode.containerInfo);break;case 10:var g=l.type._context,y=l.memoizedProps.value;fn(Gf,g._currentValue),g._currentValue=y;break;case 13:if(g=l.memoizedState,g!==null)return g.dehydrated!==null?(fn(Mn,Mn.current&1),l.flags|=128,null):(d&l.child.childLanes)!==0?pw(o,l,d):(fn(Mn,Mn.current&1),o=yo(o,l,d),o!==null?o.sibling:null);fn(Mn,Mn.current&1);break;case 19:if(g=(d&l.childLanes)!==0,(o.flags&128)!==0){if(g)return gw(o,l,d);l.flags|=128}if(y=l.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),fn(Mn,Mn.current),g)break;return null;case 22:case 23:return l.lanes=0,cw(o,l,d)}return yo(o,l,d)}var _w,yv,vw,yw;_w=function(o,l){for(var d=l.child;d!==null;){if(d.tag===5||d.tag===6)o.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},yv=function(){},vw=function(o,l,d,g){var y=o.memoizedProps;if(y!==g){o=l.stateNode,_l(Ds.current);var x=null;switch(d){case"input":y=st(o,y),g=st(o,g),x=[];break;case"select":y=ie({},y,{value:void 0}),g=ie({},g,{value:void 0}),x=[];break;case"textarea":y=Ie(o,y),g=Ie(o,g),x=[];break;default:typeof y.onClick!="function"&&typeof g.onClick=="function"&&(o.onclick=Nf)}ct(d,g);var L;d=null;for(me in y)if(!g.hasOwnProperty(me)&&y.hasOwnProperty(me)&&y[me]!=null)if(me==="style"){var q=y[me];for(L in q)q.hasOwnProperty(L)&&(d||(d={}),d[L]="")}else me!=="dangerouslySetInnerHTML"&&me!=="children"&&me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&me!=="autoFocus"&&(i.hasOwnProperty(me)?x||(x=[]):(x=x||[]).push(me,null));for(me in g){var Z=g[me];if(q=y?.[me],g.hasOwnProperty(me)&&Z!==q&&(Z!=null||q!=null))if(me==="style")if(q){for(L in q)!q.hasOwnProperty(L)||Z&&Z.hasOwnProperty(L)||(d||(d={}),d[L]="");for(L in Z)Z.hasOwnProperty(L)&&q[L]!==Z[L]&&(d||(d={}),d[L]=Z[L])}else d||(x||(x=[]),x.push(me,d)),d=Z;else me==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,q=q?q.__html:void 0,Z!=null&&q!==Z&&(x=x||[]).push(me,Z)):me==="children"?typeof Z!="string"&&typeof Z!="number"||(x=x||[]).push(me,""+Z):me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&(i.hasOwnProperty(me)?(Z!=null&&me==="onScroll"&&gn("scroll",o),x||q===Z||(x=[])):(x=x||[]).push(me,Z))}d&&(x=x||[]).push("style",d);var me=x;(l.updateQueue=me)&&(l.flags|=4)}},yw=function(o,l,d,g){d!==g&&(l.flags|=4)};function Uh(o,l){if(!En)switch(o.tailMode){case"hidden":l=o.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?o.tail=null:d.sibling=null;break;case"collapsed":d=o.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Ir(o){var l=o.alternate!==null&&o.alternate.child===o.child,d=0,g=0;if(l)for(var y=o.child;y!==null;)d|=y.lanes|y.childLanes,g|=y.subtreeFlags&14680064,g|=y.flags&14680064,y.return=o,y=y.sibling;else for(y=o.child;y!==null;)d|=y.lanes|y.childLanes,g|=y.subtreeFlags,g|=y.flags,y.return=o,y=y.sibling;return o.subtreeFlags|=g,o.childLanes=d,l}function yO(o,l,d){var g=l.pendingProps;switch(B_(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ir(l),null;case 1:return ti(l.type)&&kf(),Ir(l),null;case 3:return g=l.stateNode,Bc(),_n(ei),_n(Cr),ev(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(o===null||o.child===null)&&(Bf(l)?l.flags|=4:o===null||o.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,es!==null&&(Pv(es),es=null))),yv(o,l),Ir(l),null;case 5:Q_(l);var y=_l(Dh.current);if(d=l.type,o!==null&&l.stateNode!=null)vw(o,l,d,g,y),o.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!g){if(l.stateNode===null)throw Error(t(166));return Ir(l),null}if(o=_l(Ds.current),Bf(l)){g=l.stateNode,d=l.type;var x=l.memoizedProps;switch(g[Is]=l,g[bh]=x,o=(l.mode&1)!==0,d){case"dialog":gn("cancel",g),gn("close",g);break;case"iframe":case"object":case"embed":gn("load",g);break;case"video":case"audio":for(y=0;y<wh.length;y++)gn(wh[y],g);break;case"source":gn("error",g);break;case"img":case"image":case"link":gn("error",g),gn("load",g);break;case"details":gn("toggle",g);break;case"input":ft(g,x),gn("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!x.multiple},gn("invalid",g);break;case"textarea":Re(g,x),gn("invalid",g)}ct(d,x),y=null;for(var L in x)if(x.hasOwnProperty(L)){var q=x[L];L==="children"?typeof q=="string"?g.textContent!==q&&(x.suppressHydrationWarning!==!0&&Lf(g.textContent,q,o),y=["children",q]):typeof q=="number"&&g.textContent!==""+q&&(x.suppressHydrationWarning!==!0&&Lf(g.textContent,q,o),y=["children",""+q]):i.hasOwnProperty(L)&&q!=null&&L==="onScroll"&&gn("scroll",g)}switch(d){case"input":It(g),mt(g,x,!0);break;case"textarea":It(g),Xe(g);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(g.onclick=Nf)}g=y,l.updateQueue=g,g!==null&&(l.flags|=4)}else{L=y.nodeType===9?y:y.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=ze(d)),o==="http://www.w3.org/1999/xhtml"?d==="script"?(o=L.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof g.is=="string"?o=L.createElement(d,{is:g.is}):(o=L.createElement(d),d==="select"&&(L=o,g.multiple?L.multiple=!0:g.size&&(L.size=g.size))):o=L.createElementNS(o,d),o[Is]=l,o[bh]=g,_w(o,l,!1,!1),l.stateNode=o;e:{switch(L=Ot(d,g),d){case"dialog":gn("cancel",o),gn("close",o),y=g;break;case"iframe":case"object":case"embed":gn("load",o),y=g;break;case"video":case"audio":for(y=0;y<wh.length;y++)gn(wh[y],o);y=g;break;case"source":gn("error",o),y=g;break;case"img":case"image":case"link":gn("error",o),gn("load",o),y=g;break;case"details":gn("toggle",o),y=g;break;case"input":ft(o,g),y=st(o,g),gn("invalid",o);break;case"option":y=g;break;case"select":o._wrapperState={wasMultiple:!!g.multiple},y=ie({},g,{value:void 0}),gn("invalid",o);break;case"textarea":Re(o,g),y=Ie(o,g),gn("invalid",o);break;default:y=g}ct(d,y),q=y;for(x in q)if(q.hasOwnProperty(x)){var Z=q[x];x==="style"?rt(o,Z):x==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,Z!=null&&xt(o,Z)):x==="children"?typeof Z=="string"?(d!=="textarea"||Z!=="")&&Ae(o,Z):typeof Z=="number"&&Ae(o,""+Z):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(i.hasOwnProperty(x)?Z!=null&&x==="onScroll"&&gn("scroll",o):Z!=null&&b(o,x,Z,L))}switch(d){case"input":It(o),mt(o,g,!1);break;case"textarea":It(o),Xe(o);break;case"option":g.value!=null&&o.setAttribute("value",""+ke(g.value));break;case"select":o.multiple=!!g.multiple,x=g.value,x!=null?de(o,!!g.multiple,x,!1):g.defaultValue!=null&&de(o,!!g.multiple,g.defaultValue,!0);break;default:typeof y.onClick=="function"&&(o.onclick=Nf)}switch(d){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Ir(l),null;case 6:if(o&&l.stateNode!=null)yw(o,l,o.memoizedProps,g);else{if(typeof g!="string"&&l.stateNode===null)throw Error(t(166));if(d=_l(Dh.current),_l(Ds.current),Bf(l)){if(g=l.stateNode,d=l.memoizedProps,g[Is]=l,(x=g.nodeValue!==d)&&(o=yi,o!==null))switch(o.tag){case 3:Lf(g.nodeValue,d,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Lf(g.nodeValue,d,(o.mode&1)!==0)}x&&(l.flags|=4)}else g=(d.nodeType===9?d:d.ownerDocument).createTextNode(g),g[Is]=l,l.stateNode=g}return Ir(l),null;case 13:if(_n(Mn),g=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(En&&Ei!==null&&(l.mode&1)!==0&&(l.flags&128)===0)Tx(),Uc(),l.flags|=98560,x=!1;else if(x=Bf(l),g!==null&&g.dehydrated!==null){if(o===null){if(!x)throw Error(t(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(t(317));x[Is]=l}else Uc(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Ir(l),x=!1}else es!==null&&(Pv(es),es=null),x=!0;if(!x)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=d,l):(g=g!==null,g!==(o!==null&&o.memoizedState!==null)&&g&&(l.child.flags|=8192,(l.mode&1)!==0&&(o===null||(Mn.current&1)!==0?tr===0&&(tr=3):Lv())),l.updateQueue!==null&&(l.flags|=4),Ir(l),null);case 4:return Bc(),yv(o,l),o===null&&Ah(l.stateNode.containerInfo),Ir(l),null;case 10:return q_(l.type._context),Ir(l),null;case 17:return ti(l.type)&&kf(),Ir(l),null;case 19:if(_n(Mn),x=l.memoizedState,x===null)return Ir(l),null;if(g=(l.flags&128)!==0,L=x.rendering,L===null)if(g)Uh(x,!1);else{if(tr!==0||o!==null&&(o.flags&128)!==0)for(o=l.child;o!==null;){if(L=qf(o),L!==null){for(l.flags|=128,Uh(x,!1),g=L.updateQueue,g!==null&&(l.updateQueue=g,l.flags|=4),l.subtreeFlags=0,g=d,d=l.child;d!==null;)x=d,o=g,x.flags&=14680066,L=x.alternate,L===null?(x.childLanes=0,x.lanes=o,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=L.childLanes,x.lanes=L.lanes,x.child=L.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=L.memoizedProps,x.memoizedState=L.memoizedState,x.updateQueue=L.updateQueue,x.type=L.type,o=L.dependencies,x.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),d=d.sibling;return fn(Mn,Mn.current&1|2),l.child}o=o.sibling}x.tail!==null&&Fe()>Wc&&(l.flags|=128,g=!0,Uh(x,!1),l.lanes=4194304)}else{if(!g)if(o=qf(L),o!==null){if(l.flags|=128,g=!0,d=o.updateQueue,d!==null&&(l.updateQueue=d,l.flags|=4),Uh(x,!0),x.tail===null&&x.tailMode==="hidden"&&!L.alternate&&!En)return Ir(l),null}else 2*Fe()-x.renderingStartTime>Wc&&d!==1073741824&&(l.flags|=128,g=!0,Uh(x,!1),l.lanes=4194304);x.isBackwards?(L.sibling=l.child,l.child=L):(d=x.last,d!==null?d.sibling=L:l.child=L,x.last=L)}return x.tail!==null?(l=x.tail,x.rendering=l,x.tail=l.sibling,x.renderingStartTime=Fe(),l.sibling=null,d=Mn.current,fn(Mn,g?d&1|2:d&1),l):(Ir(l),null);case 22:case 23:return Dv(),g=l.memoizedState!==null,o!==null&&o.memoizedState!==null!==g&&(l.flags|=8192),g&&(l.mode&1)!==0?(Si&1073741824)!==0&&(Ir(l),l.subtreeFlags&6&&(l.flags|=8192)):Ir(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function EO(o,l){switch(B_(l),l.tag){case 1:return ti(l.type)&&kf(),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return Bc(),_n(ei),_n(Cr),ev(),o=l.flags,(o&65536)!==0&&(o&128)===0?(l.flags=o&-65537|128,l):null;case 5:return Q_(l),null;case 13:if(_n(Mn),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(t(340));Uc()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return _n(Mn),null;case 4:return Bc(),null;case 10:return q_(l.type._context),null;case 22:case 23:return Dv(),null;case 24:return null;default:return null}}var np=!1,Dr=!1,SO=typeof WeakSet=="function"?WeakSet:Set,Je=null;function Gc(o,l){var d=o.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(g){Nn(o,l,g)}else d.current=null}function Ev(o,l,d){try{d()}catch(g){Nn(o,l,g)}}var Ew=!1;function TO(o,l){if(D_=co,o=QT(),w_(o)){if("selectionStart"in o)var d={start:o.selectionStart,end:o.selectionEnd};else e:{d=(d=o.ownerDocument)&&d.defaultView||window;var g=d.getSelection&&d.getSelection();if(g&&g.rangeCount!==0){d=g.anchorNode;var y=g.anchorOffset,x=g.focusNode;g=g.focusOffset;try{d.nodeType,x.nodeType}catch{d=null;break e}var L=0,q=-1,Z=-1,me=0,Ce=0,Ne=o,be=null;t:for(;;){for(var Ke;Ne!==d||y!==0&&Ne.nodeType!==3||(q=L+y),Ne!==x||g!==0&&Ne.nodeType!==3||(Z=L+g),Ne.nodeType===3&&(L+=Ne.nodeValue.length),(Ke=Ne.firstChild)!==null;)be=Ne,Ne=Ke;for(;;){if(Ne===o)break t;if(be===d&&++me===y&&(q=L),be===x&&++Ce===g&&(Z=L),(Ke=Ne.nextSibling)!==null)break;Ne=be,be=Ne.parentNode}Ne=Ke}d=q===-1||Z===-1?null:{start:q,end:Z}}else d=null}d=d||{start:0,end:0}}else d=null;for(L_={focusedElem:o,selectionRange:d},co=!1,Je=l;Je!==null;)if(l=Je,o=l.child,(l.subtreeFlags&1028)!==0&&o!==null)o.return=l,Je=o;else for(;Je!==null;){l=Je;try{var nt=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(nt!==null){var it=nt.memoizedProps,Bn=nt.memoizedState,le=l.stateNode,ee=le.getSnapshotBeforeUpdate(l.elementType===l.type?it:ts(l.type,it),Bn);le.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:var he=l.stateNode.containerInfo;he.nodeType===1?he.textContent="":he.nodeType===9&&he.documentElement&&he.removeChild(he.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ue){Nn(l,l.return,Ue)}if(o=l.sibling,o!==null){o.return=l.return,Je=o;break}Je=l.return}return nt=Ew,Ew=!1,nt}function Fh(o,l,d){var g=l.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var y=g=g.next;do{if((y.tag&o)===o){var x=y.destroy;y.destroy=void 0,x!==void 0&&Ev(l,d,x)}y=y.next}while(y!==g)}}function rp(o,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var d=l=l.next;do{if((d.tag&o)===o){var g=d.create;d.destroy=g()}d=d.next}while(d!==l)}}function Sv(o){var l=o.ref;if(l!==null){var d=o.stateNode;o.tag,o=d,typeof l=="function"?l(o):l.current=o}}function Sw(o){var l=o.alternate;l!==null&&(o.alternate=null,Sw(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&(delete l[Is],delete l[bh],delete l[U_],delete l[iO],delete l[sO])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function Tw(o){return o.tag===5||o.tag===3||o.tag===4}function xw(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Tw(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Tv(o,l,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,l?d.nodeType===8?d.parentNode.insertBefore(o,l):d.insertBefore(o,l):(d.nodeType===8?(l=d.parentNode,l.insertBefore(o,d)):(l=d,l.appendChild(o)),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=Nf));else if(g!==4&&(o=o.child,o!==null))for(Tv(o,l,d),o=o.sibling;o!==null;)Tv(o,l,d),o=o.sibling}function xv(o,l,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,l?d.insertBefore(o,l):d.appendChild(o);else if(g!==4&&(o=o.child,o!==null))for(xv(o,l,d),o=o.sibling;o!==null;)xv(o,l,d),o=o.sibling}var yr=null,ns=!1;function ca(o,l,d){for(d=d.child;d!==null;)ww(o,l,d),d=d.sibling}function ww(o,l,d){if(kt&&typeof kt.onCommitFiberUnmount=="function")try{kt.onCommitFiberUnmount(Wn,d)}catch{}switch(d.tag){case 5:Dr||Gc(d,l);case 6:var g=yr,y=ns;yr=null,ca(o,l,d),yr=g,ns=y,yr!==null&&(ns?(o=yr,d=d.stateNode,o.nodeType===8?o.parentNode.removeChild(d):o.removeChild(d)):yr.removeChild(d.stateNode));break;case 18:yr!==null&&(ns?(o=yr,d=d.stateNode,o.nodeType===8?k_(o.parentNode,d):o.nodeType===1&&k_(o,d),Jo(o)):k_(yr,d.stateNode));break;case 4:g=yr,y=ns,yr=d.stateNode.containerInfo,ns=!0,ca(o,l,d),yr=g,ns=y;break;case 0:case 11:case 14:case 15:if(!Dr&&(g=d.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){y=g=g.next;do{var x=y,L=x.destroy;x=x.tag,L!==void 0&&((x&2)!==0||(x&4)!==0)&&Ev(d,l,L),y=y.next}while(y!==g)}ca(o,l,d);break;case 1:if(!Dr&&(Gc(d,l),g=d.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=d.memoizedProps,g.state=d.memoizedState,g.componentWillUnmount()}catch(q){Nn(d,l,q)}ca(o,l,d);break;case 21:ca(o,l,d);break;case 22:d.mode&1?(Dr=(g=Dr)||d.memoizedState!==null,ca(o,l,d),Dr=g):ca(o,l,d);break;default:ca(o,l,d)}}function Aw(o){var l=o.updateQueue;if(l!==null){o.updateQueue=null;var d=o.stateNode;d===null&&(d=o.stateNode=new SO),l.forEach(function(g){var y=IO.bind(null,o,g);d.has(g)||(d.add(g),g.then(y,y))})}}function rs(o,l){var d=l.deletions;if(d!==null)for(var g=0;g<d.length;g++){var y=d[g];try{var x=o,L=l,q=L;e:for(;q!==null;){switch(q.tag){case 5:yr=q.stateNode,ns=!1;break e;case 3:yr=q.stateNode.containerInfo,ns=!0;break e;case 4:yr=q.stateNode.containerInfo,ns=!0;break e}q=q.return}if(yr===null)throw Error(t(160));ww(x,L,y),yr=null,ns=!1;var Z=y.alternate;Z!==null&&(Z.return=null),y.return=null}catch(me){Nn(y,l,me)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Mw(l,o),l=l.sibling}function Mw(o,l){var d=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(rs(l,o),Ns(o),g&4){try{Fh(3,o,o.return),rp(3,o)}catch(it){Nn(o,o.return,it)}try{Fh(5,o,o.return)}catch(it){Nn(o,o.return,it)}}break;case 1:rs(l,o),Ns(o),g&512&&d!==null&&Gc(d,d.return);break;case 5:if(rs(l,o),Ns(o),g&512&&d!==null&&Gc(d,d.return),o.flags&32){var y=o.stateNode;try{Ae(y,"")}catch(it){Nn(o,o.return,it)}}if(g&4&&(y=o.stateNode,y!=null)){var x=o.memoizedProps,L=d!==null?d.memoizedProps:x,q=o.type,Z=o.updateQueue;if(o.updateQueue=null,Z!==null)try{q==="input"&&x.type==="radio"&&x.name!=null&&Qe(y,x),Ot(q,L);var me=Ot(q,x);for(L=0;L<Z.length;L+=2){var Ce=Z[L],Ne=Z[L+1];Ce==="style"?rt(y,Ne):Ce==="dangerouslySetInnerHTML"?xt(y,Ne):Ce==="children"?Ae(y,Ne):b(y,Ce,Ne,me)}switch(q){case"input":Xt(y,x);break;case"textarea":De(y,x);break;case"select":var be=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!x.multiple;var Ke=x.value;Ke!=null?de(y,!!x.multiple,Ke,!1):be!==!!x.multiple&&(x.defaultValue!=null?de(y,!!x.multiple,x.defaultValue,!0):de(y,!!x.multiple,x.multiple?[]:"",!1))}y[bh]=x}catch(it){Nn(o,o.return,it)}}break;case 6:if(rs(l,o),Ns(o),g&4){if(o.stateNode===null)throw Error(t(162));y=o.stateNode,x=o.memoizedProps;try{y.nodeValue=x}catch(it){Nn(o,o.return,it)}}break;case 3:if(rs(l,o),Ns(o),g&4&&d!==null&&d.memoizedState.isDehydrated)try{Jo(l.containerInfo)}catch(it){Nn(o,o.return,it)}break;case 4:rs(l,o),Ns(o);break;case 13:rs(l,o),Ns(o),y=o.child,y.flags&8192&&(x=y.memoizedState!==null,y.stateNode.isHidden=x,!x||y.alternate!==null&&y.alternate.memoizedState!==null||(Mv=Fe())),g&4&&Aw(o);break;case 22:if(Ce=d!==null&&d.memoizedState!==null,o.mode&1?(Dr=(me=Dr)||Ce,rs(l,o),Dr=me):rs(l,o),Ns(o),g&8192){if(me=o.memoizedState!==null,(o.stateNode.isHidden=me)&&!Ce&&(o.mode&1)!==0)for(Je=o,Ce=o.child;Ce!==null;){for(Ne=Je=Ce;Je!==null;){switch(be=Je,Ke=be.child,be.tag){case 0:case 11:case 14:case 15:Fh(4,be,be.return);break;case 1:Gc(be,be.return);var nt=be.stateNode;if(typeof nt.componentWillUnmount=="function"){g=be,d=be.return;try{l=g,nt.props=l.memoizedProps,nt.state=l.memoizedState,nt.componentWillUnmount()}catch(it){Nn(g,d,it)}}break;case 5:Gc(be,be.return);break;case 22:if(be.memoizedState!==null){Cw(Ne);continue}}Ke!==null?(Ke.return=be,Je=Ke):Cw(Ne)}Ce=Ce.sibling}e:for(Ce=null,Ne=o;;){if(Ne.tag===5){if(Ce===null){Ce=Ne;try{y=Ne.stateNode,me?(x=y.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(q=Ne.stateNode,Z=Ne.memoizedProps.style,L=Z!=null&&Z.hasOwnProperty("display")?Z.display:null,q.style.display=ut("display",L))}catch(it){Nn(o,o.return,it)}}}else if(Ne.tag===6){if(Ce===null)try{Ne.stateNode.nodeValue=me?"":Ne.memoizedProps}catch(it){Nn(o,o.return,it)}}else if((Ne.tag!==22&&Ne.tag!==23||Ne.memoizedState===null||Ne===o)&&Ne.child!==null){Ne.child.return=Ne,Ne=Ne.child;continue}if(Ne===o)break e;for(;Ne.sibling===null;){if(Ne.return===null||Ne.return===o)break e;Ce===Ne&&(Ce=null),Ne=Ne.return}Ce===Ne&&(Ce=null),Ne.sibling.return=Ne.return,Ne=Ne.sibling}}break;case 19:rs(l,o),Ns(o),g&4&&Aw(o);break;case 21:break;default:rs(l,o),Ns(o)}}function Ns(o){var l=o.flags;if(l&2){try{e:{for(var d=o.return;d!==null;){if(Tw(d)){var g=d;break e}d=d.return}throw Error(t(160))}switch(g.tag){case 5:var y=g.stateNode;g.flags&32&&(Ae(y,""),g.flags&=-33);var x=xw(o);xv(o,x,y);break;case 3:case 4:var L=g.stateNode.containerInfo,q=xw(o);Tv(o,q,L);break;default:throw Error(t(161))}}catch(Z){Nn(o,o.return,Z)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function xO(o,l,d){Je=o,bw(o)}function bw(o,l,d){for(var g=(o.mode&1)!==0;Je!==null;){var y=Je,x=y.child;if(y.tag===22&&g){var L=y.memoizedState!==null||np;if(!L){var q=y.alternate,Z=q!==null&&q.memoizedState!==null||Dr;q=np;var me=Dr;if(np=L,(Dr=Z)&&!me)for(Je=y;Je!==null;)L=Je,Z=L.child,L.tag===22&&L.memoizedState!==null?Pw(y):Z!==null?(Z.return=L,Je=Z):Pw(y);for(;x!==null;)Je=x,bw(x),x=x.sibling;Je=y,np=q,Dr=me}Rw(o)}else(y.subtreeFlags&8772)!==0&&x!==null?(x.return=y,Je=x):Rw(o)}}function Rw(o){for(;Je!==null;){var l=Je;if((l.flags&8772)!==0){var d=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Dr||rp(5,l);break;case 1:var g=l.stateNode;if(l.flags&4&&!Dr)if(d===null)g.componentDidMount();else{var y=l.elementType===l.type?d.memoizedProps:ts(l.type,d.memoizedProps);g.componentDidUpdate(y,d.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var x=l.updateQueue;x!==null&&Cx(l,x,g);break;case 3:var L=l.updateQueue;if(L!==null){if(d=null,l.child!==null)switch(l.child.tag){case 5:d=l.child.stateNode;break;case 1:d=l.child.stateNode}Cx(l,L,d)}break;case 5:var q=l.stateNode;if(d===null&&l.flags&4){d=q;var Z=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":Z.autoFocus&&d.focus();break;case"img":Z.src&&(d.src=Z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var me=l.alternate;if(me!==null){var Ce=me.memoizedState;if(Ce!==null){var Ne=Ce.dehydrated;Ne!==null&&Jo(Ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Dr||l.flags&512&&Sv(l)}catch(be){Nn(l,l.return,be)}}if(l===o){Je=null;break}if(d=l.sibling,d!==null){d.return=l.return,Je=d;break}Je=l.return}}function Cw(o){for(;Je!==null;){var l=Je;if(l===o){Je=null;break}var d=l.sibling;if(d!==null){d.return=l.return,Je=d;break}Je=l.return}}function Pw(o){for(;Je!==null;){var l=Je;try{switch(l.tag){case 0:case 11:case 15:var d=l.return;try{rp(4,l)}catch(Z){Nn(l,d,Z)}break;case 1:var g=l.stateNode;if(typeof g.componentDidMount=="function"){var y=l.return;try{g.componentDidMount()}catch(Z){Nn(l,y,Z)}}var x=l.return;try{Sv(l)}catch(Z){Nn(l,x,Z)}break;case 5:var L=l.return;try{Sv(l)}catch(Z){Nn(l,L,Z)}}}catch(Z){Nn(l,l.return,Z)}if(l===o){Je=null;break}var q=l.sibling;if(q!==null){q.return=l.return,Je=q;break}Je=l.return}}var wO=Math.ceil,ip=k.ReactCurrentDispatcher,wv=k.ReactCurrentOwner,ki=k.ReactCurrentBatchConfig,Jt=0,lr=null,Kn=null,Er=0,Si=0,jc=ia(0),tr=0,Vh=null,yl=0,sp=0,Av=0,zh=null,ri=null,Mv=0,Wc=1/0,Eo=null,op=!1,bv=null,ua=null,ap=!1,ha=null,lp=0,Bh=0,Rv=null,cp=-1,up=0;function Gr(){return(Jt&6)!==0?Fe():cp!==-1?cp:cp=Fe()}function da(o){return(o.mode&1)===0?1:(Jt&2)!==0&&Er!==0?Er&-Er:aO.transition!==null?(up===0&&(up=ol()),up):(o=Yt,o!==0||(o=window.event,o=o===void 0?16:Ec(o.type)),o)}function is(o,l,d,g){if(50<Bh)throw Bh=0,Rv=null,Error(t(185));al(o,d,g),((Jt&2)===0||o!==lr)&&(o===lr&&((Jt&2)===0&&(sp|=d),tr===4&&fa(o,Er)),ii(o,g),d===1&&Jt===0&&(l.mode&1)===0&&(Wc=Fe()+500,Ff&&oa()))}function ii(o,l){var d=o.callbackNode;qn(o,l);var g=gr(o,o===lr?Er:0);if(g===0)d!==null&&ae(d),o.callbackNode=null,o.callbackPriority=0;else if(l=g&-g,o.callbackPriority!==l){if(d!=null&&ae(d),l===1)o.tag===0?oO(Dw.bind(null,o)):_x(Dw.bind(null,o)),nO(function(){(Jt&6)===0&&oa()}),d=null;else{switch(Ss(g)){case 1:d=tt;break;case 4:d=dt;break;case 16:d=jt;break;case 536870912:d=Dt;break;default:d=jt}d=zw(d,Iw.bind(null,o))}o.callbackPriority=l,o.callbackNode=d}}function Iw(o,l){if(cp=-1,up=0,(Jt&6)!==0)throw Error(t(327));var d=o.callbackNode;if($c()&&o.callbackNode!==d)return null;var g=gr(o,o===lr?Er:0);if(g===0)return null;if((g&30)!==0||(g&o.expiredLanes)!==0||l)l=hp(o,g);else{l=g;var y=Jt;Jt|=2;var x=Nw();(lr!==o||Er!==l)&&(Eo=null,Wc=Fe()+500,Sl(o,l));do try{bO();break}catch(q){Lw(o,q)}while(!0);$_(),ip.current=x,Jt=y,Kn!==null?l=0:(lr=null,Er=0,l=tr)}if(l!==0){if(l===2&&(y=oo(o),y!==0&&(g=y,l=Cv(o,y))),l===1)throw d=Vh,Sl(o,0),fa(o,g),ii(o,Fe()),d;if(l===6)fa(o,g);else{if(y=o.current.alternate,(g&30)===0&&!AO(y)&&(l=hp(o,g),l===2&&(x=oo(o),x!==0&&(g=x,l=Cv(o,x))),l===1))throw d=Vh,Sl(o,0),fa(o,g),ii(o,Fe()),d;switch(o.finishedWork=y,o.finishedLanes=g,l){case 0:case 1:throw Error(t(345));case 2:Tl(o,ri,Eo);break;case 3:if(fa(o,g),(g&130023424)===g&&(l=Mv+500-Fe(),10<l)){if(gr(o,0)!==0)break;if(y=o.suspendedLanes,(y&g)!==g){Gr(),o.pingedLanes|=o.suspendedLanes&y;break}o.timeoutHandle=O_(Tl.bind(null,o,ri,Eo),l);break}Tl(o,ri,Eo);break;case 4:if(fa(o,g),(g&4194240)===g)break;for(l=o.eventTimes,y=-1;0<g;){var L=31-mr(g);x=1<<L,L=l[L],L>y&&(y=L),g&=~x}if(g=y,g=Fe()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*wO(g/1960))-g,10<g){o.timeoutHandle=O_(Tl.bind(null,o,ri,Eo),g);break}Tl(o,ri,Eo);break;case 5:Tl(o,ri,Eo);break;default:throw Error(t(329))}}}return ii(o,Fe()),o.callbackNode===d?Iw.bind(null,o):null}function Cv(o,l){var d=zh;return o.current.memoizedState.isDehydrated&&(Sl(o,l).flags|=256),o=hp(o,l),o!==2&&(l=ri,ri=d,l!==null&&Pv(l)),o}function Pv(o){ri===null?ri=o:ri.push.apply(ri,o)}function AO(o){for(var l=o;;){if(l.flags&16384){var d=l.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var g=0;g<d.length;g++){var y=d[g],x=y.getSnapshot;y=y.value;try{if(!Ji(x(),y))return!1}catch{return!1}}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function fa(o,l){for(l&=~Av,l&=~sp,o.suspendedLanes|=l,o.pingedLanes&=~l,o=o.expirationTimes;0<l;){var d=31-mr(l),g=1<<d;o[d]=-1,l&=~g}}function Dw(o){if((Jt&6)!==0)throw Error(t(327));$c();var l=gr(o,0);if((l&1)===0)return ii(o,Fe()),null;var d=hp(o,l);if(o.tag!==0&&d===2){var g=oo(o);g!==0&&(l=g,d=Cv(o,g))}if(d===1)throw d=Vh,Sl(o,0),fa(o,l),ii(o,Fe()),d;if(d===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=l,Tl(o,ri,Eo),ii(o,Fe()),null}function Iv(o,l){var d=Jt;Jt|=1;try{return o(l)}finally{Jt=d,Jt===0&&(Wc=Fe()+500,Ff&&oa())}}function El(o){ha!==null&&ha.tag===0&&(Jt&6)===0&&$c();var l=Jt;Jt|=1;var d=ki.transition,g=Yt;try{if(ki.transition=null,Yt=1,o)return o()}finally{Yt=g,ki.transition=d,Jt=l,(Jt&6)===0&&oa()}}function Dv(){Si=jc.current,_n(jc)}function Sl(o,l){o.finishedWork=null,o.finishedLanes=0;var d=o.timeoutHandle;if(d!==-1&&(o.timeoutHandle=-1,tO(d)),Kn!==null)for(d=Kn.return;d!==null;){var g=d;switch(B_(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&kf();break;case 3:Bc(),_n(ei),_n(Cr),ev();break;case 5:Q_(g);break;case 4:Bc();break;case 13:_n(Mn);break;case 19:_n(Mn);break;case 10:q_(g.type._context);break;case 22:case 23:Dv()}d=d.return}if(lr=o,Kn=o=pa(o.current,null),Er=Si=l,tr=0,Vh=null,Av=sp=yl=0,ri=zh=null,gl!==null){for(l=0;l<gl.length;l++)if(d=gl[l],g=d.interleaved,g!==null){d.interleaved=null;var y=g.next,x=d.pending;if(x!==null){var L=x.next;x.next=y,g.next=L}d.pending=g}gl=null}return o}function Lw(o,l){do{var d=Kn;try{if($_(),Xf.current=Qf,Kf){for(var g=bn.memoizedState;g!==null;){var y=g.queue;y!==null&&(y.pending=null),g=g.next}Kf=!1}if(vl=0,ar=er=bn=null,Lh=!1,Nh=0,wv.current=null,d===null||d.return===null){tr=1,Vh=l,Kn=null;break}e:{var x=o,L=d.return,q=d,Z=l;if(l=Er,q.flags|=32768,Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var me=Z,Ce=q,Ne=Ce.tag;if((Ce.mode&1)===0&&(Ne===0||Ne===11||Ne===15)){var be=Ce.alternate;be?(Ce.updateQueue=be.updateQueue,Ce.memoizedState=be.memoizedState,Ce.lanes=be.lanes):(Ce.updateQueue=null,Ce.memoizedState=null)}var Ke=iw(L);if(Ke!==null){Ke.flags&=-257,sw(Ke,L,q,x,l),Ke.mode&1&&rw(x,me,l),l=Ke,Z=me;var nt=l.updateQueue;if(nt===null){var it=new Set;it.add(Z),l.updateQueue=it}else nt.add(Z);break e}else{if((l&1)===0){rw(x,me,l),Lv();break e}Z=Error(t(426))}}else if(En&&q.mode&1){var Bn=iw(L);if(Bn!==null){(Bn.flags&65536)===0&&(Bn.flags|=256),sw(Bn,L,q,x,l),j_(Hc(Z,q));break e}}x=Z=Hc(Z,q),tr!==4&&(tr=2),zh===null?zh=[x]:zh.push(x),x=L;do{switch(x.tag){case 3:x.flags|=65536,l&=-l,x.lanes|=l;var le=tw(x,Z,l);Rx(x,le);break e;case 1:q=Z;var ee=x.type,he=x.stateNode;if((x.flags&128)===0&&(typeof ee.getDerivedStateFromError=="function"||he!==null&&typeof he.componentDidCatch=="function"&&(ua===null||!ua.has(he)))){x.flags|=65536,l&=-l,x.lanes|=l;var Ue=nw(x,q,l);Rx(x,Ue);break e}}x=x.return}while(x!==null)}kw(d)}catch(lt){l=lt,Kn===d&&d!==null&&(Kn=d=d.return);continue}break}while(!0)}function Nw(){var o=ip.current;return ip.current=Qf,o===null?Qf:o}function Lv(){(tr===0||tr===3||tr===2)&&(tr=4),lr===null||(yl&268435455)===0&&(sp&268435455)===0||fa(lr,Er)}function hp(o,l){var d=Jt;Jt|=2;var g=Nw();(lr!==o||Er!==l)&&(Eo=null,Sl(o,l));do try{MO();break}catch(y){Lw(o,y)}while(!0);if($_(),Jt=d,ip.current=g,Kn!==null)throw Error(t(261));return lr=null,Er=0,tr}function MO(){for(;Kn!==null;)Ow(Kn)}function bO(){for(;Kn!==null&&!Se();)Ow(Kn)}function Ow(o){var l=Vw(o.alternate,o,Si);o.memoizedProps=o.pendingProps,l===null?kw(o):Kn=l,wv.current=null}function kw(o){var l=o;do{var d=l.alternate;if(o=l.return,(l.flags&32768)===0){if(d=yO(d,l,Si),d!==null){Kn=d;return}}else{if(d=EO(d,l),d!==null){d.flags&=32767,Kn=d;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{tr=6,Kn=null;return}}if(l=l.sibling,l!==null){Kn=l;return}Kn=l=o}while(l!==null);tr===0&&(tr=5)}function Tl(o,l,d){var g=Yt,y=ki.transition;try{ki.transition=null,Yt=1,RO(o,l,d,g)}finally{ki.transition=y,Yt=g}return null}function RO(o,l,d,g){do $c();while(ha!==null);if((Jt&6)!==0)throw Error(t(327));d=o.finishedWork;var y=o.finishedLanes;if(d===null)return null;if(o.finishedWork=null,o.finishedLanes=0,d===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var x=d.lanes|d.childLanes;if(y_(o,x),o===lr&&(Kn=lr=null,Er=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||ap||(ap=!0,zw(jt,function(){return $c(),null})),x=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||x){x=ki.transition,ki.transition=null;var L=Yt;Yt=1;var q=Jt;Jt|=4,wv.current=null,TO(o,d),Mw(d,o),XN(L_),co=!!D_,L_=D_=null,o.current=d,xO(d),Be(),Jt=q,Yt=L,ki.transition=x}else o.current=d;if(ap&&(ap=!1,ha=o,lp=y),x=o.pendingLanes,x===0&&(ua=null),Lt(d.stateNode),ii(o,Fe()),l!==null)for(g=o.onRecoverableError,d=0;d<l.length;d++)y=l[d],g(y.value,{componentStack:y.stack,digest:y.digest});if(op)throw op=!1,o=bv,bv=null,o;return(lp&1)!==0&&o.tag!==0&&$c(),x=o.pendingLanes,(x&1)!==0?o===Rv?Bh++:(Bh=0,Rv=o):Bh=0,oa(),null}function $c(){if(ha!==null){var o=Ss(lp),l=ki.transition,d=Yt;try{if(ki.transition=null,Yt=16>o?16:o,ha===null)var g=!1;else{if(o=ha,ha=null,lp=0,(Jt&6)!==0)throw Error(t(331));var y=Jt;for(Jt|=4,Je=o.current;Je!==null;){var x=Je,L=x.child;if((Je.flags&16)!==0){var q=x.deletions;if(q!==null){for(var Z=0;Z<q.length;Z++){var me=q[Z];for(Je=me;Je!==null;){var Ce=Je;switch(Ce.tag){case 0:case 11:case 15:Fh(8,Ce,x)}var Ne=Ce.child;if(Ne!==null)Ne.return=Ce,Je=Ne;else for(;Je!==null;){Ce=Je;var be=Ce.sibling,Ke=Ce.return;if(Sw(Ce),Ce===me){Je=null;break}if(be!==null){be.return=Ke,Je=be;break}Je=Ke}}}var nt=x.alternate;if(nt!==null){var it=nt.child;if(it!==null){nt.child=null;do{var Bn=it.sibling;it.sibling=null,it=Bn}while(it!==null)}}Je=x}}if((x.subtreeFlags&2064)!==0&&L!==null)L.return=x,Je=L;else e:for(;Je!==null;){if(x=Je,(x.flags&2048)!==0)switch(x.tag){case 0:case 11:case 15:Fh(9,x,x.return)}var le=x.sibling;if(le!==null){le.return=x.return,Je=le;break e}Je=x.return}}var ee=o.current;for(Je=ee;Je!==null;){L=Je;var he=L.child;if((L.subtreeFlags&2064)!==0&&he!==null)he.return=L,Je=he;else e:for(L=ee;Je!==null;){if(q=Je,(q.flags&2048)!==0)try{switch(q.tag){case 0:case 11:case 15:rp(9,q)}}catch(lt){Nn(q,q.return,lt)}if(q===L){Je=null;break e}var Ue=q.sibling;if(Ue!==null){Ue.return=q.return,Je=Ue;break e}Je=q.return}}if(Jt=y,oa(),kt&&typeof kt.onPostCommitFiberRoot=="function")try{kt.onPostCommitFiberRoot(Wn,o)}catch{}g=!0}return g}finally{Yt=d,ki.transition=l}}return!1}function Uw(o,l,d){l=Hc(d,l),l=tw(o,l,1),o=la(o,l,1),l=Gr(),o!==null&&(al(o,1,l),ii(o,l))}function Nn(o,l,d){if(o.tag===3)Uw(o,o,d);else for(;l!==null;){if(l.tag===3){Uw(l,o,d);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(ua===null||!ua.has(g))){o=Hc(d,o),o=nw(l,o,1),l=la(l,o,1),o=Gr(),l!==null&&(al(l,1,o),ii(l,o));break}}l=l.return}}function CO(o,l,d){var g=o.pingCache;g!==null&&g.delete(l),l=Gr(),o.pingedLanes|=o.suspendedLanes&d,lr===o&&(Er&d)===d&&(tr===4||tr===3&&(Er&130023424)===Er&&500>Fe()-Mv?Sl(o,0):Av|=d),ii(o,l)}function Fw(o,l){l===0&&((o.mode&1)===0?l=1:(l=Ii,Ii<<=1,(Ii&130023424)===0&&(Ii=4194304)));var d=Gr();o=_o(o,l),o!==null&&(al(o,l,d),ii(o,d))}function PO(o){var l=o.memoizedState,d=0;l!==null&&(d=l.retryLane),Fw(o,d)}function IO(o,l){var d=0;switch(o.tag){case 13:var g=o.stateNode,y=o.memoizedState;y!==null&&(d=y.retryLane);break;case 19:g=o.stateNode;break;default:throw Error(t(314))}g!==null&&g.delete(l),Fw(o,d)}var Vw;Vw=function(o,l,d){if(o!==null)if(o.memoizedProps!==l.pendingProps||ei.current)ni=!0;else{if((o.lanes&d)===0&&(l.flags&128)===0)return ni=!1,vO(o,l,d);ni=(o.flags&131072)!==0}else ni=!1,En&&(l.flags&1048576)!==0&&vx(l,zf,l.index);switch(l.lanes=0,l.tag){case 2:var g=l.type;tp(o,l),o=l.pendingProps;var y=Nc(l,Cr.current);zc(l,d),y=rv(null,l,g,o,y,d);var x=iv();return l.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,ti(g)?(x=!0,Uf(l)):x=!1,l.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Y_(l),y.updater=Jf,l.stateNode=y,y._reactInternals=l,uv(l,g,o,d),l=pv(null,l,g,!0,x,d)):(l.tag=0,En&&x&&z_(l),Hr(null,l,y,d),l=l.child),l;case 16:g=l.elementType;e:{switch(tp(o,l),o=l.pendingProps,y=g._init,g=y(g._payload),l.type=g,y=l.tag=LO(g),o=ts(g,o),y){case 0:l=fv(null,l,g,o,d);break e;case 1:l=hw(null,l,g,o,d);break e;case 11:l=ow(null,l,g,o,d);break e;case 14:l=aw(null,l,g,ts(g.type,o),d);break e}throw Error(t(306,g,""))}return l;case 0:return g=l.type,y=l.pendingProps,y=l.elementType===g?y:ts(g,y),fv(o,l,g,y,d);case 1:return g=l.type,y=l.pendingProps,y=l.elementType===g?y:ts(g,y),hw(o,l,g,y,d);case 3:e:{if(dw(l),o===null)throw Error(t(387));g=l.pendingProps,x=l.memoizedState,y=x.element,bx(o,l),$f(l,g,null,d);var L=l.memoizedState;if(g=L.element,x.isDehydrated)if(x={element:g,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},l.updateQueue.baseState=x,l.memoizedState=x,l.flags&256){y=Hc(Error(t(423)),l),l=fw(o,l,g,d,y);break e}else if(g!==y){y=Hc(Error(t(424)),l),l=fw(o,l,g,d,y);break e}else for(Ei=ra(l.stateNode.containerInfo.firstChild),yi=l,En=!0,es=null,d=Ax(l,null,g,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Uc(),g===y){l=yo(o,l,d);break e}Hr(o,l,g,d)}l=l.child}return l;case 5:return Px(l),o===null&&G_(l),g=l.type,y=l.pendingProps,x=o!==null?o.memoizedProps:null,L=y.children,N_(g,y)?L=null:x!==null&&N_(g,x)&&(l.flags|=32),uw(o,l),Hr(o,l,L,d),l.child;case 6:return o===null&&G_(l),null;case 13:return pw(o,l,d);case 4:return Z_(l,l.stateNode.containerInfo),g=l.pendingProps,o===null?l.child=Fc(l,null,g,d):Hr(o,l,g,d),l.child;case 11:return g=l.type,y=l.pendingProps,y=l.elementType===g?y:ts(g,y),ow(o,l,g,y,d);case 7:return Hr(o,l,l.pendingProps,d),l.child;case 8:return Hr(o,l,l.pendingProps.children,d),l.child;case 12:return Hr(o,l,l.pendingProps.children,d),l.child;case 10:e:{if(g=l.type._context,y=l.pendingProps,x=l.memoizedProps,L=y.value,fn(Gf,g._currentValue),g._currentValue=L,x!==null)if(Ji(x.value,L)){if(x.children===y.children&&!ei.current){l=yo(o,l,d);break e}}else for(x=l.child,x!==null&&(x.return=l);x!==null;){var q=x.dependencies;if(q!==null){L=x.child;for(var Z=q.firstContext;Z!==null;){if(Z.context===g){if(x.tag===1){Z=vo(-1,d&-d),Z.tag=2;var me=x.updateQueue;if(me!==null){me=me.shared;var Ce=me.pending;Ce===null?Z.next=Z:(Z.next=Ce.next,Ce.next=Z),me.pending=Z}}x.lanes|=d,Z=x.alternate,Z!==null&&(Z.lanes|=d),X_(x.return,d,l),q.lanes|=d;break}Z=Z.next}}else if(x.tag===10)L=x.type===l.type?null:x.child;else if(x.tag===18){if(L=x.return,L===null)throw Error(t(341));L.lanes|=d,q=L.alternate,q!==null&&(q.lanes|=d),X_(L,d,l),L=x.sibling}else L=x.child;if(L!==null)L.return=x;else for(L=x;L!==null;){if(L===l){L=null;break}if(x=L.sibling,x!==null){x.return=L.return,L=x;break}L=L.return}x=L}Hr(o,l,y.children,d),l=l.child}return l;case 9:return y=l.type,g=l.pendingProps.children,zc(l,d),y=Ni(y),g=g(y),l.flags|=1,Hr(o,l,g,d),l.child;case 14:return g=l.type,y=ts(g,l.pendingProps),y=ts(g.type,y),aw(o,l,g,y,d);case 15:return lw(o,l,l.type,l.pendingProps,d);case 17:return g=l.type,y=l.pendingProps,y=l.elementType===g?y:ts(g,y),tp(o,l),l.tag=1,ti(g)?(o=!0,Uf(l)):o=!1,zc(l,d),Jx(l,g,y),uv(l,g,y,d),pv(null,l,g,!0,o,d);case 19:return gw(o,l,d);case 22:return cw(o,l,d)}throw Error(t(156,l.tag))};function zw(o,l){return O(o,l)}function DO(o,l,d,g){this.tag=o,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ui(o,l,d,g){return new DO(o,l,d,g)}function Nv(o){return o=o.prototype,!(!o||!o.isReactComponent)}function LO(o){if(typeof o=="function")return Nv(o)?1:0;if(o!=null){if(o=o.$$typeof,o===W)return 11;if(o===ue)return 14}return 2}function pa(o,l){var d=o.alternate;return d===null?(d=Ui(o.tag,l,o.key,o.mode),d.elementType=o.elementType,d.type=o.type,d.stateNode=o.stateNode,d.alternate=o,o.alternate=d):(d.pendingProps=l,d.type=o.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=o.flags&14680064,d.childLanes=o.childLanes,d.lanes=o.lanes,d.child=o.child,d.memoizedProps=o.memoizedProps,d.memoizedState=o.memoizedState,d.updateQueue=o.updateQueue,l=o.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=o.sibling,d.index=o.index,d.ref=o.ref,d}function dp(o,l,d,g,y,x){var L=2;if(g=o,typeof o=="function")Nv(o)&&(L=1);else if(typeof o=="string")L=5;else e:switch(o){case P:return xl(d.children,y,x,l);case I:L=8,y|=8;break;case M:return o=Ui(12,d,l,y|2),o.elementType=M,o.lanes=x,o;case F:return o=Ui(13,d,l,y),o.elementType=F,o.lanes=x,o;case Y:return o=Ui(19,d,l,y),o.elementType=Y,o.lanes=x,o;case ge:return fp(d,y,x,l);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case C:L=10;break e;case N:L=9;break e;case W:L=11;break e;case ue:L=14;break e;case ye:L=16,g=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return l=Ui(L,d,l,y),l.elementType=o,l.type=g,l.lanes=x,l}function xl(o,l,d,g){return o=Ui(7,o,g,l),o.lanes=d,o}function fp(o,l,d,g){return o=Ui(22,o,g,l),o.elementType=ge,o.lanes=d,o.stateNode={isHidden:!1},o}function Ov(o,l,d){return o=Ui(6,o,null,l),o.lanes=d,o}function kv(o,l,d){return l=Ui(4,o.children!==null?o.children:[],o.key,l),l.lanes=d,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}function NO(o,l,d,g,y){this.tag=l,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yo(0),this.expirationTimes=Yo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yo(0),this.identifierPrefix=g,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function Uv(o,l,d,g,y,x,L,q,Z){return o=new NO(o,l,d,q,Z),l===1?(l=1,x===!0&&(l|=8)):l=0,x=Ui(3,null,null,l),o.current=x,x.stateNode=o,x.memoizedState={element:g,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Y_(x),o}function OO(o,l,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:H,key:g==null?null:""+g,children:o,containerInfo:l,implementation:d}}function Bw(o){if(!o)return sa;o=o._reactInternals;e:{if(Mr(o)!==o||o.tag!==1)throw Error(t(170));var l=o;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(ti(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(o.tag===1){var d=o.type;if(ti(d))return mx(o,d,l)}return l}function Hw(o,l,d,g,y,x,L,q,Z){return o=Uv(d,g,!0,o,y,x,L,q,Z),o.context=Bw(null),d=o.current,g=Gr(),y=da(d),x=vo(g,y),x.callback=l??null,la(d,x,y),o.current.lanes=y,al(o,y,g),ii(o,g),o}function pp(o,l,d,g){var y=l.current,x=Gr(),L=da(y);return d=Bw(d),l.context===null?l.context=d:l.pendingContext=d,l=vo(x,L),l.payload={element:o},g=g===void 0?null:g,g!==null&&(l.callback=g),o=la(y,l,L),o!==null&&(is(o,y,L,x),Wf(o,y,L)),L}function mp(o){return o=o.current,o.child?(o.child.tag===5,o.child.stateNode):null}function Gw(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var d=o.retryLane;o.retryLane=d!==0&&d<l?d:l}}function Fv(o,l){Gw(o,l),(o=o.alternate)&&Gw(o,l)}function kO(){return null}var jw=typeof reportError=="function"?reportError:function(o){console.error(o)};function Vv(o){this._internalRoot=o}gp.prototype.render=Vv.prototype.render=function(o){var l=this._internalRoot;if(l===null)throw Error(t(409));pp(o,l,null,null)},gp.prototype.unmount=Vv.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var l=o.containerInfo;El(function(){pp(null,o,null,null)}),l[fo]=null}};function gp(o){this._internalRoot=o}gp.prototype.unstable_scheduleHydration=function(o){if(o){var l=fh();o={blockedOn:null,target:o,priority:l};for(var d=0;d<mi.length&&l!==0&&l<mi[d].priority;d++);mi.splice(d,0,o),d===0&&vc(o)}};function zv(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function _p(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function Ww(){}function UO(o,l,d,g,y){if(y){if(typeof g=="function"){var x=g;g=function(){var me=mp(L);x.call(me)}}var L=Hw(l,g,o,0,null,!1,!1,"",Ww);return o._reactRootContainer=L,o[fo]=L.current,Ah(o.nodeType===8?o.parentNode:o),El(),L}for(;y=o.lastChild;)o.removeChild(y);if(typeof g=="function"){var q=g;g=function(){var me=mp(Z);q.call(me)}}var Z=Uv(o,0,!1,null,null,!1,!1,"",Ww);return o._reactRootContainer=Z,o[fo]=Z.current,Ah(o.nodeType===8?o.parentNode:o),El(function(){pp(l,Z,d,g)}),Z}function vp(o,l,d,g,y){var x=d._reactRootContainer;if(x){var L=x;if(typeof y=="function"){var q=y;y=function(){var Z=mp(L);q.call(Z)}}pp(l,L,o,y)}else L=UO(d,l,o,y,g);return mp(L)}hh=function(o){switch(o.tag){case 3:var l=o.stateNode;if(l.current.memoizedState.isDehydrated){var d=Tt(l.pendingLanes);d!==0&&(uh(l,d|1),ii(l,Fe()),(Jt&6)===0&&(Wc=Fe()+500,oa()))}break;case 13:El(function(){var g=_o(o,1);if(g!==null){var y=Gr();is(g,o,1,y)}}),Fv(o,1)}},gc=function(o){if(o.tag===13){var l=_o(o,134217728);if(l!==null){var d=Gr();is(l,o,134217728,d)}Fv(o,134217728)}},dh=function(o){if(o.tag===13){var l=da(o),d=_o(o,l);if(d!==null){var g=Gr();is(d,o,l,g)}Fv(o,l)}},fh=function(){return Yt},ph=function(o,l){var d=Yt;try{return Yt=o,l()}finally{Yt=d}},Oe=function(o,l,d){switch(l){case"input":if(Xt(o,d),l=d.name,d.type==="radio"&&l!=null){for(d=o;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<d.length;l++){var g=d[l];if(g!==o&&g.form===o.form){var y=Of(g);if(!y)throw Error(t(90));fe(g),Xt(g,y)}}}break;case"textarea":De(o,d);break;case"select":l=d.value,l!=null&&de(o,!!d.multiple,l,!1)}},vt=Iv,Vt=El;var FO={usingClientEntryPoint:!1,Events:[Rh,Dc,Of,ht,at,Iv]},Hh={findFiberByHostInstance:dl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},VO={bundleType:Hh.bundleType,version:Hh.version,rendererPackageName:Hh.rendererPackageName,rendererConfig:Hh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=pe(o),o===null?null:o.stateNode},findFiberByHostInstance:Hh.findFiberByHostInstance||kO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yp.isDisabled&&yp.supportsFiber)try{Wn=yp.inject(VO),kt=yp}catch{}}return si.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FO,si.createPortal=function(o,l){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zv(l))throw Error(t(200));return OO(o,l,null,d)},si.createRoot=function(o,l){if(!zv(o))throw Error(t(299));var d=!1,g="",y=jw;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onRecoverableError!==void 0&&(y=l.onRecoverableError)),l=Uv(o,1,!1,null,null,d,!1,g,y),o[fo]=l.current,Ah(o.nodeType===8?o.parentNode:o),new Vv(l)},si.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=pe(l),o=o===null?null:o.stateNode,o},si.flushSync=function(o){return El(o)},si.hydrate=function(o,l,d){if(!_p(l))throw Error(t(200));return vp(null,o,l,!0,d)},si.hydrateRoot=function(o,l,d){if(!zv(o))throw Error(t(405));var g=d!=null&&d.hydratedSources||null,y=!1,x="",L=jw;if(d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(x=d.identifierPrefix),d.onRecoverableError!==void 0&&(L=d.onRecoverableError)),l=Hw(l,null,o,1,d??null,y,!1,x,L),o[fo]=l.current,Ah(o),g)for(o=0;o<g.length;o++)d=g[o],y=d._getVersion,y=y(d._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[d,y]:l.mutableSourceEagerHydrationData.push(d,y);return new gp(l)},si.render=function(o,l,d){if(!_p(l))throw Error(t(200));return vp(null,o,l,!1,d)},si.unmountComponentAtNode=function(o){if(!_p(o))throw Error(t(40));return o._reactRootContainer?(El(function(){vp(null,null,o,!1,function(){o._reactRootContainer=null,o[fo]=null})}),!0):!1},si.unstable_batchedUpdates=Iv,si.unstable_renderSubtreeIntoContainer=function(o,l,d,g){if(!_p(d))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return vp(o,l,d,!1,g)},si.version="18.3.1-next-f1338f8080-20240426",si}var eA;function MC(){if(eA)return Gv.exports;eA=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Gv.exports=YO(),Gv.exports}var tA;function ZO(){if(tA)return Sp;tA=1;var n=MC();return Sp.createRoot=n.createRoot,Sp.hydrateRoot=n.hydrateRoot,Sp}var QO=ZO(),Tne=MC();function Pd(){return Pd=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Pd.apply(this,arguments)}var Ia;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Ia||(Ia={}));const nA="popstate";function JO(n){n===void 0&&(n={});function e(i,s){let{pathname:a="/",search:c="",hash:u=""}=sc(i.location.hash.substr(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),m0("",{pathname:a,search:c,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(i,s){let a=i.document.querySelector("base"),c="";if(a&&a.getAttribute("href")){let u=i.location.href,h=u.indexOf("#");c=h===-1?u:u.slice(0,h)}return c+"#"+(typeof s=="string"?s:Lm(s))}function r(i,s){Sg(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return tk(e,t,r,n)}function Cn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Sg(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ek(){return Math.random().toString(36).substr(2,8)}function rA(n,e){return{usr:n.state,key:n.key,idx:e}}function m0(n,e,t,r){return t===void 0&&(t=null),Pd({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?sc(e):e,{state:t,key:e&&e.key||r||ek()})}function Lm(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function sc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function tk(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,a=i.history,c=Ia.Pop,u=null,h=f();h==null&&(h=0,a.replaceState(Pd({},a.state,{idx:h}),""));function f(){return(a.state||{idx:null}).idx}function m(){c=Ia.Pop;let E=f(),S=E==null?null:E-h;h=E,u&&u({action:c,location:A.location,delta:S})}function _(E,S){c=Ia.Push;let D=m0(A.location,E,S);t&&t(D,E),h=f()+1;let b=rA(D,h),k=A.createHref(D);try{a.pushState(b,"",k)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;i.location.assign(k)}s&&u&&u({action:c,location:A.location,delta:1})}function v(E,S){c=Ia.Replace;let D=m0(A.location,E,S);t&&t(D,E),h=f();let b=rA(D,h),k=A.createHref(D);a.replaceState(b,"",k),s&&u&&u({action:c,location:A.location,delta:0})}function T(E){let S=i.location.origin!=="null"?i.location.origin:i.location.href,D=typeof E=="string"?E:Lm(E);return D=D.replace(/ $/,"%20"),Cn(S,"No window.location.(origin|href) available to create URL for href: "+D),new URL(D,S)}let A={get action(){return c},get location(){return n(i,a)},listen(E){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(nA,m),u=E,()=>{i.removeEventListener(nA,m),u=null}},createHref(E){return e(i,E)},createURL:T,encodeLocation(E){let S=T(E);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:_,replace:v,go(E){return a.go(E)}};return A}var iA;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(iA||(iA={}));function nk(n,e,t){return t===void 0&&(t="/"),rk(n,e,t)}function rk(n,e,t,r){let i=typeof e=="string"?sc(e):e,s=Ou(i.pathname||"/",t);if(s==null)return null;let a=bC(n);ik(a);let c=null;for(let u=0;c==null&&u<a.length;++u){let h=mk(s);c=fk(a[u],h)}return c}function bC(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(s,a,c)=>{let u={relativePath:c===void 0?s.path||"":c,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};u.relativePath.startsWith("/")&&(Cn(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let h=Oa([r,u.relativePath]),f=t.concat(u);s.children&&s.children.length>0&&(Cn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),bC(s.children,e,f,h)),!(s.path==null&&!s.index)&&e.push({path:h,score:hk(h,s.index),routesMeta:f})};return n.forEach((s,a)=>{var c;if(s.path===""||!((c=s.path)!=null&&c.includes("?")))i(s,a);else for(let u of RC(s.path))i(s,a,u)}),e}function RC(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let a=RC(r.join("/")),c=[];return c.push(...a.map(u=>u===""?s:[s,u].join("/"))),i&&c.push(...a),c.map(u=>n.startsWith("/")&&u===""?"/":u)}function ik(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:dk(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const sk=/^:[\w-]+$/,ok=3,ak=2,lk=1,ck=10,uk=-2,sA=n=>n==="*";function hk(n,e){let t=n.split("/"),r=t.length;return t.some(sA)&&(r+=uk),e&&(r+=ak),t.filter(i=>!sA(i)).reduce((i,s)=>i+(sk.test(s)?ok:s===""?lk:ck),r)}function dk(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function fk(n,e,t){let{routesMeta:r}=n,i={},s="/",a=[];for(let c=0;c<r.length;++c){let u=r[c],h=c===r.length-1,f=s==="/"?e:e.slice(s.length)||"/",m=g0({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},f),_=u.route;if(!m)return null;Object.assign(i,m.params),a.push({params:i,pathname:Oa([s,m.pathname]),pathnameBase:Ek(Oa([s,m.pathnameBase])),route:_}),m.pathnameBase!=="/"&&(s=Oa([s,m.pathnameBase]))}return a}function g0(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=pk(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((h,f,m)=>{let{paramName:_,isOptional:v}=f;if(_==="*"){let A=c[m]||"";a=s.slice(0,s.length-A.length).replace(/(.)\/+$/,"$1")}const T=c[m];return v&&!T?h[_]=void 0:h[_]=(T||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:a,pattern:n}}function pk(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Sg(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function mk(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Sg(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Ou(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const gk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_k=n=>gk.test(n);function vk(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?sc(n):n,s;if(t)if(_k(t))s=t;else{if(t.includes("//")){let a=t;t=t.replace(/\/\/+/g,"/"),Sg(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+t))}t.startsWith("/")?s=oA(t.substring(1),"/"):s=oA(t,e)}else s=e;return{pathname:s,search:Sk(r),hash:Tk(i)}}function oA(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function $v(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function yk(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function IE(n,e){let t=yk(n);return e?t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function DE(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=sc(n):(i=Pd({},n),Cn(!i.pathname||!i.pathname.includes("?"),$v("?","pathname","search",i)),Cn(!i.pathname||!i.pathname.includes("#"),$v("#","pathname","hash",i)),Cn(!i.search||!i.search.includes("#"),$v("#","search","hash",i)));let s=n===""||i.pathname==="",a=s?"/":i.pathname,c;if(a==null)c=t;else{let m=e.length-1;if(!r&&a.startsWith("..")){let _=a.split("/");for(;_[0]==="..";)_.shift(),m-=1;i.pathname=_.join("/")}c=m>=0?e[m]:"/"}let u=vk(i,c),h=a&&a!=="/"&&a.endsWith("/"),f=(s||a===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(h||f)&&(u.pathname+="/"),u}const Oa=n=>n.join("/").replace(/\/\/+/g,"/"),Ek=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Sk=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Tk=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function xk(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const CC=["post","put","patch","delete"];new Set(CC);const wk=["get",...CC];new Set(wk);function Id(){return Id=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Id.apply(this,arguments)}const Tg=X.createContext(null),PC=X.createContext(null),$o=X.createContext(null),xg=X.createContext(null),qo=X.createContext({outlet:null,matches:[],isDataRoute:!1}),IC=X.createContext(null);function Ak(n,e){let{relative:t}=e===void 0?{}:e;Yu()||Cn(!1);let{basename:r,navigator:i}=X.useContext($o),{hash:s,pathname:a,search:c}=wg(n,{relative:t}),u=a;return r!=="/"&&(u=a==="/"?r:Oa([r,a])),i.createHref({pathname:u,search:c,hash:s})}function Yu(){return X.useContext(xg)!=null}function Xo(){return Yu()||Cn(!1),X.useContext(xg).location}function DC(n){X.useContext($o).static||X.useLayoutEffect(n)}function Zd(){let{isDataRoute:n}=X.useContext(qo);return n?Fk():Mk()}function Mk(){Yu()||Cn(!1);let n=X.useContext(Tg),{basename:e,future:t,navigator:r}=X.useContext($o),{matches:i}=X.useContext(qo),{pathname:s}=Xo(),a=JSON.stringify(IE(i,t.v7_relativeSplatPath)),c=X.useRef(!1);return DC(()=>{c.current=!0}),X.useCallback(function(h,f){if(f===void 0&&(f={}),!c.current)return;if(typeof h=="number"){r.go(h);return}let m=DE(h,JSON.parse(a),s,f.relative==="path");n==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Oa([e,m.pathname])),(f.replace?r.replace:r.push)(m,f.state,f)},[e,r,a,s,n])}function xne(){let{matches:n}=X.useContext(qo),e=n[n.length-1];return e?e.params:{}}function wg(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=X.useContext($o),{matches:i}=X.useContext(qo),{pathname:s}=Xo(),a=JSON.stringify(IE(i,r.v7_relativeSplatPath));return X.useMemo(()=>DE(n,JSON.parse(a),s,t==="path"),[n,a,s,t])}function bk(n,e){return Rk(n,e)}function Rk(n,e,t,r){Yu()||Cn(!1);let{navigator:i}=X.useContext($o),{matches:s}=X.useContext(qo),a=s[s.length-1],c=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let h=Xo(),f;if(e){var m;let E=typeof e=="string"?sc(e):e;u==="/"||(m=E.pathname)!=null&&m.startsWith(u)||Cn(!1),f=E}else f=h;let _=f.pathname||"/",v=_;if(u!=="/"){let E=u.replace(/^\//,"").split("/");v="/"+_.replace(/^\//,"").split("/").slice(E.length).join("/")}let T=nk(n,{pathname:v}),A=Lk(T&&T.map(E=>Object.assign({},E,{params:Object.assign({},c,E.params),pathname:Oa([u,i.encodeLocation?i.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?u:Oa([u,i.encodeLocation?i.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),s,t,r);return e&&A?X.createElement(xg.Provider,{value:{location:Id({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Ia.Pop}},A):A}function Ck(){let n=Uk(),e=xk(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},e),t?X.createElement("pre",{style:i},t):null,null)}const Pk=X.createElement(Ck,null);class Ik extends X.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?X.createElement(qo.Provider,{value:this.props.routeContext},X.createElement(IC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Dk(n){let{routeContext:e,match:t,children:r}=n,i=X.useContext(Tg);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),X.createElement(qo.Provider,{value:e},r)}function Lk(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var s;if(!t)return null;if(t.errors)n=t.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,c=(i=t)==null?void 0:i.errors;if(c!=null){let f=a.findIndex(m=>m.route.id&&c?.[m.route.id]!==void 0);f>=0||Cn(!1),a=a.slice(0,Math.min(a.length,f+1))}let u=!1,h=-1;if(t&&r&&r.v7_partialHydration)for(let f=0;f<a.length;f++){let m=a[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(h=f),m.route.id){let{loaderData:_,errors:v}=t,T=m.route.loader&&_[m.route.id]===void 0&&(!v||v[m.route.id]===void 0);if(m.route.lazy||T){u=!0,h>=0?a=a.slice(0,h+1):a=[a[0]];break}}}return a.reduceRight((f,m,_)=>{let v,T=!1,A=null,E=null;t&&(v=c&&m.route.id?c[m.route.id]:void 0,A=m.route.errorElement||Pk,u&&(h<0&&_===0?(Vk("route-fallback"),T=!0,E=null):h===_&&(T=!0,E=m.route.hydrateFallbackElement||null)));let S=e.concat(a.slice(0,_+1)),D=()=>{let b;return v?b=A:T?b=E:m.route.Component?b=X.createElement(m.route.Component,null):m.route.element?b=m.route.element:b=f,X.createElement(Dk,{match:m,routeContext:{outlet:f,matches:S,isDataRoute:t!=null},children:b})};return t&&(m.route.ErrorBoundary||m.route.errorElement||_===0)?X.createElement(Ik,{location:t.location,revalidation:t.revalidation,component:A,error:v,children:D(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):D()},null)}var LC=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(LC||{}),NC=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(NC||{});function Nk(n){let e=X.useContext(Tg);return e||Cn(!1),e}function Ok(n){let e=X.useContext(PC);return e||Cn(!1),e}function kk(n){let e=X.useContext(qo);return e||Cn(!1),e}function OC(n){let e=kk(),t=e.matches[e.matches.length-1];return t.route.id||Cn(!1),t.route.id}function Uk(){var n;let e=X.useContext(IC),t=Ok(),r=OC();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Fk(){let{router:n}=Nk(LC.UseNavigateStable),e=OC(NC.UseNavigateStable),t=X.useRef(!1);return DC(()=>{t.current=!0}),X.useCallback(function(i,s){s===void 0&&(s={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,Id({fromRouteId:e},s)))},[n,e])}const aA={};function Vk(n,e,t){aA[n]||(aA[n]=!0)}function zk(n,e){n?.v7_startTransition,n?.v7_relativeSplatPath}function Bk(n){let{to:e,replace:t,state:r,relative:i}=n;Yu()||Cn(!1);let{future:s,static:a}=X.useContext($o),{matches:c}=X.useContext(qo),{pathname:u}=Xo(),h=Zd(),f=DE(e,IE(c,s.v7_relativeSplatPath),u,i==="path"),m=JSON.stringify(f);return X.useEffect(()=>h(JSON.parse(m),{replace:t,state:r,relative:i}),[h,m,i,t,r]),null}function oi(n){Cn(!1)}function Hk(n){let{basename:e="/",children:t=null,location:r,navigationType:i=Ia.Pop,navigator:s,static:a=!1,future:c}=n;Yu()&&Cn(!1);let u=e.replace(/^\/*/,"/"),h=X.useMemo(()=>({basename:u,navigator:s,static:a,future:Id({v7_relativeSplatPath:!1},c)}),[u,c,s,a]);typeof r=="string"&&(r=sc(r));let{pathname:f="/",search:m="",hash:_="",state:v=null,key:T="default"}=r,A=X.useMemo(()=>{let E=Ou(f,u);return E==null?null:{location:{pathname:E,search:m,hash:_,state:v,key:T},navigationType:i}},[u,f,m,_,v,T,i]);return A==null?null:X.createElement($o.Provider,{value:h},X.createElement(xg.Provider,{children:t,value:A}))}function Gk(n){let{children:e,location:t}=n;return bk(_0(e),t)}new Promise(()=>{});function _0(n,e){e===void 0&&(e=[]);let t=[];return X.Children.forEach(n,(r,i)=>{if(!X.isValidElement(r))return;let s=[...e,i];if(r.type===X.Fragment){t.push.apply(t,_0(r.props.children,s));return}r.type!==oi&&Cn(!1),!r.props.index||!r.props.children||Cn(!1);let a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=_0(r.props.children,s)),t.push(a)}),t}function Nm(){return Nm=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Nm.apply(this,arguments)}function kC(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function jk(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Wk(n,e){return n.button===0&&(!e||e==="_self")&&!jk(n)}const $k=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],qk=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Xk="6";try{window.__reactRouterVersion=Xk}catch{}const Kk=X.createContext({isTransitioning:!1}),Yk="startTransition",lA=qO[Yk];function Zk(n){let{basename:e,children:t,future:r,window:i}=n,s=X.useRef();s.current==null&&(s.current=JO({window:i,v5Compat:!0}));let a=s.current,[c,u]=X.useState({action:a.action,location:a.location}),{v7_startTransition:h}=r||{},f=X.useCallback(m=>{h&&lA?lA(()=>u(m)):u(m)},[u,h]);return X.useLayoutEffect(()=>a.listen(f),[a,f]),X.useEffect(()=>zk(r),[r]),X.createElement(Hk,{basename:e,children:t,location:c.location,navigationType:c.action,navigator:a,future:r})}const Qk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Jk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ul=X.forwardRef(function(e,t){let{onClick:r,relative:i,reloadDocument:s,replace:a,state:c,target:u,to:h,preventScrollReset:f,viewTransition:m}=e,_=kC(e,$k),{basename:v}=X.useContext($o),T,A=!1;if(typeof h=="string"&&Jk.test(h)&&(T=h,Qk))try{let b=new URL(window.location.href),k=h.startsWith("//")?new URL(b.protocol+h):new URL(h),V=Ou(k.pathname,v);k.origin===b.origin&&V!=null?h=V+k.search+k.hash:A=!0}catch{}let E=Ak(h,{relative:i}),S=tU(h,{replace:a,state:c,target:u,preventScrollReset:f,relative:i,viewTransition:m});function D(b){r&&r(b),b.defaultPrevented||S(b)}return X.createElement("a",Nm({},_,{href:T||E,onClick:A||s?r:D,ref:t,target:u}))}),Ag=X.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:i=!1,className:s="",end:a=!1,style:c,to:u,viewTransition:h,children:f}=e,m=kC(e,qk),_=wg(u,{relative:m.relative}),v=Xo(),T=X.useContext(PC),{navigator:A,basename:E}=X.useContext($o),S=T!=null&&nU(_)&&h===!0,D=A.encodeLocation?A.encodeLocation(_).pathname:_.pathname,b=v.pathname,k=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;i||(b=b.toLowerCase(),k=k?k.toLowerCase():null,D=D.toLowerCase()),k&&E&&(k=Ou(k,E)||k);const V=D!=="/"&&D.endsWith("/")?D.length-1:D.length;let H=b===D||!a&&b.startsWith(D)&&b.charAt(V)==="/",P=k!=null&&(k===D||!a&&k.startsWith(D)&&k.charAt(D.length)==="/"),I={isActive:H,isPending:P,isTransitioning:S},M=H?r:void 0,C;typeof s=="function"?C=s(I):C=[s,H?"active":null,P?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let N=typeof c=="function"?c(I):c;return X.createElement(Ul,Nm({},m,{"aria-current":M,className:C,ref:t,style:N,to:u,viewTransition:h}),typeof f=="function"?f(I):f)});var v0;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(v0||(v0={}));var cA;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(cA||(cA={}));function eU(n){let e=X.useContext(Tg);return e||Cn(!1),e}function tU(n,e){let{target:t,replace:r,state:i,preventScrollReset:s,relative:a,viewTransition:c}=e===void 0?{}:e,u=Zd(),h=Xo(),f=wg(n,{relative:a});return X.useCallback(m=>{if(Wk(m,t)){m.preventDefault();let _=r!==void 0?r:Lm(h)===Lm(f);u(n,{replace:_,state:i,preventScrollReset:s,relative:a,viewTransition:c})}},[h,u,f,r,i,t,n,s,a,c])}function nU(n,e){e===void 0&&(e={});let t=X.useContext(Kk);t==null&&Cn(!1);let{basename:r}=eU(v0.useViewTransitionState),i=wg(n,{relative:e.relative});if(!t.isTransitioning)return!1;let s=Ou(t.currentLocation.pathname,r)||t.currentLocation.pathname,a=Ou(t.nextLocation.pathname,r)||t.nextLocation.pathname;return g0(i.pathname,a)!=null||g0(i.pathname,s)!=null}const LE=X.createContext({});function Zu(n){const e=X.useRef(null);return e.current===null&&(e.current=n()),e.current}const Mg=X.createContext(null),bg=X.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class rU extends X.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function iU({children:n,isPresent:e}){const t=X.useId(),r=X.useRef(null),i=X.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=X.useContext(bg);return X.useInsertionEffect(()=>{const{width:a,height:c,top:u,left:h}=i.current;if(e||!r.current||!a||!c)return;r.current.dataset.motionPopId=t;const f=document.createElement("style");return s&&(f.nonce=s),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${c}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),B.jsx(rU,{isPresent:e,childRef:r,sizeRef:i,children:X.cloneElement(n,{ref:r})})}const sU=({children:n,initial:e,isPresent:t,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const c=Zu(oU),u=X.useId(),h=X.useCallback(m=>{c.set(m,!0);for(const _ of c.values())if(!_)return;r&&r()},[c,r]),f=X.useMemo(()=>({id:u,initial:e,isPresent:t,custom:i,onExitComplete:h,register:m=>(c.set(m,!1),()=>c.delete(m))}),s?[Math.random(),h]:[t,h]);return X.useMemo(()=>{c.forEach((m,_)=>c.set(_,!1))},[t]),X.useEffect(()=>{!t&&!c.size&&r&&r()},[t]),a==="popLayout"&&(n=B.jsx(iU,{isPresent:t,children:n})),B.jsx(Mg.Provider,{value:f,children:n})};function oU(){return new Map}function UC(n=!0){const e=X.useContext(Mg);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=X.useId();X.useEffect(()=>{n&&i(s)},[n]);const a=X.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const Tp=n=>n.key||"";function uA(n){const e=[];return X.Children.forEach(n,t=>{X.isValidElement(t)&&e.push(t)}),e}const NE=typeof window<"u",Rg=NE?X.useLayoutEffect:X.useEffect,FC=({children:n,custom:e,initial:t=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[c,u]=UC(a),h=X.useMemo(()=>uA(n),[n]),f=a&&!c?[]:h.map(Tp),m=X.useRef(!0),_=X.useRef(h),v=Zu(()=>new Map),[T,A]=X.useState(h),[E,S]=X.useState(h);Rg(()=>{m.current=!1,_.current=h;for(let k=0;k<E.length;k++){const V=Tp(E[k]);f.includes(V)?v.delete(V):v.get(V)!==!0&&v.set(V,!1)}},[E,f.length,f.join("-")]);const D=[];if(h!==T){let k=[...h];for(let V=0;V<E.length;V++){const H=E[V],P=Tp(H);f.includes(P)||(k.splice(V,0,H),D.push(H))}s==="wait"&&D.length&&(k=D),S(uA(k)),A(h);return}const{forceRender:b}=X.useContext(LE);return B.jsx(B.Fragment,{children:E.map(k=>{const V=Tp(k),H=a&&!c?!1:h===E||f.includes(V),P=()=>{if(v.has(V))v.set(V,!0);else return;let I=!0;v.forEach(M=>{M||(I=!1)}),I&&(b?.(),S(_.current),a&&u?.(),r&&r())};return B.jsx(sU,{isPresent:H,initial:!m.current||t?void 0:!1,custom:H?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:H?void 0:P,children:k},V)})})},Yr=n=>n;let aU=Yr,VC=Yr;function OE(n){let e;return()=>(e===void 0&&(e=n()),e)}const ql=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r},No=n=>n*1e3,Oo=n=>n/1e3,lU={useManualTiming:!1};function cU(n){let e=new Set,t=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function c(h){s.has(h)&&(u.schedule(h),n()),h(a)}const u={schedule:(h,f=!1,m=!1)=>{const v=m&&r?e:t;return f&&s.add(h),v.has(h)||v.add(h),h},cancel:h=>{t.delete(h),s.delete(h)},process:h=>{if(a=h,r){i=!0;return}r=!0,[e,t]=[t,e],e.forEach(c),e.clear(),r=!1,i&&(i=!1,u.process(h))}};return u}const xp=["read","resolveKeyframes","update","preRender","render","postRender"],uU=40;function zC(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=xp.reduce((S,D)=>(S[D]=cU(s),S),{}),{read:c,resolveKeyframes:u,update:h,preRender:f,render:m,postRender:_}=a,v=()=>{const S=performance.now();t=!1,i.delta=r?1e3/60:Math.max(Math.min(S-i.timestamp,uU),1),i.timestamp=S,i.isProcessing=!0,c.process(i),u.process(i),h.process(i),f.process(i),m.process(i),_.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(v))},T=()=>{t=!0,r=!0,i.isProcessing||n(v)};return{schedule:xp.reduce((S,D)=>{const b=a[D];return S[D]=(k,V=!1,H=!1)=>(t||T(),b.schedule(k,V,H)),S},{}),cancel:S=>{for(let D=0;D<xp.length;D++)a[xp[D]].cancel(S)},state:i,steps:a}}const{schedule:sn,cancel:ms,state:hr,steps:qv}=zC(typeof requestAnimationFrame<"u"?requestAnimationFrame:Yr,!0),BC=X.createContext({strict:!1}),hA={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ku={};for(const n in hA)ku[n]={isEnabled:e=>hA[n].some(t=>!!e[t])};function hU(n){for(const e in n)ku[e]={...ku[e],...n[e]}}const dU=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Om(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||dU.has(n)}let HC=n=>!Om(n);function fU(n){n&&(HC=e=>e.startsWith("on")?!Om(e):n(e))}try{fU(require("@emotion/is-prop-valid").default)}catch{}function pU(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(HC(i)||t===!0&&Om(i)||!e&&!Om(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}function mU(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...r)=>n(...r);return new Proxy(t,{get:(r,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const Cg=X.createContext({});function Dd(n){return typeof n=="string"||Array.isArray(n)}function Pg(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const kE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],UE=["initial",...kE];function Ig(n){return Pg(n.animate)||UE.some(e=>Dd(n[e]))}function GC(n){return!!(Ig(n)||n.variants)}function gU(n,e){if(Ig(n)){const{initial:t,animate:r}=n;return{initial:t===!1||Dd(t)?t:void 0,animate:Dd(r)?r:void 0}}return n.inherit!==!1?e:{}}function _U(n){const{initial:e,animate:t}=gU(n,X.useContext(Cg));return X.useMemo(()=>({initial:e,animate:t}),[dA(e),dA(t)])}function dA(n){return Array.isArray(n)?n.join(" "):n}const vU=Symbol.for("motionComponentSymbol");function vu(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function yU(n,e,t){return X.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):vu(t)&&(t.current=r))},[e])}const FE=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),EU="framerAppearId",jC="data-"+FE(EU),{schedule:VE}=zC(queueMicrotask,!1),WC=X.createContext({});function SU(n,e,t,r,i){var s,a;const{visualElement:c}=X.useContext(Cg),u=X.useContext(BC),h=X.useContext(Mg),f=X.useContext(bg).reducedMotion,m=X.useRef(null);r=r||u.renderer,!m.current&&r&&(m.current=r(n,{visualState:e,parent:c,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const _=m.current,v=X.useContext(WC);_&&!_.projection&&i&&(_.type==="html"||_.type==="svg")&&TU(m.current,t,i,v);const T=X.useRef(!1);X.useInsertionEffect(()=>{_&&T.current&&_.update(t,h)});const A=t[jC],E=X.useRef(!!A&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,A))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,A)));return Rg(()=>{_&&(T.current=!0,window.MotionIsMounted=!0,_.updateFeatures(),VE.render(_.render),E.current&&_.animationState&&_.animationState.animateChanges())}),X.useEffect(()=>{_&&(!E.current&&_.animationState&&_.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)===null||S===void 0||S.call(window,A)}),E.current=!1))}),_}function TU(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:c,layoutScroll:u,layoutRoot:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:$C(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||c&&vu(c),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:u,layoutRoot:h})}function $C(n){if(n)return n.options.allowProjection!==!1?n.projection:$C(n.parent)}function xU({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:r,Component:i}){var s,a;n&&hU(n);function c(h,f){let m;const _={...X.useContext(bg),...h,layoutId:wU(h)},{isStatic:v}=_,T=_U(h),A=r(h,v);if(!v&&NE){AU();const E=MU(_);m=E.MeasureLayout,T.visualElement=SU(i,A,_,e,E.ProjectionNode)}return B.jsxs(Cg.Provider,{value:T,children:[m&&T.visualElement?B.jsx(m,{visualElement:T.visualElement,..._}):null,t(i,h,yU(A,T.visualElement,f),A,v,T.visualElement)]})}c.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const u=X.forwardRef(c);return u[vU]=i,u}function wU({layoutId:n}){const e=X.useContext(LE).id;return e&&n!==void 0?e+"-"+n:n}function AU(n,e){X.useContext(BC).strict}function MU(n){const{drag:e,layout:t}=ku;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const bU=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function zE(n){return typeof n!="string"||n.includes("-")?!1:!!(bU.indexOf(n)>-1||/[A-Z]/u.test(n))}function fA(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function BE(n,e,t,r){if(typeof e=="function"){const[i,s]=fA(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=fA(r);e=e(t!==void 0?t:n.custom,i,s)}return e}const y0=n=>Array.isArray(n),RU=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),CU=n=>y0(n)?n[n.length-1]||0:n,Vr=n=>!!(n&&n.getVelocity);function mm(n){const e=Vr(n)?n.get():n;return RU(e)?e.toValue():e}function PU({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},r,i,s){const a={latestValues:IU(r,i,s,n),renderState:e()};return t&&(a.onMount=c=>t({props:r,current:c,...a}),a.onUpdate=c=>t(c)),a}const qC=n=>(e,t)=>{const r=X.useContext(Cg),i=X.useContext(Mg),s=()=>PU(n,e,r,i);return t?s():Zu(s)};function IU(n,e,t,r){const i={},s=r(n,{});for(const _ in s)i[_]=mm(s[_]);let{initial:a,animate:c}=n;const u=Ig(n),h=GC(n);e&&h&&!u&&n.inherit!==!1&&(a===void 0&&(a=e.initial),c===void 0&&(c=e.animate));let f=t?t.initial===!1:!1;f=f||a===!1;const m=f?c:a;if(m&&typeof m!="boolean"&&!Pg(m)){const _=Array.isArray(m)?m:[m];for(let v=0;v<_.length;v++){const T=BE(n,_[v]);if(T){const{transitionEnd:A,transition:E,...S}=T;for(const D in S){let b=S[D];if(Array.isArray(b)){const k=f?b.length-1:0;b=b[k]}b!==null&&(i[D]=b)}for(const D in A)i[D]=A[D]}}}return i}const Qu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],oc=new Set(Qu),XC=n=>e=>typeof e=="string"&&e.startsWith(n),KC=XC("--"),DU=XC("var(--"),HE=n=>DU(n)?LU.test(n.split("/*")[0].trim()):!1,LU=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,YC=(n,e)=>e&&typeof n=="number"?e.transform(n):n,Js=(n,e,t)=>t>e?e:t<n?n:t,Ju={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Ld={...Ju,transform:n=>Js(0,1,n)},wp={...Ju,default:1},Qd=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),xa=Qd("deg"),Gs=Qd("%"),yt=Qd("px"),NU=Qd("vh"),OU=Qd("vw"),pA={...Gs,parse:n=>Gs.parse(n)/100,transform:n=>Gs.transform(n*100)},kU={borderWidth:yt,borderTopWidth:yt,borderRightWidth:yt,borderBottomWidth:yt,borderLeftWidth:yt,borderRadius:yt,radius:yt,borderTopLeftRadius:yt,borderTopRightRadius:yt,borderBottomRightRadius:yt,borderBottomLeftRadius:yt,width:yt,maxWidth:yt,height:yt,maxHeight:yt,top:yt,right:yt,bottom:yt,left:yt,padding:yt,paddingTop:yt,paddingRight:yt,paddingBottom:yt,paddingLeft:yt,margin:yt,marginTop:yt,marginRight:yt,marginBottom:yt,marginLeft:yt,backgroundPositionX:yt,backgroundPositionY:yt},UU={rotate:xa,rotateX:xa,rotateY:xa,rotateZ:xa,scale:wp,scaleX:wp,scaleY:wp,scaleZ:wp,skew:xa,skewX:xa,skewY:xa,distance:yt,translateX:yt,translateY:yt,translateZ:yt,x:yt,y:yt,z:yt,perspective:yt,transformPerspective:yt,opacity:Ld,originX:pA,originY:pA,originZ:yt},mA={...Ju,transform:Math.round},GE={...kU,...UU,zIndex:mA,size:yt,fillOpacity:Ld,strokeOpacity:Ld,numOctaves:mA},FU={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},VU=Qu.length;function zU(n,e,t){let r="",i=!0;for(let s=0;s<VU;s++){const a=Qu[s],c=n[a];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(a.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||t){const h=YC(c,GE[a]);if(!u){i=!1;const f=FU[a]||a;r+=`${f}(${h}) `}t&&(e[a]=h)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function jE(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,c=!1;for(const u in e){const h=e[u];if(oc.has(u)){a=!0;continue}else if(KC(u)){i[u]=h;continue}else{const f=YC(h,GE[u]);u.startsWith("origin")?(c=!0,s[u]=f):r[u]=f}}if(e.transform||(a||t?r.transform=zU(e,n.transform,t):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:h="50%",originZ:f=0}=s;r.transformOrigin=`${u} ${h} ${f}`}}const BU={offset:"stroke-dashoffset",array:"stroke-dasharray"},HU={offset:"strokeDashoffset",array:"strokeDasharray"};function GU(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?BU:HU;n[s.offset]=yt.transform(-r);const a=yt.transform(e),c=yt.transform(t);n[s.array]=`${a} ${c}`}function gA(n,e,t){return typeof n=="string"?n:yt.transform(e+t*n)}function jU(n,e,t){const r=gA(e,n.x,n.width),i=gA(t,n.y,n.height);return`${r} ${i}`}function WE(n,{attrX:e,attrY:t,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:c=1,pathOffset:u=0,...h},f,m){if(jE(n,h,m),f){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:_,style:v,dimensions:T}=n;_.transform&&(T&&(v.transform=_.transform),delete _.transform),T&&(i!==void 0||s!==void 0||v.transform)&&(v.transformOrigin=jU(T,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(_.x=e),t!==void 0&&(_.y=t),r!==void 0&&(_.scale=r),a!==void 0&&GU(_,a,c,u,!1)}const $E=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),ZC=()=>({...$E(),attrs:{}}),qE=n=>typeof n=="string"&&n.toLowerCase()==="svg";function QC(n,{style:e,vars:t},r,i){Object.assign(n.style,e,i&&i.getProjectionStyles(r));for(const s in t)n.style.setProperty(s,t[s])}const JC=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function eP(n,e,t,r){QC(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(JC.has(i)?i:FE(i),e.attrs[i])}const km={};function WU(n){Object.assign(km,n)}function tP(n,{layout:e,layoutId:t}){return oc.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!km[n]||n==="opacity")}function XE(n,e,t){var r;const{style:i}=n,s={};for(const a in i)(Vr(i[a])||e.style&&Vr(e.style[a])||tP(a,n)||((r=t?.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function nP(n,e,t){const r=XE(n,e,t);for(const i in n)if(Vr(n[i])||Vr(e[i])){const s=Qu.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}function $U(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const _A=["x","y","width","height","cx","cy","r"],qU={useVisualState:qC({scrapeMotionValuesFromProps:nP,createRenderState:ZC,onUpdate:({props:n,prevProps:e,current:t,renderState:r,latestValues:i})=>{if(!t)return;let s=!!n.drag;if(!s){for(const c in i)if(oc.has(c)){s=!0;break}}if(!s)return;let a=!e;if(e)for(let c=0;c<_A.length;c++){const u=_A[c];n[u]!==e[u]&&(a=!0)}a&&sn.read(()=>{$U(t,r),sn.render(()=>{WE(r,i,qE(t.tagName),n.transformTemplate),eP(t,r)})})}})},XU={useVisualState:qC({scrapeMotionValuesFromProps:XE,createRenderState:$E})};function rP(n,e,t){for(const r in e)!Vr(e[r])&&!tP(r,t)&&(n[r]=e[r])}function KU({transformTemplate:n},e){return X.useMemo(()=>{const t=$E();return jE(t,e,n),Object.assign({},t.vars,t.style)},[e])}function YU(n,e){const t=n.style||{},r={};return rP(r,t,n),Object.assign(r,KU(n,e)),r}function ZU(n,e){const t={},r=YU(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}function QU(n,e,t,r){const i=X.useMemo(()=>{const s=ZC();return WE(s,e,qE(r),n.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};rP(s,n.style,n),i.style={...s,...i.style}}return i}function JU(n=!1){return(t,r,i,{latestValues:s},a)=>{const u=(zE(t)?QU:ZU)(r,s,a,t),h=pU(r,typeof t=="string",n),f=t!==X.Fragment?{...h,...u,ref:i}:{},{children:m}=r,_=X.useMemo(()=>Vr(m)?m.get():m,[m]);return X.createElement(t,{...f,children:_})}}function e3(n,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...zE(r)?qU:XU,preloadedFeatures:n,useRender:JU(i),createVisualElement:e,Component:r};return xU(a)}}function iP(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}function Dg(n,e,t){const r=n.getProps();return BE(r,e,t!==void 0?t:r.custom,n)}const sP=OE(()=>window.ScrollTimeline!==void 0);class t3{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=t}attachTimeline(e,t){const r=this.animations.map(i=>{if(sP()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class n3 extends t3{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function KE(n,e){return n?n[e]||n.default||n:void 0}const E0=2e4;function oP(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<E0;)e+=t,r=n.next(e);return e>=E0?1/0:e}function YE(n){return typeof n=="function"}function vA(n,e){n.timeline=e,n.onfinish=null}const ZE=n=>Array.isArray(n)&&typeof n[0]=="number",r3={linearEasing:void 0};function i3(n,e){const t=OE(n);return()=>{var r;return(r=r3[e])!==null&&r!==void 0?r:t()}}const Um=i3(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),aP=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=n(ql(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function lP(n){return!!(typeof n=="function"&&Um()||!n||typeof n=="string"&&(n in S0||Um())||ZE(n)||Array.isArray(n)&&n.every(lP))}const od=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,S0={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:od([0,.65,.55,1]),circOut:od([.55,0,1,.45]),backIn:od([.31,.01,.66,-.59]),backOut:od([.33,1.53,.69,.99])};function cP(n,e){if(n)return typeof n=="function"&&Um()?aP(n,e):ZE(n)?od(n):Array.isArray(n)?n.map(t=>cP(t,e)||S0.easeOut):S0[n]}const ls={x:!1,y:!1};function uP(){return ls.x||ls.y}function hP(n,e,t){var r;if(n instanceof Element)return[n];if(typeof n=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}function dP(n,e){const t=hP(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function yA(n){return e=>{e.pointerType==="touch"||uP()||n(e)}}function s3(n,e,t={}){const[r,i,s]=dP(n,t),a=yA(c=>{const{target:u}=c,h=e(c);if(typeof h!="function"||!u)return;const f=yA(m=>{h(m),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,i)});return r.forEach(c=>{c.addEventListener("pointerenter",a,i)}),s}const fP=(n,e)=>e?n===e?!0:fP(n,e.parentElement):!1,QE=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,o3=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function a3(n){return o3.has(n.tagName)||n.tabIndex!==-1}const ad=new WeakSet;function EA(n){return e=>{e.key==="Enter"&&n(e)}}function Xv(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const l3=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=EA(()=>{if(ad.has(t))return;Xv(t,"down");const i=EA(()=>{Xv(t,"up")}),s=()=>Xv(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function SA(n){return QE(n)&&!uP()}function c3(n,e,t={}){const[r,i,s]=dP(n,t),a=c=>{const u=c.currentTarget;if(!SA(c)||ad.has(u))return;ad.add(u);const h=e(c),f=(v,T)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",_),!(!SA(v)||!ad.has(u))&&(ad.delete(u),typeof h=="function"&&h(v,{success:T}))},m=v=>{f(v,t.useGlobalTarget||fP(u,v.target))},_=v=>{f(v,!1)};window.addEventListener("pointerup",m,i),window.addEventListener("pointercancel",_,i)};return r.forEach(c=>{!a3(c)&&c.getAttribute("tabindex")===null&&(c.tabIndex=0),(t.useGlobalTarget?window:c).addEventListener("pointerdown",a,i),c.addEventListener("focus",h=>l3(h,i),i)}),s}function u3(n){return n==="x"||n==="y"?ls[n]?null:(ls[n]=!0,()=>{ls[n]=!1}):ls.x||ls.y?null:(ls.x=ls.y=!0,()=>{ls.x=ls.y=!1})}const pP=new Set(["width","height","top","left","right","bottom",...Qu]);let gm;function h3(){gm=void 0}const js={now:()=>(gm===void 0&&js.set(hr.isProcessing||lU.useManualTiming?hr.timestamp:performance.now()),gm),set:n=>{gm=n,queueMicrotask(h3)}};function JE(n,e){n.indexOf(e)===-1&&n.push(e)}function eS(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class tS{constructor(){this.subscriptions=[]}add(e){return JE(this.subscriptions,e),()=>eS(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function nS(n,e){return e?n*(1e3/e):0}const TA=30,d3=n=>!isNaN(parseFloat(n)),gd={current:void 0};class f3{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=js.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=js.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=d3(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new tS);const r=this.events[e].add(t);return e==="change"?()=>{r(),sn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return gd.current&&gd.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=js.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>TA)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,TA);return nS(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function zs(n,e){return new f3(n,e)}function p3(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,zs(t))}function m3(n,e){const t=Dg(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const c=CU(s[a]);p3(n,a,c)}}function g3(n){return!!(Vr(n)&&n.add)}function T0(n,e){const t=n.getValue("willChange");if(g3(t))return t.add(e)}function mP(n){return n.props[jC]}const gP=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,_3=1e-7,v3=12;function y3(n,e,t,r,i){let s,a,c=0;do a=e+(t-e)/2,s=gP(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>_3&&++c<v3);return a}function Jd(n,e,t,r){if(n===e&&t===r)return Yr;const i=s=>y3(s,0,1,n,t);return s=>s===0||s===1?s:gP(i(s),e,r)}const _P=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,vP=n=>e=>1-n(1-e),yP=Jd(.33,1.53,.69,.99),rS=vP(yP),EP=_P(rS),SP=n=>(n*=2)<1?.5*rS(n):.5*(2-Math.pow(2,-10*(n-1))),iS=n=>1-Math.sin(Math.acos(n)),TP=vP(iS),xP=_P(iS),wP=n=>/^0[^.\s]+$/u.test(n);function E3(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||wP(n):!0}const _d=n=>Math.round(n*1e5)/1e5,sS=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function S3(n){return n==null}const T3=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,oS=(n,e)=>t=>!!(typeof t=="string"&&T3.test(t)&&t.startsWith(n)||e&&!S3(t)&&Object.prototype.hasOwnProperty.call(t,e)),AP=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,c]=r.match(sS);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:c!==void 0?parseFloat(c):1}},x3=n=>Js(0,255,n),Kv={...Ju,transform:n=>Math.round(x3(n))},Fl={test:oS("rgb","red"),parse:AP("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+Kv.transform(n)+", "+Kv.transform(e)+", "+Kv.transform(t)+", "+_d(Ld.transform(r))+")"};function w3(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const x0={test:oS("#"),parse:w3,transform:Fl.transform},yu={test:oS("hsl","hue"),parse:AP("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+Gs.transform(_d(e))+", "+Gs.transform(_d(t))+", "+_d(Ld.transform(r))+")"},kr={test:n=>Fl.test(n)||x0.test(n)||yu.test(n),parse:n=>Fl.test(n)?Fl.parse(n):yu.test(n)?yu.parse(n):x0.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Fl.transform(n):yu.transform(n)},A3=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function M3(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(sS))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(A3))===null||t===void 0?void 0:t.length)||0)>0}const MP="number",bP="color",b3="var",R3="var(",xA="${}",C3=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Nd(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const c=e.replace(C3,u=>(kr.test(u)?(r.color.push(s),i.push(bP),t.push(kr.parse(u))):u.startsWith(R3)?(r.var.push(s),i.push(b3),t.push(u)):(r.number.push(s),i.push(MP),t.push(parseFloat(u))),++s,xA)).split(xA);return{values:t,split:c,indexes:r,types:i}}function RP(n){return Nd(n).values}function CP(n){const{split:e,types:t}=Nd(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const c=t[a];c===MP?s+=_d(i[a]):c===bP?s+=kr.transform(i[a]):s+=i[a]}return s}}const P3=n=>typeof n=="number"?0:n;function I3(n){const e=RP(n);return CP(n)(e.map(P3))}const ja={test:M3,parse:RP,createTransformer:CP,getAnimatableNone:I3},D3=new Set(["brightness","contrast","saturate","opacity"]);function L3(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(sS)||[];if(!r)return n;const i=t.replace(r,"");let s=D3.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const N3=/\b([a-z-]*)\(.*?\)/gu,w0={...ja,getAnimatableNone:n=>{const e=n.match(N3);return e?e.map(L3).join(" "):n}},O3={...GE,color:kr,backgroundColor:kr,outlineColor:kr,fill:kr,stroke:kr,borderColor:kr,borderTopColor:kr,borderRightColor:kr,borderBottomColor:kr,borderLeftColor:kr,filter:w0,WebkitFilter:w0},aS=n=>O3[n];function PP(n,e){let t=aS(n);return t!==w0&&(t=ja),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const k3=new Set(["auto","none","0"]);function U3(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!k3.has(s)&&Nd(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=PP(t,i)}const wA=n=>n===Ju||n===yt,AA=(n,e)=>parseFloat(n.split(", ")[e]),MA=(n,e)=>(t,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return AA(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?AA(s[1],n):0}},F3=new Set(["x","y","z"]),V3=Qu.filter(n=>!F3.has(n));function z3(n){const e=[];return V3.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const Uu={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:MA(4,13),y:MA(5,14)};Uu.translateX=Uu.x;Uu.translateY=Uu.y;const Bl=new Set;let A0=!1,M0=!1;function IP(){if(M0){const n=Array.from(Bl).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=z3(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var c;(c=r.getValue(s))===null||c===void 0||c.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}M0=!1,A0=!1,Bl.forEach(n=>n.complete()),Bl.clear()}function DP(){Bl.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(M0=!0)})}function B3(){DP(),IP()}class lS{constructor(e,t,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Bl.add(this),A0||(A0=!0,sn.read(DP),sn.resolveKeyframes(IP))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const a=i?.get(),c=e[e.length-1];if(a!==void 0)e[0]=a;else if(r&&t){const u=r.readValue(t,c);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=c),i&&a===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Bl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Bl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const LP=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),H3=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function G3(n){const e=H3.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function NP(n,e,t=1){const[r,i]=G3(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return LP(a)?parseFloat(a):a}return HE(i)?NP(i,e,t+1):i}const OP=n=>e=>e.test(n),j3={test:n=>n==="auto",parse:n=>n},kP=[Ju,yt,Gs,xa,OU,NU,j3],bA=n=>kP.find(OP(n));class UP extends lS{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),HE(h))){const f=NP(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!pP.has(r)||e.length!==2)return;const[i,s]=e,a=bA(i),c=bA(s);if(a!==c)if(wA(a)&&wA(c))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)E3(e[i])&&r.push(i);r.length&&U3(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Uu[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,c=i[a];i[a]=Uu[r](t.measureViewportBox(),window.getComputedStyle(t.current)),c!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=c),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const RA=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ja.test(n)||n==="0")&&!n.startsWith("url("));function W3(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function $3(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=RA(i,e),c=RA(s,e);return!a||!c?!1:W3(n)||(t==="spring"||YE(t))&&r}const q3=n=>n!==null;function Lg(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(q3),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const X3=40;class FP{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...c}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=js.now(),this.options={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,...c},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>X3?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&B3(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=js.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:c,onUpdate:u,isGenerator:h}=this.options;if(!h&&!$3(e,r,i,s))if(a)this.options.duration=0;else{u&&u(Lg(e,this.options,t)),c&&c(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Rn=(n,e,t)=>n+(e-n)*t;function Yv(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function K3({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const c=t<.5?t*(1+e):t+e-t*e,u=2*t-c;i=Yv(u,c,n+1/3),s=Yv(u,c,n),a=Yv(u,c,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function Fm(n,e){return t=>t>0?e:n}const Zv=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},Y3=[x0,Fl,yu],Z3=n=>Y3.find(e=>e.test(n));function CA(n){const e=Z3(n);if(!e)return!1;let t=e.parse(n);return e===yu&&(t=K3(t)),t}const PA=(n,e)=>{const t=CA(n),r=CA(e);if(!t||!r)return Fm(n,e);const i={...t};return s=>(i.red=Zv(t.red,r.red,s),i.green=Zv(t.green,r.green,s),i.blue=Zv(t.blue,r.blue,s),i.alpha=Rn(t.alpha,r.alpha,s),Fl.transform(i))},Q3=(n,e)=>t=>e(n(t)),ef=(...n)=>n.reduce(Q3),b0=new Set(["none","hidden"]);function J3(n,e){return b0.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function eF(n,e){return t=>Rn(n,e,t)}function cS(n){return typeof n=="number"?eF:typeof n=="string"?HE(n)?Fm:kr.test(n)?PA:rF:Array.isArray(n)?VP:typeof n=="object"?kr.test(n)?PA:tF:Fm}function VP(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>cS(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function tF(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=cS(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function nF(n,e){var t;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],c=n.indexes[a][i[a]],u=(t=n.values[c])!==null&&t!==void 0?t:0;r[s]=u,i[a]++}return r}const rF=(n,e)=>{const t=ja.createTransformer(e),r=Nd(n),i=Nd(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?b0.has(n)&&!i.values.length||b0.has(e)&&!r.values.length?J3(n,e):ef(VP(nF(r,i),i.values),t):Fm(n,e)};function zP(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Rn(n,e,t):cS(n)(n,e)}const iF=5;function BP(n,e,t){const r=Math.max(e-iF,0);return nS(t-n(r),e-r)}const On={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Qv=.001;function sF({duration:n=On.duration,bounce:e=On.bounce,velocity:t=On.velocity,mass:r=On.mass}){let i,s,a=1-e;a=Js(On.minDamping,On.maxDamping,a),n=Js(On.minDuration,On.maxDuration,Oo(n)),a<1?(i=h=>{const f=h*a,m=f*n,_=f-t,v=R0(h,a),T=Math.exp(-m);return Qv-_/v*T},s=h=>{const m=h*a*n,_=m*t+t,v=Math.pow(a,2)*Math.pow(h,2)*n,T=Math.exp(-m),A=R0(Math.pow(h,2),a);return(-i(h)+Qv>0?-1:1)*((_-v)*T)/A}):(i=h=>{const f=Math.exp(-h*n),m=(h-t)*n+1;return-Qv+f*m},s=h=>{const f=Math.exp(-h*n),m=(t-h)*(n*n);return f*m});const c=5/n,u=aF(i,s,c);if(n=No(n),isNaN(u))return{stiffness:On.stiffness,damping:On.damping,duration:n};{const h=Math.pow(u,2)*r;return{stiffness:h,damping:a*2*Math.sqrt(r*h),duration:n}}}const oF=12;function aF(n,e,t){let r=t;for(let i=1;i<oF;i++)r=r-n(r)/e(r);return r}function R0(n,e){return n*Math.sqrt(1-e*e)}const lF=["duration","bounce"],cF=["stiffness","damping","mass"];function IA(n,e){return e.some(t=>n[t]!==void 0)}function uF(n){let e={velocity:On.velocity,stiffness:On.stiffness,damping:On.damping,mass:On.mass,isResolvedFromDuration:!1,...n};if(!IA(n,cF)&&IA(n,lF))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*Js(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:On.mass,stiffness:i,damping:s}}else{const t=sF(n);e={...e,...t,mass:On.mass},e.isResolvedFromDuration=!0}return e}function HP(n=On.visualDuration,e=On.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],c={done:!1,value:s},{stiffness:u,damping:h,mass:f,duration:m,velocity:_,isResolvedFromDuration:v}=uF({...t,velocity:-Oo(t.velocity||0)}),T=_||0,A=h/(2*Math.sqrt(u*f)),E=a-s,S=Oo(Math.sqrt(u/f)),D=Math.abs(E)<5;r||(r=D?On.restSpeed.granular:On.restSpeed.default),i||(i=D?On.restDelta.granular:On.restDelta.default);let b;if(A<1){const V=R0(S,A);b=H=>{const P=Math.exp(-A*S*H);return a-P*((T+A*S*E)/V*Math.sin(V*H)+E*Math.cos(V*H))}}else if(A===1)b=V=>a-Math.exp(-S*V)*(E+(T+S*E)*V);else{const V=S*Math.sqrt(A*A-1);b=H=>{const P=Math.exp(-A*S*H),I=Math.min(V*H,300);return a-P*((T+A*S*E)*Math.sinh(I)+V*E*Math.cosh(I))/V}}const k={calculatedDuration:v&&m||null,next:V=>{const H=b(V);if(v)c.done=V>=m;else{let P=0;A<1&&(P=V===0?No(T):BP(b,V,H));const I=Math.abs(P)<=r,M=Math.abs(a-H)<=i;c.done=I&&M}return c.value=c.done?a:H,c},toString:()=>{const V=Math.min(oP(k),E0),H=aP(P=>k.next(V*P).value,V,30);return V+"ms "+H}};return k}function DA({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:c,max:u,restDelta:h=.5,restSpeed:f}){const m=n[0],_={done:!1,value:m},v=I=>c!==void 0&&I<c||u!==void 0&&I>u,T=I=>c===void 0?u:u===void 0||Math.abs(c-I)<Math.abs(u-I)?c:u;let A=t*e;const E=m+A,S=a===void 0?E:a(E);S!==E&&(A=S-m);const D=I=>-A*Math.exp(-I/r),b=I=>S+D(I),k=I=>{const M=D(I),C=b(I);_.done=Math.abs(M)<=h,_.value=_.done?S:C};let V,H;const P=I=>{v(_.value)&&(V=I,H=HP({keyframes:[_.value,T(_.value)],velocity:BP(b,I,_.value),damping:i,stiffness:s,restDelta:h,restSpeed:f}))};return P(0),{calculatedDuration:null,next:I=>{let M=!1;return!H&&V===void 0&&(M=!0,k(I),P(I)),V!==void 0&&I>=V?H.next(I-V):(!M&&k(I),_)}}}const hF=Jd(.42,0,1,1),dF=Jd(0,0,.58,1),GP=Jd(.42,0,.58,1),fF=n=>Array.isArray(n)&&typeof n[0]!="number",pF={linear:Yr,easeIn:hF,easeInOut:GP,easeOut:dF,circIn:iS,circInOut:xP,circOut:TP,backIn:rS,backInOut:EP,backOut:yP,anticipate:SP},LA=n=>{if(ZE(n)){VC(n.length===4);const[e,t,r,i]=n;return Jd(e,t,r,i)}else if(typeof n=="string")return pF[n];return n};function mF(n,e,t){const r=[],i=t||zP,s=n.length-1;for(let a=0;a<s;a++){let c=i(n[a],n[a+1]);if(e){const u=Array.isArray(e)?e[a]||Yr:e;c=ef(u,c)}r.push(c)}return r}function uS(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(VC(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const c=mF(e,r,i),u=c.length,h=f=>{if(a&&f<n[0])return e[0];let m=0;if(u>1)for(;m<n.length-2&&!(f<n[m+1]);m++);const _=ql(n[m],n[m+1],f);return c[m](_)};return t?f=>h(Js(n[0],n[s-1],f)):h}function gF(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=ql(0,e,r);n.push(Rn(t,1,i))}}function jP(n){const e=[0];return gF(e,n.length-1),e}function _F(n,e){return n.map(t=>t*e)}function vF(n,e){return n.map(()=>e||GP).splice(0,n.length-1)}function Vm({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=fF(r)?r.map(LA):LA(r),s={done:!1,value:e[0]},a=_F(t&&t.length===e.length?t:jP(e),n),c=uS(a,e,{ease:Array.isArray(i)?i:vF(e,i)});return{calculatedDuration:n,next:u=>(s.value=c(u),s.done=u>=n,s)}}const yF=n=>{const e=({timestamp:t})=>n(t);return{start:()=>sn.update(e,!0),stop:()=>ms(e),now:()=>hr.isProcessing?hr.timestamp:js.now()}},EF={decay:DA,inertia:DA,tween:Vm,keyframes:Vm,spring:HP},SF=n=>n/100;class hS extends FP{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:r,element:i,keyframes:s}=this.options,a=i?.KeyframeResolver||lS,c=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new a(s,c,t,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,c=YE(t)?t:EF[t]||Vm;let u,h;c!==Vm&&typeof e[0]!="number"&&(u=ef(SF,zP(e[0],e[1])),e=[0,100]);const f=c({...this.options,keyframes:e});s==="mirror"&&(h=c({...this.options,keyframes:[...e].reverse(),velocity:-a})),f.calculatedDuration===null&&(f.calculatedDuration=oP(f));const{calculatedDuration:m}=f,_=m+i,v=_*(r+1)-i;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:m,resolvedDuration:_,totalDuration:v}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:r}=this;if(!r){const{keyframes:I}=this.options;return{done:!0,value:I[I.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:c,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:m}=r;if(this.startTime===null)return s.next(0);const{delay:_,repeat:v,repeatType:T,repeatDelay:A,onUpdate:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const S=this.currentTime-_*(this.speed>=0?1:-1),D=this.speed>=0?S<0:S>f;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let b=this.currentTime,k=s;if(v){const I=Math.min(this.currentTime,f)/m;let M=Math.floor(I),C=I%1;!C&&I>=1&&(C=1),C===1&&M--,M=Math.min(M,v+1),M%2&&(T==="reverse"?(C=1-C,A&&(C-=A/m)):T==="mirror"&&(k=a)),b=Js(0,1,C)*m}const V=D?{done:!1,value:u[0]}:k.next(b);c&&(V.value=c(V.value));let{done:H}=V;!D&&h!==null&&(H=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&H);return P&&i!==void 0&&(V.value=Lg(u,this.options,i)),E&&E(V.value),P&&this.finish(),V}get duration(){const{resolved:e}=this;return e?Oo(e.calculatedDuration):0}get time(){return Oo(this.currentTime)}set time(e){e=No(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Oo(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=yF,onPlay:t,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const TF=new Set(["opacity","clipPath","filter","transform"]);function xF(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:c="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=cP(c,i);return Array.isArray(f)&&(h.easing=f),n.animate(h,{delay:r,duration:i,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const wF=OE(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),zm=10,AF=2e4;function MF(n){return YE(n.type)||n.type==="spring"||!lP(n.ease)}function bF(n,e){const t=new hS({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:n[0]};const i=[];let s=0;for(;!r.done&&s<AF;)r=t.sample(s),i.push(r.value),s+=zm;return{times:void 0,keyframes:i,duration:s-zm,ease:"linear"}}const WP={anticipate:SP,backInOut:EP,circInOut:xP};function RF(n){return n in WP}class NA extends FP{constructor(e){super(e);const{name:t,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new UP(s,(a,c)=>this.onKeyframesResolved(a,c),t,r,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:r=300,times:i,ease:s,type:a,motionValue:c,name:u,startTime:h}=this.options;if(!c.owner||!c.owner.current)return!1;if(typeof s=="string"&&Um()&&RF(s)&&(s=WP[s]),MF(this.options)){const{onComplete:m,onUpdate:_,motionValue:v,element:T,...A}=this.options,E=bF(e,A);e=E.keyframes,e.length===1&&(e[1]=e[0]),r=E.duration,i=E.times,s=E.ease,a="keyframes"}const f=xF(c.owner.current,u,e,{...this.options,duration:r,times:i,ease:s});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(vA(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:m}=this.options;c.set(Lg(e,this.options,t)),m&&m(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:r,times:i,type:a,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Oo(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Oo(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.currentTime=No(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Yr;const{animation:r}=t;vA(r,e)}return Yr}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:r,duration:i,type:s,ease:a,times:c}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:m,element:_,...v}=this.options,T=new hS({...v,keyframes:r,duration:i,type:s,ease:a,times:c,isGenerator:!0}),A=No(this.time);h.setWithVelocity(T.sample(A-zm).value,T.sample(A).value,zm)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:s,damping:a,type:c}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return wF()&&r&&TF.has(r)&&!u&&!h&&!i&&s!=="mirror"&&a!==0&&c!=="inertia"}}const CF={type:"spring",stiffness:500,damping:25,restSpeed:10},PF=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),IF={type:"keyframes",duration:.8},DF={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},LF=(n,{keyframes:e})=>e.length>2?IF:oc.has(n)?n.startsWith("scale")?PF(e[1]):CF:DF;function NF({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:c,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const dS=(n,e,t,r={},i,s)=>a=>{const c=KE(r,n)||{},u=c.delay||r.delay||0;let{elapsed:h=0}=r;h=h-No(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-h,onUpdate:_=>{e.set(_),c.onUpdate&&c.onUpdate(_)},onComplete:()=>{a(),c.onComplete&&c.onComplete()},name:n,motionValue:e,element:s?void 0:i};NF(c)||(f={...f,...LF(n,f)}),f.duration&&(f.duration=No(f.duration)),f.repeatDelay&&(f.repeatDelay=No(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let m=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(m=!0)),m&&!s&&e.get()!==void 0){const _=Lg(f.keyframes,c);if(_!==void 0)return sn.update(()=>{f.onUpdate(_),f.onComplete()}),new n3([])}return!s&&NA.supports(f)?new NA(f):new hS(f)};function OF({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function $P(n,e,{delay:t=0,transitionOverride:r,type:i}={}){var s;let{transition:a=n.getDefaultTransition(),transitionEnd:c,...u}=e;r&&(a=r);const h=[],f=i&&n.animationState&&n.animationState.getState()[i];for(const m in u){const _=n.getValue(m,(s=n.latestValues[m])!==null&&s!==void 0?s:null),v=u[m];if(v===void 0||f&&OF(f,m))continue;const T={delay:t,...KE(a||{},m)};let A=!1;if(window.MotionHandoffAnimation){const S=mP(n);if(S){const D=window.MotionHandoffAnimation(S,m,sn);D!==null&&(T.startTime=D,A=!0)}}T0(n,m),_.start(dS(m,_,v,n.shouldReduceMotion&&pP.has(m)?{type:!1}:T,n,A));const E=_.animation;E&&h.push(E)}return c&&Promise.all(h).then(()=>{sn.update(()=>{c&&m3(n,c)})}),h}function C0(n,e,t={}){var r;const i=Dg(n,e,t.type==="exit"?(r=n.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(s=t.transitionOverride);const a=i?()=>Promise.all($P(n,i,t)):()=>Promise.resolve(),c=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:m,staggerDirection:_}=s;return kF(n,e,f+h,m,_,t)}:()=>Promise.resolve(),{when:u}=s;if(u){const[h,f]=u==="beforeChildren"?[a,c]:[c,a];return h().then(()=>f())}else return Promise.all([a(),c(t.delay)])}function kF(n,e,t=0,r=0,i=1,s){const a=[],c=(n.variantChildren.size-1)*r,u=i===1?(h=0)=>h*r:(h=0)=>c-h*r;return Array.from(n.variantChildren).sort(UF).forEach((h,f)=>{h.notify("AnimationStart",e),a.push(C0(h,e,{...s,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(a)}function UF(n,e){return n.sortNodePosition(e)}function FF(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>C0(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=C0(n,e,t);else{const i=typeof e=="function"?Dg(n,e,t.custom):e;r=Promise.all($P(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}const VF=UE.length;function qP(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?qP(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<VF;t++){const r=UE[t],i=n.props[r];(Dd(i)||i===!1)&&(e[r]=i)}return e}const zF=[...kE].reverse(),BF=kE.length;function HF(n){return e=>Promise.all(e.map(({animation:t,options:r})=>FF(n,t,r)))}function GF(n){let e=HF(n),t=OA(),r=!0;const i=u=>(h,f)=>{var m;const _=Dg(n,f,u==="exit"?(m=n.presenceContext)===null||m===void 0?void 0:m.custom:void 0);if(_){const{transition:v,transitionEnd:T,...A}=_;h={...h,...A,...T}}return h};function s(u){e=u(n)}function a(u){const{props:h}=n,f=qP(n.parent)||{},m=[],_=new Set;let v={},T=1/0;for(let E=0;E<BF;E++){const S=zF[E],D=t[S],b=h[S]!==void 0?h[S]:f[S],k=Dd(b),V=S===u?D.isActive:null;V===!1&&(T=E);let H=b===f[S]&&b!==h[S]&&k;if(H&&r&&n.manuallyAnimateOnMount&&(H=!1),D.protectedKeys={...v},!D.isActive&&V===null||!b&&!D.prevProp||Pg(b)||typeof b=="boolean")continue;const P=jF(D.prevProp,b);let I=P||S===u&&D.isActive&&!H&&k||E>T&&k,M=!1;const C=Array.isArray(b)?b:[b];let N=C.reduce(i(S),{});V===!1&&(N={});const{prevResolvedValues:W={}}=D,F={...W,...N},Y=ge=>{I=!0,_.has(ge)&&(M=!0,_.delete(ge)),D.needsAnimating[ge]=!0;const Q=n.getValue(ge);Q&&(Q.liveStyle=!1)};for(const ge in F){const Q=N[ge],re=W[ge];if(v.hasOwnProperty(ge))continue;let ie=!1;y0(Q)&&y0(re)?ie=!iP(Q,re):ie=Q!==re,ie?Q!=null?Y(ge):_.add(ge):Q!==void 0&&_.has(ge)?Y(ge):D.protectedKeys[ge]=!0}D.prevProp=b,D.prevResolvedValues=N,D.isActive&&(v={...v,...N}),r&&n.blockInitialAnimation&&(I=!1),I&&(!(H&&P)||M)&&m.push(...C.map(ge=>({animation:ge,options:{type:S}})))}if(_.size){const E={};_.forEach(S=>{const D=n.getBaseTarget(S),b=n.getValue(S);b&&(b.liveStyle=!0),E[S]=D??null}),m.push({animation:E})}let A=!!m.length;return r&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(A=!1),r=!1,A?e(m):Promise.resolve()}function c(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=n.variantChildren)===null||f===void 0||f.forEach(_=>{var v;return(v=_.animationState)===null||v===void 0?void 0:v.setActive(u,h)}),t[u].isActive=h;const m=a(u);for(const _ in t)t[_].protectedKeys={};return m}return{animateChanges:a,setActive:c,setAnimateFunction:s,getState:()=>t,reset:()=>{t=OA(),r=!0}}}function jF(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!iP(e,n):!1}function wl(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function OA(){return{animate:wl(!0),whileInView:wl(),whileHover:wl(),whileTap:wl(),whileDrag:wl(),whileFocus:wl(),exit:wl()}}class Ja{constructor(e){this.isMounted=!1,this.node=e}update(){}}class WF extends Ja{constructor(e){super(e),e.animationState||(e.animationState=GF(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Pg(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let $F=0;class qF extends Ja{constructor(){super(...arguments),this.id=$F++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const XF={animation:{Feature:WF},exit:{Feature:qF}};function Od(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function tf(n){return{point:{x:n.pageX,y:n.pageY}}}const KF=n=>e=>QE(e)&&n(e,tf(e));function vd(n,e,t,r){return Od(n,e,KF(t),r)}const kA=(n,e)=>Math.abs(n-e);function YF(n,e){const t=kA(n.x,e.x),r=kA(n.y,e.y);return Math.sqrt(t**2+r**2)}class XP{constructor(e,t,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=ey(this.lastMoveEventInfo,this.history),_=this.startEvent!==null,v=YF(m.offset,{x:0,y:0})>=3;if(!_&&!v)return;const{point:T}=m,{timestamp:A}=hr;this.history.push({...T,timestamp:A});const{onStart:E,onMove:S}=this.handlers;_||(E&&E(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),S&&S(this.lastMoveEvent,m)},this.handlePointerMove=(m,_)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Jv(_,this.transformPagePoint),sn.update(this.updatePoint,!0)},this.handlePointerUp=(m,_)=>{this.end();const{onEnd:v,onSessionEnd:T,resumeAnimation:A}=this.handlers;if(this.dragSnapToOrigin&&A&&A(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=ey(m.type==="pointercancel"?this.lastMoveEventInfo:Jv(_,this.transformPagePoint),this.history);this.startEvent&&v&&v(m,E),T&&T(m,E)},!QE(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.contextWindow=i||window;const a=tf(e),c=Jv(a,this.transformPagePoint),{point:u}=c,{timestamp:h}=hr;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,ey(c,this.history)),this.removeListeners=ef(vd(this.contextWindow,"pointermove",this.handlePointerMove),vd(this.contextWindow,"pointerup",this.handlePointerUp),vd(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ms(this.updatePoint)}}function Jv(n,e){return e?{point:e(n.point)}:n}function UA(n,e){return{x:n.x-e.x,y:n.y-e.y}}function ey({point:n},e){return{point:n,delta:UA(n,KP(e)),offset:UA(n,ZF(e)),velocity:QF(e,.1)}}function ZF(n){return n[0]}function KP(n){return n[n.length-1]}function QF(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=KP(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>No(e)));)t--;if(!r)return{x:0,y:0};const s=Oo(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const YP=1e-4,JF=1-YP,eV=1+YP,ZP=.01,tV=0-ZP,nV=0+ZP;function Ci(n){return n.max-n.min}function rV(n,e,t){return Math.abs(n-e)<=t}function FA(n,e,t,r=.5){n.origin=r,n.originPoint=Rn(e.min,e.max,n.origin),n.scale=Ci(t)/Ci(e),n.translate=Rn(t.min,t.max,n.origin)-n.originPoint,(n.scale>=JF&&n.scale<=eV||isNaN(n.scale))&&(n.scale=1),(n.translate>=tV&&n.translate<=nV||isNaN(n.translate))&&(n.translate=0)}function yd(n,e,t,r){FA(n.x,e.x,t.x,r?r.originX:void 0),FA(n.y,e.y,t.y,r?r.originY:void 0)}function VA(n,e,t){n.min=t.min+e.min,n.max=n.min+Ci(e)}function iV(n,e,t){VA(n.x,e.x,t.x),VA(n.y,e.y,t.y)}function zA(n,e,t){n.min=e.min-t.min,n.max=n.min+Ci(e)}function Ed(n,e,t){zA(n.x,e.x,t.x),zA(n.y,e.y,t.y)}function sV(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Rn(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Rn(t,n,r.max):Math.min(n,t)),n}function BA(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function oV(n,{top:e,left:t,bottom:r,right:i}){return{x:BA(n.x,t,i),y:BA(n.y,e,r)}}function HA(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function aV(n,e){return{x:HA(n.x,e.x),y:HA(n.y,e.y)}}function lV(n,e){let t=.5;const r=Ci(n),i=Ci(e);return i>r?t=ql(e.min,e.max-r,n.min):r>i&&(t=ql(n.min,n.max-i,e.min)),Js(0,1,t)}function cV(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const P0=.35;function uV(n=P0){return n===!1?n=0:n===!0&&(n=P0),{x:GA(n,"left","right"),y:GA(n,"top","bottom")}}function GA(n,e,t){return{min:jA(n,e),max:jA(n,t)}}function jA(n,e){return typeof n=="number"?n:n[e]||0}const WA=()=>({translate:0,scale:1,origin:0,originPoint:0}),Eu=()=>({x:WA(),y:WA()}),$A=()=>({min:0,max:0}),Hn=()=>({x:$A(),y:$A()});function zi(n){return[n("x"),n("y")]}function QP({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function hV({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function dV(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function ty(n){return n===void 0||n===1}function I0({scale:n,scaleX:e,scaleY:t}){return!ty(n)||!ty(e)||!ty(t)}function Pl(n){return I0(n)||JP(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function JP(n){return qA(n.x)||qA(n.y)}function qA(n){return n&&n!=="0%"}function Bm(n,e,t){const r=n-t,i=e*r;return t+i}function XA(n,e,t,r,i){return i!==void 0&&(n=Bm(n,i,r)),Bm(n,t,r)+e}function D0(n,e=0,t=1,r,i){n.min=XA(n.min,e,t,r,i),n.max=XA(n.max,e,t,r,i)}function eI(n,{x:e,y:t}){D0(n.x,e.translate,e.scale,e.originPoint),D0(n.y,t.translate,t.scale,t.originPoint)}const KA=.999999999999,YA=1.0000000000001;function fV(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let c=0;c<i;c++){s=t[c],a=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Tu(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,eI(n,a)),r&&Pl(s.latestValues)&&Tu(n,s.latestValues))}e.x<YA&&e.x>KA&&(e.x=1),e.y<YA&&e.y>KA&&(e.y=1)}function Su(n,e){n.min=n.min+e,n.max=n.max+e}function ZA(n,e,t,r,i=.5){const s=Rn(n.min,n.max,i);D0(n,e,t,s,r)}function Tu(n,e){ZA(n.x,e.x,e.scaleX,e.scale,e.originX),ZA(n.y,e.y,e.scaleY,e.scale,e.originY)}function tI(n,e){return QP(dV(n.getBoundingClientRect(),e))}function pV(n,e,t){const r=tI(n,t),{scroll:i}=e;return i&&(Su(r.x,i.offset.x),Su(r.y,i.offset.y)),r}const nI=({current:n})=>n?n.ownerDocument.defaultView:null,mV=new WeakMap;class gV{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Hn(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=f=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(tf(f).point)},s=(f,m)=>{const{drag:_,dragPropagation:v,onDragStart:T}=this.getProps();if(_&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=u3(_),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),zi(E=>{let S=this.getAxisMotionValue(E).get()||0;if(Gs.test(S)){const{projection:D}=this.visualElement;if(D&&D.layout){const b=D.layout.layoutBox[E];b&&(S=Ci(b)*(parseFloat(S)/100))}}this.originPoint[E]=S}),T&&sn.postRender(()=>T(f,m)),T0(this.visualElement,"transform");const{animationState:A}=this.visualElement;A&&A.setActive("whileDrag",!0)},a=(f,m)=>{const{dragPropagation:_,dragDirectionLock:v,onDirectionLock:T,onDrag:A}=this.getProps();if(!_&&!this.openDragLock)return;const{offset:E}=m;if(v&&this.currentDirection===null){this.currentDirection=_V(E),this.currentDirection!==null&&T&&T(this.currentDirection);return}this.updateAxis("x",m.point,E),this.updateAxis("y",m.point,E),this.visualElement.render(),A&&A(f,m)},c=(f,m)=>this.stop(f,m),u=()=>zi(f=>{var m;return this.getAnimationState(f)==="paused"&&((m=this.getAxisMotionValue(f).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new XP(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:nI(this.visualElement)})}stop(e,t){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&sn.postRender(()=>s(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!Ap(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=sV(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;t&&vu(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=oV(i.layoutBox,t):this.constraints=!1,this.elastic=uV(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&zi(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=cV(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!vu(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=pV(r,i.root,this.visualElement.getTransformPagePoint());let a=aV(i.layout.layoutBox,s);if(t){const c=t(hV(a));this.hasMutatedConstraints=!!c,c&&(a=QP(c))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},h=zi(f=>{if(!Ap(f,t,this.currentDirection))return;let m=u&&u[f]||{};a&&(m={min:0,max:0});const _=i?200:1e6,v=i?40:1e7,T={type:"inertia",velocity:r?e[f]:0,bounceStiffness:_,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...s,...m};return this.startAxisValueAnimation(f,T)});return Promise.all(h).then(c)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return T0(this.visualElement,e),r.start(dS(e,r,0,t,this.visualElement,!1))}stopAnimation(){zi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){zi(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){zi(t=>{const{drag:r}=this.getProps();if(!Ap(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:c}=i.layout.layoutBox[t];s.set(e[t]-Rn(a,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!vu(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};zi(a=>{const c=this.getAxisMotionValue(a);if(c&&this.constraints!==!1){const u=c.get();i[a]=lV({min:u,max:u},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),zi(a=>{if(!Ap(a,e,null))return;const c=this.getAxisMotionValue(a),{min:u,max:h}=this.constraints[a];c.set(Rn(u,h,i[a]))})}addListeners(){if(!this.visualElement.current)return;mV.set(this.visualElement,this);const e=this.visualElement.current,t=vd(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();vu(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),sn.read(r);const a=Od(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(zi(f=>{const m=this.getAxisMotionValue(f);m&&(this.originPoint[f]+=u[f].translate,m.set(m.get()+u[f].translate))}),this.visualElement.render())}));return()=>{a(),t(),s(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=P0,dragMomentum:c=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:c}}}function Ap(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function _V(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class vV extends Ja{constructor(e){super(e),this.removeGroupControls=Yr,this.removeListeners=Yr,this.controls=new gV(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Yr}unmount(){this.removeGroupControls(),this.removeListeners()}}const QA=n=>(e,t)=>{n&&sn.postRender(()=>n(e,t))};class yV extends Ja{constructor(){super(...arguments),this.removePointerDownListener=Yr}onPointerDown(e){this.session=new XP(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:nI(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:QA(e),onStart:QA(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&sn.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=vd(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const _m={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function JA(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const jh={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(yt.test(n))n=parseFloat(n);else return n;const t=JA(n,e.target.x),r=JA(n,e.target.y);return`${t}% ${r}%`}},EV={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=ja.parse(n);if(i.length>5)return r;const s=ja.createTransformer(n),a=typeof i[0]!="number"?1:0,c=t.x.scale*e.x,u=t.y.scale*e.y;i[0+a]/=c,i[1+a]/=u;const h=Rn(c,u,.5);return typeof i[2+a]=="number"&&(i[2+a]/=h),typeof i[3+a]=="number"&&(i[3+a]/=h),s(i)}};class SV extends X.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;WU(TV),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),_m.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||sn.postRender(()=>{const c=a.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),VE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function rI(n){const[e,t]=UC(),r=X.useContext(LE);return B.jsx(SV,{...n,layoutGroup:r,switchLayoutGroup:X.useContext(WC),isPresent:e,safeToRemove:t})}const TV={borderRadius:{...jh,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:jh,borderTopRightRadius:jh,borderBottomLeftRadius:jh,borderBottomRightRadius:jh,boxShadow:EV};function xV(n,e,t){const r=Vr(n)?n:zs(n);return r.start(dS("",r,e,t)),r.animation}function wV(n){return n instanceof SVGElement&&n.tagName!=="svg"}const AV=(n,e)=>n.depth-e.depth;class MV{constructor(){this.children=[],this.isDirty=!1}add(e){JE(this.children,e),this.isDirty=!0}remove(e){eS(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(AV),this.isDirty=!1,this.children.forEach(e)}}function bV(n,e){const t=js.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(ms(r),n(s-e))};return sn.read(r,!0),()=>ms(r)}const iI=["TopLeft","TopRight","BottomLeft","BottomRight"],RV=iI.length,eM=n=>typeof n=="string"?parseFloat(n):n,tM=n=>typeof n=="number"||yt.test(n);function CV(n,e,t,r,i,s){i?(n.opacity=Rn(0,t.opacity!==void 0?t.opacity:1,PV(r)),n.opacityExit=Rn(e.opacity!==void 0?e.opacity:1,0,IV(r))):s&&(n.opacity=Rn(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,r));for(let a=0;a<RV;a++){const c=`border${iI[a]}Radius`;let u=nM(e,c),h=nM(t,c);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||tM(u)===tM(h)?(n[c]=Math.max(Rn(eM(u),eM(h),r),0),(Gs.test(h)||Gs.test(u))&&(n[c]+="%")):n[c]=h}(e.rotate||t.rotate)&&(n.rotate=Rn(e.rotate||0,t.rotate||0,r))}function nM(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const PV=sI(0,.5,TP),IV=sI(.5,.95,Yr);function sI(n,e,t){return r=>r<n?0:r>e?1:t(ql(n,e,r))}function rM(n,e){n.min=e.min,n.max=e.max}function Fi(n,e){rM(n.x,e.x),rM(n.y,e.y)}function iM(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function sM(n,e,t,r,i){return n-=e,n=Bm(n,1/t,r),i!==void 0&&(n=Bm(n,1/i,r)),n}function DV(n,e=0,t=1,r=.5,i,s=n,a=n){if(Gs.test(e)&&(e=parseFloat(e),e=Rn(a.min,a.max,e/100)-a.min),typeof e!="number")return;let c=Rn(s.min,s.max,r);n===s&&(c-=e),n.min=sM(n.min,e,t,c,i),n.max=sM(n.max,e,t,c,i)}function oM(n,e,[t,r,i],s,a){DV(n,e[t],e[r],e[i],e.scale,s,a)}const LV=["x","scaleX","originX"],NV=["y","scaleY","originY"];function aM(n,e,t,r){oM(n.x,e,LV,t?t.x:void 0,r?r.x:void 0),oM(n.y,e,NV,t?t.y:void 0,r?r.y:void 0)}function lM(n){return n.translate===0&&n.scale===1}function oI(n){return lM(n.x)&&lM(n.y)}function cM(n,e){return n.min===e.min&&n.max===e.max}function OV(n,e){return cM(n.x,e.x)&&cM(n.y,e.y)}function uM(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function aI(n,e){return uM(n.x,e.x)&&uM(n.y,e.y)}function hM(n){return Ci(n.x)/Ci(n.y)}function dM(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class kV{constructor(){this.members=[]}add(e){JE(this.members,e),e.scheduleRender()}remove(e){if(eS(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function UV(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=t?.z||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:m,rotateY:_,skewX:v,skewY:T}=t;h&&(r=`perspective(${h}px) ${r}`),f&&(r+=`rotate(${f}deg) `),m&&(r+=`rotateX(${m}deg) `),_&&(r+=`rotateY(${_}deg) `),v&&(r+=`skewX(${v}deg) `),T&&(r+=`skewY(${T}deg) `)}const c=n.x.scale*e.x,u=n.y.scale*e.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const Il={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},ld=typeof window<"u"&&window.MotionDebug!==void 0,ny=["","X","Y","Z"],FV={visibility:"hidden"},fM=1e3;let VV=0;function ry(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function lI(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=mP(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",sn,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&lI(r)}function cI({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},c=e?.()){this.id=VV++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ld&&(Il.totalNodes=Il.resolvedTargetDeltas=Il.recalculatedProjection=0),this.nodes.forEach(HV),this.nodes.forEach(qV),this.nodes.forEach(XV),this.nodes.forEach(GV),ld&&window.MotionDebug.record(Il)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new MV)}addEventListener(a,c){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new tS),this.eventHandlers.get(a).add(c)}notifyListeners(a,...c){const u=this.eventHandlers.get(a);u&&u.notify(...c)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,c=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=wV(a),this.instance=a;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),c&&(h||u)&&(this.isLayoutDirty=!0),n){let m;const _=()=>this.root.updateBlockedByResize=!1;n(a,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=bV(_,250),_m.hasAnimatedSinceResize&&(_m.hasAnimatedSinceResize=!1,this.nodes.forEach(mM))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:_,hasRelativeTargetChanged:v,layout:T})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const A=this.options.transition||f.getDefaultTransition()||JV,{onLayoutAnimationStart:E,onLayoutAnimationComplete:S}=f.getProps(),D=!this.targetLayout||!aI(this.targetLayout,T)||v,b=!_&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||_&&(D||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,b);const k={...KE(A,"layout"),onPlay:E,onComplete:S};(f.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k)}else _||mM(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=T})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ms(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(KV),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&lI(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const m=this.path[f];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(pM);return}this.isUpdating||this.nodes.forEach(WV),this.isUpdating=!1,this.nodes.forEach($V),this.nodes.forEach(zV),this.nodes.forEach(BV),this.clearAllSnapshots();const c=js.now();hr.delta=Js(0,1e3/60,c-hr.timestamp),hr.timestamp=c,hr.isProcessing=!0,qv.update.process(hr),qv.preRender.process(hr),qv.render.process(hr),hr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,VE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(jV),this.sharedNodes.forEach(YV)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,sn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){sn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Hn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(c=!1),c){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!oI(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;a&&(c||Pl(this.latestValues)||f)&&(i(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return a&&(u=this.removeTransform(u)),e4(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:c}=this.options;if(!c)return Hn();const u=c.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(t4))){const{scroll:f}=this.root;f&&(Su(u.x,f.offset.x),Su(u.y,f.offset.y))}return u}removeElementScroll(a){var c;const u=Hn();if(Fi(u,a),!((c=this.scroll)===null||c===void 0)&&c.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:m,options:_}=f;f!==this.root&&m&&_.layoutScroll&&(m.wasRoot&&Fi(u,a),Su(u.x,m.offset.x),Su(u.y,m.offset.y))}return u}applyTransform(a,c=!1){const u=Hn();Fi(u,a);for(let h=0;h<this.path.length;h++){const f=this.path[h];!c&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Tu(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Pl(f.latestValues)&&Tu(u,f.latestValues)}return Pl(this.latestValues)&&Tu(u,this.latestValues),u}removeTransform(a){const c=Hn();Fi(c,a);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Pl(h.latestValues))continue;I0(h.latestValues)&&h.updateSnapshot();const f=Hn(),m=h.measurePageBox();Fi(f,m),aM(c,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return Pl(this.latestValues)&&aM(c,this.latestValues),c}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==hr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var c;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(a||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((c=this.parent)===null||c===void 0)&&c.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:_}=this.options;if(!(!this.layout||!(m||_))){if(this.resolvedRelativeTargetAt=hr.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Hn(),this.relativeTargetOrigin=Hn(),Ed(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),Fi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Hn(),this.targetWithTransforms=Hn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),iV(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Fi(this.target,this.layout.layoutBox),eI(this.target,this.targetDelta)):Fi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Hn(),this.relativeTargetOrigin=Hn(),Ed(this.relativeTargetOrigin,this.target,v.target),Fi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ld&&Il.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||I0(this.parent.latestValues)||JP(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const c=this.getLead(),u=!!this.resumingFrom||this!==c;let h=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===hr.timestamp&&(h=!1),h)return;const{layout:f,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||m))return;Fi(this.layoutCorrected,this.layout.layoutBox);const _=this.treeScale.x,v=this.treeScale.y;fV(this.layoutCorrected,this.treeScale,this.path,u),c.layout&&!c.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(c.target=c.layout.layoutBox,c.targetWithTransforms=Hn());const{target:T}=c;if(!T){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(iM(this.prevProjectionDelta.x,this.projectionDelta.x),iM(this.prevProjectionDelta.y,this.projectionDelta.y)),yd(this.projectionDelta,this.layoutCorrected,T,this.latestValues),(this.treeScale.x!==_||this.treeScale.y!==v||!dM(this.projectionDelta.x,this.prevProjectionDelta.x)||!dM(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",T)),ld&&Il.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var c;if((c=this.options.visualElement)===null||c===void 0||c.scheduleRender(),a){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Eu(),this.projectionDelta=Eu(),this.projectionDeltaWithTransform=Eu()}setAnimationOrigin(a,c=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},m=Eu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const _=Hn(),v=u?u.source:void 0,T=this.layout?this.layout.source:void 0,A=v!==T,E=this.getStack(),S=!E||E.members.length<=1,D=!!(A&&!S&&this.options.crossfade===!0&&!this.path.some(QV));this.animationProgress=0;let b;this.mixTargetDelta=k=>{const V=k/1e3;gM(m.x,a.x,V),gM(m.y,a.y,V),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ed(_,this.layout.layoutBox,this.relativeParent.layout.layoutBox),ZV(this.relativeTarget,this.relativeTargetOrigin,_,V),b&&OV(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=Hn()),Fi(b,this.relativeTarget)),A&&(this.animationValues=f,CV(f,h,this.latestValues,V,D,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=V},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ms(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=sn.update(()=>{_m.hasAnimatedSinceResize=!0,this.currentAnimation=xV(0,fM,{...a,onUpdate:c=>{this.mixTargetDelta(c),a.onUpdate&&a.onUpdate(c)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(fM),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:c,target:u,layout:h,latestValues:f}=a;if(!(!c||!u||!h)){if(this!==a&&this.layout&&h&&uI(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Hn();const m=Ci(this.layout.layoutBox.x);u.x.min=a.target.x.min,u.x.max=u.x.min+m;const _=Ci(this.layout.layoutBox.y);u.y.min=a.target.y.min,u.y.max=u.y.min+_}Fi(c,u),Tu(c,f),yd(this.projectionDeltaWithTransform,this.layoutCorrected,c,f)}}registerSharedNode(a,c){this.sharedNodes.has(a)||this.sharedNodes.set(a,new kV),this.sharedNodes.get(a).add(c);const h=c.options.initialPromotionConfig;c.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(c):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:c}=this.options;return c?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:c}=this.options;return c?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:c,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),a&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let c=!1;const{latestValues:u}=a;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const h={};u.z&&ry("z",a,h,this.animationValues);for(let f=0;f<ny.length;f++)ry(`rotate${ny[f]}`,a,h,this.animationValues),ry(`skew${ny[f]}`,a,h,this.animationValues);a.render();for(const f in h)a.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);a.scheduleRender()}getProjectionStyles(a){var c,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return FV;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=mm(a?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const A={};return this.options.layoutId&&(A.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,A.pointerEvents=mm(a?.pointerEvents)||""),this.hasProjected&&!Pl(this.latestValues)&&(A.transform=f?f({},""):"none",this.hasProjected=!1),A}const _=m.animationValues||m.latestValues;this.applyTransformsToTarget(),h.transform=UV(this.projectionDeltaWithTransform,this.treeScale,_),f&&(h.transform=f(_,h.transform));const{x:v,y:T}=this.projectionDelta;h.transformOrigin=`${v.origin*100}% ${T.origin*100}% 0`,m.animationValues?h.opacity=m===this?(u=(c=_.opacity)!==null&&c!==void 0?c:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:_.opacityExit:h.opacity=m===this?_.opacity!==void 0?_.opacity:"":_.opacityExit!==void 0?_.opacityExit:0;for(const A in km){if(_[A]===void 0)continue;const{correct:E,applyTo:S}=km[A],D=h.transform==="none"?_[A]:E(_[A],m);if(S){const b=S.length;for(let k=0;k<b;k++)h[S[k]]=D}else h[A]=D}return this.options.layoutId&&(h.pointerEvents=m===this?mm(a?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var c;return(c=a.currentAnimation)===null||c===void 0?void 0:c.stop()}),this.root.nodes.forEach(pM),this.root.sharedNodes.clear()}}}function zV(n){n.updateLayout()}function BV(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=t.source!==n.layout.source;s==="size"?zi(m=>{const _=a?t.measuredBox[m]:t.layoutBox[m],v=Ci(_);_.min=r[m].min,_.max=_.min+v}):uI(s,t.layoutBox,r)&&zi(m=>{const _=a?t.measuredBox[m]:t.layoutBox[m],v=Ci(r[m]);_.max=_.min+v,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[m].max=n.relativeTarget[m].min+v)});const c=Eu();yd(c,r,t.layoutBox);const u=Eu();a?yd(u,n.applyTransform(i,!0),t.measuredBox):yd(u,r,t.layoutBox);const h=!oI(c);let f=!1;if(!n.resumeFrom){const m=n.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:_,layout:v}=m;if(_&&v){const T=Hn();Ed(T,t.layoutBox,_.layoutBox);const A=Hn();Ed(A,r,v.layoutBox),aI(T,A)||(f=!0),m.options.layoutRoot&&(n.relativeTarget=A,n.relativeTargetOrigin=T,n.relativeParent=m)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:u,layoutDelta:c,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function HV(n){ld&&Il.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function GV(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function jV(n){n.clearSnapshot()}function pM(n){n.clearMeasurements()}function WV(n){n.isLayoutDirty=!1}function $V(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function mM(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function qV(n){n.resolveTargetDelta()}function XV(n){n.calcProjection()}function KV(n){n.resetSkewAndRotation()}function YV(n){n.removeLeadSnapshot()}function gM(n,e,t){n.translate=Rn(e.translate,0,t),n.scale=Rn(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function _M(n,e,t,r){n.min=Rn(e.min,t.min,r),n.max=Rn(e.max,t.max,r)}function ZV(n,e,t,r){_M(n.x,e.x,t.x,r),_M(n.y,e.y,t.y,r)}function QV(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const JV={duration:.45,ease:[.4,0,.1,1]},vM=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),yM=vM("applewebkit/")&&!vM("chrome/")?Math.round:Yr;function EM(n){n.min=yM(n.min),n.max=yM(n.max)}function e4(n){EM(n.x),EM(n.y)}function uI(n,e,t){return n==="position"||n==="preserve-aspect"&&!rV(hM(e),hM(t),.2)}function t4(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const n4=cI({attachResizeListener:(n,e)=>Od(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),iy={current:void 0},hI=cI({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!iy.current){const n=new n4({});n.mount(window),n.setOptions({layoutScroll:!0}),iy.current=n}return iy.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),r4={pan:{Feature:yV},drag:{Feature:vV,ProjectionNode:hI,MeasureLayout:rI}};function SM(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&sn.postRender(()=>s(e,tf(e)))}class i4 extends Ja{mount(){const{current:e}=this.node;e&&(this.unmount=s3(e,t=>(SM(this.node,t,"Start"),r=>SM(this.node,r,"End"))))}unmount(){}}class s4 extends Ja{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ef(Od(this.node.current,"focus",()=>this.onFocus()),Od(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function TM(n,e,t){const{props:r}=n;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&sn.postRender(()=>s(e,tf(e)))}class o4 extends Ja{mount(){const{current:e}=this.node;e&&(this.unmount=c3(e,t=>(TM(this.node,t,"Start"),(r,{success:i})=>TM(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const L0=new WeakMap,sy=new WeakMap,a4=n=>{const e=L0.get(n.target);e&&e(n)},l4=n=>{n.forEach(a4)};function c4({root:n,...e}){const t=n||document;sy.has(t)||sy.set(t,{});const r=sy.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(l4,{root:n,...e})),r[i]}function u4(n,e,t){const r=c4(e);return L0.set(n,t),r.observe(n),()=>{L0.delete(n),r.unobserve(n)}}const h4={some:0,all:1};class d4 extends Ja{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:h4[i]},c=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:m}=this.node.getProps(),_=h?f:m;_&&_(u)};return u4(this.node.current,a,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(f4(e,t))&&this.startObserver()}unmount(){}}function f4({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const p4={inView:{Feature:d4},tap:{Feature:o4},focus:{Feature:s4},hover:{Feature:i4}},m4={layout:{ProjectionNode:hI,MeasureLayout:rI}},N0={current:null},dI={current:!1};function g4(){if(dI.current=!0,!!NE)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>N0.current=n.matches;n.addListener(e),e()}else N0.current=!1}const _4=[...kP,kr,ja],v4=n=>_4.find(OP(n)),xM=new WeakMap;function y4(n,e,t){for(const r in e){const i=e[r],s=t[r];if(Vr(i))n.addValue(r,i);else if(Vr(s))n.addValue(r,zs(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,zs(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const wM=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class E4{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=lS,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=js.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,sn.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=a;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!s,this.isControllingVariants=Ig(t),this.isVariantNode=GC(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:m,..._}=this.scrapeMotionValuesFromProps(t,{},this);for(const v in _){const T=_[v];u[v]!==void 0&&Vr(T)&&T.set(u[v],!1)}}mount(e){this.current=e,xM.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),dI.current||g4(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:N0.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){xM.delete(this.current),this.projection&&this.projection.unmount(),ms(this.notifyUpdate),ms(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=oc.has(e),i=t.on("change",c=>{this.latestValues[e]=c,this.props.onUpdate&&sn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in ku){const t=ku[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Hn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<wM.length;r++){const i=wM[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=y4(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=zs(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(LP(i)||wP(i))?i=parseFloat(i):!v4(i)&&ja.test(t)&&(i=PP(e,t)),this.setBaseTarget(e,Vr(i)?i.get():i)),Vr(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=BE(this.props,r,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Vr(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new tS),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class fI extends E4{constructor(){super(...arguments),this.KeyframeResolver=UP}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Vr(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function S4(n){return window.getComputedStyle(n)}class T4 extends fI{constructor(){super(...arguments),this.type="html",this.renderInstance=QC}readValueFromInstance(e,t){if(oc.has(t)){const r=aS(t);return r&&r.default||0}else{const r=S4(e),i=(KC(t)?r.getPropertyValue(t):r[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return tI(e,t)}build(e,t,r){jE(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return XE(e,t,r)}}class x4 extends fI{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Hn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(oc.has(t)){const r=aS(t);return r&&r.default||0}return t=JC.has(t)?t:FE(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return nP(e,t,r)}build(e,t,r){WE(e,t,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,r,i){eP(e,t,r,i)}mount(e){this.isSVGTag=qE(e.tagName),super.mount(e)}}const w4=(n,e)=>zE(n)?new x4(e):new T4(e,{allowProjection:n!==X.Fragment}),A4=e3({...XF,...p4,...r4,...m4},w4),us=mU(A4);function pI(n,e){let t;const r=()=>{const{currentTime:i}=e,a=(i===null?0:i.value)/100;t!==a&&n(a),t=a};return sn.update(r,!0),()=>ms(r)}const vm=new WeakMap;let wa;function M4(n,e){if(e){const{inlineSize:t,blockSize:r}=e[0];return{width:t,height:r}}else return n instanceof SVGElement&&"getBBox"in n?n.getBBox():{width:n.offsetWidth,height:n.offsetHeight}}function b4({target:n,contentRect:e,borderBoxSize:t}){var r;(r=vm.get(n))===null||r===void 0||r.forEach(i=>{i({target:n,contentSize:e,get size(){return M4(n,t)}})})}function R4(n){n.forEach(b4)}function C4(){typeof ResizeObserver>"u"||(wa=new ResizeObserver(R4))}function P4(n,e){wa||C4();const t=hP(n);return t.forEach(r=>{let i=vm.get(r);i||(i=new Set,vm.set(r,i)),i.add(e),wa?.observe(r)}),()=>{t.forEach(r=>{const i=vm.get(r);i?.delete(e),i?.size||wa?.unobserve(r)})}}const ym=new Set;let Sd;function I4(){Sd=()=>{const n={width:window.innerWidth,height:window.innerHeight},e={target:window,size:n,contentSize:n};ym.forEach(t=>t(e))},window.addEventListener("resize",Sd)}function D4(n){return ym.add(n),Sd||I4(),()=>{ym.delete(n),!ym.size&&Sd&&(Sd=void 0)}}function L4(n,e){return typeof n=="function"?D4(n):P4(n,e)}const N4=50,AM=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),O4=()=>({time:0,x:AM(),y:AM()}),k4={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function MM(n,e,t,r){const i=t[e],{length:s,position:a}=k4[e],c=i.current,u=t.time;i.current=n[`scroll${a}`],i.scrollLength=n[`scroll${s}`]-n[`client${s}`],i.offset.length=0,i.offset[0]=0,i.offset[1]=i.scrollLength,i.progress=ql(0,i.scrollLength,i.current);const h=r-u;i.velocity=h>N4?0:nS(i.current-c,h)}function U4(n,e,t){MM(n,"x",e,t),MM(n,"y",e,t),e.time=t}function F4(n,e){const t={x:0,y:0};let r=n;for(;r&&r!==e;)if(r instanceof HTMLElement)t.x+=r.offsetLeft,t.y+=r.offsetTop,r=r.offsetParent;else if(r.tagName==="svg"){const i=r.getBoundingClientRect();r=r.parentElement;const s=r.getBoundingClientRect();t.x+=i.left-s.left,t.y+=i.top-s.top}else if(r instanceof SVGGraphicsElement){const{x:i,y:s}=r.getBBox();t.x+=i,t.y+=s;let a=null,c=r.parentNode;for(;!a;)c.tagName==="svg"&&(a=c),c=r.parentNode;r=a}else break;return t}const O0={start:0,center:.5,end:1};function bM(n,e,t=0){let r=0;if(n in O0&&(n=O0[n]),typeof n=="string"){const i=parseFloat(n);n.endsWith("px")?r=i:n.endsWith("%")?n=i/100:n.endsWith("vw")?r=i/100*document.documentElement.clientWidth:n.endsWith("vh")?r=i/100*document.documentElement.clientHeight:n=i}return typeof n=="number"&&(r=e*n),t+r}const V4=[0,0];function z4(n,e,t,r){let i=Array.isArray(n)?n:V4,s=0,a=0;return typeof n=="number"?i=[n,n]:typeof n=="string"&&(n=n.trim(),n.includes(" ")?i=n.split(" "):i=[n,O0[n]?n:"0"]),s=bM(i[0],t,r),a=bM(i[1],e),s-a}const B4={All:[[0,0],[1,1]]},H4={x:0,y:0};function G4(n){return"getBBox"in n&&n.tagName!=="svg"?n.getBBox():{width:n.clientWidth,height:n.clientHeight}}function j4(n,e,t){const{offset:r=B4.All}=t,{target:i=n,axis:s="y"}=t,a=s==="y"?"height":"width",c=i!==n?F4(i,n):H4,u=i===n?{width:n.scrollWidth,height:n.scrollHeight}:G4(i),h={width:n.clientWidth,height:n.clientHeight};e[s].offset.length=0;let f=!e[s].interpolate;const m=r.length;for(let _=0;_<m;_++){const v=z4(r[_],h[a],u[a],c[s]);!f&&v!==e[s].interpolatorOffsets[_]&&(f=!0),e[s].offset[_]=v}f&&(e[s].interpolate=uS(e[s].offset,jP(r),{clamp:!1}),e[s].interpolatorOffsets=[...e[s].offset]),e[s].progress=Js(0,1,e[s].interpolate(e[s].current))}function W4(n,e=n,t){if(t.x.targetOffset=0,t.y.targetOffset=0,e!==n){let r=e;for(;r&&r!==n;)t.x.targetOffset+=r.offsetLeft,t.y.targetOffset+=r.offsetTop,r=r.offsetParent}t.x.targetLength=e===n?e.scrollWidth:e.clientWidth,t.y.targetLength=e===n?e.scrollHeight:e.clientHeight,t.x.containerLength=n.clientWidth,t.y.containerLength=n.clientHeight}function $4(n,e,t,r={}){return{measure:()=>W4(n,r.target,t),update:i=>{U4(n,t,i),(r.offset||r.target)&&j4(n,t,r)},notify:()=>e(t)}}const Wh=new WeakMap,RM=new WeakMap,oy=new WeakMap,CM=n=>n===document.documentElement?window:n;function fS(n,{container:e=document.documentElement,...t}={}){let r=oy.get(e);r||(r=new Set,oy.set(e,r));const i=O4(),s=$4(e,n,i,t);if(r.add(s),!Wh.has(e)){const c=()=>{for(const _ of r)_.measure()},u=()=>{for(const _ of r)_.update(hr.timestamp)},h=()=>{for(const _ of r)_.notify()},f=()=>{sn.read(c,!1,!0),sn.read(u,!1,!0),sn.update(h,!1,!0)};Wh.set(e,f);const m=CM(e);window.addEventListener("resize",f,{passive:!0}),e!==document.documentElement&&RM.set(e,L4(e,f)),m.addEventListener("scroll",f,{passive:!0})}const a=Wh.get(e);return sn.read(a,!1,!0),()=>{var c;ms(a);const u=oy.get(e);if(!u||(u.delete(s),u.size))return;const h=Wh.get(e);Wh.delete(e),h&&(CM(e).removeEventListener("scroll",h),(c=RM.get(e))===null||c===void 0||c(),window.removeEventListener("resize",h))}}function q4({source:n,container:e,axis:t="y"}){n&&(e=n);const r={value:0},i=fS(s=>{r.value=s[t].progress*100},{container:e,axis:t});return{currentTime:r,cancel:i}}const ay=new Map;function mI({source:n,container:e=document.documentElement,axis:t="y"}={}){n&&(e=n),ay.has(e)||ay.set(e,{});const r=ay.get(e);return r[t]||(r[t]=sP()?new ScrollTimeline({source:e,axis:t}):q4({source:e,axis:t})),r[t]}function X4(n){return n.length===2}function gI(n){return n&&(n.target||n.offset)}function K4(n,e){return X4(n)||gI(e)?fS(t=>{n(t[e.axis].progress,t)},e):pI(n,mI(e))}function Y4(n,e){if(n.flatten(),gI(e))return n.pause(),fS(t=>{n.time=n.duration*t[e.axis].progress},e);{const t=mI(e);return n.attachTimeline?n.attachTimeline(t,r=>(r.pause(),pI(i=>{r.time=r.duration*i},t))):Yr}}function Z4(n,{axis:e="y",...t}={}){const r={axis:e,...t};return typeof n=="function"?K4(n,r):Y4(n,r)}function PM(n,e){aU(!!(!e||e.current))}const Q4=()=>({scrollX:zs(0),scrollY:zs(0),scrollXProgress:zs(0),scrollYProgress:zs(0)});function J4({container:n,target:e,layoutEffect:t=!0,...r}={}){const i=Zu(Q4);return(t?Rg:X.useEffect)(()=>(PM("target",e),PM("container",n),Z4((a,{x:c,y:u})=>{i.scrollX.set(c.current),i.scrollXProgress.set(c.progress),i.scrollY.set(u.current),i.scrollYProgress.set(u.progress)},{...r,container:n?.current||void 0,target:e?.current||void 0})),[n,e,JSON.stringify(r.offset)]),i}function ez(n){const e=Zu(()=>zs(n)),{isStatic:t}=X.useContext(bg);if(t){const[,r]=X.useState(n);X.useEffect(()=>e.on("change",r),[])}return e}function _I(n,e){const t=ez(e()),r=()=>t.set(e());return r(),Rg(()=>{const i=()=>sn.preRender(r,!1,!0),s=n.map(a=>a.on("change",i));return()=>{s.forEach(a=>a()),ms(r)}}),t}const tz=n=>n&&typeof n=="object"&&n.mix,nz=n=>tz(n)?n.mix:void 0;function rz(...n){const e=!Array.isArray(n[0]),t=e?0:-1,r=n[0+t],i=n[1+t],s=n[2+t],a=n[3+t],c=uS(i,s,{mixer:nz(s[0]),...a});return e?c(r):c}function iz(n){gd.current=[],n();const e=_I(gd.current,n);return gd.current=void 0,e}function ly(n,e,t,r){if(typeof n=="function")return iz(n);const i=typeof e=="function"?e:rz(e,t,r);return Array.isArray(n)?IM(n,i):IM([n],([s])=>i(s))}function IM(n,e){const t=Zu(()=>[]);return _I(n,()=>{t.length=0;const r=n.length;for(let i=0;i<r;i++)t[i]=n[i].get();return e(t)})}const sz=()=>{};var DM={};const vI=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},oz=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],c=n[t++],u=((i&7)<<18|(s&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},yI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,c=a?n[i+1]:0,u=i+2<n.length,h=u?n[i+2]:0,f=s>>2,m=(s&3)<<4|c>>4;let _=(c&15)<<2|h>>6,v=h&63;u||(v=64,a||(_=64)),r.push(t[f],t[m],t[_],t[v])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(vI(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):oz(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;const h=i<n.length?t[n.charAt(i)]:64;++i;const m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||h==null||m==null)throw new az;const _=s<<2|c>>4;if(r.push(_),h!==64){const v=c<<4&240|h>>2;if(r.push(v),m!==64){const T=h<<6&192|m;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class az extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const lz=function(n){const e=vI(n);return yI.encodeByteArray(e,!0)},Hm=function(n){return lz(n).replace(/\./g,"")},EI=function(n){try{return yI.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function cz(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const uz=()=>cz().__FIREBASE_DEFAULTS__,hz=()=>{if(typeof process>"u"||typeof DM>"u")return;const n=DM.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},dz=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&EI(n[1]);return e&&JSON.parse(e)},Ng=()=>{try{return sz()||uz()||hz()||dz()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},SI=n=>Ng()?.emulatorHosts?.[n],TI=n=>{const e=SI(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},xI=()=>Ng()?.config,wI=n=>Ng()?.[`_${n}`];class fz{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function el(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function pS(n){return(await fetch(n,{credentials:"include"})).ok}function AI(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Hm(JSON.stringify(t)),Hm(JSON.stringify(a)),""].join(".")}const Td={};function pz(){const n={prod:[],emulator:[]};for(const e of Object.keys(Td))Td[e]?n.emulator.push(e):n.prod.push(e);return n}function mz(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let LM=!1;function mS(n,e){if(typeof window>"u"||typeof document>"u"||!el(window.location.host)||Td[n]===e||Td[n]||LM)return;Td[n]=e;function t(_){return`__firebase__banner__${_}`}const r="__firebase__banner",s=pz().prod.length>0;function a(){const _=document.getElementById(r);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function u(_,v){_.setAttribute("width","24"),_.setAttribute("id",v),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{LM=!0,a()},_}function f(_,v){_.setAttribute("id",v),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function m(){const _=mz(r),v=t("text"),T=document.getElementById(v)||document.createElement("span"),A=t("learnmore"),E=document.getElementById(A)||document.createElement("a"),S=t("preprendIcon"),D=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const b=_.element;c(b),f(E,A);const k=h();u(D,S),b.append(D,T,E,k),document.body.appendChild(b)}s?(T.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Br(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gz(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Br())}function _z(){const n=Ng()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function vz(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function yz(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Ez(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Sz(){const n=Br();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Tz(){return!_z()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xz(){try{return typeof indexedDB=="object"}catch{return!1}}function wz(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const Az="FirebaseError";class no extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Az,Object.setPrototypeOf(this,no.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nf.prototype.create)}}class nf{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?Mz(s,r):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new no(i,c,r)}}function Mz(n,e){return n.replace(bz,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const bz=/\{\$([^}]+)}/g;function Rz(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Fo(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(NM(s)&&NM(a)){if(!Fo(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function NM(n){return n!==null&&typeof n=="object"}function rf(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function cd(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function ud(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Cz(n,e){const t=new Pz(n,e);return t.subscribe.bind(t)}class Pz{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Iz(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=cy),i.error===void 0&&(i.error=cy),i.complete===void 0&&(i.complete=cy);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Iz(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function cy(){}function dn(n){return n&&n._delegate?n._delegate:n}class Wa{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Dl="[DEFAULT]";class Dz{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new fz;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Nz(e))try{this.getOrInitializeService({instanceIdentifier:Dl})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Dl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Dl){return this.instances.has(e)}getOptions(e=Dl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(s);r===c&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Lz(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Dl){return this.component?this.component.multipleInstances?e:Dl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Lz(n){return n===Dl?void 0:n}function Nz(n){return n.instantiationMode==="EAGER"}class Oz{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Dz(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Wt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Wt||(Wt={}));const kz={debug:Wt.DEBUG,verbose:Wt.VERBOSE,info:Wt.INFO,warn:Wt.WARN,error:Wt.ERROR,silent:Wt.SILENT},Uz=Wt.INFO,Fz={[Wt.DEBUG]:"log",[Wt.VERBOSE]:"log",[Wt.INFO]:"info",[Wt.WARN]:"warn",[Wt.ERROR]:"error"},Vz=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=Fz[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class gS{constructor(e){this.name=e,this._logLevel=Uz,this._logHandler=Vz,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Wt.DEBUG,...e),this._logHandler(this,Wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Wt.VERBOSE,...e),this._logHandler(this,Wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Wt.INFO,...e),this._logHandler(this,Wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Wt.WARN,...e),this._logHandler(this,Wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Wt.ERROR,...e),this._logHandler(this,Wt.ERROR,...e)}}const zz=(n,e)=>e.some(t=>n instanceof t);let OM,kM;function Bz(){return OM||(OM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Hz(){return kM||(kM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const MI=new WeakMap,k0=new WeakMap,bI=new WeakMap,uy=new WeakMap,_S=new WeakMap;function Gz(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(ko(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&MI.set(t,n)}).catch(()=>{}),_S.set(e,n),e}function jz(n){if(k0.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});k0.set(n,e)}let U0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return k0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||bI.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ko(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Wz(n){U0=n(U0)}function $z(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(hy(this),e,...t);return bI.set(r,e.sort?e.sort():[e]),ko(r)}:Hz().includes(n)?function(...e){return n.apply(hy(this),e),ko(MI.get(this))}:function(...e){return ko(n.apply(hy(this),e))}}function qz(n){return typeof n=="function"?$z(n):(n instanceof IDBTransaction&&jz(n),zz(n,Bz())?new Proxy(n,U0):n)}function ko(n){if(n instanceof IDBRequest)return Gz(n);if(uy.has(n))return uy.get(n);const e=qz(n);return e!==n&&(uy.set(n,e),_S.set(e,n)),e}const hy=n=>_S.get(n);function Xz(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),c=ko(a);return r&&a.addEventListener("upgradeneeded",u=>{r(ko(a.result),u.oldVersion,u.newVersion,ko(a.transaction),u)}),t&&a.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}function Ane(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),ko(t).then(()=>{})}const Kz=["get","getKey","getAll","getAllKeys","count"],Yz=["put","add","delete","clear"],dy=new Map;function UM(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(dy.get(e))return dy.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=Yz.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Kz.includes(t)))return;const s=async function(a,...c){const u=this.transaction(a,i?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),i&&u.done]))[0]};return dy.set(e,s),s}Wz(n=>({...n,get:(e,t,r)=>UM(e,t)||n.get(e,t,r),has:(e,t)=>!!UM(e,t)||n.has(e,t)}));class Zz{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Qz(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Qz(n){return n.getComponent()?.type==="VERSION"}const F0="@firebase/app",FM="0.14.6";const Vo=new gS("@firebase/app"),Jz="@firebase/app-compat",eB="@firebase/analytics-compat",tB="@firebase/analytics",nB="@firebase/app-check-compat",rB="@firebase/app-check",iB="@firebase/auth",sB="@firebase/auth-compat",oB="@firebase/database",aB="@firebase/data-connect",lB="@firebase/database-compat",cB="@firebase/functions",uB="@firebase/functions-compat",hB="@firebase/installations",dB="@firebase/installations-compat",fB="@firebase/messaging",pB="@firebase/messaging-compat",mB="@firebase/performance",gB="@firebase/performance-compat",_B="@firebase/remote-config",vB="@firebase/remote-config-compat",yB="@firebase/storage",EB="@firebase/storage-compat",SB="@firebase/firestore",TB="@firebase/ai",xB="@firebase/firestore-compat",wB="firebase",AB="12.6.0";const V0="[DEFAULT]",MB={[F0]:"fire-core",[Jz]:"fire-core-compat",[tB]:"fire-analytics",[eB]:"fire-analytics-compat",[rB]:"fire-app-check",[nB]:"fire-app-check-compat",[iB]:"fire-auth",[sB]:"fire-auth-compat",[oB]:"fire-rtdb",[aB]:"fire-data-connect",[lB]:"fire-rtdb-compat",[cB]:"fire-fn",[uB]:"fire-fn-compat",[hB]:"fire-iid",[dB]:"fire-iid-compat",[fB]:"fire-fcm",[pB]:"fire-fcm-compat",[mB]:"fire-perf",[gB]:"fire-perf-compat",[_B]:"fire-rc",[vB]:"fire-rc-compat",[yB]:"fire-gcs",[EB]:"fire-gcs-compat",[SB]:"fire-fst",[xB]:"fire-fst-compat",[TB]:"fire-vertex","fire-js":"fire-js",[wB]:"fire-js-all"};const kd=new Map,bB=new Map,z0=new Map;function VM(n,e){try{n.container.addComponent(e)}catch(t){Vo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Xl(n){const e=n.name;if(z0.has(e))return Vo.debug(`There were multiple attempts to register component ${e}.`),!1;z0.set(e,n);for(const t of kd.values())VM(t,n);for(const t of bB.values())VM(t,n);return!0}function Og(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ci(n){return n==null?!1:n.settings!==void 0}const RB={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ka=new nf("app","Firebase",RB);class CB{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Wa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ka.create("app-deleted",{appName:this._name})}}const ac=AB;function RI(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:V0,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw ka.create("bad-app-name",{appName:String(i)});if(t||(t=xI()),!t)throw ka.create("no-options");const s=kd.get(i);if(s){if(Fo(t,s.options)&&Fo(r,s.config))return s;throw ka.create("duplicate-app",{appName:i})}const a=new Oz(i);for(const u of z0.values())a.addComponent(u);const c=new CB(t,r,a);return kd.set(i,c),c}function vS(n=V0){const e=kd.get(n);if(!e&&n===V0&&xI())return RI();if(!e)throw ka.create("no-app",{appName:n});return e}function zM(){return Array.from(kd.values())}function Ws(n,e,t){let r=MB[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vo.warn(a.join(" "));return}Xl(new Wa(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const PB="firebase-heartbeat-database",IB=1,Ud="firebase-heartbeat-store";let fy=null;function CI(){return fy||(fy=Xz(PB,IB,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ud)}catch(t){console.warn(t)}}}}).catch(n=>{throw ka.create("idb-open",{originalErrorMessage:n.message})})),fy}async function DB(n){try{const t=(await CI()).transaction(Ud),r=await t.objectStore(Ud).get(PI(n));return await t.done,r}catch(e){if(e instanceof no)Vo.warn(e.message);else{const t=ka.create("idb-get",{originalErrorMessage:e?.message});Vo.warn(t.message)}}}async function BM(n,e){try{const r=(await CI()).transaction(Ud,"readwrite");await r.objectStore(Ud).put(e,PI(n)),await r.done}catch(t){if(t instanceof no)Vo.warn(t.message);else{const r=ka.create("idb-set",{originalErrorMessage:t?.message});Vo.warn(r.message)}}}function PI(n){return`${n.name}!${n.options.appId}`}const LB=1024,NB=30;class OB{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new UB(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=HM();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>NB){const i=FB(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Vo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=HM(),{heartbeatsToSend:t,unsentEntries:r}=kB(this._heartbeatsCache.heartbeats),i=Hm(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Vo.warn(e),""}}}function HM(){return new Date().toISOString().substring(0,10)}function kB(n,e=LB){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),GM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),GM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class UB{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xz()?wz().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await DB(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return BM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return BM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function GM(n){return Hm(JSON.stringify({version:2,heartbeats:n})).length}function FB(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function VB(n){Xl(new Wa("platform-logger",e=>new Zz(e),"PRIVATE")),Xl(new Wa("heartbeat",e=>new OB(e),"PRIVATE")),Ws(F0,FM,n),Ws(F0,FM,"esm2020"),Ws("fire-js","")}VB("");var zB="firebase",BB="12.7.0";Ws(zB,BB,"app");function II(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const HB=II,DI=new nf("auth","Firebase",II());const Gm=new gS("@firebase/auth");function GB(n,...e){Gm.logLevel<=Wt.WARN&&Gm.warn(`Auth (${ac}): ${n}`,...e)}function Em(n,...e){Gm.logLevel<=Wt.ERROR&&Gm.error(`Auth (${ac}): ${n}`,...e)}function gs(n,...e){throw yS(n,...e)}function $s(n,...e){return yS(n,...e)}function LI(n,e,t){const r={...HB(),[e]:t};return new nf("auth","Firebase",r).create(e,{appName:n.name})}function qs(n){return LI(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yS(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return DI.create(n,...e)}function Et(n,e,...t){if(!n)throw yS(e,...t)}function Io(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Em(e),new Error(e)}function zo(n,e){n||Io(e)}function B0(){return typeof self<"u"&&self.location?.href||""}function jB(){return jM()==="http:"||jM()==="https:"}function jM(){return typeof self<"u"&&self.location?.protocol||null}function WB(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(jB()||yz()||"connection"in navigator)?navigator.onLine:!0}function $B(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class sf{constructor(e,t){this.shortDelay=e,this.longDelay=t,zo(t>e,"Short delay should be less than long delay!"),this.isMobile=gz()||Ez()}get(){return WB()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ES(n,e){zo(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class NI{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Io("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Io("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Io("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const qB={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const XB=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],KB=new sf(3e4,6e4);function tl(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ro(n,e,t,r,i={}){return OI(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const c=rf({key:n.config.apiKey,...a}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:u,...s};return vz()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&el(n.emulatorConfig.host)&&(h.credentials="include"),NI.fetch()(await kI(n,n.config.apiHost,t,c),h)})}async function OI(n,e,t){n._canInitEmulator=!1;const r={...qB,...e};try{const i=new ZB(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Mp(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const c=s.ok?a.errorMessage:a.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Mp(n,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Mp(n,"email-already-in-use",a);if(u==="USER_DISABLED")throw Mp(n,"user-disabled",a);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw LI(n,f,h);gs(n,f)}}catch(i){if(i instanceof no)throw i;gs(n,"network-request-failed",{message:String(i)})}}async function of(n,e,t,r,i={}){const s=await ro(n,e,t,r,i);return"mfaPendingCredential"in s&&gs(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function kI(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?ES(n.config,i):`${n.config.apiScheme}://${i}`;return XB.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}function YB(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ZB{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r($s(this.auth,"network-request-failed")),KB.get())})}}function Mp(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=$s(n,e,r);return i.customData._tokenResponse=t,i}function WM(n){return n!==void 0&&n.enterprise!==void 0}class QB{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return YB(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function JB(n,e){return ro(n,"GET","/v2/recaptchaConfig",tl(n,e))}async function e5(n,e){return ro(n,"POST","/v1/accounts:delete",e)}async function jm(n,e){return ro(n,"POST","/v1/accounts:lookup",e)}function xd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function t5(n,e=!1){const t=dn(n),r=await t.getIdToken(e),i=SS(r);Et(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:xd(py(i.auth_time)),issuedAtTime:xd(py(i.iat)),expirationTime:xd(py(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function py(n){return Number(n)*1e3}function SS(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Em("JWT malformed, contained fewer than 3 sections"),null;try{const i=EI(t);return i?JSON.parse(i):(Em("Failed to decode base64 JWT payload"),null)}catch(i){return Em("Caught error parsing JWT payload as JSON",i?.toString()),null}}function $M(n){const e=SS(n);return Et(e,"internal-error"),Et(typeof e.exp<"u","internal-error"),Et(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Kl(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof no&&n5(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function n5({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class r5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class H0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=xd(this.lastLoginAt),this.creationTime=xd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Wm(n){const e=n.auth,t=await n.getIdToken(),r=await Kl(n,jm(e,{idToken:t}));Et(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?UI(i.providerUserInfo):[],a=s5(n.providerData,s),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!a?.length,h=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new H0(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function i5(n){const e=dn(n);await Wm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function s5(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function UI(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function o5(n,e){const t=await OI(n,{},async()=>{const r=rf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await kI(n,i,"/v1/token",`key=${s}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return n.emulatorConfig&&el(n.emulatorConfig.host)&&(u.credentials="include"),NI.fetch()(a,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function a5(n,e){return ro(n,"POST","/v2/accounts:revokeToken",tl(n,e))}class Ru{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Et(e.idToken,"internal-error"),Et(typeof e.idToken<"u","internal-error"),Et(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$M(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Et(e.length!==0,"internal-error");const t=$M(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Et(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await o5(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new Ru;return r&&(Et(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Et(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Et(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ru,this.toJSON())}_performRefresh(){return Io("not implemented")}}function ga(n,e){Et(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class fs{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new r5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new H0(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Kl(this,this.stsTokenManager.getToken(this.auth,e));return Et(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return t5(this,e)}reload(){return i5(this)}_assign(e){this!==e&&(Et(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new fs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Et(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Wm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ci(this.auth.app))return Promise.reject(qs(this.auth));const e=await this.getIdToken();return await Kl(this,e5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:m,emailVerified:_,isAnonymous:v,providerData:T,stsTokenManager:A}=t;Et(m&&A,e,"internal-error");const E=Ru.fromJSON(this.name,A);Et(typeof m=="string",e,"internal-error"),ga(r,e.name),ga(i,e.name),Et(typeof _=="boolean",e,"internal-error"),Et(typeof v=="boolean",e,"internal-error"),ga(s,e.name),ga(a,e.name),ga(c,e.name),ga(u,e.name),ga(h,e.name),ga(f,e.name);const S=new fs({uid:m,auth:e,email:i,emailVerified:_,displayName:r,isAnonymous:v,photoURL:a,phoneNumber:s,tenantId:c,stsTokenManager:E,createdAt:h,lastLoginAt:f});return T&&Array.isArray(T)&&(S.providerData=T.map(D=>({...D}))),u&&(S._redirectEventId=u),S}static async _fromIdTokenResponse(e,t,r=!1){const i=new Ru;i.updateFromServerResponse(t);const s=new fs({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Wm(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Et(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?UI(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,c=new Ru;c.updateFromIdToken(r);const u=new fs({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new H0(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const qM=new Map;function Do(n){zo(n instanceof Function,"Expected a class definition");let e=qM.get(n);return e?(zo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,qM.set(n,e),e)}class FI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}FI.type="NONE";const XM=FI;function Sm(n,e,t){return`firebase:${n}:${e}:${t}`}class Cu{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Sm(this.userKey,i.apiKey,s),this.fullPersistenceKey=Sm("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await jm(this.auth,{idToken:e}).catch(()=>{});return t?fs._fromGetAccountInfoResponse(this.auth,t,e):null}return fs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Cu(Do(XM),e,r);const i=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=i[0]||Do(XM);const a=Sm(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const f=await h._get(a);if(f){let m;if(typeof f=="string"){const _=await jm(e,{idToken:f}).catch(()=>{});if(!_)break;m=await fs._fromGetAccountInfoResponse(e,_,f)}else m=fs._fromJSON(e,f);h!==s&&(c=m),s=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Cu(s,e,r):(s=u[0],c&&await s._set(a,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(a)}catch{}})),new Cu(s,e,r))}}function KM(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(HI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(VI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(jI(e))return"Blackberry";if(WI(e))return"Webos";if(zI(e))return"Safari";if((e.includes("chrome/")||BI(e))&&!e.includes("edge/"))return"Chrome";if(GI(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function VI(n=Br()){return/firefox\//i.test(n)}function zI(n=Br()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function BI(n=Br()){return/crios\//i.test(n)}function HI(n=Br()){return/iemobile/i.test(n)}function GI(n=Br()){return/android/i.test(n)}function jI(n=Br()){return/blackberry/i.test(n)}function WI(n=Br()){return/webos/i.test(n)}function TS(n=Br()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function l5(n=Br()){return TS(n)&&!!window.navigator?.standalone}function c5(){return Sz()&&document.documentMode===10}function $I(n=Br()){return TS(n)||GI(n)||WI(n)||jI(n)||/windows phone/i.test(n)||HI(n)}function qI(n,e=[]){let t;switch(n){case"Browser":t=KM(Br());break;case"Worker":t=`${KM(Br())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ac}/${r}`}class u5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,c)=>{try{const u=e(s);a(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function h5(n,e={}){return ro(n,"GET","/v2/passwordPolicy",tl(n,e))}const d5=6;class f5{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??d5,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class p5{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new YM(this),this.idTokenSubscription=new YM(this),this.beforeStateQueue=new u5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=DI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Do(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Cu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await jm(this,{idToken:e}),r=await fs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ci(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,a=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!s||s===a)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Et(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Wm(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$B()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ci(this.app))return Promise.reject(qs(this));const t=e?dn(e):null;return t&&Et(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Et(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ci(this.app)?Promise.reject(qs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ci(this.app)?Promise.reject(qs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Do(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await h5(this),t=new f5(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new nf("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await a5(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Do(e)||this._popupRedirectResolver;Et(t,this,"argument-error"),this.redirectPersistenceManager=await Cu.create(this,[Do(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Et(c,this,"internal-error"),c.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,r,i);return()=>{a=!0,u()}}else{const u=e.addObserver(t);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Et(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ci(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&GB(`Error while retrieving App Check token: ${e.error}`),e?.token}}function lc(n){return dn(n)}class YM{constructor(e){this.auth=e,this.observer=null,this.addObserver=Cz(t=>this.observer=t)}get next(){return Et(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let kg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function m5(n){kg=n}function XI(n){return kg.loadJS(n)}function g5(){return kg.recaptchaEnterpriseScript}function _5(){return kg.gapiScript}function v5(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class y5{constructor(){this.enterprise=new E5}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class E5{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const S5="recaptcha-enterprise",KI="NO_RECAPTCHA";class T5{constructor(e){this.type=S5,this.auth=lc(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,c)=>{JB(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const h=new QB(u);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,a(h.siteKey)}}).catch(u=>{c(u)})})}function i(s,a,c){const u=window.grecaptcha;WM(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(h=>{a(h)}).catch(()=>{a(KI)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new y5().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{r(this.auth).then(c=>{if(!t&&WM(window.grecaptcha))i(c,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=g5();u.length!==0&&(u+=c),XI(u).then(()=>{i(c,s,a)}).catch(h=>{a(h)})}}).catch(c=>{a(c)})})}}async function ZM(n,e,t,r=!1,i=!1){const s=new T5(n);let a;if(i)a=KI;else try{a=await s.verify(t)}catch{a=await s.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:a}):Object.assign(c,{captchaResponse:a}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function G0(n,e,t,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await ZM(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await ZM(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)})}function x5(n,e){const t=Og(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(Fo(s,e??{}))return i;gs(i,"already-initialized")}return t.initialize({options:e})}function w5(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Do);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function A5(n,e,t){const r=lc(n);Et(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=YI(e),{host:a,port:c}=M5(e),u=c===null?"":`:${c}`,h={url:`${s}//${a}${u}/`},f=Object.freeze({host:a,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Et(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Et(Fo(h,r.config.emulator)&&Fo(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,el(a)?(pS(`${s}//${a}${u}`),mS("Auth",!0)):b5()}function YI(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function M5(n){const e=YI(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:QM(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:QM(a)}}}function QM(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function b5(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class xS{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Io("not implemented")}_getIdTokenResponse(e){return Io("not implemented")}_linkToIdToken(e,t){return Io("not implemented")}_getReauthenticationResolver(e){return Io("not implemented")}}async function R5(n,e){return ro(n,"POST","/v1/accounts:update",e)}async function C5(n,e){return ro(n,"POST","/v1/accounts:signUp",e)}async function P5(n,e){return of(n,"POST","/v1/accounts:signInWithPassword",tl(n,e))}async function I5(n,e){return of(n,"POST","/v1/accounts:signInWithEmailLink",tl(n,e))}async function D5(n,e){return of(n,"POST","/v1/accounts:signInWithEmailLink",tl(n,e))}class Fd extends xS{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Fd(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Fd(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return G0(e,t,"signInWithPassword",P5);case"emailLink":return I5(e,{email:this._email,oobCode:this._password});default:gs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return G0(e,r,"signUpPassword",C5);case"emailLink":return D5(e,{idToken:t,email:this._email,oobCode:this._password});default:gs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Pu(n,e){return of(n,"POST","/v1/accounts:signInWithIdp",tl(n,e))}const L5="http://localhost";class Yl extends xS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Yl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):gs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new Yl(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Pu(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Pu(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Pu(e,t)}buildRequest(){const e={requestUri:L5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=rf(t)}return e}}function N5(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function O5(n){const e=cd(ud(n)).link,t=e?cd(ud(e)).deep_link_id:null,r=cd(ud(n)).deep_link_id;return(r?cd(ud(r)).link:null)||r||t||e||n}class wS{constructor(e){const t=cd(ud(e)),r=t.apiKey??null,i=t.oobCode??null,s=N5(t.mode??null);Et(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=O5(e);try{return new wS(t)}catch{return null}}}class eh{constructor(){this.providerId=eh.PROVIDER_ID}static credential(e,t){return Fd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=wS.parseLink(t);return Et(r,"argument-error"),Fd._fromEmailAndCode(e,r.code,r.tenantId)}}eh.PROVIDER_ID="password";eh.EMAIL_PASSWORD_SIGN_IN_METHOD="password";eh.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ZI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class af extends ZI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Aa extends af{constructor(){super("facebook.com")}static credential(e){return Yl._fromParams({providerId:Aa.PROVIDER_ID,signInMethod:Aa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Aa.credentialFromTaggedObject(e)}static credentialFromError(e){return Aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Aa.credential(e.oauthAccessToken)}catch{return null}}}Aa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Aa.PROVIDER_ID="facebook.com";class Ma extends af{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Yl._fromParams({providerId:Ma.PROVIDER_ID,signInMethod:Ma.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ma.credentialFromTaggedObject(e)}static credentialFromError(e){return Ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ma.credential(t,r)}catch{return null}}}Ma.GOOGLE_SIGN_IN_METHOD="google.com";Ma.PROVIDER_ID="google.com";class ba extends af{constructor(){super("github.com")}static credential(e){return Yl._fromParams({providerId:ba.PROVIDER_ID,signInMethod:ba.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ba.credentialFromTaggedObject(e)}static credentialFromError(e){return ba.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ba.credential(e.oauthAccessToken)}catch{return null}}}ba.GITHUB_SIGN_IN_METHOD="github.com";ba.PROVIDER_ID="github.com";class Ra extends af{constructor(){super("twitter.com")}static credential(e,t){return Yl._fromParams({providerId:Ra.PROVIDER_ID,signInMethod:Ra.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ra.credentialFromTaggedObject(e)}static credentialFromError(e){return Ra.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ra.credential(t,r)}catch{return null}}}Ra.TWITTER_SIGN_IN_METHOD="twitter.com";Ra.PROVIDER_ID="twitter.com";async function k5(n,e){return of(n,"POST","/v1/accounts:signUp",tl(n,e))}class Zl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await fs._fromIdTokenResponse(e,r,i),a=JM(r);return new Zl({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=JM(r);return new Zl({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function JM(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class $m extends no{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,$m.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new $m(e,t,r,i)}}function QI(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?$m._fromErrorAndOperation(n,s,e,r):s})}async function U5(n,e,t=!1){const r=await Kl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Zl._forOperation(n,"link",r)}async function F5(n,e,t=!1){const{auth:r}=n;if(ci(r.app))return Promise.reject(qs(r));const i="reauthenticate";try{const s=await Kl(n,QI(r,i,e,n),t);Et(s.idToken,r,"internal-error");const a=SS(s.idToken);Et(a,r,"internal-error");const{sub:c}=a;return Et(n.uid===c,r,"user-mismatch"),Zl._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&gs(r,"user-mismatch"),s}}async function JI(n,e,t=!1){if(ci(n.app))return Promise.reject(qs(n));const r="signIn",i=await QI(n,r,e),s=await Zl._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function V5(n,e){return JI(lc(n),e)}async function eD(n){const e=lc(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function z5(n,e,t){if(ci(n.app))return Promise.reject(qs(n));const r=lc(n),a=await G0(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",k5).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&eD(n),u}),c=await Zl._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(c.user),c}function B5(n,e,t){return ci(n.app)?Promise.reject(qs(n)):V5(dn(n),eh.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&eD(n),r})}async function H5(n,e){return ro(n,"POST","/v1/accounts:update",e)}async function G5(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=dn(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},a=await Kl(r,H5(r.auth,s));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const c=r.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function j5(n,e){const t=dn(n);return ci(t.auth.app)?Promise.reject(qs(t.auth)):tD(t,e,null)}function W5(n,e){return tD(dn(n),null,e)}async function tD(n,e,t){const{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);const a=await Kl(n,R5(r,s));await n._updateTokensIfNecessary(a,!0)}function $5(n,e,t,r){return dn(n).onIdTokenChanged(e,t,r)}function q5(n,e,t){return dn(n).beforeAuthStateChanged(e,t)}function X5(n,e,t,r){return dn(n).onAuthStateChanged(e,t,r)}function K5(n){return dn(n).signOut()}async function Mne(n){return dn(n).delete()}const qm="__sak";class nD{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(qm,"1"),this.storage.removeItem(qm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Y5=1e3,Z5=10;class rD extends nD{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=$I(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);c5()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Z5):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Y5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}rD.type="LOCAL";const Q5=rD;class iD extends nD{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}iD.type="SESSION";const sD=iD;function J5(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Ug{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Ug(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(a).map(async h=>h(t.origin,s)),u=await J5(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ug.receivers=[];function AS(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class e6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((c,u)=>{const h=AS("",20);i.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(m){const _=m;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(_.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Xs(){return window}function t6(n){Xs().location.href=n}function oD(){return typeof Xs().WorkerGlobalScope<"u"&&typeof Xs().importScripts=="function"}async function n6(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function r6(){return navigator?.serviceWorker?.controller||null}function i6(){return oD()?self:null}const aD="firebaseLocalStorageDb",s6=1,Xm="firebaseLocalStorage",lD="fbase_key";class lf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Fg(n,e){return n.transaction([Xm],e?"readwrite":"readonly").objectStore(Xm)}function o6(){const n=indexedDB.deleteDatabase(aD);return new lf(n).toPromise()}function j0(){const n=indexedDB.open(aD,s6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Xm,{keyPath:lD})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Xm)?e(r):(r.close(),await o6(),e(await j0()))})})}async function eb(n,e,t){const r=Fg(n,!0).put({[lD]:e,value:t});return new lf(r).toPromise()}async function a6(n,e){const t=Fg(n,!1).get(e),r=await new lf(t).toPromise();return r===void 0?null:r.value}function tb(n,e){const t=Fg(n,!0).delete(e);return new lf(t).toPromise()}const l6=800,c6=3;class cD{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await j0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>c6)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return oD()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ug._getInstance(i6()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await n6(),!this.activeServiceWorker)return;this.sender=new e6(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||r6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await j0();return await eb(e,qm,"1"),await tb(e,qm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>eb(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>a6(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>tb(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Fg(i,!1).getAll();return new lf(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),l6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}cD.type="LOCAL";const u6=cD;new sf(3e4,6e4);function h6(n,e){return e?Do(e):(Et(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class MS extends xS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Pu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Pu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Pu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function d6(n){return JI(n.auth,new MS(n),n.bypassAuthState)}function f6(n){const{auth:e,user:t}=n;return Et(t,e,"internal-error"),F5(t,new MS(n),n.bypassAuthState)}async function p6(n){const{auth:e,user:t}=n;return Et(t,e,"internal-error"),U5(t,new MS(n),n.bypassAuthState)}class uD{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return d6;case"linkViaPopup":case"linkViaRedirect":return p6;case"reauthViaPopup":case"reauthViaRedirect":return f6;default:gs(this.auth,"internal-error")}}resolve(e){zo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const m6=new sf(2e3,1e4);class xu extends uD{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,xu.currentPopupAction&&xu.currentPopupAction.cancel(),xu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Et(e,this.auth,"internal-error"),e}async onExecution(){zo(this.filter.length===1,"Popup operations only handle one event");const e=AS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject($s(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject($s(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject($s(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,m6.get())};e()}}xu.currentPopupAction=null;const g6="pendingRedirect",Tm=new Map;class _6 extends uD{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Tm.get(this.auth._key());if(!e){try{const r=await v6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Tm.set(this.auth._key(),e)}return this.bypassAuthState||Tm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function v6(n,e){const t=S6(e),r=E6(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function y6(n,e){Tm.set(n._key(),e)}function E6(n){return Do(n._redirectPersistence)}function S6(n){return Sm(g6,n.config.apiKey,n.name)}async function T6(n,e,t=!1){if(ci(n.app))return Promise.reject(qs(n));const r=lc(n),i=h6(r,e),a=await new _6(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const x6=600*1e3;class w6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!A6(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!hD(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError($s(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=x6&&this.cachedEventUids.clear(),this.cachedEventUids.has(nb(e))}saveEventToCache(e){this.cachedEventUids.add(nb(e)),this.lastProcessedEventTime=Date.now()}}function nb(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function hD({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function A6(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hD(n);default:return!1}}async function M6(n,e={}){return ro(n,"GET","/v1/projects",e)}const b6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,R6=/^https?/;async function C6(n){if(n.config.emulator)return;const{authorizedDomains:e}=await M6(n);for(const t of e)try{if(P6(t))return}catch{}gs(n,"unauthorized-domain")}function P6(n){const e=B0(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!R6.test(t))return!1;if(b6.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const I6=new sf(3e4,6e4);function rb(){const n=Xs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function D6(n){return new Promise((e,t)=>{function r(){rb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rb(),t($s(n,"network-request-failed"))},timeout:I6.get()})}if(Xs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Xs().gapi?.load)r();else{const i=v5("iframefcb");return Xs()[i]=()=>{gapi.load?r():t($s(n,"network-request-failed"))},XI(`${_5()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw xm=null,e})}let xm=null;function L6(n){return xm=xm||D6(n),xm}const N6=new sf(5e3,15e3),O6="__/auth/iframe",k6="emulator/auth/iframe",U6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},F6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function V6(n){const e=n.config;Et(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ES(e,k6):`https://${n.config.authDomain}/${O6}`,r={apiKey:e.apiKey,appName:n.name,v:ac},i=F6.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${rf(r).slice(1)}`}async function z6(n){const e=await L6(n),t=Xs().gapi;return Et(t,n,"internal-error"),e.open({where:document.body,url:V6(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:U6,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=$s(n,"network-request-failed"),c=Xs().setTimeout(()=>{s(a)},N6.get());function u(){Xs().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{s(a)})}))}const B6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},H6=500,G6=600,j6="_blank",W6="http://localhost";class ib{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $6(n,e,t,r=H6,i=G6){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...B6,width:r.toString(),height:i.toString(),top:s,left:a},h=Br().toLowerCase();t&&(c=BI(h)?j6:t),VI(h)&&(e=e||W6,u.scrollbars="yes");const f=Object.entries(u).reduce((_,[v,T])=>`${_}${v}=${T},`,"");if(l5(h)&&c!=="_self")return q6(e||"",c),new ib(null);const m=window.open(e||"",c,f);Et(m,n,"popup-blocked");try{m.focus()}catch{}return new ib(m)}function q6(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const X6="__/auth/handler",K6="emulator/auth/handler",Y6=encodeURIComponent("fac");async function sb(n,e,t,r,i,s){Et(n.config.authDomain,n,"auth-domain-config-required"),Et(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:ac,eventId:i};if(e instanceof ZI){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Rz(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))a[f]=m}if(e instanceof af){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(a.scopes=f.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await n._getAppCheckToken(),h=u?`#${Y6}=${encodeURIComponent(u)}`:"";return`${Z6(n)}?${rf(c).slice(1)}${h}`}function Z6({config:n}){return n.emulator?ES(n,K6):`https://${n.authDomain}/${X6}`}const my="webStorageSupport";class Q6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=sD,this._completeRedirectFn=T6,this._overrideRedirectResult=y6}async _openPopup(e,t,r,i){zo(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await sb(e,t,r,B0(),i);return $6(e,s,AS())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await sb(e,t,r,B0(),i);return t6(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(zo(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await z6(e),r=new w6(e);return t.register("authEvent",i=>(Et(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(my,{type:my},i=>{const s=i?.[0]?.[my];s!==void 0&&t(!!s),gs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=C6(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return $I()||zI()||TS()}}const J6=Q6;var ob="@firebase/auth",ab="1.12.0";class eH{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Et(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function tH(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function nH(n){Xl(new Wa("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;Et(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qI(n)},h=new p5(r,i,s,u);return w5(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Xl(new Wa("auth-internal",e=>{const t=lc(e.getProvider("auth").getImmediate());return(r=>new eH(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ws(ob,ab,tH(n)),Ws(ob,ab,"esm2020")}const rH=300,iH=wI("authIdTokenMaxAge")||rH;let lb=null;const sH=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>iH)return;const i=t?.token;lb!==i&&(lb=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function oH(n=vS()){const e=Og(n,"auth");if(e.isInitialized())return e.getImmediate();const t=x5(n,{popupRedirectResolver:J6,persistence:[u6,Q5,sD]}),r=wI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=sH(s.toString());q5(t,a,()=>a(t.currentUser)),$5(t,c=>a(c))}}const i=SI("auth");return i&&A5(t,`http://${i}`),t}function aH(){return document.getElementsByTagName("head")?.[0]??document}m5({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=$s("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",aH().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});nH("Browser");var cb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ua,dD;(function(){var n;function e(P,I){function M(){}M.prototype=I.prototype,P.F=I.prototype,P.prototype=new M,P.prototype.constructor=P,P.D=function(C,N,W){for(var F=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)F[Y-2]=arguments[Y];return I.prototype[N].apply(C,F)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,I,M){M||(M=0);const C=Array(16);if(typeof I=="string")for(var N=0;N<16;++N)C[N]=I.charCodeAt(M++)|I.charCodeAt(M++)<<8|I.charCodeAt(M++)<<16|I.charCodeAt(M++)<<24;else for(N=0;N<16;++N)C[N]=I[M++]|I[M++]<<8|I[M++]<<16|I[M++]<<24;I=P.g[0],M=P.g[1],N=P.g[2];let W=P.g[3],F;F=I+(W^M&(N^W))+C[0]+3614090360&4294967295,I=M+(F<<7&4294967295|F>>>25),F=W+(N^I&(M^N))+C[1]+3905402710&4294967295,W=I+(F<<12&4294967295|F>>>20),F=N+(M^W&(I^M))+C[2]+606105819&4294967295,N=W+(F<<17&4294967295|F>>>15),F=M+(I^N&(W^I))+C[3]+3250441966&4294967295,M=N+(F<<22&4294967295|F>>>10),F=I+(W^M&(N^W))+C[4]+4118548399&4294967295,I=M+(F<<7&4294967295|F>>>25),F=W+(N^I&(M^N))+C[5]+1200080426&4294967295,W=I+(F<<12&4294967295|F>>>20),F=N+(M^W&(I^M))+C[6]+2821735955&4294967295,N=W+(F<<17&4294967295|F>>>15),F=M+(I^N&(W^I))+C[7]+4249261313&4294967295,M=N+(F<<22&4294967295|F>>>10),F=I+(W^M&(N^W))+C[8]+1770035416&4294967295,I=M+(F<<7&4294967295|F>>>25),F=W+(N^I&(M^N))+C[9]+2336552879&4294967295,W=I+(F<<12&4294967295|F>>>20),F=N+(M^W&(I^M))+C[10]+4294925233&4294967295,N=W+(F<<17&4294967295|F>>>15),F=M+(I^N&(W^I))+C[11]+2304563134&4294967295,M=N+(F<<22&4294967295|F>>>10),F=I+(W^M&(N^W))+C[12]+1804603682&4294967295,I=M+(F<<7&4294967295|F>>>25),F=W+(N^I&(M^N))+C[13]+4254626195&4294967295,W=I+(F<<12&4294967295|F>>>20),F=N+(M^W&(I^M))+C[14]+2792965006&4294967295,N=W+(F<<17&4294967295|F>>>15),F=M+(I^N&(W^I))+C[15]+1236535329&4294967295,M=N+(F<<22&4294967295|F>>>10),F=I+(N^W&(M^N))+C[1]+4129170786&4294967295,I=M+(F<<5&4294967295|F>>>27),F=W+(M^N&(I^M))+C[6]+3225465664&4294967295,W=I+(F<<9&4294967295|F>>>23),F=N+(I^M&(W^I))+C[11]+643717713&4294967295,N=W+(F<<14&4294967295|F>>>18),F=M+(W^I&(N^W))+C[0]+3921069994&4294967295,M=N+(F<<20&4294967295|F>>>12),F=I+(N^W&(M^N))+C[5]+3593408605&4294967295,I=M+(F<<5&4294967295|F>>>27),F=W+(M^N&(I^M))+C[10]+38016083&4294967295,W=I+(F<<9&4294967295|F>>>23),F=N+(I^M&(W^I))+C[15]+3634488961&4294967295,N=W+(F<<14&4294967295|F>>>18),F=M+(W^I&(N^W))+C[4]+3889429448&4294967295,M=N+(F<<20&4294967295|F>>>12),F=I+(N^W&(M^N))+C[9]+568446438&4294967295,I=M+(F<<5&4294967295|F>>>27),F=W+(M^N&(I^M))+C[14]+3275163606&4294967295,W=I+(F<<9&4294967295|F>>>23),F=N+(I^M&(W^I))+C[3]+4107603335&4294967295,N=W+(F<<14&4294967295|F>>>18),F=M+(W^I&(N^W))+C[8]+1163531501&4294967295,M=N+(F<<20&4294967295|F>>>12),F=I+(N^W&(M^N))+C[13]+2850285829&4294967295,I=M+(F<<5&4294967295|F>>>27),F=W+(M^N&(I^M))+C[2]+4243563512&4294967295,W=I+(F<<9&4294967295|F>>>23),F=N+(I^M&(W^I))+C[7]+1735328473&4294967295,N=W+(F<<14&4294967295|F>>>18),F=M+(W^I&(N^W))+C[12]+2368359562&4294967295,M=N+(F<<20&4294967295|F>>>12),F=I+(M^N^W)+C[5]+4294588738&4294967295,I=M+(F<<4&4294967295|F>>>28),F=W+(I^M^N)+C[8]+2272392833&4294967295,W=I+(F<<11&4294967295|F>>>21),F=N+(W^I^M)+C[11]+1839030562&4294967295,N=W+(F<<16&4294967295|F>>>16),F=M+(N^W^I)+C[14]+4259657740&4294967295,M=N+(F<<23&4294967295|F>>>9),F=I+(M^N^W)+C[1]+2763975236&4294967295,I=M+(F<<4&4294967295|F>>>28),F=W+(I^M^N)+C[4]+1272893353&4294967295,W=I+(F<<11&4294967295|F>>>21),F=N+(W^I^M)+C[7]+4139469664&4294967295,N=W+(F<<16&4294967295|F>>>16),F=M+(N^W^I)+C[10]+3200236656&4294967295,M=N+(F<<23&4294967295|F>>>9),F=I+(M^N^W)+C[13]+681279174&4294967295,I=M+(F<<4&4294967295|F>>>28),F=W+(I^M^N)+C[0]+3936430074&4294967295,W=I+(F<<11&4294967295|F>>>21),F=N+(W^I^M)+C[3]+3572445317&4294967295,N=W+(F<<16&4294967295|F>>>16),F=M+(N^W^I)+C[6]+76029189&4294967295,M=N+(F<<23&4294967295|F>>>9),F=I+(M^N^W)+C[9]+3654602809&4294967295,I=M+(F<<4&4294967295|F>>>28),F=W+(I^M^N)+C[12]+3873151461&4294967295,W=I+(F<<11&4294967295|F>>>21),F=N+(W^I^M)+C[15]+530742520&4294967295,N=W+(F<<16&4294967295|F>>>16),F=M+(N^W^I)+C[2]+3299628645&4294967295,M=N+(F<<23&4294967295|F>>>9),F=I+(N^(M|~W))+C[0]+4096336452&4294967295,I=M+(F<<6&4294967295|F>>>26),F=W+(M^(I|~N))+C[7]+1126891415&4294967295,W=I+(F<<10&4294967295|F>>>22),F=N+(I^(W|~M))+C[14]+2878612391&4294967295,N=W+(F<<15&4294967295|F>>>17),F=M+(W^(N|~I))+C[5]+4237533241&4294967295,M=N+(F<<21&4294967295|F>>>11),F=I+(N^(M|~W))+C[12]+1700485571&4294967295,I=M+(F<<6&4294967295|F>>>26),F=W+(M^(I|~N))+C[3]+2399980690&4294967295,W=I+(F<<10&4294967295|F>>>22),F=N+(I^(W|~M))+C[10]+4293915773&4294967295,N=W+(F<<15&4294967295|F>>>17),F=M+(W^(N|~I))+C[1]+2240044497&4294967295,M=N+(F<<21&4294967295|F>>>11),F=I+(N^(M|~W))+C[8]+1873313359&4294967295,I=M+(F<<6&4294967295|F>>>26),F=W+(M^(I|~N))+C[15]+4264355552&4294967295,W=I+(F<<10&4294967295|F>>>22),F=N+(I^(W|~M))+C[6]+2734768916&4294967295,N=W+(F<<15&4294967295|F>>>17),F=M+(W^(N|~I))+C[13]+1309151649&4294967295,M=N+(F<<21&4294967295|F>>>11),F=I+(N^(M|~W))+C[4]+4149444226&4294967295,I=M+(F<<6&4294967295|F>>>26),F=W+(M^(I|~N))+C[11]+3174756917&4294967295,W=I+(F<<10&4294967295|F>>>22),F=N+(I^(W|~M))+C[2]+718787259&4294967295,N=W+(F<<15&4294967295|F>>>17),F=M+(W^(N|~I))+C[9]+3951481745&4294967295,P.g[0]=P.g[0]+I&4294967295,P.g[1]=P.g[1]+(N+(F<<21&4294967295|F>>>11))&4294967295,P.g[2]=P.g[2]+N&4294967295,P.g[3]=P.g[3]+W&4294967295}r.prototype.v=function(P,I){I===void 0&&(I=P.length);const M=I-this.blockSize,C=this.C;let N=this.h,W=0;for(;W<I;){if(N==0)for(;W<=M;)i(this,P,W),W+=this.blockSize;if(typeof P=="string"){for(;W<I;)if(C[N++]=P.charCodeAt(W++),N==this.blockSize){i(this,C),N=0;break}}else for(;W<I;)if(C[N++]=P[W++],N==this.blockSize){i(this,C),N=0;break}}this.h=N,this.o+=I},r.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var I=1;I<P.length-8;++I)P[I]=0;I=this.o*8;for(var M=P.length-8;M<P.length;++M)P[M]=I&255,I/=256;for(this.v(P),P=Array(16),I=0,M=0;M<4;++M)for(let C=0;C<32;C+=8)P[I++]=this.g[M]>>>C&255;return P};function s(P,I){var M=c;return Object.prototype.hasOwnProperty.call(M,P)?M[P]:M[P]=I(P)}function a(P,I){this.h=I;const M=[];let C=!0;for(let N=P.length-1;N>=0;N--){const W=P[N]|0;C&&W==I||(M[N]=W,C=!1)}this.g=M}var c={};function u(P){return-128<=P&&P<128?s(P,function(I){return new a([I|0],I<0?-1:0)}):new a([P|0],P<0?-1:0)}function h(P){if(isNaN(P)||!isFinite(P))return m;if(P<0)return E(h(-P));const I=[];let M=1;for(let C=0;P>=M;C++)I[C]=P/M|0,M*=4294967296;return new a(I,0)}function f(P,I){if(P.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(P.charAt(0)=="-")return E(f(P.substring(1),I));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=h(Math.pow(I,8));let C=m;for(let W=0;W<P.length;W+=8){var N=Math.min(8,P.length-W);const F=parseInt(P.substring(W,W+N),I);N<8?(N=h(Math.pow(I,N)),C=C.j(N).add(h(F))):(C=C.j(M),C=C.add(h(F)))}return C}var m=u(0),_=u(1),v=u(16777216);n=a.prototype,n.m=function(){if(A(this))return-E(this).m();let P=0,I=1;for(let M=0;M<this.g.length;M++){const C=this.i(M);P+=(C>=0?C:4294967296+C)*I,I*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(T(this))return"0";if(A(this))return"-"+E(this).toString(P);const I=h(Math.pow(P,6));var M=this;let C="";for(;;){const N=k(M,I).g;M=S(M,N.j(I));let W=((M.g.length>0?M.g[0]:M.h)>>>0).toString(P);if(M=N,T(M))return W+C;for(;W.length<6;)W="0"+W;C=W+C}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function T(P){if(P.h!=0)return!1;for(let I=0;I<P.g.length;I++)if(P.g[I]!=0)return!1;return!0}function A(P){return P.h==-1}n.l=function(P){return P=S(this,P),A(P)?-1:T(P)?0:1};function E(P){const I=P.g.length,M=[];for(let C=0;C<I;C++)M[C]=~P.g[C];return new a(M,~P.h).add(_)}n.abs=function(){return A(this)?E(this):this},n.add=function(P){const I=Math.max(this.g.length,P.g.length),M=[];let C=0;for(let N=0;N<=I;N++){let W=C+(this.i(N)&65535)+(P.i(N)&65535),F=(W>>>16)+(this.i(N)>>>16)+(P.i(N)>>>16);C=F>>>16,W&=65535,F&=65535,M[N]=F<<16|W}return new a(M,M[M.length-1]&-2147483648?-1:0)};function S(P,I){return P.add(E(I))}n.j=function(P){if(T(this)||T(P))return m;if(A(this))return A(P)?E(this).j(E(P)):E(E(this).j(P));if(A(P))return E(this.j(E(P)));if(this.l(v)<0&&P.l(v)<0)return h(this.m()*P.m());const I=this.g.length+P.g.length,M=[];for(var C=0;C<2*I;C++)M[C]=0;for(C=0;C<this.g.length;C++)for(let N=0;N<P.g.length;N++){const W=this.i(C)>>>16,F=this.i(C)&65535,Y=P.i(N)>>>16,ue=P.i(N)&65535;M[2*C+2*N]+=F*ue,D(M,2*C+2*N),M[2*C+2*N+1]+=W*ue,D(M,2*C+2*N+1),M[2*C+2*N+1]+=F*Y,D(M,2*C+2*N+1),M[2*C+2*N+2]+=W*Y,D(M,2*C+2*N+2)}for(P=0;P<I;P++)M[P]=M[2*P+1]<<16|M[2*P];for(P=I;P<2*I;P++)M[P]=0;return new a(M,0)};function D(P,I){for(;(P[I]&65535)!=P[I];)P[I+1]+=P[I]>>>16,P[I]&=65535,I++}function b(P,I){this.g=P,this.h=I}function k(P,I){if(T(I))throw Error("division by zero");if(T(P))return new b(m,m);if(A(P))return I=k(E(P),I),new b(E(I.g),E(I.h));if(A(I))return I=k(P,E(I)),new b(E(I.g),I.h);if(P.g.length>30){if(A(P)||A(I))throw Error("slowDivide_ only works with positive integers.");for(var M=_,C=I;C.l(P)<=0;)M=V(M),C=V(C);var N=H(M,1),W=H(C,1);for(C=H(C,2),M=H(M,2);!T(C);){var F=W.add(C);F.l(P)<=0&&(N=N.add(M),W=F),C=H(C,1),M=H(M,1)}return I=S(P,N.j(I)),new b(N,I)}for(N=m;P.l(I)>=0;){for(M=Math.max(1,Math.floor(P.m()/I.m())),C=Math.ceil(Math.log(M)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),W=h(M),F=W.j(I);A(F)||F.l(P)>0;)M-=C,W=h(M),F=W.j(I);T(W)&&(W=_),N=N.add(W),P=S(P,F)}return new b(N,P)}n.B=function(P){return k(this,P).h},n.and=function(P){const I=Math.max(this.g.length,P.g.length),M=[];for(let C=0;C<I;C++)M[C]=this.i(C)&P.i(C);return new a(M,this.h&P.h)},n.or=function(P){const I=Math.max(this.g.length,P.g.length),M=[];for(let C=0;C<I;C++)M[C]=this.i(C)|P.i(C);return new a(M,this.h|P.h)},n.xor=function(P){const I=Math.max(this.g.length,P.g.length),M=[];for(let C=0;C<I;C++)M[C]=this.i(C)^P.i(C);return new a(M,this.h^P.h)};function V(P){const I=P.g.length+1,M=[];for(let C=0;C<I;C++)M[C]=P.i(C)<<1|P.i(C-1)>>>31;return new a(M,P.h)}function H(P,I){const M=I>>5;I%=32;const C=P.g.length-M,N=[];for(let W=0;W<C;W++)N[W]=I>0?P.i(W+M)>>>I|P.i(W+M+1)<<32-I:P.i(W+M);return new a(N,P.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,dD=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=f,Ua=a}).apply(typeof cb<"u"?cb:typeof self<"u"?self:typeof window<"u"?window:{});var bp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var fD,hd,pD,wm,W0,mD,gD,_D;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof bp=="object"&&bp];for(var w=0;w<p.length;++w){var R=p[w];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var r=t(this);function i(p,w){if(w)e:{var R=r;p=p.split(".");for(var z=0;z<p.length-1;z++){var ce=p[z];if(!(ce in R))break e;R=R[ce]}p=p[p.length-1],z=R[p],w=w(z),w!=z&&w!=null&&e(R,p,{configurable:!0,writable:!0,value:w})}}i("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(p){return p||function(w){var R=[],z;for(z in w)Object.prototype.hasOwnProperty.call(w,z)&&R.push([z,w[z]]);return R}});var s=s||{},a=this||self;function c(p){var w=typeof p;return w=="object"&&p!=null||w=="function"}function u(p,w,R){return p.call.apply(p.bind,arguments)}function h(p,w,R){return h=u,h.apply(null,arguments)}function f(p,w){var R=Array.prototype.slice.call(arguments,1);return function(){var z=R.slice();return z.push.apply(z,arguments),p.apply(this,z)}}function m(p,w){function R(){}R.prototype=w.prototype,p.Z=w.prototype,p.prototype=new R,p.prototype.constructor=p,p.Ob=function(z,ce,ve){for(var He=Array(arguments.length-2),Ct=2;Ct<arguments.length;Ct++)He[Ct-2]=arguments[Ct];return w.prototype[ce].apply(z,He)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function v(p){const w=p.length;if(w>0){const R=Array(w);for(let z=0;z<w;z++)R[z]=p[z];return R}return[]}function T(p,w){for(let z=1;z<arguments.length;z++){const ce=arguments[z];var R=typeof ce;if(R=R!="object"?R:ce?Array.isArray(ce)?"array":R:"null",R=="array"||R=="object"&&typeof ce.length=="number"){R=p.length||0;const ve=ce.length||0;p.length=R+ve;for(let He=0;He<ve;He++)p[R+He]=ce[He]}else p.push(ce)}}class A{constructor(w,R){this.i=w,this.j=R,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function E(p){a.setTimeout(()=>{throw p},0)}function S(){var p=P;let w=null;return p.g&&(w=p.g,p.g=p.g.next,p.g||(p.h=null),w.next=null),w}class D{constructor(){this.h=this.g=null}add(w,R){const z=b.get();z.set(w,R),this.h?this.h.next=z:this.g=z,this.h=z}}var b=new A(()=>new k,p=>p.reset());class k{constructor(){this.next=this.g=this.h=null}set(w,R){this.h=w,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let V,H=!1,P=new D,I=()=>{const p=Promise.resolve(void 0);V=()=>{p.then(M)}};function M(){for(var p;p=S();){try{p.h.call(p.g)}catch(R){E(R)}var w=b;w.j(p),w.h<100&&(w.h++,p.next=w.g,w.g=p)}H=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(p,w){this.type=p,this.g=this.target=w,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var W=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var p=!1,w=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const R=()=>{};a.addEventListener("test",R,w),a.removeEventListener("test",R,w)}catch{}return p})();function F(p){return/^[\s\xa0]*$/.test(p)}function Y(p,w){N.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,w)}m(Y,N),Y.prototype.init=function(p,w){const R=this.type=p.type,z=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=w,w=p.relatedTarget,w||(R=="mouseover"?w=p.fromElement:R=="mouseout"&&(w=p.toElement)),this.relatedTarget=w,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&Y.Z.h.call(this)},Y.prototype.h=function(){Y.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var ue="closure_listenable_"+(Math.random()*1e6|0),ye=0;function ge(p,w,R,z,ce){this.listener=p,this.proxy=null,this.src=w,this.type=R,this.capture=!!z,this.ha=ce,this.key=++ye,this.da=this.fa=!1}function Q(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function re(p,w,R){for(const z in p)w.call(R,p[z],z,p)}function ie(p,w){for(const R in p)w.call(void 0,p[R],R,p)}function $(p){const w={};for(const R in p)w[R]=p[R];return w}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function te(p,w){let R,z;for(let ce=1;ce<arguments.length;ce++){z=arguments[ce];for(R in z)p[R]=z[R];for(let ve=0;ve<ne.length;ve++)R=ne[ve],Object.prototype.hasOwnProperty.call(z,R)&&(p[R]=z[R])}}function _e(p){this.src=p,this.g={},this.h=0}_e.prototype.add=function(p,w,R,z,ce){const ve=p.toString();p=this.g[ve],p||(p=this.g[ve]=[],this.h++);const He=Pe(p,w,z,ce);return He>-1?(w=p[He],R||(w.fa=!1)):(w=new ge(w,this.src,ve,!!z,ce),w.fa=R,p.push(w)),w};function Ee(p,w){const R=w.type;if(R in p.g){var z=p.g[R],ce=Array.prototype.indexOf.call(z,w,void 0),ve;(ve=ce>=0)&&Array.prototype.splice.call(z,ce,1),ve&&(Q(w),p.g[R].length==0&&(delete p.g[R],p.h--))}}function Pe(p,w,R,z){for(let ce=0;ce<p.length;++ce){const ve=p[ce];if(!ve.da&&ve.listener==w&&ve.capture==!!R&&ve.ha==z)return ce}return-1}var we="closure_lm_"+(Math.random()*1e6|0),ke={};function We(p,w,R,z,ce){if(Array.isArray(w)){for(let ve=0;ve<w.length;ve++)We(p,w[ve],R,z,ce);return null}return R=mt(R),p&&p[ue]?p.J(w,R,c(z)?!!z.capture:!1,ce):Ye(p,w,R,!1,z,ce)}function Ye(p,w,R,z,ce,ve){if(!w)throw Error("Invalid event type");const He=c(ce)?!!ce.capture:!!ce;let Ct=Qe(p);if(Ct||(p[we]=Ct=new _e(p)),R=Ct.add(w,R,z,He,ve),R.proxy)return R;if(z=It(),R.proxy=z,z.src=p,z.listener=R,p.addEventListener)W||(ce=He),ce===void 0&&(ce=!1),p.addEventListener(w.toString(),z,ce);else if(p.attachEvent)p.attachEvent(st(w.toString()),z);else if(p.addListener&&p.removeListener)p.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return R}function It(){function p(R){return w.call(p.src,p.listener,R)}const w=ft;return p}function fe(p,w,R,z,ce){if(Array.isArray(w))for(var ve=0;ve<w.length;ve++)fe(p,w[ve],R,z,ce);else z=c(z)?!!z.capture:!!z,R=mt(R),p&&p[ue]?(p=p.i,ve=String(w).toString(),ve in p.g&&(w=p.g[ve],R=Pe(w,R,z,ce),R>-1&&(Q(w[R]),Array.prototype.splice.call(w,R,1),w.length==0&&(delete p.g[ve],p.h--)))):p&&(p=Qe(p))&&(w=p.g[w.toString()],p=-1,w&&(p=Pe(w,R,z,ce)),(R=p>-1?w[p]:null)&&nn(R))}function nn(p){if(typeof p!="number"&&p&&!p.da){var w=p.src;if(w&&w[ue])Ee(w.i,p);else{var R=p.type,z=p.proxy;w.removeEventListener?w.removeEventListener(R,z,p.capture):w.detachEvent?w.detachEvent(st(R),z):w.addListener&&w.removeListener&&w.removeListener(z),(R=Qe(w))?(Ee(R,p),R.h==0&&(R.src=null,w[we]=null)):Q(p)}}}function st(p){return p in ke?ke[p]:ke[p]="on"+p}function ft(p,w){if(p.da)p=!0;else{w=new Y(w,this);const R=p.listener,z=p.ha||p.src;p.fa&&nn(p),p=R.call(z,w)}return p}function Qe(p){return p=p[we],p instanceof _e?p:null}var Xt="__closure_events_fn_"+(Math.random()*1e9>>>0);function mt(p){return typeof p=="function"?p:(p[Xt]||(p[Xt]=function(w){return p.handleEvent(w)}),p[Xt])}function G(){C.call(this),this.i=new _e(this),this.M=this,this.G=null}m(G,C),G.prototype[ue]=!0,G.prototype.removeEventListener=function(p,w,R,z){fe(this,p,w,R,z)};function U(p,w){var R,z=p.G;if(z)for(R=[];z;z=z.G)R.push(z);if(p=p.M,z=w.type||w,typeof w=="string")w=new N(w,p);else if(w instanceof N)w.target=w.target||p;else{var ce=w;w=new N(z,p),te(w,ce)}ce=!0;let ve,He;if(R)for(He=R.length-1;He>=0;He--)ve=w.g=R[He],ce=de(ve,z,!0,w)&&ce;if(ve=w.g=p,ce=de(ve,z,!0,w)&&ce,ce=de(ve,z,!1,w)&&ce,R)for(He=0;He<R.length;He++)ve=w.g=R[He],ce=de(ve,z,!1,w)&&ce}G.prototype.N=function(){if(G.Z.N.call(this),this.i){var p=this.i;for(const w in p.g){const R=p.g[w];for(let z=0;z<R.length;z++)Q(R[z]);delete p.g[w],p.h--}}this.G=null},G.prototype.J=function(p,w,R,z){return this.i.add(String(p),w,!1,R,z)},G.prototype.K=function(p,w,R,z){return this.i.add(String(p),w,!0,R,z)};function de(p,w,R,z){if(w=p.i.g[String(w)],!w)return!0;w=w.concat();let ce=!0;for(let ve=0;ve<w.length;++ve){const He=w[ve];if(He&&!He.da&&He.capture==R){const Ct=He.listener,zn=He.ha||He.src;He.fa&&Ee(p.i,He),ce=Ct.call(zn,z)!==!1&&ce}}return ce&&!z.defaultPrevented}function Ie(p,w){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:a.setTimeout(p,w||0)}function Re(p){p.g=Ie(()=>{p.g=null,p.i&&(p.i=!1,Re(p))},p.l);const w=p.h;p.h=null,p.m.apply(null,w)}class De extends C{constructor(w,R){super(),this.m=w,this.l=R,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:Re(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xe(p){C.call(this),this.h=p,this.g={}}m(Xe,C);var ze=[];function Ge(p){re(p.g,function(w,R){this.g.hasOwnProperty(R)&&nn(w)},p),p.g={}}Xe.prototype.N=function(){Xe.Z.N.call(this),Ge(this)},Xe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ot=a.JSON.stringify,xt=a.JSON.parse,Ae=class{stringify(p){return a.JSON.stringify(p,void 0)}parse(p){return a.JSON.parse(p,void 0)}};function Nt(){}function bt(){}var ut={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function rt(){N.call(this,"d")}m(rt,N);function $e(){N.call(this,"c")}m($e,N);var ct={},Ot=null;function Kt(){return Ot=Ot||new G}ct.Ia="serverreachability";function wt(p){N.call(this,ct.Ia,p)}m(wt,N);function Oe(p){const w=Kt();U(w,new wt(w))}ct.STAT_EVENT="statevent";function K(p,w){N.call(this,ct.STAT_EVENT,p),this.stat=w}m(K,N);function Le(p){const w=Kt();U(w,new K(w,p))}ct.Ja="timingevent";function Ve(p,w){N.call(this,ct.Ja,p),this.size=w}m(Ve,N);function ht(p,w){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){p()},w)}function at(){this.g=!0}at.prototype.ua=function(){this.g=!1};function vt(p,w,R,z,ce,ve){p.info(function(){if(p.g)if(ve){var He="",Ct=ve.split("&");for(let an=0;an<Ct.length;an++){var zn=Ct[an].split("=");if(zn.length>1){const Xn=zn[0];zn=zn[1];const vi=Xn.split("_");He=vi.length>=2&&vi[1]=="type"?He+(Xn+"="+zn+"&"):He+(Xn+"=redacted&")}}}else He=null;else He=ve;return"XMLHTTP REQ ("+z+") [attempt "+ce+"]: "+w+`
`+R+`
`+He})}function Vt(p,w,R,z,ce,ve,He){p.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+ce+"]: "+w+`
`+R+`
`+ve+" "+He})}function rn(p,w,R,z){p.info(function(){return"XMLHTTP TEXT ("+w+"): "+zt(p,R)+(z?" "+z:"")})}function xn(p,w){p.info(function(){return"TIMEOUT: "+w})}at.prototype.info=function(){};function zt(p,w){if(!p.g)return w;if(!w)return null;try{const ve=JSON.parse(w);if(ve){for(p=0;p<ve.length;p++)if(Array.isArray(ve[p])){var R=ve[p];if(!(R.length<2)){var z=R[1];if(Array.isArray(z)&&!(z.length<1)){var ce=z[0];if(ce!="noop"&&ce!="stop"&&ce!="close")for(let He=1;He<z.length;He++)z[He]=""}}}}return ot(ve)}catch{return w}}var cn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Dn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},so;function Ln(){}m(Ln,Nt),Ln.prototype.g=function(){return new XMLHttpRequest},so=new Ln;function wn(p){return encodeURIComponent(String(p))}function Pi(p){var w=1;p=p.split(":");const R=[];for(;w>0&&p.length;)R.push(p.shift()),w--;return p.length&&R.push(p.join(":")),R}function jn(p,w,R,z){this.j=p,this.i=w,this.l=R,this.S=z||1,this.V=new Xe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Yi}function Yi(){this.i=null,this.g="",this.h=!1}var vs={},pr={};function Mr(p,w,R){p.M=1,p.A=gr($n(w)),p.u=R,p.R=!0,ys(p,null)}function ys(p,w){p.F=Date.now(),J(p),p.B=$n(p.A);var R=p.B,z=p.S;Array.isArray(z)||(z=[String(z)]),fh(R.i,"t",z),p.C=0,R=p.j.L,p.h=new Yi,p.g=wf(p.j,R?w:null,!p.u),p.P>0&&(p.O=new De(h(p.Y,p,p.g),p.P)),w=p.V,R=p.g,z=p.ba;var ce="readystatechange";Array.isArray(ce)||(ce&&(ze[0]=ce.toString()),ce=ze);for(let ve=0;ve<ce.length;ve++){const He=We(R,ce[ve],z||w.handleEvent,!1,w.h||w);if(!He)break;w.g[He.key]=He}w=p.J?$(p.J):{},p.u?(p.v||(p.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,w)):(p.v="GET",p.g.ea(p.B,p.v,null,w)),Oe(),vt(p.i,p.v,p.B,p.l,p.S,p.u)}jn.prototype.ba=function(p){p=p.target;const w=this.O;w&&As(p)==3?w.j():this.Y(p)},jn.prototype.Y=function(p){try{if(p==this.g)e:{const Ct=As(this.g),zn=this.g.ya(),an=this.g.ca();if(!(Ct<3)&&(Ct!=3||this.g&&(this.h.h||this.g.la()||Tf(this.g)))){this.K||Ct!=4||zn==7||(zn==8||an<=0?Oe(3):Oe(2)),ae(this);var w=this.g.ca();this.X=w;var R=j(this);if(this.o=w==200,Vt(this.i,this.v,this.B,this.l,this.S,Ct,w),this.o){if(this.U&&!this.L){t:{if(this.g){var z,ce=this.g;if((z=ce.g?ce.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(z)){var ve=z;break t}}ve=null}if(p=ve)rn(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Fe(this,p);else{this.o=!1,this.m=3,Le(12),Be(this),Se(this);break e}}if(this.R){p=!0;let Xn;for(;!this.K&&this.C<R.length;)if(Xn=pe(this,R),Xn==pr){Ct==4&&(this.m=4,Le(14),p=!1),rn(this.i,this.l,null,"[Incomplete Response]");break}else if(Xn==vs){this.m=4,Le(15),rn(this.i,this.l,R,"[Invalid Chunk]"),p=!1;break}else rn(this.i,this.l,Xn,null),Fe(this,Xn);if(se(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ct!=4||R.length!=0||this.h.h||(this.m=1,Le(16),p=!1),this.o=this.o&&p,!p)rn(this.i,this.l,R,"[Invalid Chunked Response]"),Be(this),Se(this);else if(R.length>0&&!this.W){this.W=!0;var He=this.j;He.g==this&&He.aa&&!He.P&&(He.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),ul(He),He.P=!0,Le(11))}}else rn(this.i,this.l,R,null),Fe(this,R);Ct==4&&Be(this),this.o&&!this.K&&(Ct==4?xc(this.j,this):(this.o=!1,J(this)))}else mh(this.g),w==400&&R.indexOf("Unknown SID")>0?(this.m=3,Le(12)):(this.m=0,Le(13)),Be(this),Se(this)}}}catch{}};function j(p){if(!se(p))return p.g.la();const w=Tf(p.g);if(w==="")return"";let R="";const z=w.length,ce=As(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Be(p),Se(p),"";p.h.i=new a.TextDecoder}for(let ve=0;ve<z;ve++)p.h.h=!0,R+=p.h.i.decode(w[ve],{stream:!(ce&&ve==z-1)});return w.length=0,p.h.g+=R,p.C=0,p.h.g}function se(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function pe(p,w){var R=p.C,z=w.indexOf(`
`,R);return z==-1?pr:(R=Number(w.substring(R,z)),isNaN(R)?vs:(z+=1,z+R>w.length?pr:(w=w.slice(z,z+R),p.C=z+R,w)))}jn.prototype.cancel=function(){this.K=!0,Be(this)};function J(p){p.T=Date.now()+p.H,O(p,p.H)}function O(p,w){if(p.D!=null)throw Error("WatchDog timer not null");p.D=ht(h(p.aa,p),w)}function ae(p){p.D&&(a.clearTimeout(p.D),p.D=null)}jn.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(xn(this.i,this.B),this.M!=2&&(Oe(),Le(17)),Be(this),this.m=2,Se(this)):O(this,this.T-p)};function Se(p){p.j.I==0||p.K||xc(p.j,p)}function Be(p){ae(p);var w=p.O;w&&typeof w.dispose=="function"&&w.dispose(),p.O=null,Ge(p.V),p.g&&(w=p.g,p.g=null,w.abort(),w.dispose())}function Fe(p,w){try{var R=p.j;if(R.I!=0&&(R.g==p||An(R.h,p))){if(!p.L&&An(R.h,p)&&R.I==3){try{var z=R.Ba.g.parse(w)}catch{z=null}if(Array.isArray(z)&&z.length==3){var ce=z;if(ce[0]==0){e:if(!R.v){if(R.g)if(R.g.F+3e3<p.F)Tc(R),gi(R);else break e;Rs(R),Le(18)}}else R.xa=ce[1],0<R.xa-R.K&&ce[2]<37500&&R.F&&R.A==0&&!R.C&&(R.C=ht(h(R.Va,R),6e3));jt(R.h)<=1&&R.ta&&(R.ta=void 0)}else _i(R,11)}else if((p.L||R.g==p)&&Tc(R),!F(w))for(ce=R.Ba.g.parse(w),w=0;w<ce.length;w++){let an=ce[w];const Xn=an[0];if(!(Xn<=R.K))if(R.K=Xn,an=an[1],R.I==2)if(an[0]=="c"){R.M=an[1],R.ba=an[2];const vi=an[3];vi!=null&&(R.ka=vi,R.j.info("VER="+R.ka));const ho=an[4];ho!=null&&(R.za=ho,R.j.info("SVER="+R.za));const Cs=an[5];Cs!=null&&typeof Cs=="number"&&Cs>0&&(z=1.5*Cs,R.O=z,R.j.info("backChannelRequestTimeoutMs_="+z)),z=R;const Ps=p.g;if(Ps){const Mc=Ps.g?Ps.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Mc){var ve=z.h;ve.g||Mc.indexOf("spdy")==-1&&Mc.indexOf("quic")==-1&&Mc.indexOf("h2")==-1||(ve.j=ve.l,ve.g=new Set,ve.h&&(Dt(ve,ve.h),ve.h=null))}if(z.G){const vh=Ps.g?Ps.g.getResponseHeader("X-HTTP-Session-Id"):null;vh&&(z.wa=vh,Tt(z.J,z.G,vh))}}R.I=3,R.l&&R.l.ra(),R.aa&&(R.T=Date.now()-p.F,R.j.info("Handshake RTT: "+R.T+"ms")),z=R;var He=p;if(z.na=_h(z,z.L?z.ba:null,z.W),He.L){Wn(z.h,He);var Ct=He,zn=z.O;zn&&(Ct.H=zn),Ct.D&&(ae(Ct),J(Ct)),z.g=He}else Rr(z);R.i.length>0&&uo(R)}else an[0]!="stop"&&an[0]!="close"||_i(R,7);else R.I==3&&(an[0]=="stop"||an[0]=="close"?an[0]=="stop"?_i(R,7):Ec(R):an[0]!="noop"&&R.l&&R.l.qa(an),R.A=0)}}Oe(4)}catch{}}var et=class{constructor(p,w){this.g=p,this.map=w}};function tt(p){this.l=p||10,a.PerformanceNavigationTiming?(p=a.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function dt(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function jt(p){return p.h?1:p.g?p.g.size:0}function An(p,w){return p.h?p.h==w:p.g?p.g.has(w):!1}function Dt(p,w){p.g?p.g.add(w):p.h=w}function Wn(p,w){p.h&&p.h==w?p.h=null:p.g&&p.g.has(w)&&p.g.delete(w)}tt.prototype.cancel=function(){if(this.i=kt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function kt(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let w=p.i;for(const R of p.g.values())w=w.concat(R.G);return w}return v(p.i)}var Lt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mr(p,w){if(p){p=p.split("&");for(let R=0;R<p.length;R++){const z=p[R].indexOf("=");let ce,ve=null;z>=0?(ce=p[R].substring(0,z),ve=p[R].substring(z+1)):ce=p[R],w(ce,ve?decodeURIComponent(ve.replace(/\+/g," ")):"")}}}function Qt(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;p instanceof Qt?(this.l=p.l,Es(this,p.j),this.o=p.o,this.g=p.g,br(this,p.u),this.h=p.h,Ii(this,ph(p.i)),this.m=p.m):p&&(w=String(p).match(Lt))?(this.l=!1,Es(this,w[1]||"",!0),this.o=Zi(w[2]||""),this.g=Zi(w[3]||"",!0),br(this,w[4]),this.h=Zi(w[5]||"",!0),Ii(this,w[6]||"",!0),this.m=Zi(w[7]||"")):(this.l=!1,this.i=new Yt(null,this.l))}Qt.prototype.toString=function(){const p=[];var w=this.j;w&&p.push(qn(w,ol,!0),":");var R=this.g;return(R||w=="file")&&(p.push("//"),(w=this.o)&&p.push(qn(w,ol,!0),"@"),p.push(wn(R).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.u,R!=null&&p.push(":",String(R))),(R=this.h)&&(this.g&&R.charAt(0)!="/"&&p.push("/"),p.push(qn(R,R.charAt(0)=="/"?al:Yo,!0))),(R=this.i.toString())&&p.push("?",R),(R=this.m)&&p.push("#",qn(R,uh)),p.join("")},Qt.prototype.resolve=function(p){const w=$n(this);let R=!!p.j;R?Es(w,p.j):R=!!p.o,R?w.o=p.o:R=!!p.g,R?w.g=p.g:R=p.u!=null;var z=p.h;if(R)br(w,p.u);else if(R=!!p.h){if(z.charAt(0)!="/")if(this.g&&!this.h)z="/"+z;else{var ce=w.h.lastIndexOf("/");ce!=-1&&(z=w.h.slice(0,ce+1)+z)}if(ce=z,ce==".."||ce==".")z="";else if(ce.indexOf("./")!=-1||ce.indexOf("/.")!=-1){z=ce.lastIndexOf("/",0)==0,ce=ce.split("/");const ve=[];for(let He=0;He<ce.length;){const Ct=ce[He++];Ct=="."?z&&He==ce.length&&ve.push(""):Ct==".."?((ve.length>1||ve.length==1&&ve[0]!="")&&ve.pop(),z&&He==ce.length&&ve.push("")):(ve.push(Ct),z=!0)}z=ve.join("/")}else z=ce}return R?w.h=z:R=p.i.toString()!=="",R?Ii(w,ph(p.i)):R=!!p.m,R&&(w.m=p.m),w};function $n(p){return new Qt(p)}function Es(p,w,R){p.j=R?Zi(w,!0):w,p.j&&(p.j=p.j.replace(/:$/,""))}function br(p,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);p.u=w}else p.u=null}function Ii(p,w,R){w instanceof Yt?(p.i=w,_c(p.i,p.l)):(R||(w=qn(w,y_)),p.i=new Yt(w,p.l))}function Tt(p,w,R){p.i.set(w,R)}function gr(p){return Tt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Zi(p,w){return p?w?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function qn(p,w,R){return typeof p=="string"?(p=encodeURI(p).replace(w,oo),R&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function oo(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var ol=/[#\/\?@]/g,Yo=/[#\?:]/g,al=/[#\?]/g,y_=/[#\?@]/g,uh=/#/g;function Yt(p,w){this.h=this.g=null,this.i=p||null,this.j=!!w}function Ss(p){p.g||(p.g=new Map,p.h=0,p.i&&mr(p.i,function(w,R){p.add(decodeURIComponent(w.replace(/\+/g," ")),R)}))}n=Yt.prototype,n.add=function(p,w){Ss(this),this.i=null,p=Ts(this,p);let R=this.g.get(p);return R||this.g.set(p,R=[]),R.push(w),this.h+=1,this};function hh(p,w){Ss(p),w=Ts(p,w),p.g.has(w)&&(p.i=null,p.h-=p.g.get(w).length,p.g.delete(w))}function gc(p,w){return Ss(p),w=Ts(p,w),p.g.has(w)}n.forEach=function(p,w){Ss(this),this.g.forEach(function(R,z){R.forEach(function(ce){p.call(w,ce,z,this)},this)},this)};function dh(p,w){Ss(p);let R=[];if(typeof w=="string")gc(p,w)&&(R=R.concat(p.g.get(Ts(p,w))));else for(p=Array.from(p.g.values()),w=0;w<p.length;w++)R=R.concat(p[w]);return R}n.set=function(p,w){return Ss(this),this.i=null,p=Ts(this,p),gc(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[w]),this.h+=1,this},n.get=function(p,w){return p?(p=dh(this,p),p.length>0?String(p[0]):w):w};function fh(p,w,R){hh(p,w),R.length>0&&(p.i=null,p.g.set(Ts(p,w),v(R)),p.h+=R.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],w=Array.from(this.g.keys());for(let z=0;z<w.length;z++){var R=w[z];const ce=wn(R);R=dh(this,R);for(let ve=0;ve<R.length;ve++){let He=ce;R[ve]!==""&&(He+="="+wn(R[ve])),p.push(He)}}return this.i=p.join("&")};function ph(p){const w=new Yt;return w.i=p.i,p.g&&(w.g=new Map(p.g),w.h=p.h),w}function Ts(p,w){return w=String(w),p.j&&(w=w.toLowerCase()),w}function _c(p,w){w&&!p.j&&(Ss(p),p.i=null,p.g.forEach(function(R,z){const ce=z.toLowerCase();z!=ce&&(hh(this,z),fh(this,ce,R))},p)),p.j=w}function xs(p,w){const R=new at;if(a.Image){const z=new Image;z.onload=f(_r,R,"TestLoadImage: loaded",!0,w,z),z.onerror=f(_r,R,"TestLoadImage: error",!1,w,z),z.onabort=f(_r,R,"TestLoadImage: abort",!1,w,z),z.ontimeout=f(_r,R,"TestLoadImage: timeout",!1,w,z),a.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=p}else w(!1)}function ws(p,w){const R=new at,z=new AbortController,ce=setTimeout(()=>{z.abort(),_r(R,"TestPingServer: timeout",!1,w)},1e4);fetch(p,{signal:z.signal}).then(ve=>{clearTimeout(ce),ve.ok?_r(R,"TestPingServer: ok",!0,w):_r(R,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(ce),_r(R,"TestPingServer: error",!1,w)})}function _r(p,w,R,z,ce){try{ce&&(ce.onload=null,ce.onerror=null,ce.onabort=null,ce.ontimeout=null),z(R)}catch{}}function ll(){this.g=new Ae}function ao(p){this.i=p.Sb||null,this.h=p.ab||!1}m(ao,Nt),ao.prototype.g=function(){return new mi(this.i,this.h)};function mi(p,w){G.call(this),this.H=p,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(mi,G),n=mi.prototype,n.open=function(p,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=w,this.readyState=1,Qi(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(w.body=p),(this.H||a).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Zo(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Qi(this)),this.g&&(this.readyState=3,Qi(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;yf(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function yf(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var w=p.value?p.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!p.done}))&&(this.response=this.responseText+=w)}p.done?Zo(this):Qi(this),this.readyState==3&&yf(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,Zo(this))},n.Na=function(p){this.g&&(this.response=p,Zo(this))},n.ga=function(){this.g&&Zo(this)};function Zo(p){p.readyState=4,p.l=null,p.j=null,p.B=null,Qi(p)}n.setRequestHeader=function(p,w){this.A.append(p,w)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],w=this.h.entries();for(var R=w.next();!R.done;)R=R.value,p.push(R[0]+": "+R[1]),R=w.next();return p.join(`\r
`)};function Qi(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(mi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Ef(p){let w="";return re(p,function(R,z){w+=z,w+=":",w+=R,w+=`\r
`}),w}function vc(p,w,R){e:{for(z in R){var z=!1;break e}z=!0}z||(R=Ef(R),typeof p=="string"?R!=null&&wn(R):Tt(p,w,R))}function un(p){G.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(un,G);var Sf=/^https?$/i,E_=["POST","PUT"];n=un.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,w,R,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);w=w?w.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():so.g(),this.g.onreadystatechange=_(h(this.Ca,this));try{this.B=!0,this.g.open(w,String(p),!0),this.B=!1}catch(ve){Qo(this,ve);return}if(p=R||"",R=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var ce in z)R.set(ce,z[ce]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const ve of z.keys())R.set(ve,z.get(ve));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(R.keys()).find(ve=>ve.toLowerCase()=="content-type"),ce=a.FormData&&p instanceof a.FormData,!(Array.prototype.indexOf.call(E_,w,void 0)>=0)||z||ce||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ve,He]of R)this.g.setRequestHeader(ve,He);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(ve){Qo(this,ve)}};function Qo(p,w){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=w,p.o=5,Jo(p),co(p)}function Jo(p){p.A||(p.A=!0,U(p,"complete"),U(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,U(this,"complete"),U(this,"abort"),co(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),co(this,!0)),un.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?lo(this):this.Xa())},n.Xa=function(){lo(this)};function lo(p){if(p.h&&typeof s<"u"){if(p.v&&As(p)==4)setTimeout(p.Ca.bind(p),0);else if(U(p,"readystatechange"),As(p)==4){p.h=!1;try{const ve=p.ca();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var R;if(!(R=w)){var z;if(z=ve===0){let He=String(p.D).match(Lt)[1]||null;!He&&a.self&&a.self.location&&(He=a.self.location.protocol.slice(0,-1)),z=!Sf.test(He?He.toLowerCase():"")}R=z}if(R)U(p,"complete"),U(p,"success");else{p.o=6;try{var ce=As(p)>2?p.g.statusText:""}catch{ce=""}p.l=ce+" ["+p.ca()+"]",Jo(p)}}finally{co(p)}}}}function co(p,w){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const R=p.g;p.g=null,w||U(p,"ready");try{R.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function As(p){return p.g?p.g.readyState:0}n.ca=function(){try{return As(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var w=this.g.responseText;return p&&w.indexOf(p)==0&&(w=w.substring(p.length)),xt(w)}};function Tf(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function mh(p){const w={};p=(p.g&&As(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<p.length;z++){if(F(p[z]))continue;var R=Pi(p[z]);const ce=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const ve=w[ce]||[];w[ce]=ve,ve.push(R)}ie(w,function(z){return z.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ms(p,w,R){return R&&R.internalChannelParams&&R.internalChannelParams[p]||w}function yc(p){this.za=0,this.i=[],this.j=new at,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ms("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ms("baseRetryDelayMs",5e3,p),this.Za=Ms("retryDelaySeedMs",1e4,p),this.Ta=Ms("forwardChannelMaxRetries",2,p),this.va=Ms("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new tt(p&&p.concurrentRequestLimit),this.Ba=new ll,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=yc.prototype,n.ka=8,n.I=1,n.connect=function(p,w,R,z){Le(0),this.W=p,this.H=w||{},R&&z!==void 0&&(this.H.OSID=R,this.H.OAID=z),this.F=this.X,this.J=_h(this,null,this.W),uo(this)};function Ec(p){if(Sc(p),p.I==3){var w=p.V++,R=$n(p.J);if(Tt(R,"SID",p.M),Tt(R,"RID",w),Tt(R,"TYPE","terminate"),bs(p,R),w=new jn(p,p.j,w),w.M=2,w.A=gr($n(R)),R=!1,a.navigator&&a.navigator.sendBeacon)try{R=a.navigator.sendBeacon(w.A.toString(),"")}catch{}!R&&a.Image&&(new Image().src=w.A,R=!0),R||(w.g=wf(w.j,null),w.g.ea(w.A)),w.F=Date.now(),J(w)}hl(p)}function gi(p){p.g&&(ul(p),p.g.cancel(),p.g=null)}function Sc(p){gi(p),p.v&&(a.clearTimeout(p.v),p.v=null),Tc(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&a.clearTimeout(p.m),p.m=null)}function uo(p){if(!dt(p.h)&&!p.m){p.m=!0;var w=p.Ea;V||I(),H||(V(),H=!0),P.add(w,p),p.D=0}}function xf(p,w){return jt(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=w.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=ht(h(p.Ea,p,w),wc(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const ce=new jn(this,this.j,p);let ve=this.o;if(this.U&&(ve?(ve=$(ve),te(ve,this.U)):ve=this.U),this.u!==null||this.R||(ce.J=ve,ve=null),this.S)e:{for(var w=0,R=0;R<this.i.length;R++){t:{var z=this.i[R];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(w+=z,w>4096){w=R;break e}if(w===4096||R===this.i.length-1){w=R+1;break e}}w=1e3}else w=1e3;w=gh(this,ce,w),R=$n(this.J),Tt(R,"RID",p),Tt(R,"CVER",22),this.G&&Tt(R,"X-HTTP-Session-Id",this.G),bs(this,R),ve&&(this.R?w="headers="+wn(Ef(ve))+"&"+w:this.u&&vc(R,this.u,ve)),Dt(this.h,ce),this.Ra&&Tt(R,"TYPE","init"),this.S?(Tt(R,"$req",w),Tt(R,"SID","null"),ce.U=!0,Mr(ce,R,null)):Mr(ce,R,w),this.I=2}}else this.I==3&&(p?cl(this,p):this.i.length==0||dt(this.h)||cl(this))};function cl(p,w){var R;w?R=w.l:R=p.V++;const z=$n(p.J);Tt(z,"SID",p.M),Tt(z,"RID",R),Tt(z,"AID",p.K),bs(p,z),p.u&&p.o&&vc(z,p.u,p.o),R=new jn(p,p.j,R,p.D+1),p.u===null&&(R.J=p.o),w&&(p.i=w.G.concat(p.i)),w=gh(p,R,1e3),R.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),Dt(p.h,R),Mr(R,z,w)}function bs(p,w){p.H&&re(p.H,function(R,z){Tt(w,z,R)}),p.l&&re({},function(R,z){Tt(w,z,R)})}function gh(p,w,R){R=Math.min(p.i.length,R);const z=p.l?h(p.l.Ka,p.l,p):null;e:{var ce=p.i;let Ct=-1;for(;;){const zn=["count="+R];Ct==-1?R>0?(Ct=ce[0].g,zn.push("ofs="+Ct)):Ct=0:zn.push("ofs="+Ct);let an=!0;for(let Xn=0;Xn<R;Xn++){var ve=ce[Xn].g;const vi=ce[Xn].map;if(ve-=Ct,ve<0)Ct=Math.max(0,ce[Xn].g-100),an=!1;else try{ve="req"+ve+"_"||"";try{var He=vi instanceof Map?vi:Object.entries(vi);for(const[ho,Cs]of He){let Ps=Cs;c(Cs)&&(Ps=ot(Cs)),zn.push(ve+ho+"="+encodeURIComponent(Ps))}}catch(ho){throw zn.push(ve+"type="+encodeURIComponent("_badmap")),ho}}catch{z&&z(vi)}}if(an){He=zn.join("&");break e}}He=void 0}return p=p.i.splice(0,R),w.G=p,He}function Rr(p){if(!p.g&&!p.v){p.Y=1;var w=p.Da;V||I(),H||(V(),H=!0),P.add(w,p),p.A=0}}function Rs(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=ht(h(p.Da,p),wc(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,ea(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=ht(h(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Le(10),gi(this),ea(this))};function ul(p){p.B!=null&&(a.clearTimeout(p.B),p.B=null)}function ea(p){p.g=new jn(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var w=$n(p.na);Tt(w,"RID","rpc"),Tt(w,"SID",p.M),Tt(w,"AID",p.K),Tt(w,"CI",p.F?"0":"1"),!p.F&&p.ia&&Tt(w,"TO",p.ia),Tt(w,"TYPE","xmlhttp"),bs(p,w),p.u&&p.o&&vc(w,p.u,p.o),p.O&&(p.g.H=p.O);var R=p.g;p=p.ba,R.M=1,R.A=gr($n(w)),R.u=null,R.R=!0,ys(R,p)}n.Va=function(){this.C!=null&&(this.C=null,gi(this),Rs(this),Le(19))};function Tc(p){p.C!=null&&(a.clearTimeout(p.C),p.C=null)}function xc(p,w){var R=null;if(p.g==w){Tc(p),ul(p),p.g=null;var z=2}else if(An(p.h,w))R=w.G,Wn(p.h,w),z=1;else return;if(p.I!=0){if(w.o)if(z==1){R=w.u?w.u.length:0,w=Date.now()-w.F;var ce=p.D;z=Kt(),U(z,new Ve(z,R)),uo(p)}else Rr(p);else if(ce=w.m,ce==3||ce==0&&w.X>0||!(z==1&&xf(p,w)||z==2&&Rs(p)))switch(R&&R.length>0&&(w=p.h,w.i=w.i.concat(R)),ce){case 1:_i(p,5);break;case 4:_i(p,10);break;case 3:_i(p,6);break;default:_i(p,2)}}}function wc(p,w){let R=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(R*=2),R*w}function _i(p,w){if(p.j.info("Error code "+w),w==2){var R=h(p.bb,p),z=p.Ua;const ce=!z;z=new Qt(z||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Es(z,"https"),gr(z),ce?xs(z.toString(),R):ws(z.toString(),R)}else Le(2);p.I=0,p.l&&p.l.pa(w),hl(p),Sc(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Le(2)):(this.j.info("Failed to ping google.com"),Le(1))};function hl(p){if(p.I=0,p.ja=[],p.l){const w=kt(p.h);(w.length!=0||p.i.length!=0)&&(T(p.ja,w),T(p.ja,p.i),p.h.i.length=0,v(p.i),p.i.length=0),p.l.oa()}}function _h(p,w,R){var z=R instanceof Qt?$n(R):new Qt(R);if(z.g!="")w&&(z.g=w+"."+z.g),br(z,z.u);else{var ce=a.location;z=ce.protocol,w=w?w+"."+ce.hostname:ce.hostname,ce=+ce.port;const ve=new Qt(null);z&&Es(ve,z),w&&(ve.g=w),ce&&br(ve,ce),R&&(ve.h=R),z=ve}return R=p.G,w=p.wa,R&&w&&Tt(z,R,w),Tt(z,"VER",p.ka),bs(p,z),z}function wf(p,w,R){if(w&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=p.Aa&&!p.ma?new un(new ao({ab:R})):new un(p.ma),w.Fa(p.L),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Af(){}n=Af.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ac(){}Ac.prototype.g=function(p,w){return new vr(p,w)};function vr(p,w){G.call(this),this.g=new yc(w),this.l=p,this.h=w&&w.messageUrlParams||null,p=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(p?p["X-WebChannel-Content-Type"]=w.messageContentType:p={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(p?p["X-WebChannel-Client-Profile"]=w.sa:p={"X-WebChannel-Client-Profile":w.sa}),this.g.U=p,(p=w&&w.Qb)&&!F(p)&&(this.g.u=p),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!F(w)&&(this.g.G=w,p=this.h,p!==null&&w in p&&(p=this.h,w in p&&delete p[w])),this.j=new ta(this)}m(vr,G),vr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},vr.prototype.close=function(){Ec(this.g)},vr.prototype.o=function(p){var w=this.g;if(typeof p=="string"){var R={};R.__data__=p,p=R}else this.v&&(R={},R.__data__=ot(p),p=R);w.i.push(new et(w.Ya++,p)),w.I==3&&uo(w)},vr.prototype.N=function(){this.g.l=null,delete this.j,Ec(this.g),delete this.g,vr.Z.N.call(this)};function Mf(p){rt.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var w=p.__sm__;if(w){e:{for(const R in w){p=R;break e}p=void 0}(this.i=p)&&(p=this.i,w=w!==null&&p in w?w[p]:void 0),this.data=w}else this.data=p}m(Mf,rt);function bf(){$e.call(this),this.status=1}m(bf,$e);function ta(p){this.g=p}m(ta,Af),ta.prototype.ra=function(){U(this.g,"a")},ta.prototype.qa=function(p){U(this.g,new Mf(p))},ta.prototype.pa=function(p){U(this.g,new bf)},ta.prototype.oa=function(){U(this.g,"b")},Ac.prototype.createWebChannel=Ac.prototype.g,vr.prototype.send=vr.prototype.o,vr.prototype.open=vr.prototype.m,vr.prototype.close=vr.prototype.close,_D=function(){return new Ac},gD=function(){return Kt()},mD=ct,W0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},cn.NO_ERROR=0,cn.TIMEOUT=8,cn.HTTP_ERROR=6,wm=cn,Dn.COMPLETE="complete",pD=Dn,bt.EventType=ut,ut.OPEN="a",ut.CLOSE="b",ut.ERROR="c",ut.MESSAGE="d",G.prototype.listen=G.prototype.J,hd=bt,un.prototype.listenOnce=un.prototype.K,un.prototype.getLastError=un.prototype.Ha,un.prototype.getLastErrorCode=un.prototype.ya,un.prototype.getStatus=un.prototype.ca,un.prototype.getResponseJson=un.prototype.La,un.prototype.getResponseText=un.prototype.la,un.prototype.send=un.prototype.ea,un.prototype.setWithCredentials=un.prototype.Fa,fD=un}).apply(typeof bp<"u"?bp:typeof self<"u"?self:typeof window<"u"?window:{});const ub="@firebase/firestore",hb="4.9.3";let Ur=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ur.UNAUTHENTICATED=new Ur(null),Ur.GOOGLE_CREDENTIALS=new Ur("google-credentials-uid"),Ur.FIRST_PARTY=new Ur("first-party-uid"),Ur.MOCK_USER=new Ur("mock-user");let th="12.7.0";const Ql=new gS("@firebase/firestore");function fu(){return Ql.logLevel}function Ze(n,...e){if(Ql.logLevel<=Wt.DEBUG){const t=e.map(bS);Ql.debug(`Firestore (${th}): ${n}`,...t)}}function Bo(n,...e){if(Ql.logLevel<=Wt.ERROR){const t=e.map(bS);Ql.error(`Firestore (${th}): ${n}`,...t)}}function Fu(n,...e){if(Ql.logLevel<=Wt.WARN){const t=e.map(bS);Ql.warn(`Firestore (${th}): ${n}`,...t)}}function bS(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function St(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,vD(n,r,t)}function vD(n,e,t){let r=`FIRESTORE (${th}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Bo(r),new Error(r)}function on(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||vD(e,i,r)}function Pt(n,e){return n}const Te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qe extends no{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Uo{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class yD{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class lH{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ur.UNAUTHENTICATED)))}shutdown(){}}class cH{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class uH{constructor(e){this.t=e,this.currentUser=Ur.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){on(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve();let s=new Uo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Uo,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const u=s;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Uo)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(on(typeof r.accessToken=="string",31837,{l:r}),new yD(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return on(e===null||typeof e=="string",2055,{h:e}),new Ur(e)}}class hH{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ur.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class dH{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new hH(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ur.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class db{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fH{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ci(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){on(this.o===void 0,3512);const r=s=>{s.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,Ze("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new db(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(on(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new db(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function pH(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class RS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=pH(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function $t(n,e){return n<e?-1:n>e?1:0}function $0(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return gy(i)===gy(s)?$t(i,s):gy(i)?1:-1}return $t(n.length,e.length)}const mH=55296,gH=57343;function gy(n){const e=n.charCodeAt(0);return e>=mH&&e<=gH}function Vu(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}const fb="__name__";class Fs{constructor(e,t,r){t===void 0?t=0:t>e.length&&St(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&St(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Fs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Fs?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Fs.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return $t(e.length,t.length)}static compareSegments(e,t){const r=Fs.isNumericId(e),i=Fs.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Fs.extractNumericId(e).compare(Fs.extractNumericId(t)):$0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ua.fromString(e.substring(4,e.length-2))}}class pn extends Fs{construct(e,t,r){return new pn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new qe(Te.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new pn(t)}static emptyPath(){return new pn([])}}const _H=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xr extends Fs{construct(e,t,r){return new xr(e,t,r)}static isValidIdentifier(e){return _H.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fb}static keyField(){return new xr([fb])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new qe(Te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new qe(Te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new qe(Te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(r+=c,i++):(s(),i++)}if(s(),a)throw new qe(Te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xr(t)}static emptyPath(){return new xr([])}}class pt{constructor(e){this.path=e}static fromPath(e){return new pt(pn.fromString(e))}static fromName(e){return new pt(pn.fromString(e).popFirst(5))}static empty(){return new pt(pn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pt(new pn(e.slice()))}}function ED(n,e,t){if(!t)throw new qe(Te.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function vH(n,e,t,r){if(e===!0&&r===!0)throw new qe(Te.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pb(n){if(!pt.isDocumentKey(n))throw new qe(Te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mb(n){if(pt.isDocumentKey(n))throw new qe(Te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function SD(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Vg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":St(12329,{type:typeof n})}function di(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new qe(Te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Vg(n);throw new qe(Te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function yH(n,e){if(e<=0)throw new qe(Te.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Jn(n,e){const t={typeString:n};return e&&(t.value=e),t}function cf(n,e){if(!SD(n))throw new qe(Te.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new qe(Te.INVALID_ARGUMENT,t);return!0}const gb=-62135596800,_b=1e6;class yn{static now(){return yn.fromMillis(Date.now())}static fromDate(e){return yn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*_b);return new yn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new qe(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new qe(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<gb)throw new qe(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new qe(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_b}_compareTo(e){return this.seconds===e.seconds?$t(this.nanoseconds,e.nanoseconds):$t(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:yn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(cf(e,yn._jsonSchema))return new yn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-gb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}yn._jsonSchemaVersion="firestore/timestamp/1.0",yn._jsonSchema={type:Jn("string",yn._jsonSchemaVersion),seconds:Jn("number"),nanoseconds:Jn("number")};class Rt{static fromTimestamp(e){return new Rt(e)}static min(){return new Rt(new yn(0,0))}static max(){return new Rt(new yn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Vd=-1;function EH(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Rt.fromTimestamp(r===1e9?new yn(t+1,0):new yn(t,r));return new $a(i,pt.empty(),e)}function SH(n){return new $a(n.readTime,n.key,Vd)}class $a{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new $a(Rt.min(),pt.empty(),Vd)}static max(){return new $a(Rt.max(),pt.empty(),Vd)}}function TH(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=pt.comparator(n.documentKey,e.documentKey),t!==0?t:$t(n.largestBatchId,e.largestBatchId))}const xH="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wH{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function nh(n){if(n.code!==Te.FAILED_PRECONDITION||n.message!==xH)throw n;Ze("LocalStore","Unexpectedly lost primary lease")}class xe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&St(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new xe(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof xe?t:xe.resolve(t)}catch(t){return xe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):xe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):xe.reject(t)}static resolve(e){return new xe(((t,r)=>{t(e)}))}static reject(e){return new xe(((t,r)=>{r(e)}))}static waitFor(e){return new xe(((t,r)=>{let i=0,s=0,a=!1;e.forEach((c=>{++i,c.next((()=>{++s,a&&s===i&&t()}),(u=>r(u)))})),a=!0,s===i&&t()}))}static or(e){let t=xe.resolve(!1);for(const r of e)t=t.next((i=>i?xe.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new xe(((r,i)=>{const s=e.length,a=new Array(s);let c=0;for(let u=0;u<s;u++){const h=u;t(e[h]).next((f=>{a[h]=f,++c,c===s&&r(a)}),(f=>i(f)))}}))}static doWhile(e,t){return new xe(((r,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}}function AH(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function rh(n){return n.name==="IndexedDbTransactionError"}class zg{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}zg.ce=-1;const CS=-1;function Bg(n){return n==null}function Km(n){return n===0&&1/n==-1/0}function MH(n){return typeof n=="number"&&Number.isInteger(n)&&!Km(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const TD="";function bH(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=vb(e)),e=RH(n.get(t),e);return vb(e)}function RH(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case TD:t+="";break;default:t+=s}}return t}function vb(n){return n+TD+""}function yb(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function nl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function xD(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Pn{constructor(e,t){this.comparator=e,this.root=t||Sr.EMPTY}insert(e,t){return new Pn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Sr.BLACK,null,null))}remove(e){return new Pn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Sr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rp(this.root,e,this.comparator,!0)}}class Rp{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Sr{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Sr.RED,this.left=i??Sr.EMPTY,this.right=s??Sr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Sr(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Sr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Sr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Sr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Sr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw St(43730,{key:this.key,value:this.value});if(this.right.isRed())throw St(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw St(27949);return e+(this.isRed()?0:1)}}Sr.EMPTY=null,Sr.RED=!0,Sr.BLACK=!1;Sr.EMPTY=new class{constructor(){this.size=0}get key(){throw St(57766)}get value(){throw St(16141)}get color(){throw St(16727)}get left(){throw St(29726)}get right(){throw St(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Sr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class rr{constructor(e){this.comparator=e,this.data=new Pn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Eb(this.data.getIterator())}getIteratorFrom(e){return new Eb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof rr)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new rr(this.comparator);return t.data=e,t}}class Eb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Mi{constructor(e){this.fields=e,e.sort(xr.comparator)}static empty(){return new Mi([])}unionWith(e){let t=new rr(xr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Mi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Vu(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class wD extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class wr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new wD("Invalid base64 string: "+s):s}})(e);return new wr(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new wr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $t(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}wr.EMPTY_BYTE_STRING=new wr("");const CH=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qa(n){if(on(!!n,39018),typeof n=="string"){let e=0;const t=CH.exec(n);if(on(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Gn(n.seconds),nanos:Gn(n.nanos)}}function Gn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Xa(n){return typeof n=="string"?wr.fromBase64String(n):wr.fromUint8Array(n)}const AD="server_timestamp",MD="__type__",bD="__previous_value__",RD="__local_write_time__";function PS(n){return(n?.mapValue?.fields||{})[MD]?.stringValue===AD}function Hg(n){const e=n.mapValue.fields[bD];return PS(e)?Hg(e):e}function zd(n){const e=qa(n.mapValue.fields[RD].timestampValue);return new yn(e.seconds,e.nanos)}class PH{constructor(e,t,r,i,s,a,c,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const Ym="(default)";class Bd{constructor(e,t){this.projectId=e,this.database=t||Ym}static empty(){return new Bd("","")}get isDefaultDatabase(){return this.database===Ym}isEqual(e){return e instanceof Bd&&e.projectId===this.projectId&&e.database===this.database}}const CD="__type__",IH="__max__",Cp={mapValue:{}},PD="__vector__",Zm="value";function Ka(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?PS(n)?4:LH(n)?9007199254740991:DH(n)?10:11:St(28295,{value:n})}function eo(n,e){if(n===e)return!0;const t=Ka(n);if(t!==Ka(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return zd(n).isEqual(zd(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=qa(i.timestampValue),c=qa(s.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return Xa(i.bytesValue).isEqual(Xa(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return Gn(i.geoPointValue.latitude)===Gn(s.geoPointValue.latitude)&&Gn(i.geoPointValue.longitude)===Gn(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return Gn(i.integerValue)===Gn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Gn(i.doubleValue),c=Gn(s.doubleValue);return a===c?Km(a)===Km(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return Vu(n.arrayValue.values||[],e.arrayValue.values||[],eo);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},c=s.mapValue.fields||{};if(yb(a)!==yb(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!eo(a[u],c[u])))return!1;return!0})(n,e);default:return St(52216,{left:n})}}function Hd(n,e){return(n.values||[]).find((t=>eo(t,e)))!==void 0}function zu(n,e){if(n===e)return 0;const t=Ka(n),r=Ka(e);if(t!==r)return $t(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return $t(n.booleanValue,e.booleanValue);case 2:return(function(s,a){const c=Gn(s.integerValue||s.doubleValue),u=Gn(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return Sb(n.timestampValue,e.timestampValue);case 4:return Sb(zd(n),zd(e));case 5:return $0(n.stringValue,e.stringValue);case 6:return(function(s,a){const c=Xa(s),u=Xa(a);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){const c=s.split("/"),u=a.split("/");for(let h=0;h<c.length&&h<u.length;h++){const f=$t(c[h],u[h]);if(f!==0)return f}return $t(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){const c=$t(Gn(s.latitude),Gn(a.latitude));return c!==0?c:$t(Gn(s.longitude),Gn(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Tb(n.arrayValue,e.arrayValue);case 10:return(function(s,a){const c=s.fields||{},u=a.fields||{},h=c[Zm]?.arrayValue,f=u[Zm]?.arrayValue,m=$t(h?.values?.length||0,f?.values?.length||0);return m!==0?m:Tb(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===Cp.mapValue&&a===Cp.mapValue)return 0;if(s===Cp.mapValue)return 1;if(a===Cp.mapValue)return-1;const c=s.fields||{},u=Object.keys(c),h=a.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const _=$0(u[m],f[m]);if(_!==0)return _;const v=zu(c[u[m]],h[f[m]]);if(v!==0)return v}return $t(u.length,f.length)})(n.mapValue,e.mapValue);default:throw St(23264,{he:t})}}function Sb(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return $t(n,e);const t=qa(n),r=qa(e),i=$t(t.seconds,r.seconds);return i!==0?i:$t(t.nanos,r.nanos)}function Tb(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=zu(t[i],r[i]);if(s)return s}return $t(t.length,r.length)}function Bu(n){return q0(n)}function q0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=qa(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Xa(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return pt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=q0(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${q0(t.fields[a])}`;return i+"}"})(n.mapValue):St(61005,{value:n})}function Am(n){switch(Ka(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hg(n);return e?16+Am(e):16;case 5:return 2*n.stringValue.length;case 6:return Xa(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+Am(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return nl(r.fields,((s,a)=>{i+=s.length+Am(a)})),i})(n.mapValue);default:throw St(13486,{value:n})}}function xb(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function X0(n){return!!n&&"integerValue"in n}function IS(n){return!!n&&"arrayValue"in n}function wb(n){return!!n&&"nullValue"in n}function Ab(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Mm(n){return!!n&&"mapValue"in n}function DH(n){return(n?.mapValue?.fields||{})[CD]?.stringValue===PD}function wd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return nl(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=wd(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wd(n.arrayValue.values[t]);return e}return{...n}}function LH(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===IH}class ui{constructor(e){this.value=e}static empty(){return new ui({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Mm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wd(t)}setAll(e){let t=xr.emptyPath(),r={},i=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}a?r[c.lastSegment()]=wd(a):i.push(c.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Mm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return eo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Mm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){nl(t,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new ui(wd(this.value))}}function ID(n){const e=[];return nl(n.fields,((t,r)=>{const i=new xr([t]);if(Mm(r)){const s=ID(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)})),new Mi(e)}class Fr{constructor(e,t,r,i,s,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Fr(e,0,Rt.min(),Rt.min(),Rt.min(),ui.empty(),0)}static newFoundDocument(e,t,r,i){return new Fr(e,1,t,Rt.min(),r,i,0)}static newNoDocument(e,t){return new Fr(e,2,t,Rt.min(),Rt.min(),ui.empty(),0)}static newUnknownDocument(e,t){return new Fr(e,3,t,Rt.min(),Rt.min(),ui.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ui.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ui.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Rt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Fr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Fr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Qm{constructor(e,t){this.position=e,this.inclusive=t}}function Mb(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=pt.comparator(pt.fromName(a.referenceValue),t.key):r=zu(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function bb(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!eo(n.position[t],e.position[t]))return!1;return!0}class Gd{constructor(e,t="asc"){this.field=e,this.dir=t}}function NH(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class DD{}class Qn extends DD{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new kH(e,t,r):t==="array-contains"?new VH(e,r):t==="in"?new zH(e,r):t==="not-in"?new BH(e,r):t==="array-contains-any"?new HH(e,r):new Qn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new UH(e,r):new FH(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(zu(t,this.value)):t!==null&&Ka(this.value)===Ka(t)&&this.matchesComparison(zu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return St(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _s extends DD{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new _s(e,t)}matches(e){return LD(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function LD(n){return n.op==="and"}function ND(n){return OH(n)&&LD(n)}function OH(n){for(const e of n.filters)if(e instanceof _s)return!1;return!0}function K0(n){if(n instanceof Qn)return n.field.canonicalString()+n.op.toString()+Bu(n.value);if(ND(n))return n.filters.map((e=>K0(e))).join(",");{const e=n.filters.map((t=>K0(t))).join(",");return`${n.op}(${e})`}}function OD(n,e){return n instanceof Qn?(function(r,i){return i instanceof Qn&&r.op===i.op&&r.field.isEqual(i.field)&&eo(r.value,i.value)})(n,e):n instanceof _s?(function(r,i){return i instanceof _s&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,a,c)=>s&&OD(a,i.filters[c])),!0):!1})(n,e):void St(19439)}function kD(n){return n instanceof Qn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Bu(t.value)}`})(n):n instanceof _s?(function(t){return t.op.toString()+" {"+t.getFilters().map(kD).join(" ,")+"}"})(n):"Filter"}class kH extends Qn{constructor(e,t,r){super(e,t,r),this.key=pt.fromName(r.referenceValue)}matches(e){const t=pt.comparator(e.key,this.key);return this.matchesComparison(t)}}class UH extends Qn{constructor(e,t){super(e,"in",t),this.keys=UD("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class FH extends Qn{constructor(e,t){super(e,"not-in",t),this.keys=UD("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function UD(n,e){return(e.arrayValue?.values||[]).map((t=>pt.fromName(t.referenceValue)))}class VH extends Qn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return IS(t)&&Hd(t.arrayValue,this.value)}}class zH extends Qn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Hd(this.value.arrayValue,t)}}class BH extends Qn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Hd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Hd(this.value.arrayValue,t)}}class HH extends Qn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!IS(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Hd(this.value.arrayValue,r)))}}class GH{constructor(e,t=null,r=[],i=[],s=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=c,this.Te=null}}function Rb(n,e=null,t=[],r=[],i=null,s=null,a=null){return new GH(n,e,t,r,i,s,a)}function DS(n){const e=Pt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>K0(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),Bg(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Bu(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Bu(r))).join(",")),e.Te=t}return e.Te}function LS(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!NH(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!OD(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!bb(n.startAt,e.startAt)&&bb(n.endAt,e.endAt)}function Y0(n){return pt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class ih{constructor(e,t=null,r=[],i=[],s=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function jH(n,e,t,r,i,s,a,c){return new ih(n,e,t,r,i,s,a,c)}function Gg(n){return new ih(n)}function Cb(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function FD(n){return n.collectionGroup!==null}function Ad(n){const e=Pt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new rr(xr.comparator);return a.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Gd(s,r))})),t.has(xr.keyField().canonicalString())||e.Ie.push(new Gd(xr.keyField(),r))}return e.Ie}function Ks(n){const e=Pt(n);return e.Ee||(e.Ee=WH(e,Ad(n))),e.Ee}function WH(n,e){if(n.limitType==="F")return Rb(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new Gd(i.field,s)}));const t=n.endAt?new Qm(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Qm(n.startAt.position,n.startAt.inclusive):null;return Rb(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Z0(n,e){const t=n.filters.concat([e]);return new ih(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Jm(n,e,t){return new ih(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function jg(n,e){return LS(Ks(n),Ks(e))&&n.limitType===e.limitType}function VD(n){return`${DS(Ks(n))}|lt:${n.limitType}`}function pu(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>kD(i))).join(", ")}]`),Bg(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>Bu(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>Bu(i))).join(",")),`Target(${r})`})(Ks(n))}; limitType=${n.limitType})`}function Wg(n,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):pt.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(const s of Ad(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,c,u){const h=Mb(a,c,u);return a.inclusive?h<=0:h<0})(r.startAt,Ad(r),i)||r.endAt&&!(function(a,c,u){const h=Mb(a,c,u);return a.inclusive?h>=0:h>0})(r.endAt,Ad(r),i))})(n,e)}function $H(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function zD(n){return(e,t)=>{let r=!1;for(const i of Ad(n)){const s=qH(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function qH(n,e,t){const r=n.field.isKeyField()?pt.comparator(e.key,t.key):(function(s,a,c){const u=a.data.field(s),h=c.data.field(s);return u!==null&&h!==null?zu(u,h):St(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return St(19790,{direction:n.dir})}}class cc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){nl(this.inner,((t,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return xD(this.inner)}size(){return this.innerSize}}const XH=new Pn(pt.comparator);function Ho(){return XH}const BD=new Pn(pt.comparator);function dd(...n){let e=BD;for(const t of n)e=e.insert(t.key,t);return e}function HD(n){let e=BD;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Vl(){return Md()}function GD(){return Md()}function Md(){return new cc((n=>n.toString()),((n,e)=>n.isEqual(e)))}const KH=new Pn(pt.comparator),YH=new rr(pt.comparator);function qt(...n){let e=YH;for(const t of n)e=e.add(t);return e}const ZH=new rr($t);function QH(){return ZH}function NS(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Km(e)?"-0":e}}function jD(n){return{integerValue:""+n}}function WD(n,e){return MH(e)?jD(e):NS(n,e)}class $g{constructor(){this._=void 0}}function JH(n,e,t){return n instanceof jd?(function(i,s){const a={fields:{[MD]:{stringValue:AD},[RD]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&PS(s)&&(s=Hg(s)),s&&(a.fields[bD]=s),{mapValue:a}})(t,e):n instanceof Hu?qD(n,e):n instanceof Gu?XD(n,e):(function(i,s){const a=$D(i,s),c=Pb(a)+Pb(i.Ae);return X0(a)&&X0(i.Ae)?jD(c):NS(i.serializer,c)})(n,e)}function eG(n,e,t){return n instanceof Hu?qD(n,e):n instanceof Gu?XD(n,e):t}function $D(n,e){return n instanceof Wd?(function(r){return X0(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class jd extends $g{}class Hu extends $g{constructor(e){super(),this.elements=e}}function qD(n,e){const t=KD(e);for(const r of n.elements)t.some((i=>eo(i,r)))||t.push(r);return{arrayValue:{values:t}}}class Gu extends $g{constructor(e){super(),this.elements=e}}function XD(n,e){let t=KD(e);for(const r of n.elements)t=t.filter((i=>!eo(i,r)));return{arrayValue:{values:t}}}class Wd extends $g{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Pb(n){return Gn(n.integerValue||n.doubleValue)}function KD(n){return IS(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class qg{constructor(e,t){this.field=e,this.transform=t}}function tG(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Hu&&i instanceof Hu||r instanceof Gu&&i instanceof Gu?Vu(r.elements,i.elements,eo):r instanceof Wd&&i instanceof Wd?eo(r.Ae,i.Ae):r instanceof jd&&i instanceof jd})(n.transform,e.transform)}class nG{constructor(e,t){this.version=e,this.transformResults=t}}class Wi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Wi}static exists(e){return new Wi(void 0,e)}static updateTime(e){return new Wi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Xg{}function YD(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new OS(n.key,Wi.none()):new uf(n.key,n.data,Wi.none());{const t=n.data,r=ui.empty();let i=new rr(xr.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new rl(n.key,r,new Mi(i.toArray()),Wi.none())}}function rG(n,e,t){n instanceof uf?(function(i,s,a){const c=i.value.clone(),u=Db(i.fieldTransforms,s,a.transformResults);c.setAll(u),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof rl?(function(i,s,a){if(!bm(i.precondition,s))return void s.convertToUnknownDocument(a.version);const c=Db(i.fieldTransforms,s,a.transformResults),u=s.data;u.setAll(ZD(i)),u.setAll(c),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function bd(n,e,t,r){return n instanceof uf?(function(s,a,c,u){if(!bm(s.precondition,a))return c;const h=s.value.clone(),f=Lb(s.fieldTransforms,u,a);return h.setAll(f),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof rl?(function(s,a,c,u){if(!bm(s.precondition,a))return c;const h=Lb(s.fieldTransforms,u,a),f=a.data;return f.setAll(ZD(s)),f.setAll(h),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((m=>m.field)))})(n,e,t,r):(function(s,a,c){return bm(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function iG(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=$D(r.transform,i||null);s!=null&&(t===null&&(t=ui.empty()),t.set(r.field,s))}return t||null}function Ib(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Vu(r,i,((s,a)=>tG(s,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class uf extends Xg{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class rl extends Xg{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function ZD(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function Db(n,e,t){const r=new Map;on(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,c=e.data.field(s.field);r.set(s.field,eG(a,c,t[i]))}return r}function Lb(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,JH(s,a,e))}return r}class OS extends Xg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sG extends Xg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class oG{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&rG(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=bd(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=bd(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=GD();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let c=this.applyToLocalView(a,s.mutatedFields);c=t.has(i.key)?null:c;const u=YD(a,c);u!==null&&r.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(Rt.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),qt())}isEqual(e){return this.batchId===e.batchId&&Vu(this.mutations,e.mutations,((t,r)=>Ib(t,r)))&&Vu(this.baseMutations,e.baseMutations,((t,r)=>Ib(t,r)))}}class kS{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){on(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return KH})();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new kS(e,t,r,i)}}class aG{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class lG{constructor(e,t){this.count=e,this.unchangedNames=t}}var Zn,Zt;function cG(n){switch(n){case Te.OK:return St(64938);case Te.CANCELLED:case Te.UNKNOWN:case Te.DEADLINE_EXCEEDED:case Te.RESOURCE_EXHAUSTED:case Te.INTERNAL:case Te.UNAVAILABLE:case Te.UNAUTHENTICATED:return!1;case Te.INVALID_ARGUMENT:case Te.NOT_FOUND:case Te.ALREADY_EXISTS:case Te.PERMISSION_DENIED:case Te.FAILED_PRECONDITION:case Te.ABORTED:case Te.OUT_OF_RANGE:case Te.UNIMPLEMENTED:case Te.DATA_LOSS:return!0;default:return St(15467,{code:n})}}function QD(n){if(n===void 0)return Bo("GRPC error has no .code"),Te.UNKNOWN;switch(n){case Zn.OK:return Te.OK;case Zn.CANCELLED:return Te.CANCELLED;case Zn.UNKNOWN:return Te.UNKNOWN;case Zn.DEADLINE_EXCEEDED:return Te.DEADLINE_EXCEEDED;case Zn.RESOURCE_EXHAUSTED:return Te.RESOURCE_EXHAUSTED;case Zn.INTERNAL:return Te.INTERNAL;case Zn.UNAVAILABLE:return Te.UNAVAILABLE;case Zn.UNAUTHENTICATED:return Te.UNAUTHENTICATED;case Zn.INVALID_ARGUMENT:return Te.INVALID_ARGUMENT;case Zn.NOT_FOUND:return Te.NOT_FOUND;case Zn.ALREADY_EXISTS:return Te.ALREADY_EXISTS;case Zn.PERMISSION_DENIED:return Te.PERMISSION_DENIED;case Zn.FAILED_PRECONDITION:return Te.FAILED_PRECONDITION;case Zn.ABORTED:return Te.ABORTED;case Zn.OUT_OF_RANGE:return Te.OUT_OF_RANGE;case Zn.UNIMPLEMENTED:return Te.UNIMPLEMENTED;case Zn.DATA_LOSS:return Te.DATA_LOSS;default:return St(39323,{code:n})}}(Zt=Zn||(Zn={}))[Zt.OK=0]="OK",Zt[Zt.CANCELLED=1]="CANCELLED",Zt[Zt.UNKNOWN=2]="UNKNOWN",Zt[Zt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zt[Zt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zt[Zt.NOT_FOUND=5]="NOT_FOUND",Zt[Zt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zt[Zt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zt[Zt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zt[Zt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zt[Zt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zt[Zt.ABORTED=10]="ABORTED",Zt[Zt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zt[Zt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zt[Zt.INTERNAL=13]="INTERNAL",Zt[Zt.UNAVAILABLE=14]="UNAVAILABLE",Zt[Zt.DATA_LOSS=15]="DATA_LOSS";function uG(){return new TextEncoder}const hG=new Ua([4294967295,4294967295],0);function Nb(n){const e=uG().encode(n),t=new dD;return t.update(e),new Uint8Array(t.digest())}function Ob(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ua([t,r],0),new Ua([i,s],0)]}class US{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new fd(`Invalid padding: ${t}`);if(r<0)throw new fd(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new fd(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new fd(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ua.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Ua.fromNumber(r)));return i.compare(hG)===1&&(i=new Ua([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Nb(e),[r,i]=Ob(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new US(s,i,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.ge===0)return;const t=Nb(e),[r,i]=Ob(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class fd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Kg{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,hf.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Kg(Rt.min(),i,new Pn($t),Ho(),qt())}}class hf{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new hf(r,t,qt(),qt(),qt())}}class Rm{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class JD{constructor(e,t){this.targetId=e,this.Ce=t}}class e2{constructor(e,t,r=wr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class kb{constructor(){this.ve=0,this.Fe=Ub(),this.Me=wr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=qt(),t=qt(),r=qt();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:St(38017,{changeType:s})}})),new hf(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Ub()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,on(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class dG{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ho(),this.Je=Pp(),this.He=Pp(),this.Ye=new Pn($t)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:St(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(Y0(s))if(r===0){const a=new pt(s.path);this.et(t,a,Fr.newNoDocument(a,Rt.min()))}else on(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const c=this.ut(e),u=c?this.ct(c,e,a):1;if(u!==0){this.it(t);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,c;try{a=Xa(r).toUint8Array()}catch(u){if(u instanceof wD)return Fu("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new US(a,i,s)}catch(u){return Fu(u instanceof fd?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((s=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const c=this.ot(a);if(c){if(s.current&&Y0(c.target)){const u=new pt(c.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,Fr.newNoDocument(u,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let r=qt();this.He.forEach(((s,a)=>{let c=!0;a.forEachWhile((u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new Kg(e,t,this.Ye,this.je,r);return this.je=Ho(),this.Je=Pp(),this.He=Pp(),this.Ye=new Pn($t),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new kb,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new rr($t),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new rr($t),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ze("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new kb),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Pp(){return new Pn(pt.comparator)}function Ub(){return new Pn(pt.comparator)}const fG={asc:"ASCENDING",desc:"DESCENDING"},pG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mG={and:"AND",or:"OR"};class gG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Q0(n,e){return n.useProto3Json||Bg(e)?e:{value:e}}function eg(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function t2(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function _G(n,e){return eg(n,e.toTimestamp())}function Ys(n){return on(!!n,49232),Rt.fromTimestamp((function(t){const r=qa(t);return new yn(r.seconds,r.nanos)})(n))}function FS(n,e){return J0(n,e).canonicalString()}function J0(n,e){const t=(function(i){return new pn(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function n2(n){const e=pn.fromString(n);return on(a2(e),10190,{key:e.toString()}),e}function eE(n,e){return FS(n.databaseId,e.path)}function _y(n,e){const t=n2(e);if(t.get(1)!==n.databaseId.projectId)throw new qe(Te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new qe(Te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new pt(i2(t))}function r2(n,e){return FS(n.databaseId,e)}function vG(n){const e=n2(n);return e.length===4?pn.emptyPath():i2(e)}function tE(n){return new pn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function i2(n){return on(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Fb(n,e,t){return{name:eE(n,e),fields:t.value.mapValue.fields}}function yG(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:St(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(h,f){return h.useProto3Json?(on(f===void 0||typeof f=="string",58123),wr.fromBase64String(f||"")):(on(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),wr.fromUint8Array(f||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(h){const f=h.code===void 0?Te.UNKNOWN:QD(h.code);return new qe(f,h.message||"")})(a);t=new e2(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=_y(n,r.document.name),s=Ys(r.document.updateTime),a=r.document.createTime?Ys(r.document.createTime):Rt.min(),c=new ui({mapValue:{fields:r.document.fields}}),u=Fr.newFoundDocument(i,s,a,c),h=r.targetIds||[],f=r.removedTargetIds||[];t=new Rm(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=_y(n,r.document),s=r.readTime?Ys(r.readTime):Rt.min(),a=Fr.newNoDocument(i,s),c=r.removedTargetIds||[];t=new Rm([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=_y(n,r.document),s=r.removedTargetIds||[];t=new Rm([],s,i,null)}else{if(!("filter"in e))return St(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new lG(i,s),c=r.targetId;t=new JD(c,a)}}return t}function EG(n,e){let t;if(e instanceof uf)t={update:Fb(n,e.key,e.value)};else if(e instanceof OS)t={delete:eE(n,e.key)};else if(e instanceof rl)t={update:Fb(n,e.key,e.data),updateMask:CG(e.fieldMask)};else{if(!(e instanceof sG))return St(16599,{Vt:e.type});t={verify:eE(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,a){const c=a.transform;if(c instanceof jd)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Hu)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Gu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Wd)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw St(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:_G(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:St(27497)})(n,e.precondition)),t}function SG(n,e){return n&&n.length>0?(on(e!==void 0,14353),n.map((t=>(function(i,s){let a=i.updateTime?Ys(i.updateTime):Ys(s);return a.isEqual(Rt.min())&&(a=Ys(s)),new nG(a,i.transformResults||[])})(t,e)))):[]}function TG(n,e){return{documents:[r2(n,e.path)]}}function xG(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=r2(n,i);const s=(function(h){if(h.length!==0)return o2(_s.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(h){if(h.length!==0)return h.map((f=>(function(_){return{field:mu(_.field),direction:MG(_.dir)}})(f)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=Q0(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:i}}function wG(n){let e=vG(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){on(r===1,65062);const f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(m){const _=s2(m);return _ instanceof _s&&ND(_)?_.getFilters():[_]})(t.where));let a=[];t.orderBy&&(a=(function(m){return m.map((_=>(function(T){return new Gd(gu(T.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(_)))})(t.orderBy));let c=null;t.limit&&(c=(function(m){let _;return _=typeof m=="object"?m.value:m,Bg(_)?null:_})(t.limit));let u=null;t.startAt&&(u=(function(m){const _=!!m.before,v=m.values||[];return new Qm(v,_)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const _=!m.before,v=m.values||[];return new Qm(v,_)})(t.endAt)),jH(e,i,a,s,c,"F",u,h)}function AG(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return St(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function s2(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=gu(t.unaryFilter.field);return Qn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=gu(t.unaryFilter.field);return Qn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=gu(t.unaryFilter.field);return Qn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=gu(t.unaryFilter.field);return Qn.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return St(61313);default:return St(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Qn.create(gu(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return St(58110);default:return St(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return _s.create(t.compositeFilter.filters.map((r=>s2(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return St(1026)}})(t.compositeFilter.op))})(n):St(30097,{filter:n})}function MG(n){return fG[n]}function bG(n){return pG[n]}function RG(n){return mG[n]}function mu(n){return{fieldPath:n.canonicalString()}}function gu(n){return xr.fromServerFormat(n.fieldPath)}function o2(n){return n instanceof Qn?(function(t){if(t.op==="=="){if(Ab(t.value))return{unaryFilter:{field:mu(t.field),op:"IS_NAN"}};if(wb(t.value))return{unaryFilter:{field:mu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ab(t.value))return{unaryFilter:{field:mu(t.field),op:"IS_NOT_NAN"}};if(wb(t.value))return{unaryFilter:{field:mu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mu(t.field),op:bG(t.op),value:t.value}}})(n):n instanceof _s?(function(t){const r=t.getFilters().map((i=>o2(i)));return r.length===1?r[0]:{compositeFilter:{op:RG(t.op),filters:r}}})(n):St(54877,{filter:n})}function CG(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function a2(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Da{constructor(e,t,r,i,s=Rt.min(),a=Rt.min(),c=wr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Da(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class PG{constructor(e){this.yt=e}}function IG(n){const e=wG({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Jm(e,e.limit,"L"):e}class DG{constructor(){this.Cn=new LG}addToCollectionParentIndex(e,t){return this.Cn.add(t),xe.resolve()}getCollectionParents(e,t){return xe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return xe.resolve()}deleteFieldIndex(e,t){return xe.resolve()}deleteAllFieldIndexes(e){return xe.resolve()}createTargetIndexes(e,t){return xe.resolve()}getDocumentsMatchingTarget(e,t){return xe.resolve(null)}getIndexType(e,t){return xe.resolve(0)}getFieldIndexes(e,t){return xe.resolve([])}getNextCollectionGroupToUpdate(e){return xe.resolve(null)}getMinOffset(e,t){return xe.resolve($a.min())}getMinOffsetFromCollectionGroup(e,t){return xe.resolve($a.min())}updateCollectionGroup(e,t,r){return xe.resolve()}updateIndexEntries(e,t){return xe.resolve()}}class LG{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new rr(pn.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new rr(pn.comparator)).toArray()}}const Vb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},l2=41943040;class ai{static withCacheSize(e){return new ai(e,ai.DEFAULT_COLLECTION_PERCENTILE,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}ai.DEFAULT_COLLECTION_PERCENTILE=10,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ai.DEFAULT=new ai(l2,ai.DEFAULT_COLLECTION_PERCENTILE,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ai.DISABLED=new ai(-1,0,0);class ju{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ju(0)}static cr(){return new ju(-1)}}const zb="LruGarbageCollector",NG=1048576;function Bb([n,e],[t,r]){const i=$t(n,t);return i===0?$t(e,r):i}class OG{constructor(e){this.Ir=e,this.buffer=new rr(Bb),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Bb(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class kG{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ze(zb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){rh(t)?Ze(zb,"Ignoring IndexedDB error during garbage collection: ",t):await nh(t)}await this.Vr(3e5)}))}}class UG{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return xe.resolve(zg.ce);const r=new OG(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ze("LruGarbageCollector","Garbage collection skipped; disabled"),xe.resolve(Vb)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Vb):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,c,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(Ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,a=Date.now(),this.nthSequenceNumber(e,i)))).next((m=>(r=m,c=Date.now(),this.removeTargets(e,r,t)))).next((m=>(s=m,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((m=>(h=Date.now(),fu()<=Wt.DEBUG&&Ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${s} targets in `+(u-c)+`ms
	Removed ${m} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),xe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m}))))}}function FG(n,e){return new UG(n,e)}class VG{constructor(){this.changes=new cc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Fr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?xe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class zG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class BG{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&bd(r.mutation,i,Mi.empty(),yn.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,qt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=qt()){const i=Vl();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let a=dd();return s.forEach(((c,u)=>{a=a.insert(c,u.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Vl();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,qt())))}populateOverlays(e,t,r){const i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,i){let s=Ho();const a=Md(),c=(function(){return Md()})();return t.forEach(((u,h)=>{const f=r.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof rl)?s=s.insert(h.key,h):f!==void 0?(a.set(h.key,f.mutation.getFieldMask()),bd(f.mutation,h,f.mutation.getFieldMask(),yn.now())):a.set(h.key,Mi.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>a.set(h,f))),t.forEach(((h,f)=>c.set(h,new zG(f,a.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=Md();let i=new Pn(((a,c)=>a-c)),s=qt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((u=>{const h=t.get(u);if(h===null)return;let f=r.get(u)||Mi.empty();f=c.applyToLocalView(h,f),r.set(u,f);const m=(i.get(c.batchId)||qt()).add(u);i=i.insert(c.batchId,m)}))})).next((()=>{const a=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,f=u.value,m=GD();f.forEach((_=>{if(!s.has(_)){const v=YD(t.get(_),r.get(_));v!==null&&m.set(_,v),s=s.add(_)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return xe.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return pt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):FD(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):xe.resolve(Vl());let c=Vd,u=s;return a.next((h=>xe.forEach(h,((f,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),s.get(f)?xe.resolve():this.remoteDocumentCache.getEntry(e,f).next((_=>{u=u.insert(f,_)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,qt()))).next((f=>({batchId:c,changes:HD(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pt(t)).next((r=>{let i=dd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=dd();return this.indexManager.getCollectionParents(e,s).next((c=>xe.forEach(c,(u=>{const h=(function(m,_){return new ih(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next((f=>{f.forEach(((m,_)=>{a=a.insert(m,_)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((a=>{s.forEach(((u,h)=>{const f=h.getKey();a.get(f)===null&&(a=a.insert(f,Fr.newInvalidDocument(f)))}));let c=dd();return a.forEach(((u,h)=>{const f=s.get(u);f!==void 0&&bd(f.mutation,h,Mi.empty(),yn.now()),Wg(t,h)&&(c=c.insert(u,h))})),c}))}}class HG{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return xe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Ys(i.createTime)}})(t)),xe.resolve()}getNamedQuery(e,t){return xe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:IG(i.bundledQuery),readTime:Ys(i.readTime)}})(t)),xe.resolve()}}class GG{constructor(){this.overlays=new Pn(pt.comparator),this.qr=new Map}getOverlay(e,t){return xe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Vl();return xe.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),xe.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),xe.resolve()}getOverlaysForCollection(e,t,r){const i=Vl(),s=t.length+1,a=new pt(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return xe.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Pn(((h,f)=>h-f));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let f=s.get(h.largestBatchId);f===null&&(f=Vl(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const c=Vl(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>c.set(h,f))),!(c.size()>=i)););return xe.resolve(c)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new aG(t,r));let s=this.qr.get(t);s===void 0&&(s=qt(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}class jG{constructor(){this.sessionToken=wr.EMPTY_BYTE_STRING}getSessionToken(e){return xe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,xe.resolve()}}class VS{constructor(){this.Qr=new rr(dr.$r),this.Ur=new rr(dr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new dr(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new dr(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new pt(new pn([])),r=new dr(t,e),i=new dr(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new pt(new pn([])),r=new dr(t,e),i=new dr(t,e+1);let s=qt();return this.Ur.forEachInRange([r,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new dr(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class dr{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return pt.comparator(e.key,t.key)||$t(e.Yr,t.Yr)}static Kr(e,t){return $t(e.Yr,t.Yr)||pt.comparator(e.key,t.key)}}class WG{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new rr(dr.$r)}checkEmpty(e){return xe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new oG(s,t,r,i);this.mutationQueue.push(a);for(const c of i)this.Zr=this.Zr.add(new dr(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return xe.resolve(a)}lookupMutationBatch(e,t){return xe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return xe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return xe.resolve(this.mutationQueue.length===0?CS:this.tr-1)}getAllMutationBatches(e){return xe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new dr(t,0),i=new dr(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(a=>{const c=this.Xr(a.Yr);s.push(c)})),xe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new rr($t);return t.forEach((i=>{const s=new dr(i,0),a=new dr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(c=>{r=r.add(c.Yr)}))})),xe.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;pt.isDocumentKey(s)||(s=s.child(""));const a=new dr(new pt(s),0);let c=new rr($t);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Yr)),!0)}),a),xe.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){on(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return xe.forEach(t.mutations,(i=>{const s=new dr(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new dr(t,0),i=this.Zr.firstAfterOrEqual(r);return xe.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,xe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class $G{constructor(e){this.ri=e,this.docs=(function(){return new Pn(pt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return xe.resolve(r?r.document.mutableCopy():Fr.newInvalidDocument(t))}getEntries(e,t){let r=Ho();return t.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Fr.newInvalidDocument(i))})),xe.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ho();const a=t.path,c=new pt(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||TH(SH(f),r)<=0||(i.has(f.key)||Wg(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return xe.resolve(s)}getAllFromCollectionGroup(e,t,r,i){St(9500)}ii(e,t){return xe.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new qG(this)}getSize(e){return xe.resolve(this.size)}}class qG extends VG{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),xe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class XG{constructor(e){this.persistence=e,this.si=new cc((t=>DS(t)),LS),this.lastRemoteSnapshotVersion=Rt.min(),this.highestTargetId=0,this.oi=0,this._i=new VS,this.targetCount=0,this.ai=ju.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),xe.resolve()}getLastRemoteSnapshotVersion(e){return xe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return xe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),xe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),xe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ju(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,xe.resolve()}updateTargetData(e,t){return this.Pr(t),xe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,xe.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),xe.waitFor(s).next((()=>i))}getTargetCount(e){return xe.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return xe.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),xe.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),xe.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),xe.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return xe.resolve(r)}containsKey(e,t){return xe.resolve(this._i.containsKey(t))}}class c2{constructor(e,t){this.ui={},this.overlays={},this.ci=new zg(0),this.li=!1,this.li=!0,this.hi=new jG,this.referenceDelegate=e(this),this.Pi=new XG(this),this.indexManager=new DG,this.remoteDocumentCache=(function(i){return new $G(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new PG(t),this.Ii=new HG(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new GG,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new WG(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Ze("MemoryPersistence","Starting transaction:",e);const i=new KG(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return xe.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class KG extends wH{constructor(e){super(),this.currentSequenceNumber=e}}class zS{constructor(e){this.persistence=e,this.Ri=new VS,this.Vi=null}static mi(e){return new zS(e)}get fi(){if(this.Vi)return this.Vi;throw St(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),xe.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),xe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),xe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xe.forEach(this.fi,(r=>{const i=pt.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,Rt.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return xe.or([()=>xe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class tg{constructor(e,t){this.persistence=e,this.pi=new cc((r=>bH(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=FG(this,t)}static mi(e,t){return new tg(e,t)}Ei(){}di(e){return xe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return xe.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?xe.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((c=>{c||(r++,s.removeEntry(a,Rt.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),xe.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),xe.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),xe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),xe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Am(e.data.value)),t}br(e,t,r){return xe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return xe.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class BS{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=qt(),i=qt();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new BS(e,t.fromCache,r,i)}}class YG{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class ZG{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Tz()?8:AH(Br())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new YG;return this.Ss(e,t,a).next((c=>{if(s.result=c,this.Vs)return this.bs(e,t,a,c.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(fu()<=Wt.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",pu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),xe.resolve()):(fu()<=Wt.DEBUG&&Ze("QueryEngine","Query:",pu(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(fu()<=Wt.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",pu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ks(t))):xe.resolve())}ys(e,t){if(Cb(t))return xe.resolve(null);let r=Ks(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Jm(t,null,"F"),r=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const a=qt(...s);return this.ps.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{const h=this.Ds(t,c);return this.Cs(t,h,a,u.readTime)?this.ys(e,Jm(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,r,i){return Cb(t)||i.isEqual(Rt.min())?xe.resolve(null):this.ps.getDocuments(e,r).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?xe.resolve(null):(fu()<=Wt.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),pu(t)),this.vs(e,a,t,EH(i,Vd)).next((c=>c)))}))}Ds(e,t){let r=new rr(zD(e));return t.forEach(((i,s)=>{Wg(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return fu()<=Wt.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",pu(t)),this.ps.getDocumentsMatchingQuery(e,t,$a.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}const HS="LocalStore",QG=3e8;class JG{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Pn($t),this.xs=new cc((s=>DS(s)),LS),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new BG(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function e9(n,e,t,r){return new JG(n,e,t,r)}async function u2(n,e){const t=Pt(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{const a=[],c=[];let u=qt();for(const h of i){a.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){c.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(r,u).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:c})))}))}))}function t9(n,e){const t=Pt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,h,f){const m=h.batch,_=m.keys();let v=xe.resolve();return _.forEach((T=>{v=v.next((()=>f.getEntry(u,T))).next((A=>{const E=h.docVersions.get(T);on(E!==null,48541),A.version.compareTo(E)<0&&(m.applyToRemoteDocument(A,h),A.isValidDocument()&&(A.setReadTime(h.commitVersion),f.addEntry(A)))}))})),v.next((()=>c.mutationQueue.removeMutationBatch(u,m)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=qt();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function h2(n){const e=Pt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function n9(n,e){const t=Pt(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const c=[];e.targetChanges.forEach(((f,m)=>{const _=i.get(m);if(!_)return;c.push(t.Pi.removeMatchingKeys(s,f.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(s,f.addedDocuments,m))));let v=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?v=v.withResumeToken(wr.EMPTY_BYTE_STRING,Rt.min()).withLastLimboFreeSnapshotVersion(Rt.min()):f.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(f.resumeToken,r)),i=i.insert(m,v),(function(A,E,S){return A.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=QG?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0})(_,v,f)&&c.push(t.Pi.updateTargetData(s,v))}));let u=Ho(),h=qt();if(e.documentUpdates.forEach((f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))})),c.push(r9(s,a,e.documentUpdates).next((f=>{u=f.ks,h=f.qs}))),!r.isEqual(Rt.min())){const f=t.Pi.getLastRemoteSnapshotVersion(s).next((m=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));c.push(f)}return xe.waitFor(c).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,u,h))).next((()=>u))})).then((s=>(t.Ms=i,s)))}function r9(n,e,t){let r=qt(),i=qt();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let a=Ho();return t.forEach(((c,u)=>{const h=s.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(Rt.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):Ze(HS,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)})),{ks:a,qs:i}}))}function i9(n,e){const t=Pt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=CS),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function s9(n,e){const t=Pt(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,xe.resolve(i)):t.Pi.allocateTargetId(r).next((a=>(i=new Da(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function nE(n,e,t){const r=Pt(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!rh(a))throw a;Ze(HS,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Hb(n,e,t){const r=Pt(n);let i=Rt.min(),s=qt();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(u,h,f){const m=Pt(u),_=m.xs.get(f);return _!==void 0?xe.resolve(m.Ms.get(_)):m.Pi.getTargetData(h,f)})(r,a,Ks(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next((u=>{s=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Rt.min(),t?s:qt()))).next((c=>(o9(r,$H(e),c),{documents:c,Qs:s})))))}function o9(n,e,t){let r=n.Os.get(e)||Rt.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}class Gb{constructor(){this.activeTargetIds=QH()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class a9{constructor(){this.Mo=new Gb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Gb,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class l9{Oo(e){}shutdown(){}}const jb="ConnectivityMonitor";class Wb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ze(jb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ze(jb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Ip=null;function rE(){return Ip===null?Ip=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ip++,"0x"+Ip.toString(16)}const vy="RestConnection",c9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class u9{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===Ym?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=rE(),c=this.zo(e,t.toUriEncodedString());Ze(vy,`Sending RPC '${e}' ${a}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,s);const{host:h}=new URL(c),f=el(h);return this.Jo(e,c,u,r,f).then((m=>(Ze(vy,`Received RPC '${e}' ${a}: `,m),m)),(m=>{throw Fu(vy,`RPC '${e}' ${a} failed with error: `,m,"url: ",c,"request:",r),m}))}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+th})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const r=c9[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class h9{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Lr="WebChannelConnection";class d9 extends u9{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=rE();return new Promise(((c,u)=>{const h=new fD;h.setWithCredentials(!0),h.listenOnce(pD.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case wm.NO_ERROR:const m=h.getResponseJson();Ze(Lr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),c(m);break;case wm.TIMEOUT:Ze(Lr,`RPC '${e}' ${a} timed out`),u(new qe(Te.DEADLINE_EXCEEDED,"Request time out"));break;case wm.HTTP_ERROR:const _=h.getStatus();if(Ze(Lr,`RPC '${e}' ${a} failed with status:`,_,"response text:",h.getResponseText()),_>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const T=v?.error;if(T&&T.status&&T.message){const A=(function(S){const D=S.toLowerCase().replace(/_/g,"-");return Object.values(Te).indexOf(D)>=0?D:Te.UNKNOWN})(T.status);u(new qe(A,T.message))}else u(new qe(Te.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new qe(Te.UNAVAILABLE,"Connection failed."));break;default:St(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Ze(Lr,`RPC '${e}' ${a} completed.`)}}));const f=JSON.stringify(i);Ze(Lr,`RPC '${e}' ${a} sending request:`,i),h.send(t,"POST",f,r,15)}))}T_(e,t,r){const i=rE(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=_D(),c=gD(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const f=s.join("");Ze(Lr,`Creating RPC '${e}' stream ${i}: ${f}`,u);const m=a.createWebChannel(f,u);this.I_(m);let _=!1,v=!1;const T=new h9({Yo:E=>{v?Ze(Lr,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(_||(Ze(Lr,`Opening RPC '${e}' stream ${i} transport.`),m.open(),_=!0),Ze(Lr,`RPC '${e}' stream ${i} sending:`,E),m.send(E))},Zo:()=>m.close()}),A=(E,S,D)=>{E.listen(S,(b=>{try{D(b)}catch(k){setTimeout((()=>{throw k}),0)}}))};return A(m,hd.EventType.OPEN,(()=>{v||(Ze(Lr,`RPC '${e}' stream ${i} transport opened.`),T.o_())})),A(m,hd.EventType.CLOSE,(()=>{v||(v=!0,Ze(Lr,`RPC '${e}' stream ${i} transport closed`),T.a_(),this.E_(m))})),A(m,hd.EventType.ERROR,(E=>{v||(v=!0,Fu(Lr,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),T.a_(new qe(Te.UNAVAILABLE,"The operation could not be completed")))})),A(m,hd.EventType.MESSAGE,(E=>{if(!v){const S=E.data[0];on(!!S,16349);const D=S,b=D?.error||D[0]?.error;if(b){Ze(Lr,`RPC '${e}' stream ${i} received error:`,b);const k=b.status;let V=(function(I){const M=Zn[I];if(M!==void 0)return QD(M)})(k),H=b.message;V===void 0&&(V=Te.INTERNAL,H="Unknown error status: "+k+" with message "+b.message),v=!0,T.a_(new qe(V,H)),m.close()}else Ze(Lr,`RPC '${e}' stream ${i} received:`,S),T.u_(S)}})),A(c,mD.STAT_EVENT,(E=>{E.stat===W0.PROXY?Ze(Lr,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===W0.NOPROXY&&Ze(Lr,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{T.__()}),0),T}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function yy(){return typeof document<"u"?document:null}function Yg(n){return new gG(n,!0)}class d2{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&Ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const $b="PersistentStream";class f2{constructor(e,t,r,i,s,a,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new d2(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Te.RESOURCE_EXHAUSTED?(Bo(t.toString()),Bo("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new qe(Te.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ze($b,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ze($b,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class f9 extends f2{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=yG(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Rt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Rt.min():a.readTime?Ys(a.readTime):Rt.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=tE(this.serializer),t.addTarget=(function(s,a){let c;const u=a.target;if(c=Y0(u)?{documents:TG(s,u)}:{query:xG(s,u).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=t2(s,a.resumeToken);const h=Q0(s,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(Rt.min())>0){c.readTime=eg(s,a.snapshotVersion.toTimestamp());const h=Q0(s,a.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const r=AG(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=tE(this.serializer),t.removeTarget=e,this.q_(t)}}class p9 extends f2{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return on(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,on(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){on(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=SG(e.writeResults,e.commitTime),r=Ys(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=tE(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>EG(this.serializer,r)))};this.q_(t)}}class m9{}class g9 extends m9{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new qe(Te.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,J0(t,r),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new qe(Te.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Ho(e,J0(t,r),i,a,c,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new qe(Te.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class _9{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Bo(t),this.aa=!1):Ze("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Jl="RemoteStore";class v9{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{uc(this)&&(Ze(Jl,"Restarting streams for network reachability change."),await(async function(u){const h=Pt(u);h.Ea.add(4),await df(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Zg(h)})(this))}))})),this.Ra=new _9(r,i)}}async function Zg(n){if(uc(n))for(const e of n.da)await e(!0)}async function df(n){for(const e of n.da)await e(!1)}function p2(n,e){const t=Pt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),$S(t)?WS(t):sh(t).O_()&&jS(t,e))}function GS(n,e){const t=Pt(n),r=sh(t);t.Ia.delete(e),r.O_()&&m2(t,e),t.Ia.size===0&&(r.O_()?r.L_():uc(t)&&t.Ra.set("Unknown"))}function jS(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Rt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}sh(n).Y_(e)}function m2(n,e){n.Va.Ue(e),sh(n).Z_(e)}function WS(n){n.Va=new dG({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),sh(n).start(),n.Ra.ua()}function $S(n){return uc(n)&&!sh(n).x_()&&n.Ia.size>0}function uc(n){return Pt(n).Ea.size===0}function g2(n){n.Va=void 0}async function y9(n){n.Ra.set("Online")}async function E9(n){n.Ia.forEach(((e,t)=>{jS(n,e)}))}async function S9(n,e){g2(n),$S(n)?(n.Ra.ha(e),WS(n)):n.Ra.set("Unknown")}async function T9(n,e,t){if(n.Ra.set("Online"),e instanceof e2&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const c of s.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,a),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){Ze(Jl,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ng(n,r)}else if(e instanceof Rm?n.Va.Ze(e):e instanceof JD?n.Va.st(e):n.Va.tt(e),!t.isEqual(Rt.min()))try{const r=await h2(n.localStore);t.compareTo(r)>=0&&await(function(s,a){const c=s.Va.Tt(a);return c.targetChanges.forEach(((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const f=s.Ia.get(h);f&&s.Ia.set(h,f.withResumeToken(u.resumeToken,a))}})),c.targetMismatches.forEach(((u,h)=>{const f=s.Ia.get(u);if(!f)return;s.Ia.set(u,f.withResumeToken(wr.EMPTY_BYTE_STRING,f.snapshotVersion)),m2(s,u);const m=new Da(f.target,u,h,f.sequenceNumber);jS(s,m)})),s.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){Ze(Jl,"Failed to raise snapshot:",r),await ng(n,r)}}async function ng(n,e,t){if(!rh(e))throw e;n.Ea.add(1),await df(n),n.Ra.set("Offline"),t||(t=()=>h2(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ze(Jl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Zg(n)}))}function _2(n,e){return e().catch((t=>ng(n,t,e)))}async function Qg(n){const e=Pt(n),t=Ya(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:CS;for(;x9(e);)try{const i=await i9(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,w9(e,i)}catch(i){await ng(e,i)}v2(e)&&y2(e)}function x9(n){return uc(n)&&n.Ta.length<10}function w9(n,e){n.Ta.push(e);const t=Ya(n);t.O_()&&t.X_&&t.ea(e.mutations)}function v2(n){return uc(n)&&!Ya(n).x_()&&n.Ta.length>0}function y2(n){Ya(n).start()}async function A9(n){Ya(n).ra()}async function M9(n){const e=Ya(n);for(const t of n.Ta)e.ea(t.mutations)}async function b9(n,e,t){const r=n.Ta.shift(),i=kS.from(r,e,t);await _2(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Qg(n)}async function R9(n,e){e&&Ya(n).X_&&await(async function(r,i){if((function(a){return cG(a)&&a!==Te.ABORTED})(i.code)){const s=r.Ta.shift();Ya(r).B_(),await _2(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await Qg(r)}})(n,e),v2(n)&&y2(n)}async function qb(n,e){const t=Pt(n);t.asyncQueue.verifyOperationInProgress(),Ze(Jl,"RemoteStore received new credentials");const r=uc(t);t.Ea.add(3),await df(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Zg(t)}async function C9(n,e){const t=Pt(n);e?(t.Ea.delete(2),await Zg(t)):e||(t.Ea.add(2),await df(t),t.Ra.set("Unknown"))}function sh(n){return n.ma||(n.ma=(function(t,r,i){const s=Pt(t);return s.sa(),new f9(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:y9.bind(null,n),t_:E9.bind(null,n),r_:S9.bind(null,n),H_:T9.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),$S(n)?WS(n):n.Ra.set("Unknown")):(await n.ma.stop(),g2(n))}))),n.ma}function Ya(n){return n.fa||(n.fa=(function(t,r,i){const s=Pt(t);return s.sa(),new p9(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:A9.bind(null,n),r_:R9.bind(null,n),ta:M9.bind(null,n),na:b9.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Qg(n)):(await n.fa.stop(),n.Ta.length>0&&(Ze(Jl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class qS{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Uo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,c=new qS(e,t,a,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new qe(Te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function XS(n,e){if(Bo("AsyncQueue",`${e}: ${n}`),rh(n))return new qe(Te.UNAVAILABLE,`${e}: ${n}`);throw n}class Iu{static emptySet(e){return new Iu(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||pt.comparator(t.key,r.key):(t,r)=>pt.comparator(t.key,r.key),this.keyedMap=dd(),this.sortedSet=new Pn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Iu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Iu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Xb{constructor(){this.ga=new Pn(pt.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):St(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Wu{constructor(e,t,r,i,s,a,c,u,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new Wu(e,t,Iu.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&jg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class P9{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class I9{constructor(){this.queries=Kb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Pt(t),s=i.queries;i.queries=Kb(),s.forEach(((a,c)=>{for(const u of c.Sa)u.onError(r)}))})(this,new qe(Te.ABORTED,"Firestore shutting down"))}}function Kb(){return new cc((n=>VD(n)),jg)}async function KS(n,e){const t=Pt(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new P9,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const c=XS(a,`Initialization of query '${pu(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&ZS(t)}async function YS(n,e){const t=Pt(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function D9(n,e){const t=Pt(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const c of a.Sa)c.Fa(i)&&(r=!0);a.wa=i}}r&&ZS(t)}function L9(n,e,t){const r=Pt(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function ZS(n){n.Ca.forEach((e=>{e.next()}))}var iE,Yb;(Yb=iE||(iE={})).Ma="default",Yb.Cache="cache";class QS{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Wu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Wu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==iE.Cache}}class E2{constructor(e){this.key=e}}class S2{constructor(e){this.key=e}}class N9{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=qt(),this.mutatedKeys=qt(),this.eu=zD(e),this.tu=new Iu(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Xb,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((f,m)=>{const _=i.get(f),v=Wg(this.query,m)?m:null,T=!!_&&this.mutatedKeys.has(_.key),A=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let E=!1;_&&v?_.data.isEqual(v.data)?T!==A&&(r.track({type:3,doc:v}),E=!0):this.su(_,v)||(r.track({type:2,doc:v}),E=!0,(u&&this.eu(v,u)>0||h&&this.eu(v,h)<0)&&(c=!0)):!_&&v?(r.track({type:0,doc:v}),E=!0):_&&!v&&(r.track({type:1,doc:_}),E=!0,(u||h)&&(c=!0)),E&&(v?(a=a.add(v),s=A?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{tu:a,iu:r,Cs:c,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((f,m)=>(function(v,T){const A=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return St(20277,{Rt:E})}};return A(v)-A(T)})(f.type,m.type)||this.eu(f.doc,m.doc))),this.ou(r),i=i??!1;const c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,h=u!==this.Za;return this.Za=u,a.length!==0||h?{snapshot:new Wu(this.query,e.tu,s,a,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Xb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=qt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new S2(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new E2(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=qt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Wu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const JS="SyncEngine";class O9{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class k9{constructor(e){this.key=e,this.hu=!1}}class U9{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new cc((c=>VD(c)),jg),this.Iu=new Map,this.Eu=new Set,this.du=new Pn(pt.comparator),this.Au=new Map,this.Ru=new VS,this.Vu={},this.mu=new Map,this.fu=ju.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function F9(n,e,t=!0){const r=b2(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await T2(r,e,t,!0),i}async function V9(n,e){const t=b2(n);await T2(t,e,!0,!1)}async function T2(n,e,t,r){const i=await s9(n.localStore,Ks(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let c;return r&&(c=await z9(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&p2(n.remoteStore,i),c}async function z9(n,e,t,r,i){n.pu=(m,_,v)=>(async function(A,E,S,D){let b=E.view.ru(S);b.Cs&&(b=await Hb(A.localStore,E.query,!1).then((({documents:P})=>E.view.ru(P,b))));const k=D&&D.targetChanges.get(E.targetId),V=D&&D.targetMismatches.get(E.targetId)!=null,H=E.view.applyChanges(b,A.isPrimaryClient,k,V);return Qb(A,E.targetId,H.au),H.snapshot})(n,m,_,v);const s=await Hb(n.localStore,e,!0),a=new N9(e,s.Qs),c=a.ru(s.documents),u=hf.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=a.applyChanges(c,n.isPrimaryClient,u);Qb(n,t,h.au);const f=new O9(e,t,a);return n.Tu.set(e,f),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function B9(n,e,t){const r=Pt(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((a=>!jg(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await nE(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&GS(r.remoteStore,i.targetId),sE(r,i.targetId)})).catch(nh)):(sE(r,i.targetId),await nE(r.localStore,i.targetId,!0))}async function H9(n,e){const t=Pt(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),GS(t.remoteStore,r.targetId))}async function G9(n,e,t){const r=Y9(n);try{const i=await(function(a,c){const u=Pt(a),h=yn.now(),f=c.reduce(((v,T)=>v.add(T.key)),qt());let m,_;return u.persistence.runTransaction("Locally write mutations","readwrite",(v=>{let T=Ho(),A=qt();return u.Ns.getEntries(v,f).next((E=>{T=E,T.forEach(((S,D)=>{D.isValidDocument()||(A=A.add(S))}))})).next((()=>u.localDocuments.getOverlayedDocuments(v,T))).next((E=>{m=E;const S=[];for(const D of c){const b=iG(D,m.get(D.key).overlayedDocument);b!=null&&S.push(new rl(D.key,b,ID(b.value.mapValue),Wi.exists(!0)))}return u.mutationQueue.addMutationBatch(v,h,S,c)})).next((E=>{_=E;const S=E.applyToLocalDocumentSet(m,A);return u.documentOverlayCache.saveOverlays(v,E.batchId,S)}))})).then((()=>({batchId:_.batchId,changes:HD(m)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,c,u){let h=a.Vu[a.currentUser.toKey()];h||(h=new Pn($t)),h=h.insert(c,u),a.Vu[a.currentUser.toKey()]=h})(r,i.batchId,t),await ff(r,i.changes),await Qg(r.remoteStore)}catch(i){const s=XS(i,"Failed to persist write");t.reject(s)}}async function x2(n,e){const t=Pt(n);try{const r=await n9(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(on(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?on(a.hu,14607):i.removedDocuments.size>0&&(on(a.hu,42227),a.hu=!1))})),await ff(t,r,e)}catch(r){await nh(r)}}function Zb(n,e,t){const r=Pt(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((s,a)=>{const c=a.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(a,c){const u=Pt(a);u.onlineState=c;let h=!1;u.queries.forEach(((f,m)=>{for(const _ of m.Sa)_.va(c)&&(h=!0)})),h&&ZS(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function j9(n,e,t){const r=Pt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new Pn(pt.comparator);a=a.insert(s,Fr.newNoDocument(s,Rt.min()));const c=qt().add(s),u=new Kg(Rt.min(),new Map,new Pn($t),a,c);await x2(r,u),r.du=r.du.remove(s),r.Au.delete(e),eT(r)}else await nE(r.localStore,e,!1).then((()=>sE(r,e,t))).catch(nh)}async function W9(n,e){const t=Pt(n),r=e.batch.batchId;try{const i=await t9(t.localStore,e);A2(t,r,null),w2(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await ff(t,i)}catch(i){await nh(i)}}async function $9(n,e,t){const r=Pt(n);try{const i=await(function(a,c){const u=Pt(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next((m=>(on(m!==null,37113),f=m.keys(),u.mutationQueue.removeMutationBatch(h,m)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(r.localStore,e);A2(r,e,t),w2(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await ff(r,i)}catch(i){await nh(i)}}function w2(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function A2(n,e,t){const r=Pt(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function sE(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||M2(n,r)}))}function M2(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(GS(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),eT(n))}function Qb(n,e,t){for(const r of t)r instanceof E2?(n.Ru.addReference(r.key,e),q9(n,r)):r instanceof S2?(Ze(JS,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||M2(n,r.key)):St(19791,{wu:r})}function q9(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(Ze(JS,"New document in limbo: "+t),n.Eu.add(r),eT(n))}function eT(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new pt(pn.fromString(e)),r=n.fu.next();n.Au.set(r,new k9(t)),n.du=n.du.insert(t,r),p2(n.remoteStore,new Da(Ks(Gg(t.path)),r,"TargetPurposeLimboResolution",zg.ce))}}async function ff(n,e,t){const r=Pt(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{a.push(r.pu(u,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){i.push(h);const f=BS.As(u.targetId,h);s.push(f)}})))})),await Promise.all(a),r.Pu.H_(i),await(async function(u,h){const f=Pt(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>xe.forEach(h,(_=>xe.forEach(_.Es,(v=>f.persistence.referenceDelegate.addReference(m,_.targetId,v))).next((()=>xe.forEach(_.ds,(v=>f.persistence.referenceDelegate.removeReference(m,_.targetId,v)))))))))}catch(m){if(!rh(m))throw m;Ze(HS,"Failed to update sequence numbers: "+m)}for(const m of h){const _=m.targetId;if(!m.fromCache){const v=f.Ms.get(_),T=v.snapshotVersion,A=v.withLastLimboFreeSnapshotVersion(T);f.Ms=f.Ms.insert(_,A)}}})(r.localStore,s))}async function X9(n,e){const t=Pt(n);if(!t.currentUser.isEqual(e)){Ze(JS,"User change. New user:",e.toKey());const r=await u2(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((c=>{c.forEach((u=>{u.reject(new qe(Te.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ff(t,r.Ls)}}function K9(n,e){const t=Pt(n),r=t.Au.get(e);if(r&&r.hu)return qt().add(r.key);{let i=qt();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const c=t.Tu.get(a);i=i.unionWith(c.view.nu)}return i}}function b2(n){const e=Pt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=x2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=K9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=j9.bind(null,e),e.Pu.H_=D9.bind(null,e.eventManager),e.Pu.yu=L9.bind(null,e.eventManager),e}function Y9(n){const e=Pt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=W9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$9.bind(null,e),e}class rg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Yg(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return e9(this.persistence,new ZG,e.initialUser,this.serializer)}Cu(e){return new c2(zS.mi,this.serializer)}Du(e){return new a9}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}rg.provider={build:()=>new rg};class Z9 extends rg{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){on(this.persistence.referenceDelegate instanceof tg,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new kG(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ai.withCacheSize(this.cacheSizeBytes):ai.DEFAULT;return new c2((r=>tg.mi(r,t)),this.serializer)}}class oE{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Zb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=X9.bind(null,this.syncEngine),await C9(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new I9})()}createDatastore(e){const t=Yg(e.databaseInfo.databaseId),r=(function(s){return new d9(s)})(e.databaseInfo);return(function(s,a,c,u){return new g9(s,a,c,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,a,c){return new v9(r,i,s,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>Zb(this.syncEngine,t,0)),(function(){return Wb.v()?new Wb:new l9})())}createSyncEngine(e,t){return(function(i,s,a,c,u,h,f){const m=new U9(i,s,a,c,u,h);return f&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=Pt(t);Ze(Jl,"RemoteStore shutting down."),r.Ea.add(5),await df(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}oE.provider={build:()=>new oE};class tT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Bo("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Za="FirestoreClient";class Q9{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ur.UNAUTHENTICATED,this.clientId=RS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async a=>{Ze(Za,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(Ze(Za,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Uo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=XS(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Ey(n,e){n.asyncQueue.verifyOperationInProgress(),Ze(Za,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await u2(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Jb(n,e){n.asyncQueue.verifyOperationInProgress();const t=await J9(n);Ze(Za,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>qb(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>qb(e.remoteStore,i))),n._onlineComponents=e}async function J9(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ze(Za,"Using user provided OfflineComponentProvider");try{await Ey(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===Te.FAILED_PRECONDITION||i.code===Te.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Fu("Error using user provided cache. Falling back to memory cache: "+t),await Ey(n,new rg)}}else Ze(Za,"Using default OfflineComponentProvider"),await Ey(n,new Z9(void 0));return n._offlineComponents}async function R2(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ze(Za,"Using user provided OnlineComponentProvider"),await Jb(n,n._uninitializedComponentsProvider._online)):(Ze(Za,"Using default OnlineComponentProvider"),await Jb(n,new oE))),n._onlineComponents}function ej(n){return R2(n).then((e=>e.syncEngine))}async function ig(n){const e=await R2(n),t=e.eventManager;return t.onListen=F9.bind(null,e.syncEngine),t.onUnlisten=B9.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=V9.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=H9.bind(null,e.syncEngine),t}function tj(n,e,t={}){const r=new Uo;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,c,u,h){const f=new tT({next:_=>{f.Nu(),a.enqueueAndForget((()=>YS(s,m)));const v=_.docs.has(c);!v&&_.fromCache?h.reject(new qe(Te.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&_.fromCache&&u&&u.source==="server"?h.reject(new qe(Te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new QS(Gg(c.path),f,{includeMetadataChanges:!0,qa:!0});return KS(s,m)})(await ig(n),n.asyncQueue,e,t,r))),r.promise}function nj(n,e,t={}){const r=new Uo;return n.asyncQueue.enqueueAndForget((async()=>(function(s,a,c,u,h){const f=new tT({next:_=>{f.Nu(),a.enqueueAndForget((()=>YS(s,m))),_.fromCache&&u.source==="server"?h.reject(new qe(Te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new QS(c,f,{includeMetadataChanges:!0,qa:!0});return KS(s,m)})(await ig(n),n.asyncQueue,e,t,r))),r.promise}function C2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const e1=new Map;const P2="firestore.googleapis.com",t1=!0;class n1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new qe(Te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=P2,this.ssl=t1}else this.host=e.host,this.ssl=e.ssl??t1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=l2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<NG)throw new qe(Te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vH("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=C2(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new qe(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new qe(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new qe(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Jg{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new n1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new qe(Te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new qe(Te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new n1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new lH;switch(r.type){case"firstParty":return new dH(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new qe(Te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=e1.get(t);r&&(Ze("ComponentProvider","Removing Datastore"),e1.delete(t),r.terminate())})(this),Promise.resolve()}}function rj(n,e,t,r={}){n=di(n,Jg);const i=el(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(pS(`https://${c}`),mS("Firestore",!0)),s.host!==P2&&s.host!==c&&Fu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:c,ssl:i,emulatorOptions:r};if(!Fo(u,a)&&(n._setSettings(u),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Ur.MOCK_USER;else{h=AI(r.mockUserToken,n._app?.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new qe(Te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Ur(m)}n._authCredentials=new cH(new yD(h,f))}}class Ko{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ko(this.firestore,e,this._query)}}class kn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kn(this.firestore,e,this._key)}toJSON(){return{type:kn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(cf(t,kn._jsonSchema))return new kn(e,r||null,new pt(pn.fromString(t.referencePath)))}}kn._jsonSchemaVersion="firestore/documentReference/1.0",kn._jsonSchema={type:Jn("string",kn._jsonSchemaVersion),referencePath:Jn("string")};class Fa extends Ko{constructor(e,t,r){super(e,t,Gg(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kn(this.firestore,null,new pt(e))}withConverter(e){return new Fa(this.firestore,e,this._path)}}function Cne(n,e,...t){if(n=dn(n),ED("collection","path",e),n instanceof Jg){const r=pn.fromString(e,...t);return mb(r),new Fa(n,null,r)}{if(!(n instanceof kn||n instanceof Fa))throw new qe(Te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(pn.fromString(e,...t));return mb(r),new Fa(n.firestore,null,r)}}function zl(n,e,...t){if(n=dn(n),arguments.length===1&&(e=RS.newId()),ED("doc","path",e),n instanceof Jg){const r=pn.fromString(e,...t);return pb(r),new kn(n,null,new pt(r))}{if(!(n instanceof kn||n instanceof Fa))throw new qe(Te.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(pn.fromString(e,...t));return pb(r),new kn(n.firestore,n instanceof Fa?n.converter:null,new pt(r))}}const r1="AsyncQueue";class i1{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new d2(this,"async_queue_retry"),this._c=()=>{const r=yy();r&&Ze(r1,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=yy();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=yy();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Uo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!rh(e))throw e;Ze(r1,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Bo("INTERNAL UNHANDLED ERROR: ",s1(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=qS.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&St(47125,{Pc:s1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function s1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function o1(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}class Go extends Jg{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new i1,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new i1(e),this._firestoreClient=void 0,await e}}}function ij(n,e){const t=typeof n=="object"?n:vS(),r=typeof n=="string"?n:Ym,i=Og(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=TI("firestore");s&&rj(i,...s)}return i}function e_(n){if(n._terminated)throw new qe(Te.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||sj(n),n._firestoreClient}function sj(n){const e=n._freezeSettings(),t=(function(i,s,a,c){return new PH(i,s,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,C2(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Q9(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}class Gi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gi(wr.fromBase64String(e))}catch(t){throw new qe(Te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Gi(wr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(cf(e,Gi._jsonSchema))return Gi.fromBase64String(e.bytes)}}Gi._jsonSchemaVersion="firestore/bytes/1.0",Gi._jsonSchema={type:Jn("string",Gi._jsonSchemaVersion),bytes:Jn("string")};class t_{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new qe(Te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hc{constructor(e){this._methodName=e}}class Zs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new qe(Te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new qe(Te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return $t(this._lat,e._lat)||$t(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Zs._jsonSchemaVersion}}static fromJSON(e){if(cf(e,Zs._jsonSchema))return new Zs(e.latitude,e.longitude)}}Zs._jsonSchemaVersion="firestore/geoPoint/1.0",Zs._jsonSchema={type:Jn("string",Zs._jsonSchemaVersion),latitude:Jn("number"),longitude:Jn("number")};class Qs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Qs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(cf(e,Qs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Qs(e.vectorValues);throw new qe(Te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Qs._jsonSchemaVersion="firestore/vectorValue/1.0",Qs._jsonSchema={type:Jn("string",Qs._jsonSchemaVersion),vectorValues:Jn("object")};const oj=/^__.*__$/;class aj{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new rl(e,this.data,this.fieldMask,t,this.fieldTransforms):new uf(e,this.data,t,this.fieldTransforms)}}class I2{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new rl(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function D2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw St(40011,{Ac:n})}}class n_{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new n_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return sg(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(D2(this.Ac)&&oj.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class lj{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Yg(e)}Cc(e,t,r,i=!1){return new n_({Ac:e,methodName:t,Dc:r,path:xr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function r_(n){const e=n._freezeSettings(),t=Yg(n._databaseId);return new lj(n._databaseId,!!e.ignoreUndefinedProperties,t)}function L2(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);oT("Data must be an object, but it was:",a,r);const c=O2(r,a);let u,h;if(s.merge)u=new Mi(a.fieldMask),h=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const m of s.mergeFields){const _=aE(e,m,t);if(!a.contains(_))throw new qe(Te.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);U2(f,_)||f.push(_)}u=new Mi(f),h=a.fieldTransforms.filter((m=>u.covers(m.field)))}else u=null,h=a.fieldTransforms;return new aj(new ui(c),u,h)}class i_ extends hc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof i_}}function N2(n,e,t){return new n_({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class nT extends hc{_toFieldTransform(e){return new qg(e.path,new jd)}isEqual(e){return e instanceof nT}}class rT extends hc{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=N2(this,e,!0),r=this.vc.map((s=>dc(s,t))),i=new Hu(r);return new qg(e.path,i)}isEqual(e){return e instanceof rT&&Fo(this.vc,e.vc)}}class iT extends hc{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=N2(this,e,!0),r=this.vc.map((s=>dc(s,t))),i=new Gu(r);return new qg(e.path,i)}isEqual(e){return e instanceof iT&&Fo(this.vc,e.vc)}}class sT extends hc{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Wd(e.serializer,WD(e.serializer,this.Fc));return new qg(e.path,t)}isEqual(e){return e instanceof sT&&this.Fc===e.Fc}}function cj(n,e,t,r){const i=n.Cc(1,e,t);oT("Data must be an object, but it was:",i,r);const s=[],a=ui.empty();nl(r,((u,h)=>{const f=aT(e,u,t);h=dn(h);const m=i.yc(f);if(h instanceof i_)s.push(f);else{const _=dc(h,m);_!=null&&(s.push(f),a.set(f,_))}}));const c=new Mi(s);return new I2(a,c,i.fieldTransforms)}function uj(n,e,t,r,i,s){const a=n.Cc(1,e,t),c=[aE(e,r,t)],u=[i];if(s.length%2!=0)throw new qe(Te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)c.push(aE(e,s[_])),u.push(s[_+1]);const h=[],f=ui.empty();for(let _=c.length-1;_>=0;--_)if(!U2(h,c[_])){const v=c[_];let T=u[_];T=dn(T);const A=a.yc(v);if(T instanceof i_)h.push(v);else{const E=dc(T,A);E!=null&&(h.push(v),f.set(v,E))}}const m=new Mi(h);return new I2(f,m,a.fieldTransforms)}function hj(n,e,t,r=!1){return dc(t,n.Cc(r?4:3,e))}function dc(n,e){if(k2(n=dn(n)))return oT("Unsupported field value:",e,n),O2(n,e);if(n instanceof hc)return(function(r,i){if(!D2(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let a=0;for(const c of r){let u=dc(c,i.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=dn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return WD(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=yn.fromDate(r);return{timestampValue:eg(i.serializer,s)}}if(r instanceof yn){const s=new yn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:eg(i.serializer,s)}}if(r instanceof Zs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Gi)return{bytesValue:t2(i.serializer,r._byteString)};if(r instanceof kn){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:FS(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Qs)return(function(a,c){return{mapValue:{fields:{[CD]:{stringValue:PD},[Zm]:{arrayValue:{values:a.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return NS(c.serializer,h)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Vg(r)}`)})(n,e)}function O2(n,e){const t={};return xD(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):nl(n,((r,i)=>{const s=dc(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function k2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof yn||n instanceof Zs||n instanceof Gi||n instanceof kn||n instanceof hc||n instanceof Qs)}function oT(n,e,t){if(!k2(t)||!SD(t)){const r=Vg(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function aE(n,e,t){if((e=dn(e))instanceof t_)return e._internalPath;if(typeof e=="string")return aT(n,e);throw sg("Field path arguments must be of type string or ",n,!1,void 0,t)}const dj=new RegExp("[~\\*/\\[\\]]");function aT(n,e,t){if(e.search(dj)>=0)throw sg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new t_(...e.split("."))._internalPath}catch{throw sg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function sg(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(s||a)&&(u+=" (found",s&&(u+=` in field ${r}`),a&&(u+=` in document ${i}`),u+=")"),new qe(Te.INVALID_ARGUMENT,c+n+u)}function U2(n,e){return n.some((t=>t.isEqual(e)))}class F2{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new kn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new fj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(s_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class fj extends F2{data(){return super.data()}}function s_(n,e){return typeof e=="string"?aT(n,e):e instanceof t_?e._internalPath:e._delegate._internalPath}function V2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new qe(Te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lT{}class cT extends lT{}function Pne(n,e,...t){let r=[];e instanceof lT&&r.push(e),r=r.concat(t),(function(s){const a=s.filter((u=>u instanceof uT)).length,c=s.filter((u=>u instanceof o_)).length;if(a>1||a>0&&c>0)throw new qe(Te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class o_ extends cT{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new o_(e,t,r)}_apply(e){const t=this._parse(e);return z2(e._query,t),new Ko(e.firestore,e.converter,Z0(e._query,t))}_parse(e){const t=r_(e.firestore);return(function(s,a,c,u,h,f,m){let _;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new qe(Te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){l1(m,f);const T=[];for(const A of m)T.push(a1(u,s,A));_={arrayValue:{values:T}}}else _=a1(u,s,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||l1(m,f),_=hj(c,a,m,f==="in"||f==="not-in");return Qn.create(h,f,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ine(n,e,t){const r=e,i=s_("where",n);return o_._create(i,r,t)}class uT extends lT{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new uT(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:_s.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i;const c=s.getFlattenedFilters();for(const u of c)z2(a,u),a=Z0(a,u)})(e._query,t),new Ko(e.firestore,e.converter,Z0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class hT extends cT{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new hT(e,t)}_apply(e){const t=(function(i,s,a){if(i.startAt!==null)throw new qe(Te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new qe(Te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Gd(s,a)})(e._query,this._field,this._direction);return new Ko(e.firestore,e.converter,(function(i,s){const a=i.explicitOrderBy.concat([s]);return new ih(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function Dne(n,e="asc"){const t=e,r=s_("orderBy",n);return hT._create(r,t)}class dT extends cT{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new dT(e,t,r)}_apply(e){return new Ko(e.firestore,e.converter,Jm(e._query,this._limit,this._limitType))}}function Lne(n){return yH("limit",n),dT._create("limit",n,"F")}function a1(n,e,t){if(typeof(t=dn(t))=="string"){if(t==="")throw new qe(Te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!FD(e)&&t.indexOf("/")!==-1)throw new qe(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(pn.fromString(t));if(!pt.isDocumentKey(r))throw new qe(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xb(n,new pt(r))}if(t instanceof kn)return xb(n,t._key);throw new qe(Te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vg(t)}.`)}function l1(n,e){if(!Array.isArray(n)||n.length===0)throw new qe(Te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function z2(n,e){const t=(function(i,s){for(const a of i)for(const c of a.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new qe(Te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new qe(Te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class pj{convertValue(e,t="none"){switch(Ka(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Gn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Xa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw St(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return nl(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){const t=e.fields?.[Zm].arrayValue?.values?.map((r=>Gn(r.doubleValue)));return new Qs(t)}convertGeoPoint(e){return new Zs(Gn(e.latitude),Gn(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Hg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(zd(e));default:return null}}convertTimestamp(e){const t=qa(e);return new yn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=pn.fromString(e);on(a2(r),9688,{name:e});const i=new Bd(r.get(1),r.get(3)),s=new pt(r.popFirst(5));return i.isEqual(t)||Bo(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function B2(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class pd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Hl extends F2{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Cm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(s_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(Te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Hl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Hl._jsonSchemaVersion="firestore/documentSnapshot/1.0",Hl._jsonSchema={type:Jn("string",Hl._jsonSchemaVersion),bundleSource:Jn("string","DocumentSnapshot"),bundleName:Jn("string"),bundle:Jn("string")};class Cm extends Hl{data(e={}){return super.data(e)}}class Gl{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new pd(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Cm(this._firestore,this._userDataWriter,r.key,r,new pd(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new qe(Te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((c=>{const u=new Cm(i._firestore,i._userDataWriter,c.doc.key,c.doc,new pd(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>s||c.type!==3)).map((c=>{const u=new Cm(i._firestore,i._userDataWriter,c.doc.key,c.doc,new pd(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,f=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:mj(c.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(Te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Gl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=RS.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function mj(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return St(61501,{type:n})}}function c1(n){n=di(n,kn);const e=di(n.firestore,Go);return tj(e_(e),n._key).then((t=>H2(e,n,t)))}Gl._jsonSchemaVersion="firestore/querySnapshot/1.0",Gl._jsonSchema={type:Jn("string",Gl._jsonSchemaVersion),bundleSource:Jn("string","QuerySnapshot"),bundleName:Jn("string"),bundle:Jn("string")};class fT extends pj{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new kn(this.firestore,null,t)}}function Nne(n){n=di(n,Ko);const e=di(n.firestore,Go),t=e_(e),r=new fT(e);return V2(n._query),nj(t,n._query).then((i=>new Gl(e,r,n,i)))}function gj(n,e,t){n=di(n,kn);const r=di(n.firestore,Go),i=B2(n.converter,e);return a_(r,[L2(r_(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Wi.none())])}function lE(n,e,t,...r){n=di(n,kn);const i=di(n.firestore,Go),s=r_(i);let a;return a=typeof(e=dn(e))=="string"||e instanceof t_?uj(s,"updateDoc",n._key,e,t,r):cj(s,"updateDoc",n._key,e),a_(i,[a.toMutation(n._key,Wi.exists(!0))])}function One(n){return a_(di(n.firestore,Go),[new OS(n._key,Wi.none())])}function kne(n,e){const t=di(n.firestore,Go),r=zl(n),i=B2(n.converter,e);return a_(t,[L2(r_(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Wi.exists(!1))]).then((()=>r))}function Une(n,...e){n=dn(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||o1(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(o1(e[r])){const u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let s,a,c;if(n instanceof kn)a=di(n.firestore,Go),c=Gg(n._key.path),s={next:u=>{e[r]&&e[r](H2(a,n,u))},error:e[r+1],complete:e[r+2]};else{const u=di(n,Ko);a=di(u.firestore,Go),c=u._query;const h=new fT(a);s={next:f=>{e[r]&&e[r](new Gl(a,h,u,f))},error:e[r+1],complete:e[r+2]},V2(n._query)}return(function(h,f,m,_){const v=new tT(_),T=new QS(f,v,m);return h.asyncQueue.enqueueAndForget((async()=>KS(await ig(h),T))),()=>{v.Nu(),h.asyncQueue.enqueueAndForget((async()=>YS(await ig(h),T)))}})(e_(a),c,i,s)}function a_(n,e){return(function(r,i){const s=new Uo;return r.asyncQueue.enqueueAndForget((async()=>G9(await ej(r),i,s))),s.promise})(e_(n),e)}function H2(n,e,t){const r=t.docs.get(e._key),i=new fT(n);return new Hl(n,i,e._key,r,new pd(t.hasPendingWrites,t.fromCache),e.converter)}function Fne(){return new nT("serverTimestamp")}function Vne(...n){return new rT("arrayUnion",n)}function zne(...n){return new iT("arrayRemove",n)}function Bne(n){return new sT("increment",n)}(function(e,t=!0){(function(i){th=i})(ac),Xl(new Wa("firestore",((r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),c=new Go(new uH(r.getProvider("auth-internal")),new fH(a,r.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new qe(Te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bd(h.options.projectId,f)})(a,i),a);return s={useFetchStreams:t,...s},c._setSettings(s),c}),"PUBLIC").setMultipleInstances(!0)),Ws(ub,hb,e),Ws(ub,hb,"esm2020")})();const G2="firebasestorage.googleapis.com",j2="storageBucket",_j=120*1e3,vj=600*1e3;class Vn extends no{constructor(e,t,r=0){super(Sy(e),`Firebase Storage: ${t} (${Sy(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Vn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Sy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Fn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Fn||(Fn={}));function Sy(n){return"storage/"+n}function pT(){const n="An unknown error occurred, please check the error payload for server response.";return new Vn(Fn.UNKNOWN,n)}function yj(n){return new Vn(Fn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Ej(n){return new Vn(Fn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Sj(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Vn(Fn.UNAUTHENTICATED,n)}function Tj(){return new Vn(Fn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function xj(n){return new Vn(Fn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function wj(){return new Vn(Fn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Aj(){return new Vn(Fn.CANCELED,"User canceled the upload/download.")}function Mj(n){return new Vn(Fn.INVALID_URL,"Invalid URL '"+n+"'.")}function bj(n){return new Vn(Fn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Rj(){return new Vn(Fn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+j2+"' property when initializing the app?")}function Cj(){return new Vn(Fn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Pj(){return new Vn(Fn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Ij(n){return new Vn(Fn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function cE(n){return new Vn(Fn.INVALID_ARGUMENT,n)}function W2(){return new Vn(Fn.APP_DELETED,"The Firebase app was deleted.")}function Dj(n){return new Vn(Fn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Rd(n,e){return new Vn(Fn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function $h(n){throw new Vn(Fn.INTERNAL_ERROR,"Internal error: "+n)}class bi{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=bi.makeFromUrl(e,t)}catch{return new bi(e,"")}if(r.path==="")return r;throw bj(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(k){k.path.charAt(k.path.length-1)==="/"&&(k.path_=k.path_.slice(0,-1))}const a="(/(.*))?$",c=new RegExp("^gs://"+i+a,"i"),u={bucket:1,path:3};function h(k){k.path_=decodeURIComponent(k.path)}const f="v[A-Za-z0-9_]+",m=t.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",v=new RegExp(`^https?://${m}/${f}/b/${i}/o${_}`,"i"),T={bucket:1,path:3},A=t===G2?"(?:storage.googleapis.com|storage.cloud.google.com)":t,E="([^?#]*)",S=new RegExp(`^https?://${A}/${i}/${E}`,"i"),b=[{regex:c,indices:u,postModify:s},{regex:v,indices:T,postModify:h},{regex:S,indices:{bucket:1,path:2},postModify:h}];for(let k=0;k<b.length;k++){const V=b[k],H=V.regex.exec(e);if(H){const P=H[V.indices.bucket];let I=H[V.indices.path];I||(I=""),r=new bi(P,I),V.postModify(r);break}}if(r==null)throw Mj(e);return r}}class Lj{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Nj(n,e,t){let r=1,i=null,s=null,a=!1,c=0;function u(){return c===2}let h=!1;function f(...E){h||(h=!0,e.apply(null,E))}function m(E){i=setTimeout(()=>{i=null,n(v,u())},E)}function _(){s&&clearTimeout(s)}function v(E,...S){if(h){_();return}if(E){_(),f.call(null,E,...S);return}if(u()||a){_(),f.call(null,E,...S);return}r<64&&(r*=2);let b;c===1?(c=2,b=0):b=(r+Math.random())*1e3,m(b)}let T=!1;function A(E){T||(T=!0,_(),!h&&(i!==null?(E||(c=2),clearTimeout(i),m(0)):E||(c=1)))}return m(0),s=setTimeout(()=>{a=!0,A(!0)},t),A}function Oj(n){n(!1)}function kj(n){return n!==void 0}function Uj(n){return typeof n=="object"&&!Array.isArray(n)}function mT(n){return typeof n=="string"||n instanceof String}function u1(n){return gT()&&n instanceof Blob}function gT(){return typeof Blob<"u"}function h1(n,e,t,r){if(r<e)throw cE(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw cE(`Invalid value for '${n}'. Expected ${t} or less.`)}function _T(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function $2(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var jl;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(jl||(jl={}));function Fj(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}class Vj{constructor(e,t,r,i,s,a,c,u,h,f,m,_=!0,v=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=m,this.retry=_,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,A)=>{this.resolve_=T,this.reject_=A,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Dp(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=c=>{const u=c.loaded,h=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const c=s.getErrorCode()===jl.NO_ERROR,u=s.getStatus();if(!c||Fj(u,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===jl.ABORT;r(!1,new Dp(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;r(!0,new Dp(h,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(c,c.getResponse());kj(u)?s(u):s()}catch(u){a(u)}else if(c!==null){const u=pT();u.serverResponse=c.getErrorText(),this.errorCallback_?a(this.errorCallback_(c,u)):a(u)}else if(i.canceled){const u=this.appDelete_?W2():Aj();a(u)}else{const u=wj();a(u)}};this.canceled_?t(!1,new Dp(!1,null,!0)):this.backoffId_=Nj(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Oj(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Dp{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function zj(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Bj(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Hj(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Gj(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function jj(n,e,t,r,i,s,a=!0,c=!1){const u=$2(n.urlParams),h=n.url+u,f=Object.assign({},n.headers);return Hj(f,e),zj(f,t),Bj(f,s),Gj(f,r),new Vj(h,n.method,f,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,c)}function Wj(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function $j(...n){const e=Wj();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(gT())return new Blob(n);throw new Vn(Fn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function qj(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function Xj(n){if(typeof atob>"u")throw Ij("base-64");return atob(n)}const Bs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ty{constructor(e,t){this.data=e,this.contentType=t||null}}function Kj(n,e){switch(n){case Bs.RAW:return new Ty(q2(e));case Bs.BASE64:case Bs.BASE64URL:return new Ty(X2(n,e));case Bs.DATA_URL:return new Ty(Zj(e),Qj(e))}throw pT()}function q2(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const s=r,a=n.charCodeAt(++t);r=65536|(s&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function Yj(n){let e;try{e=decodeURIComponent(n)}catch{throw Rd(Bs.DATA_URL,"Malformed data URL.")}return q2(e)}function X2(n,e){switch(n){case Bs.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Rd(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Bs.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Rd(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=Xj(e)}catch(i){throw i.message.includes("polyfill")?i:Rd(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class K2{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Rd(Bs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=Jj(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function Zj(n){const e=new K2(n);return e.base64?X2(Bs.BASE64,e.rest):Yj(e.rest)}function Qj(n){return new K2(n).contentType}function Jj(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class Ca{constructor(e,t){let r=0,i="";u1(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(u1(this.data_)){const r=this.data_,i=qj(r,e,t);return i===null?null:new Ca(i)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new Ca(r,!0)}}static getBlob(...e){if(gT()){const t=e.map(r=>r instanceof Ca?r.data_:r);return new Ca($j.apply(null,t))}else{const t=e.map(a=>mT(a)?Kj(Bs.RAW,a).data:a.data_);let r=0;t.forEach(a=>{r+=a.byteLength});const i=new Uint8Array(r);let s=0;return t.forEach(a=>{for(let c=0;c<a.length;c++)i[s++]=a[c]}),new Ca(i,!0)}}uploadData(){return this.data_}}function Y2(n){let e;try{e=JSON.parse(n)}catch{return null}return Uj(e)?e:null}function eW(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function tW(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function Z2(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function nW(n,e){return e}class jr{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||nW}}let Lp=null;function rW(n){return!mT(n)||n.length<2?n:Z2(n)}function Q2(){if(Lp)return Lp;const n=[];n.push(new jr("bucket")),n.push(new jr("generation")),n.push(new jr("metageneration")),n.push(new jr("name","fullPath",!0));function e(s,a){return rW(a)}const t=new jr("name");t.xform=e,n.push(t);function r(s,a){return a!==void 0?Number(a):a}const i=new jr("size");return i.xform=r,n.push(i),n.push(new jr("timeCreated")),n.push(new jr("updated")),n.push(new jr("md5Hash",null,!0)),n.push(new jr("cacheControl",null,!0)),n.push(new jr("contentDisposition",null,!0)),n.push(new jr("contentEncoding",null,!0)),n.push(new jr("contentLanguage",null,!0)),n.push(new jr("contentType",null,!0)),n.push(new jr("metadata","customMetadata",!0)),Lp=n,Lp}function iW(n,e){function t(){const r=n.bucket,i=n.fullPath,s=new bi(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function sW(n,e,t){const r={};r.type="file";const i=t.length;for(let s=0;s<i;s++){const a=t[s];r[a.local]=a.xform(r,e[a.server])}return iW(r,n),r}function J2(n,e,t){const r=Y2(e);return r===null?null:sW(n,r,t)}function oW(n,e,t,r){const i=Y2(e);if(i===null||!mT(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const a=encodeURIComponent;return s.split(",").map(h=>{const f=n.bucket,m=n.fullPath,_="/b/"+a(f)+"/o/"+a(m),v=_T(_,t,r),T=$2({alt:"media",token:h});return v+T})[0]}function aW(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}class eL{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function tL(n){if(!n)throw pT()}function lW(n,e){function t(r,i){const s=J2(n,i,e);return tL(s!==null),s}return t}function cW(n,e){function t(r,i){const s=J2(n,i,e);return tL(s!==null),oW(s,i,n.host,n._protocol)}return t}function nL(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=Tj():i=Sj():t.getStatus()===402?i=Ej(n.bucket):t.getStatus()===403?i=xj(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function uW(n){const e=nL(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=yj(n.path)),s.serverResponse=i.serverResponse,s}return t}function hW(n,e,t){const r=e.fullServerUrl(),i=_T(r,n.host,n._protocol),s="GET",a=n.maxOperationRetryTime,c=new eL(i,s,cW(n,t),a);return c.errorHandler=uW(e),c}function dW(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function fW(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=dW(null,e)),r}function pW(n,e,t,r,i){const s=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function c(){let b="";for(let k=0;k<2;k++)b=b+Math.random().toString().slice(2);return b}const u=c();a["Content-Type"]="multipart/related; boundary="+u;const h=fW(e,r,i),f=aW(h,t),m="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+f+`\r
--`+u+`\r
Content-Type: `+h.contentType+`\r
\r
`,_=`\r
--`+u+"--",v=Ca.getBlob(m,r,_);if(v===null)throw Cj();const T={name:h.fullPath},A=_T(s,n.host,n._protocol),E="POST",S=n.maxUploadRetryTime,D=new eL(A,E,lW(n,t),S);return D.urlParams=T,D.headers=a,D.body=v.uploadData(),D.errorHandler=nL(e),D}class mW{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=jl.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=jl.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=jl.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i,s){if(this.sent_)throw $h("cannot .send() more than once");if(el(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),s!==void 0)for(const a in s)s.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,s[a].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw $h("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw $h("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw $h("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw $h("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class gW extends mW{initXhr(){this.xhr_.responseType="text"}}function rL(){return new gW}class ec{constructor(e,t){this._service=e,t instanceof bi?this._location=t:this._location=bi.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ec(e,t)}get root(){const e=new bi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Z2(this._location.path)}get storage(){return this._service}get parent(){const e=eW(this._location.path);if(e===null)return null;const t=new bi(this._location.bucket,e);return new ec(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Dj(e)}}function _W(n,e,t){n._throwIfRoot("uploadBytes");const r=pW(n.storage,n._location,Q2(),new Ca(e,!0),t);return n.storage.makeRequestWithTokens(r,rL).then(i=>({metadata:i,ref:n}))}function vW(n){n._throwIfRoot("getDownloadURL");const e=hW(n.storage,n._location,Q2());return n.storage.makeRequestWithTokens(e,rL).then(t=>{if(t===null)throw Pj();return t})}function yW(n,e){const t=tW(n._location.path,e),r=new bi(n._location.bucket,t);return new ec(n.storage,r)}function EW(n){return/^[A-Za-z]+:\/\//.test(n)}function SW(n,e){return new ec(n,e)}function iL(n,e){if(n instanceof vT){const t=n;if(t._bucket==null)throw Rj();const r=new ec(t,t._bucket);return e!=null?iL(r,e):r}else return e!==void 0?yW(n,e):n}function TW(n,e){if(e&&EW(e)){if(n instanceof vT)return SW(n,e);throw cE("To use ref(service, url), the first argument must be a Storage instance.")}else return iL(n,e)}function d1(n,e){const t=e?.[j2];return t==null?null:bi.makeFromBucketSpec(t,n)}function xW(n,e,t,r={}){n.host=`${e}:${t}`;const i=el(e);i&&(pS(`https://${n.host}/b`),mS("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:AI(s,n.app.options.projectId))}class vT{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=G2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=_j,this._maxUploadRetryTime=vj,this._requests=new Set,i!=null?this._bucket=bi.makeFromBucketSpec(i,this._host):this._bucket=d1(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=bi.makeFromBucketSpec(this._url,e):this._bucket=d1(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){h1("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){h1("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ci(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ec(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new Lj(W2());{const a=jj(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const f1="@firebase/storage",p1="0.14.0";const sL="storage";function Hne(n,e,t){return n=dn(n),_W(n,e,t)}function Gne(n){return n=dn(n),vW(n)}function jne(n,e){return n=dn(n),TW(n,e)}function wW(n=vS(),e){n=dn(n);const r=Og(n,sL).getImmediate({identifier:e}),i=TI("storage");return i&&AW(r,...i),r}function AW(n,e,t,r={}){xW(n,e,t,r)}function MW(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new vT(t,r,i,e,ac)}function bW(){Xl(new Wa(sL,MW,"PUBLIC").setMultipleInstances(!0)),Ws(f1,p1,""),Ws(f1,p1,"esm2020")}bW();const RW={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyDbZ4GJmZynAbTC03OSglAS7_XJm2PHVVQ",VITE_FIREBASE_APP_ID:"1:362205108634:web:705f279e0b722ce0514223",VITE_FIREBASE_AUTH_DOMAIN:"cosmos-e42b5.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"362205108634",VITE_FIREBASE_PROJECT_ID:"cosmos-e42b5",VITE_FIREBASE_STORAGE_BUCKET:"cosmos-e42b5.appspot.com"};console.log("=== FIREBASE CONFIG DEBUG ===");console.log("API Key:","AIzaSyDbZ4GJmZynAbTC03OSglAS7_XJm2PHVVQ");console.log("Auth Domain:","cosmos-e42b5.firebaseapp.com");console.log("Project ID:","cosmos-e42b5");console.log("All env vars:",RW);console.log("=== END DEBUG ===");const CW={apiKey:"AIzaSyDbZ4GJmZynAbTC03OSglAS7_XJm2PHVVQ",authDomain:"cosmos-e42b5.firebaseapp.com",projectId:"cosmos-e42b5",storageBucket:"cosmos-e42b5.appspot.com",messagingSenderId:"362205108634",appId:"1:362205108634:web:705f279e0b722ce0514223"},yT=zM().length===0?RI(CW):zM()[0],Al=oH(yT),wu=ij(yT),Wne=wW(yT),PW={},m1=n=>{let e;const t=new Set,r=(f,m)=>{const _=typeof f=="function"?f(e):f;if(!Object.is(_,e)){const v=e;e=m??(typeof _!="object"||_===null)?_:Object.assign({},e,_),t.forEach(T=>T(e,v))}},i=()=>e,u={setState:r,getState:i,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(PW?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(r,i,u);return u},IW=n=>n?m1(n):m1;var xy={exports:{}},wy={},Ay={exports:{}},My={};var g1;function DW(){if(g1)return My;g1=1;var n=Yd();function e(m,_){return m===_&&(m!==0||1/m===1/_)||m!==m&&_!==_}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function c(m,_){var v=_(),T=r({inst:{value:v,getSnapshot:_}}),A=T[0].inst,E=T[1];return s(function(){A.value=v,A.getSnapshot=_,u(A)&&E({inst:A})},[m,v,_]),i(function(){return u(A)&&E({inst:A}),m(function(){u(A)&&E({inst:A})})},[m]),a(v),v}function u(m){var _=m.getSnapshot;m=m.value;try{var v=_();return!t(m,v)}catch{return!0}}function h(m,_){return _()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:c;return My.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:f,My}var _1;function LW(){return _1||(_1=1,Ay.exports=DW()),Ay.exports}var v1;function NW(){if(v1)return wy;v1=1;var n=Yd(),e=LW();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,c=n.useMemo,u=n.useDebugValue;return wy.useSyncExternalStoreWithSelector=function(h,f,m,_,v){var T=s(null);if(T.current===null){var A={hasValue:!1,value:null};T.current=A}else A=T.current;T=c(function(){function S(H){if(!D){if(D=!0,b=H,H=_(H),v!==void 0&&A.hasValue){var P=A.value;if(v(P,H))return k=P}return k=H}if(P=k,r(b,H))return P;var I=_(H);return v!==void 0&&v(P,I)?(b=H,P):(b=H,k=I)}var D=!1,b,k,V=m===void 0?null:m;return[function(){return S(f())},V===null?void 0:function(){return S(V())}]},[f,m,_,v]);var E=i(h,T[0],T[1]);return a(function(){A.hasValue=!0,A.value=E},[E]),u(E),E},wy}var y1;function OW(){return y1||(y1=1,xy.exports=NW()),xy.exports}var kW=OW();const UW=PE(kW),oL={},{useDebugValue:FW}=Eg,{useSyncExternalStoreWithSelector:VW}=UW;let E1=!1;const zW=n=>n;function BW(n,e=zW,t){(oL?"production":void 0)!=="production"&&t&&!E1&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),E1=!0);const r=VW(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return FW(r),r}const S1=n=>{(oL?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?IW(n):n,t=(r,i)=>BW(e,r,i);return Object.assign(t,e),t},HW=n=>n?S1(n):S1,aL=["Entrepreneurship","AI","Consulting","Finance","Analytics","Marketing","Astrophysics","Psychology","Neuroeconomics","Economics","Computer Science","Statistics + Risk + Actuary","Social Media","Literary","Robotics","Cosmology","BioTech","Data Science","Product Management","UX/UI Design","Cybersecurity","Cloud & DevOps","Blockchain","Game Development","Healthcare","EdTech","Climate Tech","Mathematics","Law & Policy","Music & Audio"],lL=n=>n.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),cL={},uL={};for(const n of aL){const e=lL(n),t=`${e}-welcome`;cL[e]=[{id:t,title:"Weekly Ship #1",author:"system",createdAt:Date.now()}],uL[t]=[{id:t+"-p1",author:"system",type:"text",content:"Welcome! Share a tiny proof of progress you shipped this week (link, screenshot URL, or a short note).",createdAt:Date.now()}]}const Np=(()=>{try{return JSON.parse(localStorage.getItem("cosmos_forum_v1")||"null")}catch{return null}})(),_u=HW((n,e)=>({pods:aL.map(t=>({name:t,slug:lL(t),members:0})),me:{name:"You"},membership:Np?.membership?new Set(Np.membership):new Set,threads:Np?.threads||cL,posts:Np?.posts||uL,userId:null,setUserId:t=>n({userId:t}),joinPod:async t=>{const r=e(),i=new Set(r.membership);if(i.add(t),n({membership:i}),r.userId)try{const s=Array.from(i);await lE(zl(wu,"users",r.userId),{joinedPods:s})}catch(s){console.error("Error syncing pod join to Firebase:",s),n({membership:r.membership})}},leavePod:async t=>{const r=e(),i=new Set(r.membership);if(i.delete(t),n({membership:i}),r.userId)try{const s=Array.from(i);await lE(zl(wu,"users",r.userId),{joinedPods:s})}catch(s){console.error("Error syncing pod leave to Firebase:",s),n({membership:r.membership})}},initializeMembership:t=>{Array.isArray(t)&&n({membership:new Set(t)})},newThread:(t,r)=>n(i=>{const a={id:`${t}-${Math.random().toString(36).slice(2,8)}`,title:r,author:i.me.name,createdAt:Date.now()};return i.threads[t]=[...i.threads[t]||[],a],{threads:{...i.threads}}}),newPost:(t,r)=>n(i=>{const s={id:`${t}-${Math.random().toString(36).slice(2,8)}`,author:i.me.name,createdAt:Date.now(),...r};return i.posts[t]=[...i.posts[t]||[],s],{posts:{...i.posts}}}),setMe:t=>n({me:{name:t}})}));_u.subscribe(n=>{const e={threads:n.threads,posts:n.posts,membership:Array.from(n.membership)};try{localStorage.setItem("cosmos_forum_v1",JSON.stringify(e))}catch(t){console.error("Error saving to localStorage:",t)}});const hL=X.createContext({});function pf(){return X.useContext(hL)}function GW({children:n}){const[e,t]=X.useState(null),[r,i]=X.useState(!0);async function s(_,v,T){const A=await z5(Al,_,v);return await G5(A.user,{displayName:T}),await gj(zl(wu,"users",A.user.uid),{uid:A.user.uid,email:_,displayName:T,photoURL:null,bio:"",goals:[],joinedPods:[],createdAt:Date.now(),streak:0,totalProofs:0,preferences:{theme:"dark",emailNotifications:!0,publicProfile:!0}}),A}function a(_,v){return B5(Al,_,v)}function c(){const{setUserId:_,initializeMembership:v}=_u.getState();return _(null),v([]),K5(Al)}function u(_){return j5(Al.currentUser,_)}function h(_){return W5(Al.currentUser,_)}async function f(_){if(!e)return;await lE(zl(wu,"users",e.uid),_);const v=await c1(zl(wu,"users",e.uid)),T={...Al.currentUser,...v.data()};if(t(T),_.joinedPods){const{initializeMembership:A}=_u.getState();A(_.joinedPods)}}X.useEffect(()=>X5(Al,async v=>{if(v){const T=await c1(zl(wu,"users",v.uid));if(T.exists()){const A=T.data();t({...v,...A});const{setUserId:E,initializeMembership:S,setMe:D}=_u.getState();E(v.uid),D(A.displayName||"You"),S(A.joinedPods||[])}else{t(v);const{setUserId:A,setMe:E}=_u.getState();A(v.uid),E(v.displayName||"You")}}else{t(null);const{setUserId:T,initializeMembership:A}=_u.getState();T(null),A([])}i(!1)}),[]);const m={currentUser:e,signup:s,login:a,logout:c,changeEmail:u,changePassword:h,updateUserProfile:f,loading:r};return B.jsx(hL.Provider,{value:m,children:!r&&n})}function Os({children:n}){const{currentUser:e,loading:t}=pf();return t?B.jsx("div",{className:"min-h-screen flex items-center justify-center",children:B.jsx("div",{className:"text-zinc-400",children:"Loading..."})}):e?n:B.jsx(Bk,{to:"/login",replace:!0})}const jW=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),dL=(...n)=>n.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");var WW={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const $W=X.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...c},u)=>X.createElement("svg",{ref:u,...WW,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:dL("lucide",i),...c},[...a.map(([h,f])=>X.createElement(h,f)),...Array.isArray(s)?s:[s]]));const Jr=(n,e)=>{const t=X.forwardRef(({className:r,...i},s)=>X.createElement($W,{ref:s,iconNode:e,className:dL(`lucide-${jW(n)}`,r),...i}));return t.displayName=`${n}`,t};const fL=Jr("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);const qW=Jr("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const pL=Jr("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);const XW=Jr("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);const ET=Jr("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);const T1=Jr("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const KW=Jr("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);const YW=Jr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const ZW=Jr("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);const by=Jr("Scroll",[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);const QW=Jr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const JW=Jr("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const og=Jr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const mL=Jr("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const e8=Jr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),x1=[{to:"/",label:"Home",icon:ET},{to:"/pods",label:"Pods",icon:mL},{to:"/matches",label:"Matches",icon:XW},{to:"/journal",label:"Journal",icon:fL},{to:"/events",label:"Events",icon:qW},{to:"/analytics",label:"Analytics",icon:pL},{to:"/profile",label:"Profile",icon:og},{to:"/settings",label:"Settings",icon:QW}],t8=({to:n,children:e,onClick:t})=>B.jsx(Ag,{to:n,onClick:t,className:({isActive:r})=>`px-3 py-2 rounded-xl transition focus:outline-none focus:ring-2 focus:ring-brand-500/60 ${r?"bg-white/10 text-white":"text-zinc-300 hover:text-white hover:bg-white/5"}`,children:e}),w1=({to:n,label:e,icon:t,onClick:r})=>B.jsxs(Ag,{to:n,onClick:r,className:({isActive:i})=>`flex items-center gap-3 px-4 py-3 rounded-xl transition ${i?"bg-brand-500/20 text-brand-400 border border-brand-500/30":"text-zinc-300 hover:text-white hover:bg-white/5"}`,children:[B.jsx(t,{size:20}),B.jsx("span",{className:"font-medium",children:e})]});function n8(){const[n,e]=X.useState(!1),{currentUser:t,logout:r}=pf(),i=Zd(),s=Xo();X.useEffect(()=>{e(!1)},[s.pathname]),X.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]);async function a(){try{await r(),e(!1),i("/login")}catch(c){console.error("Failed to log out:",c)}}return B.jsxs(B.Fragment,{children:[B.jsx("header",{className:"sticky top-0 z-40 bg-black/30 backdrop-blur border-b border-white/10",children:B.jsxs("div",{className:"mx-auto max-w-7xl px-4 py-3 flex items-center gap-6",children:[B.jsxs(Ul,{to:"/",className:"flex items-center gap-2 text-white font-semibold",children:[B.jsx(ZW,{size:32,className:"text-brand-400"}),B.jsx("span",{className:"text-lg",children:"Cosmos"})]}),t&&B.jsx("nav",{className:"hidden md:flex items-center gap-1",children:x1.map(c=>B.jsx(t8,{to:c.to,children:c.label},c.to))}),B.jsx("nav",{className:"hidden md:flex items-center",children:B.jsxs(Ag,{to:"/constitution",className:({isActive:c})=>`px-3 py-2 rounded-xl transition flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-brand-500/60 ${c?"bg-gradient-to-r from-brand-400/20 to-glow-400/20 text-brand-400 border border-brand-400/30":"text-zinc-400 hover:text-brand-400 hover:bg-brand-400/5 border border-transparent"}`,children:[B.jsx(by,{size:16}),B.jsx("span",{className:"text-sm font-medium",children:"Constitution"})]})}),B.jsx("div",{className:"ml-auto flex items-center gap-3",children:t?B.jsxs(B.Fragment,{children:[B.jsxs(Ul,{to:"/profile",className:"hidden sm:flex items-center gap-2 px-3 py-2 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 transition",children:[B.jsx(og,{size:16}),B.jsx("span",{className:"text-sm",children:t.displayName||"Profile"})]}),B.jsxs("button",{onClick:a,className:"hidden sm:flex items-center gap-2 px-4 py-2 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 focus:outline-none focus:ring-2 focus:ring-brand-500/60 transition",children:[B.jsx(T1,{size:16}),B.jsx("span",{className:"text-sm",children:"Logout"})]}),B.jsx("button",{onClick:()=>e(!0),className:"md:hidden flex items-center justify-center w-10 h-10 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 transition","aria-label":"Open menu",children:B.jsx(KW,{size:20})})]}):B.jsxs(B.Fragment,{children:[B.jsx(Ul,{to:"/constitution",className:"flex items-center gap-2 px-3 py-2 rounded-xl text-zinc-400 hover:text-brand-400 hover:bg-brand-400/5 transition md:hidden",children:B.jsx(by,{size:16})}),B.jsx(Ul,{to:"/login",className:"btn-primary px-4 py-2 text-sm",children:"Log In"})]})})]})}),B.jsx(FC,{children:n&&B.jsxs(B.Fragment,{children:[B.jsx(us.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 md:hidden",onClick:()=>e(!1)}),B.jsxs(us.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed top-0 right-0 bottom-0 w-72 bg-night-900 border-l border-white/10 z-50 md:hidden flex flex-col",children:[B.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white/10",children:[B.jsx("span",{className:"text-lg font-semibold text-white",children:"Menu"}),B.jsx("button",{onClick:()=>e(!1),className:"flex items-center justify-center w-10 h-10 rounded-xl bg-white/5 hover:bg-white/10 transition","aria-label":"Close menu",children:B.jsx(e8,{size:20})})]}),t&&B.jsx("div",{className:"p-4 border-b border-white/10",children:B.jsxs("div",{className:"flex items-center gap-3",children:[B.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-500/20 flex items-center justify-center",children:B.jsx(og,{size:20,className:"text-brand-400"})}),B.jsxs("div",{children:[B.jsx("p",{className:"font-medium text-white",children:t.displayName||"User"}),B.jsx("p",{className:"text-sm text-zinc-400",children:t.email})]})]})}),B.jsxs("nav",{className:"flex-1 overflow-y-auto p-4 space-y-1",children:[x1.map(c=>B.jsx(w1,{...c,onClick:()=>e(!1)},c.to)),B.jsx("div",{className:"pt-2 mt-2 border-t border-white/10",children:B.jsx(w1,{to:"/constitution",label:"Constitution",icon:by,onClick:()=>e(!1)})})]}),t&&B.jsx("div",{className:"p-4 border-t border-white/10",children:B.jsxs("button",{onClick:a,className:"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 transition text-zinc-300 hover:text-white",children:[B.jsx(T1,{size:18}),B.jsx("span",{className:"font-medium",children:"Log Out"})]})})]})]})})]})}function r8(){return B.jsx("footer",{className:"border-t border-white/10 bg-black/40",children:B.jsxs("div",{className:"mx-auto max-w-7xl px-4 py-6 text-sm text-zinc-400 flex flex-col sm:flex-row items-center gap-2",children:[B.jsxs("span",{children:[" ",new Date().getFullYear()," PeerLearn"]}),B.jsx("span",{className:"opacity-60",children:"Cosmos edition  PWA enabled"}),B.jsxs("span",{className:"sm:ml-auto text-zinc-300",children:["Developed under the guidance of ",B.jsx("span",{className:"font-semibold text-brand-400",children:"Dr. Jasmine Ma'am"})]})]})})}const i8=[{to:"/",label:"Home",icon:ET},{to:"/pods",label:"Pods",icon:mL},{to:"/journal",label:"Journal",icon:fL},{to:"/analytics",label:"Stats",icon:pL},{to:"/profile",label:"Profile",icon:og}];function s8(){const n=Xo();return B.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-40 md:hidden bg-night-900/95 backdrop-blur-lg border-t border-white/10 safe-bottom",children:B.jsx("div",{className:"flex items-center justify-around px-2 py-2",children:i8.map(({to:e,label:t,icon:r})=>{const i=n.pathname===e||e!=="/"&&n.pathname.startsWith(e);return B.jsxs(Ag,{to:e,className:"relative flex flex-col items-center justify-center py-2 px-3 min-w-[60px]",children:[B.jsxs("div",{className:`relative p-2 rounded-xl transition-colors ${i?"bg-brand-500/20":""}`,children:[B.jsx(r,{size:22,className:`transition-colors ${i?"text-brand-400":"text-zinc-500"}`}),i&&B.jsx(us.div,{layoutId:"bottomNavIndicator",className:"absolute inset-0 bg-brand-500/20 rounded-xl",transition:{type:"spring",stiffness:300,damping:30}})]}),B.jsx("span",{className:`text-[10px] mt-1 font-medium transition-colors ${i?"text-brand-400":"text-zinc-500"}`,children:t})]},e)})})})}function o8(){const n=X.useRef(null);return X.useEffect(()=>{const e=n.current;if(!e)return;let t=0,r=0,i=0,s=0,a=0;const c=h=>{s=h.clientX,a=h.clientY,t||(t=requestAnimationFrame(u))},u=()=>{r+=(s-r)*.2,i+=(a-i)*.2,e.style.transform=`translate3d(${r}px, ${i}px, 0)`,t=requestAnimationFrame(u)};return window.addEventListener("mousemove",c),()=>{window.removeEventListener("mousemove",c),t&&cancelAnimationFrame(t)}},[]),B.jsx("div",{ref:n,className:"pointer-events-none fixed left-0 top-0 z-50 w-6 h-6 -translate-x-1/2 -translate-y-1/2 rounded-full border border-white/30 mix-blend-screen"})}const ST="160",a8=0,A1=1,l8=2,gL=1,c8=2,bo=3,Qa=0,fi=1,Co=2,Va=0,Du=1,M1=2,b1=3,R1=4,u8=5,Ol=100,h8=101,d8=102,C1=103,P1=104,f8=200,p8=201,m8=202,g8=203,uE=204,hE=205,_8=206,v8=207,y8=208,E8=209,S8=210,T8=211,x8=212,w8=213,A8=214,M8=0,b8=1,R8=2,ag=3,C8=4,P8=5,I8=6,D8=7,_L=0,L8=1,N8=2,za=0,O8=1,k8=2,U8=3,F8=4,V8=5,z8=6,vL=300,$u=301,qu=302,dE=303,fE=304,l_=306,pE=1e3,hs=1001,mE=1002,Kr=1003,I1=1004,Ry=1005,Bi=1006,B8=1007,$d=1008,Ba=1009,H8=1010,G8=1011,TT=1012,yL=1013,La=1014,Na=1015,qd=1016,EL=1017,SL=1018,Wl=1020,j8=1021,ds=1023,W8=1024,$8=1025,$l=1026,Xu=1027,q8=1028,TL=1029,X8=1030,xL=1031,wL=1033,Cy=33776,Py=33777,Iy=33778,Dy=33779,D1=35840,L1=35841,N1=35842,O1=35843,AL=36196,k1=37492,U1=37496,F1=37808,V1=37809,z1=37810,B1=37811,H1=37812,G1=37813,j1=37814,W1=37815,$1=37816,q1=37817,X1=37818,K1=37819,Y1=37820,Z1=37821,Ly=36492,Q1=36494,J1=36495,K8=36283,eR=36284,tR=36285,nR=36286,ML=3e3,Ha=3001,Y8=3200,Z8=3201,bL=0,Q8=1,ji="",Tr="srgb",jo="srgb-linear",xT="display-p3",c_="display-p3-linear",lg="linear",vn="srgb",cg="rec709",ug="p3",qc=7680,rR=519,J8=512,e7=513,t7=514,RL=515,n7=516,r7=517,i7=518,s7=519,gE=35044,iR="300 es",_E=1035,Lo=2e3,hg=2001;class oh{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}const Nr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Ny=Math.PI/180,vE=180/Math.PI;function Ga(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Nr[n&255]+Nr[n>>8&255]+Nr[n>>16&255]+Nr[n>>24&255]+"-"+Nr[e&255]+Nr[e>>8&255]+"-"+Nr[e>>16&15|64]+Nr[e>>24&255]+"-"+Nr[t&63|128]+Nr[t>>8&255]+"-"+Nr[t>>16&255]+Nr[t>>24&255]+Nr[r&255]+Nr[r>>8&255]+Nr[r>>16&255]+Nr[r>>24&255]).toLowerCase()}function li(n,e,t){return Math.max(e,Math.min(t,n))}function o7(n,e){return(n%e+e)%e}function Oy(n,e,t){return(1-t)*n+t*e}function sR(n){return(n&n-1)===0&&n!==0}function yE(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Po(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function hn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}class Ft{constructor(e=0,t=0){Ft.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(li(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*r-a*i+e.x,this.y=s*i+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Gt{constructor(e,t,r,i,s,a,c,u,h){Gt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,c,u,h)}set(e,t,r,i,s,a,c,u,h){const f=this.elements;return f[0]=e,f[1]=i,f[2]=c,f[3]=t,f[4]=s,f[5]=u,f[6]=r,f[7]=a,f[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],c=r[3],u=r[6],h=r[1],f=r[4],m=r[7],_=r[2],v=r[5],T=r[8],A=i[0],E=i[3],S=i[6],D=i[1],b=i[4],k=i[7],V=i[2],H=i[5],P=i[8];return s[0]=a*A+c*D+u*V,s[3]=a*E+c*b+u*H,s[6]=a*S+c*k+u*P,s[1]=h*A+f*D+m*V,s[4]=h*E+f*b+m*H,s[7]=h*S+f*k+m*P,s[2]=_*A+v*D+T*V,s[5]=_*E+v*b+T*H,s[8]=_*S+v*k+T*P,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],c=e[5],u=e[6],h=e[7],f=e[8];return t*a*f-t*c*h-r*s*f+r*c*u+i*s*h-i*a*u}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],c=e[5],u=e[6],h=e[7],f=e[8],m=f*a-c*h,_=c*u-f*s,v=h*s-a*u,T=t*m+r*_+i*v;if(T===0)return this.set(0,0,0,0,0,0,0,0,0);const A=1/T;return e[0]=m*A,e[1]=(i*h-f*r)*A,e[2]=(c*r-i*a)*A,e[3]=_*A,e[4]=(f*t-i*u)*A,e[5]=(i*s-c*t)*A,e[6]=v*A,e[7]=(r*u-h*t)*A,e[8]=(a*t-r*s)*A,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,a,c){const u=Math.cos(s),h=Math.sin(s);return this.set(r*u,r*h,-r*(u*a+h*c)+a+e,-i*h,i*u,-i*(-h*a+u*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(ky.makeScale(e,t)),this}rotate(e){return this.premultiply(ky.makeRotation(-e)),this}translate(e,t){return this.premultiply(ky.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const ky=new Gt;function CL(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function dg(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function a7(){const n=dg("canvas");return n.style.display="block",n}const oR={};function Cd(n){n in oR||(oR[n]=!0,console.warn(n))}const aR=new Gt().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),lR=new Gt().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Op={[jo]:{transfer:lg,primaries:cg,toReference:n=>n,fromReference:n=>n},[Tr]:{transfer:vn,primaries:cg,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[c_]:{transfer:lg,primaries:ug,toReference:n=>n.applyMatrix3(lR),fromReference:n=>n.applyMatrix3(aR)},[xT]:{transfer:vn,primaries:ug,toReference:n=>n.convertSRGBToLinear().applyMatrix3(lR),fromReference:n=>n.applyMatrix3(aR).convertLinearToSRGB()}},l7=new Set([jo,c_]),ln={enabled:!0,_workingColorSpace:jo,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!l7.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const r=Op[e].toReference,i=Op[t].fromReference;return i(r(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return Op[n].primaries},getTransfer:function(n){return n===ji?lg:Op[n].transfer}};function Lu(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Uy(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Xc;class PL{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Xc===void 0&&(Xc=dg("canvas")),Xc.width=e.width,Xc.height=e.height;const r=Xc.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Xc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=dg("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=Lu(s[a]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Lu(t[r]/255)*255):t[r]=Lu(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let c7=0;class IL{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:c7++}),this.uuid=Ga(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,c=i.length;a<c;a++)i[a].isDataTexture?s.push(Fy(i[a].image)):s.push(Fy(i[a]))}else s=Fy(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function Fy(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?PL.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let u7=0;class pi extends oh{constructor(e=pi.DEFAULT_IMAGE,t=pi.DEFAULT_MAPPING,r=hs,i=hs,s=Bi,a=$d,c=ds,u=Ba,h=pi.DEFAULT_ANISOTROPY,f=ji){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:u7++}),this.uuid=Ga(),this.name="",this.source=new IL(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=h,this.format=c,this.internalFormat=null,this.type=u,this.offset=new Ft(0,0),this.repeat=new Ft(1,1),this.center=new Ft(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Gt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof f=="string"?this.colorSpace=f:(Cd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===Ha?Tr:ji),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==vL)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case pE:e.x=e.x-Math.floor(e.x);break;case hs:e.x=e.x<0?0:1;break;case mE:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case pE:e.y=e.y-Math.floor(e.y);break;case hs:e.y=e.y<0?0:1;break;case mE:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Cd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Tr?Ha:ML}set encoding(e){Cd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Ha?Tr:ji}}pi.DEFAULT_IMAGE=null;pi.DEFAULT_MAPPING=vL;pi.DEFAULT_ANISOTROPY=1;class Sn{constructor(e=0,t=0,r=0,i=1){Sn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const u=e.elements,h=u[0],f=u[4],m=u[8],_=u[1],v=u[5],T=u[9],A=u[2],E=u[6],S=u[10];if(Math.abs(f-_)<.01&&Math.abs(m-A)<.01&&Math.abs(T-E)<.01){if(Math.abs(f+_)<.1&&Math.abs(m+A)<.1&&Math.abs(T+E)<.1&&Math.abs(h+v+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const b=(h+1)/2,k=(v+1)/2,V=(S+1)/2,H=(f+_)/4,P=(m+A)/4,I=(T+E)/4;return b>k&&b>V?b<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(b),i=H/r,s=P/r):k>V?k<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(k),r=H/i,s=I/i):V<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(V),r=P/s,i=I/s),this.set(r,i,s,t),this}let D=Math.sqrt((E-T)*(E-T)+(m-A)*(m-A)+(_-f)*(_-f));return Math.abs(D)<.001&&(D=1),this.x=(E-T)/D,this.y=(m-A)/D,this.z=(_-f)/D,this.w=Math.acos((h+v+S-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class h7 extends oh{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Sn(0,0,e,t),this.scissorTest=!1,this.viewport=new Sn(0,0,e,t);const i={width:e,height:t,depth:1};r.encoding!==void 0&&(Cd("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===Ha?Tr:ji),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Bi,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},r),this.texture=new pi(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps,this.texture.internalFormat=r.internalFormat,this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new IL(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class tc extends h7{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class DL extends pi{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Kr,this.minFilter=Kr,this.wrapR=hs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class d7 extends pi{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Kr,this.minFilter=Kr,this.wrapR=hs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class mf{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,a,c){let u=r[i+0],h=r[i+1],f=r[i+2],m=r[i+3];const _=s[a+0],v=s[a+1],T=s[a+2],A=s[a+3];if(c===0){e[t+0]=u,e[t+1]=h,e[t+2]=f,e[t+3]=m;return}if(c===1){e[t+0]=_,e[t+1]=v,e[t+2]=T,e[t+3]=A;return}if(m!==A||u!==_||h!==v||f!==T){let E=1-c;const S=u*_+h*v+f*T+m*A,D=S>=0?1:-1,b=1-S*S;if(b>Number.EPSILON){const V=Math.sqrt(b),H=Math.atan2(V,S*D);E=Math.sin(E*H)/V,c=Math.sin(c*H)/V}const k=c*D;if(u=u*E+_*k,h=h*E+v*k,f=f*E+T*k,m=m*E+A*k,E===1-c){const V=1/Math.sqrt(u*u+h*h+f*f+m*m);u*=V,h*=V,f*=V,m*=V}}e[t]=u,e[t+1]=h,e[t+2]=f,e[t+3]=m}static multiplyQuaternionsFlat(e,t,r,i,s,a){const c=r[i],u=r[i+1],h=r[i+2],f=r[i+3],m=s[a],_=s[a+1],v=s[a+2],T=s[a+3];return e[t]=c*T+f*m+u*v-h*_,e[t+1]=u*T+f*_+h*m-c*v,e[t+2]=h*T+f*v+c*_-u*m,e[t+3]=f*T-c*m-u*_-h*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,a=e._order,c=Math.cos,u=Math.sin,h=c(r/2),f=c(i/2),m=c(s/2),_=u(r/2),v=u(i/2),T=u(s/2);switch(a){case"XYZ":this._x=_*f*m+h*v*T,this._y=h*v*m-_*f*T,this._z=h*f*T+_*v*m,this._w=h*f*m-_*v*T;break;case"YXZ":this._x=_*f*m+h*v*T,this._y=h*v*m-_*f*T,this._z=h*f*T-_*v*m,this._w=h*f*m+_*v*T;break;case"ZXY":this._x=_*f*m-h*v*T,this._y=h*v*m+_*f*T,this._z=h*f*T+_*v*m,this._w=h*f*m-_*v*T;break;case"ZYX":this._x=_*f*m-h*v*T,this._y=h*v*m+_*f*T,this._z=h*f*T-_*v*m,this._w=h*f*m+_*v*T;break;case"YZX":this._x=_*f*m+h*v*T,this._y=h*v*m+_*f*T,this._z=h*f*T-_*v*m,this._w=h*f*m-_*v*T;break;case"XZY":this._x=_*f*m-h*v*T,this._y=h*v*m-_*f*T,this._z=h*f*T+_*v*m,this._w=h*f*m+_*v*T;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],a=t[1],c=t[5],u=t[9],h=t[2],f=t[6],m=t[10],_=r+c+m;if(_>0){const v=.5/Math.sqrt(_+1);this._w=.25/v,this._x=(f-u)*v,this._y=(s-h)*v,this._z=(a-i)*v}else if(r>c&&r>m){const v=2*Math.sqrt(1+r-c-m);this._w=(f-u)/v,this._x=.25*v,this._y=(i+a)/v,this._z=(s+h)/v}else if(c>m){const v=2*Math.sqrt(1+c-r-m);this._w=(s-h)/v,this._x=(i+a)/v,this._y=.25*v,this._z=(u+f)/v}else{const v=2*Math.sqrt(1+m-r-c);this._w=(a-i)/v,this._x=(s+h)/v,this._y=(u+f)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(li(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,a=e._w,c=t._x,u=t._y,h=t._z,f=t._w;return this._x=r*f+a*c+i*h-s*u,this._y=i*f+a*u+s*c-r*h,this._z=s*f+a*h+r*u-i*c,this._w=a*f-r*c-i*u-s*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,a=this._w;let c=a*e._w+r*e._x+i*e._y+s*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=a,this._x=r,this._y=i,this._z=s,this;const u=1-c*c;if(u<=Number.EPSILON){const v=1-t;return this._w=v*a+t*this._w,this._x=v*r+t*this._x,this._y=v*i+t*this._y,this._z=v*s+t*this._z,this.normalize(),this}const h=Math.sqrt(u),f=Math.atan2(h,c),m=Math.sin((1-t)*f)/h,_=Math.sin(t*f)/h;return this._w=a*m+this._w*_,this._x=r*m+this._x*_,this._y=i*m+this._y*_,this._z=s*m+this._z*_,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(s),r*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class oe{constructor(e=0,t=0,r=0){oe.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(cR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(cR.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,a=e.y,c=e.z,u=e.w,h=2*(a*i-c*r),f=2*(c*t-s*i),m=2*(s*r-a*t);return this.x=t+u*h+a*m-c*f,this.y=r+u*f+c*h-s*m,this.z=i+u*m+s*f-a*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,a=t.x,c=t.y,u=t.z;return this.x=i*u-s*c,this.y=s*a-r*u,this.z=r*c-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Vy.copy(this).projectOnVector(e),this.sub(Vy)}reflect(e){return this.sub(Vy.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(li(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Vy=new oe,cR=new mf;class gf{constructor(e=new oe(1/0,1/0,1/0),t=new oe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(ss.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(ss.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=ss.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,c=s.count;a<c;a++)e.isMesh===!0?e.getVertexPosition(a,ss):ss.fromBufferAttribute(s,a),ss.applyMatrix4(e.matrixWorld),this.expandByPoint(ss);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),kp.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),kp.copy(r.boundingBox)),kp.applyMatrix4(e.matrixWorld),this.union(kp)}const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ss),ss.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(qh),Up.subVectors(this.max,qh),Kc.subVectors(e.a,qh),Yc.subVectors(e.b,qh),Zc.subVectors(e.c,qh),_a.subVectors(Yc,Kc),va.subVectors(Zc,Yc),Ml.subVectors(Kc,Zc);let t=[0,-_a.z,_a.y,0,-va.z,va.y,0,-Ml.z,Ml.y,_a.z,0,-_a.x,va.z,0,-va.x,Ml.z,0,-Ml.x,-_a.y,_a.x,0,-va.y,va.x,0,-Ml.y,Ml.x,0];return!zy(t,Kc,Yc,Zc,Up)||(t=[1,0,0,0,1,0,0,0,1],!zy(t,Kc,Yc,Zc,Up))?!1:(Fp.crossVectors(_a,va),t=[Fp.x,Fp.y,Fp.z],zy(t,Kc,Yc,Zc,Up))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ss).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ss).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(So[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),So[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),So[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),So[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),So[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),So[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),So[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),So[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(So),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const So=[new oe,new oe,new oe,new oe,new oe,new oe,new oe,new oe],ss=new oe,kp=new gf,Kc=new oe,Yc=new oe,Zc=new oe,_a=new oe,va=new oe,Ml=new oe,qh=new oe,Up=new oe,Fp=new oe,bl=new oe;function zy(n,e,t,r,i){for(let s=0,a=n.length-3;s<=a;s+=3){bl.fromArray(n,s);const c=i.x*Math.abs(bl.x)+i.y*Math.abs(bl.y)+i.z*Math.abs(bl.z),u=e.dot(bl),h=t.dot(bl),f=r.dot(bl);if(Math.max(-Math.max(u,h,f),Math.min(u,h,f))>c)return!1}return!0}const f7=new gf,Xh=new oe,By=new oe;class u_{constructor(e=new oe,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):f7.setFromPoints(e).getCenter(r);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Xh.subVectors(e,this.center);const t=Xh.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(Xh,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(By.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Xh.copy(e.center).add(By)),this.expandByPoint(Xh.copy(e.center).sub(By))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const To=new oe,Hy=new oe,Vp=new oe,ya=new oe,Gy=new oe,zp=new oe,jy=new oe;class LL{constructor(e=new oe,t=new oe(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,To)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=To.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(To.copy(this.origin).addScaledVector(this.direction,t),To.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){Hy.copy(e).add(t).multiplyScalar(.5),Vp.copy(t).sub(e).normalize(),ya.copy(this.origin).sub(Hy);const s=e.distanceTo(t)*.5,a=-this.direction.dot(Vp),c=ya.dot(this.direction),u=-ya.dot(Vp),h=ya.lengthSq(),f=Math.abs(1-a*a);let m,_,v,T;if(f>0)if(m=a*u-c,_=a*c-u,T=s*f,m>=0)if(_>=-T)if(_<=T){const A=1/f;m*=A,_*=A,v=m*(m+a*_+2*c)+_*(a*m+_+2*u)+h}else _=s,m=Math.max(0,-(a*_+c)),v=-m*m+_*(_+2*u)+h;else _=-s,m=Math.max(0,-(a*_+c)),v=-m*m+_*(_+2*u)+h;else _<=-T?(m=Math.max(0,-(-a*s+c)),_=m>0?-s:Math.min(Math.max(-s,-u),s),v=-m*m+_*(_+2*u)+h):_<=T?(m=0,_=Math.min(Math.max(-s,-u),s),v=_*(_+2*u)+h):(m=Math.max(0,-(a*s+c)),_=m>0?s:Math.min(Math.max(-s,-u),s),v=-m*m+_*(_+2*u)+h);else _=a>0?-s:s,m=Math.max(0,-(a*_+c)),v=-m*m+_*(_+2*u)+h;return r&&r.copy(this.origin).addScaledVector(this.direction,m),i&&i.copy(Hy).addScaledVector(Vp,_),v}intersectSphere(e,t){To.subVectors(e.center,this.origin);const r=To.dot(this.direction),i=To.dot(To)-r*r,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),c=r-a,u=r+a;return u<0?null:c<0?this.at(u,t):this.at(c,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,a,c,u;const h=1/this.direction.x,f=1/this.direction.y,m=1/this.direction.z,_=this.origin;return h>=0?(r=(e.min.x-_.x)*h,i=(e.max.x-_.x)*h):(r=(e.max.x-_.x)*h,i=(e.min.x-_.x)*h),f>=0?(s=(e.min.y-_.y)*f,a=(e.max.y-_.y)*f):(s=(e.max.y-_.y)*f,a=(e.min.y-_.y)*f),r>a||s>i||((s>r||isNaN(r))&&(r=s),(a<i||isNaN(i))&&(i=a),m>=0?(c=(e.min.z-_.z)*m,u=(e.max.z-_.z)*m):(c=(e.max.z-_.z)*m,u=(e.min.z-_.z)*m),r>u||c>i)||((c>r||r!==r)&&(r=c),(u<i||i!==i)&&(i=u),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,To)!==null}intersectTriangle(e,t,r,i,s){Gy.subVectors(t,e),zp.subVectors(r,e),jy.crossVectors(Gy,zp);let a=this.direction.dot(jy),c;if(a>0){if(i)return null;c=1}else if(a<0)c=-1,a=-a;else return null;ya.subVectors(this.origin,e);const u=c*this.direction.dot(zp.crossVectors(ya,zp));if(u<0)return null;const h=c*this.direction.dot(Gy.cross(ya));if(h<0||u+h>a)return null;const f=-c*ya.dot(jy);return f<0?null:this.at(f/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Un{constructor(e,t,r,i,s,a,c,u,h,f,m,_,v,T,A,E){Un.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,c,u,h,f,m,_,v,T,A,E)}set(e,t,r,i,s,a,c,u,h,f,m,_,v,T,A,E){const S=this.elements;return S[0]=e,S[4]=t,S[8]=r,S[12]=i,S[1]=s,S[5]=a,S[9]=c,S[13]=u,S[2]=h,S[6]=f,S[10]=m,S[14]=_,S[3]=v,S[7]=T,S[11]=A,S[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Un().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/Qc.setFromMatrixColumn(e,0).length(),s=1/Qc.setFromMatrixColumn(e,1).length(),a=1/Qc.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,a=Math.cos(r),c=Math.sin(r),u=Math.cos(i),h=Math.sin(i),f=Math.cos(s),m=Math.sin(s);if(e.order==="XYZ"){const _=a*f,v=a*m,T=c*f,A=c*m;t[0]=u*f,t[4]=-u*m,t[8]=h,t[1]=v+T*h,t[5]=_-A*h,t[9]=-c*u,t[2]=A-_*h,t[6]=T+v*h,t[10]=a*u}else if(e.order==="YXZ"){const _=u*f,v=u*m,T=h*f,A=h*m;t[0]=_+A*c,t[4]=T*c-v,t[8]=a*h,t[1]=a*m,t[5]=a*f,t[9]=-c,t[2]=v*c-T,t[6]=A+_*c,t[10]=a*u}else if(e.order==="ZXY"){const _=u*f,v=u*m,T=h*f,A=h*m;t[0]=_-A*c,t[4]=-a*m,t[8]=T+v*c,t[1]=v+T*c,t[5]=a*f,t[9]=A-_*c,t[2]=-a*h,t[6]=c,t[10]=a*u}else if(e.order==="ZYX"){const _=a*f,v=a*m,T=c*f,A=c*m;t[0]=u*f,t[4]=T*h-v,t[8]=_*h+A,t[1]=u*m,t[5]=A*h+_,t[9]=v*h-T,t[2]=-h,t[6]=c*u,t[10]=a*u}else if(e.order==="YZX"){const _=a*u,v=a*h,T=c*u,A=c*h;t[0]=u*f,t[4]=A-_*m,t[8]=T*m+v,t[1]=m,t[5]=a*f,t[9]=-c*f,t[2]=-h*f,t[6]=v*m+T,t[10]=_-A*m}else if(e.order==="XZY"){const _=a*u,v=a*h,T=c*u,A=c*h;t[0]=u*f,t[4]=-m,t[8]=h*f,t[1]=_*m+A,t[5]=a*f,t[9]=v*m-T,t[2]=T*m-v,t[6]=c*f,t[10]=A*m+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(p7,e,m7)}lookAt(e,t,r){const i=this.elements;return Ti.subVectors(e,t),Ti.lengthSq()===0&&(Ti.z=1),Ti.normalize(),Ea.crossVectors(r,Ti),Ea.lengthSq()===0&&(Math.abs(r.z)===1?Ti.x+=1e-4:Ti.z+=1e-4,Ti.normalize(),Ea.crossVectors(r,Ti)),Ea.normalize(),Bp.crossVectors(Ti,Ea),i[0]=Ea.x,i[4]=Bp.x,i[8]=Ti.x,i[1]=Ea.y,i[5]=Bp.y,i[9]=Ti.y,i[2]=Ea.z,i[6]=Bp.z,i[10]=Ti.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],c=r[4],u=r[8],h=r[12],f=r[1],m=r[5],_=r[9],v=r[13],T=r[2],A=r[6],E=r[10],S=r[14],D=r[3],b=r[7],k=r[11],V=r[15],H=i[0],P=i[4],I=i[8],M=i[12],C=i[1],N=i[5],W=i[9],F=i[13],Y=i[2],ue=i[6],ye=i[10],ge=i[14],Q=i[3],re=i[7],ie=i[11],$=i[15];return s[0]=a*H+c*C+u*Y+h*Q,s[4]=a*P+c*N+u*ue+h*re,s[8]=a*I+c*W+u*ye+h*ie,s[12]=a*M+c*F+u*ge+h*$,s[1]=f*H+m*C+_*Y+v*Q,s[5]=f*P+m*N+_*ue+v*re,s[9]=f*I+m*W+_*ye+v*ie,s[13]=f*M+m*F+_*ge+v*$,s[2]=T*H+A*C+E*Y+S*Q,s[6]=T*P+A*N+E*ue+S*re,s[10]=T*I+A*W+E*ye+S*ie,s[14]=T*M+A*F+E*ge+S*$,s[3]=D*H+b*C+k*Y+V*Q,s[7]=D*P+b*N+k*ue+V*re,s[11]=D*I+b*W+k*ye+V*ie,s[15]=D*M+b*F+k*ge+V*$,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],a=e[1],c=e[5],u=e[9],h=e[13],f=e[2],m=e[6],_=e[10],v=e[14],T=e[3],A=e[7],E=e[11],S=e[15];return T*(+s*u*m-i*h*m-s*c*_+r*h*_+i*c*v-r*u*v)+A*(+t*u*v-t*h*_+s*a*_-i*a*v+i*h*f-s*u*f)+E*(+t*h*m-t*c*v-s*a*m+r*a*v+s*c*f-r*h*f)+S*(-i*c*f-t*u*m+t*c*_+i*a*m-r*a*_+r*u*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],c=e[5],u=e[6],h=e[7],f=e[8],m=e[9],_=e[10],v=e[11],T=e[12],A=e[13],E=e[14],S=e[15],D=m*E*h-A*_*h+A*u*v-c*E*v-m*u*S+c*_*S,b=T*_*h-f*E*h-T*u*v+a*E*v+f*u*S-a*_*S,k=f*A*h-T*m*h+T*c*v-a*A*v-f*c*S+a*m*S,V=T*m*u-f*A*u-T*c*_+a*A*_+f*c*E-a*m*E,H=t*D+r*b+i*k+s*V;if(H===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const P=1/H;return e[0]=D*P,e[1]=(A*_*s-m*E*s-A*i*v+r*E*v+m*i*S-r*_*S)*P,e[2]=(c*E*s-A*u*s+A*i*h-r*E*h-c*i*S+r*u*S)*P,e[3]=(m*u*s-c*_*s-m*i*h+r*_*h+c*i*v-r*u*v)*P,e[4]=b*P,e[5]=(f*E*s-T*_*s+T*i*v-t*E*v-f*i*S+t*_*S)*P,e[6]=(T*u*s-a*E*s-T*i*h+t*E*h+a*i*S-t*u*S)*P,e[7]=(a*_*s-f*u*s+f*i*h-t*_*h-a*i*v+t*u*v)*P,e[8]=k*P,e[9]=(T*m*s-f*A*s-T*r*v+t*A*v+f*r*S-t*m*S)*P,e[10]=(a*A*s-T*c*s+T*r*h-t*A*h-a*r*S+t*c*S)*P,e[11]=(f*c*s-a*m*s-f*r*h+t*m*h+a*r*v-t*c*v)*P,e[12]=V*P,e[13]=(f*A*i-T*m*i+T*r*_-t*A*_-f*r*E+t*m*E)*P,e[14]=(T*c*i-a*A*i-T*r*u+t*A*u+a*r*E-t*c*E)*P,e[15]=(a*m*i-f*c*i+f*r*u-t*m*u-a*r*_+t*c*_)*P,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,a=e.x,c=e.y,u=e.z,h=s*a,f=s*c;return this.set(h*a+r,h*c-i*u,h*u+i*c,0,h*c+i*u,f*c+r,f*u-i*a,0,h*u-i*c,f*u+i*a,s*u*u+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,a){return this.set(1,r,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,a=t._y,c=t._z,u=t._w,h=s+s,f=a+a,m=c+c,_=s*h,v=s*f,T=s*m,A=a*f,E=a*m,S=c*m,D=u*h,b=u*f,k=u*m,V=r.x,H=r.y,P=r.z;return i[0]=(1-(A+S))*V,i[1]=(v+k)*V,i[2]=(T-b)*V,i[3]=0,i[4]=(v-k)*H,i[5]=(1-(_+S))*H,i[6]=(E+D)*H,i[7]=0,i[8]=(T+b)*P,i[9]=(E-D)*P,i[10]=(1-(_+A))*P,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=Qc.set(i[0],i[1],i[2]).length();const a=Qc.set(i[4],i[5],i[6]).length(),c=Qc.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],os.copy(this);const h=1/s,f=1/a,m=1/c;return os.elements[0]*=h,os.elements[1]*=h,os.elements[2]*=h,os.elements[4]*=f,os.elements[5]*=f,os.elements[6]*=f,os.elements[8]*=m,os.elements[9]*=m,os.elements[10]*=m,t.setFromRotationMatrix(os),r.x=s,r.y=a,r.z=c,this}makePerspective(e,t,r,i,s,a,c=Lo){const u=this.elements,h=2*s/(t-e),f=2*s/(r-i),m=(t+e)/(t-e),_=(r+i)/(r-i);let v,T;if(c===Lo)v=-(a+s)/(a-s),T=-2*a*s/(a-s);else if(c===hg)v=-a/(a-s),T=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return u[0]=h,u[4]=0,u[8]=m,u[12]=0,u[1]=0,u[5]=f,u[9]=_,u[13]=0,u[2]=0,u[6]=0,u[10]=v,u[14]=T,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,t,r,i,s,a,c=Lo){const u=this.elements,h=1/(t-e),f=1/(r-i),m=1/(a-s),_=(t+e)*h,v=(r+i)*f;let T,A;if(c===Lo)T=(a+s)*m,A=-2*m;else if(c===hg)T=s*m,A=-1*m;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return u[0]=2*h,u[4]=0,u[8]=0,u[12]=-_,u[1]=0,u[5]=2*f,u[9]=0,u[13]=-v,u[2]=0,u[6]=0,u[10]=A,u[14]=-T,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const Qc=new oe,os=new Un,p7=new oe(0,0,0),m7=new oe(1,1,1),Ea=new oe,Bp=new oe,Ti=new oe,uR=new Un,hR=new mf;class h_{constructor(e=0,t=0,r=0,i=h_.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],a=i[4],c=i[8],u=i[1],h=i[5],f=i[9],m=i[2],_=i[6],v=i[10];switch(t){case"XYZ":this._y=Math.asin(li(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-f,v),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(_,h),this._z=0);break;case"YXZ":this._x=Math.asin(-li(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(c,v),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-m,s),this._z=0);break;case"ZXY":this._x=Math.asin(li(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-m,v),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(u,s));break;case"ZYX":this._y=Math.asin(-li(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(_,v),this._z=Math.atan2(u,s)):(this._x=0,this._z=Math.atan2(-a,h));break;case"YZX":this._z=Math.asin(li(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,h),this._y=Math.atan2(-m,s)):(this._x=0,this._y=Math.atan2(c,v));break;case"XZY":this._z=Math.asin(-li(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(_,h),this._y=Math.atan2(c,s)):(this._x=Math.atan2(-f,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return uR.makeRotationFromQuaternion(e),this.setFromRotationMatrix(uR,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return hR.setFromEuler(this),this.setFromQuaternion(hR,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}h_.DEFAULT_ORDER="XYZ";class NL{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let g7=0;const dR=new oe,Jc=new mf,xo=new Un,Hp=new oe,Kh=new oe,_7=new oe,v7=new mf,fR=new oe(1,0,0),pR=new oe(0,1,0),mR=new oe(0,0,1),y7={type:"added"},E7={type:"removed"};class zr extends oh{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:g7++}),this.uuid=Ga(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=zr.DEFAULT_UP.clone();const e=new oe,t=new h_,r=new mf,i=new oe(1,1,1);function s(){r.setFromEuler(t,!1)}function a(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Un},normalMatrix:{value:new Gt}}),this.matrix=new Un,this.matrixWorld=new Un,this.matrixAutoUpdate=zr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=zr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new NL,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Jc.setFromAxisAngle(e,t),this.quaternion.multiply(Jc),this}rotateOnWorldAxis(e,t){return Jc.setFromAxisAngle(e,t),this.quaternion.premultiply(Jc),this}rotateX(e){return this.rotateOnAxis(fR,e)}rotateY(e){return this.rotateOnAxis(pR,e)}rotateZ(e){return this.rotateOnAxis(mR,e)}translateOnAxis(e,t){return dR.copy(e).applyQuaternion(this.quaternion),this.position.add(dR.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(fR,e)}translateY(e){return this.translateOnAxis(pR,e)}translateZ(e){return this.translateOnAxis(mR,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(xo.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Hp.copy(e):Hp.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Kh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?xo.lookAt(Kh,Hp,this.up):xo.lookAt(Hp,Kh,this.up),this.quaternion.setFromRotationMatrix(xo),i&&(xo.extractRotation(i.matrixWorld),Jc.setFromRotationMatrix(xo),this.quaternion.premultiply(Jc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(y7)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(E7)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),xo.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),xo.multiply(e.parent.matrixWorld)),e.applyMatrix4(xo),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const a=this.children[r].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kh,e,_7),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kh,v7,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const s=t[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++){const c=i[s];c.matrixWorldAutoUpdate===!0&&c.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(c=>({boxInitialized:c.boxInitialized,boxMin:c.box.min.toArray(),boxMax:c.box.max.toArray(),sphereInitialized:c.sphereInitialized,sphereRadius:c.sphere.radius,sphereCenter:c.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(c,u){return c[u.uuid]===void 0&&(c[u.uuid]=u.toJSON(e)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const u=c.shapes;if(Array.isArray(u))for(let h=0,f=u.length;h<f;h++){const m=u[h];s(e.shapes,m)}else s(e.shapes,u)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let u=0,h=this.material.length;u<h;u++)c.push(s(e.materials,this.material[u]));i.material=c}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let c=0;c<this.children.length;c++)i.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let c=0;c<this.animations.length;c++){const u=this.animations[c];i.animations.push(s(e.animations,u))}}if(t){const c=a(e.geometries),u=a(e.materials),h=a(e.textures),f=a(e.images),m=a(e.shapes),_=a(e.skeletons),v=a(e.animations),T=a(e.nodes);c.length>0&&(r.geometries=c),u.length>0&&(r.materials=u),h.length>0&&(r.textures=h),f.length>0&&(r.images=f),m.length>0&&(r.shapes=m),_.length>0&&(r.skeletons=_),v.length>0&&(r.animations=v),T.length>0&&(r.nodes=T)}return r.object=i,r;function a(c){const u=[];for(const h in c){const f=c[h];delete f.metadata,u.push(f)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}zr.DEFAULT_UP=new oe(0,1,0);zr.DEFAULT_MATRIX_AUTO_UPDATE=!0;zr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const as=new oe,wo=new oe,Wy=new oe,Ao=new oe,eu=new oe,tu=new oe,gR=new oe,$y=new oe,qy=new oe,Xy=new oe;let Gp=!1;class Hi{constructor(e=new oe,t=new oe,r=new oe){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),as.subVectors(e,t),i.cross(as);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){as.subVectors(i,t),wo.subVectors(r,t),Wy.subVectors(e,t);const a=as.dot(as),c=as.dot(wo),u=as.dot(Wy),h=wo.dot(wo),f=wo.dot(Wy),m=a*h-c*c;if(m===0)return s.set(0,0,0),null;const _=1/m,v=(h*u-c*f)*_,T=(a*f-c*u)*_;return s.set(1-v-T,T,v)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,Ao)===null?!1:Ao.x>=0&&Ao.y>=0&&Ao.x+Ao.y<=1}static getUV(e,t,r,i,s,a,c,u){return Gp===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Gp=!0),this.getInterpolation(e,t,r,i,s,a,c,u)}static getInterpolation(e,t,r,i,s,a,c,u){return this.getBarycoord(e,t,r,i,Ao)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(s,Ao.x),u.addScaledVector(a,Ao.y),u.addScaledVector(c,Ao.z),u)}static isFrontFacing(e,t,r,i){return as.subVectors(r,t),wo.subVectors(e,t),as.cross(wo).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return as.subVectors(this.c,this.b),wo.subVectors(this.a,this.b),as.cross(wo).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Hi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Hi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,s){return Gp===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Gp=!0),Hi.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}getInterpolation(e,t,r,i,s){return Hi.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return Hi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Hi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let a,c;eu.subVectors(i,r),tu.subVectors(s,r),$y.subVectors(e,r);const u=eu.dot($y),h=tu.dot($y);if(u<=0&&h<=0)return t.copy(r);qy.subVectors(e,i);const f=eu.dot(qy),m=tu.dot(qy);if(f>=0&&m<=f)return t.copy(i);const _=u*m-f*h;if(_<=0&&u>=0&&f<=0)return a=u/(u-f),t.copy(r).addScaledVector(eu,a);Xy.subVectors(e,s);const v=eu.dot(Xy),T=tu.dot(Xy);if(T>=0&&v<=T)return t.copy(s);const A=v*h-u*T;if(A<=0&&h>=0&&T<=0)return c=h/(h-T),t.copy(r).addScaledVector(tu,c);const E=f*T-v*m;if(E<=0&&m-f>=0&&v-T>=0)return gR.subVectors(s,i),c=(m-f)/(m-f+(v-T)),t.copy(i).addScaledVector(gR,c);const S=1/(E+A+_);return a=A*S,c=_*S,t.copy(r).addScaledVector(eu,a).addScaledVector(tu,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const OL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Sa={h:0,s:0,l:0},jp={h:0,s:0,l:0};function Ky(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class en{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Tr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ln.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=ln.workingColorSpace){return this.r=e,this.g=t,this.b=r,ln.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=ln.workingColorSpace){if(e=o7(e,1),t=li(t,0,1),r=li(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,a=2*r-s;this.r=Ky(a,s,e+1/3),this.g=Ky(a,s,e),this.b=Ky(a,s,e-1/3)}return ln.toWorkingColorSpace(this,i),this}setStyle(e,t=Tr){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],c=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Tr){const r=OL[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Lu(e.r),this.g=Lu(e.g),this.b=Lu(e.b),this}copyLinearToSRGB(e){return this.r=Uy(e.r),this.g=Uy(e.g),this.b=Uy(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Tr){return ln.fromWorkingColorSpace(Or.copy(this),e),Math.round(li(Or.r*255,0,255))*65536+Math.round(li(Or.g*255,0,255))*256+Math.round(li(Or.b*255,0,255))}getHexString(e=Tr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=ln.workingColorSpace){ln.fromWorkingColorSpace(Or.copy(this),t);const r=Or.r,i=Or.g,s=Or.b,a=Math.max(r,i,s),c=Math.min(r,i,s);let u,h;const f=(c+a)/2;if(c===a)u=0,h=0;else{const m=a-c;switch(h=f<=.5?m/(a+c):m/(2-a-c),a){case r:u=(i-s)/m+(i<s?6:0);break;case i:u=(s-r)/m+2;break;case s:u=(r-i)/m+4;break}u/=6}return e.h=u,e.s=h,e.l=f,e}getRGB(e,t=ln.workingColorSpace){return ln.fromWorkingColorSpace(Or.copy(this),t),e.r=Or.r,e.g=Or.g,e.b=Or.b,e}getStyle(e=Tr){ln.fromWorkingColorSpace(Or.copy(this),e);const t=Or.r,r=Or.g,i=Or.b;return e!==Tr?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(Sa),this.setHSL(Sa.h+e,Sa.s+t,Sa.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Sa),e.getHSL(jp);const r=Oy(Sa.h,jp.h,t),i=Oy(Sa.s,jp.s,t),s=Oy(Sa.l,jp.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Or=new en;en.NAMES=OL;let S7=0;class fc extends oh{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:S7++}),this.uuid=Ga(),this.name="",this.type="Material",this.blending=Du,this.side=Qa,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=uE,this.blendDst=hE,this.blendEquation=Ol,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new en(0,0,0),this.blendAlpha=0,this.depthFunc=ag,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=rR,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=qc,this.stencilZFail=qc,this.stencilZPass=qc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Du&&(r.blending=this.blending),this.side!==Qa&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==uE&&(r.blendSrc=this.blendSrc),this.blendDst!==hE&&(r.blendDst=this.blendDst),this.blendEquation!==Ol&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==ag&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==rR&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==qc&&(r.stencilFail=this.stencilFail),this.stencilZFail!==qc&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==qc&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const a=[];for(const c in s){const u=s[c];delete u.metadata,a.push(u)}return a}if(t){const s=i(e.textures),a=i(e.images);s.length>0&&(r.textures=s),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class wT extends fc{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new en(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=_L,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Yn=new oe,Wp=new Ft;class $i{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=gE,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Na,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)Wp.fromBufferAttribute(this,t),Wp.applyMatrix3(e),this.setXY(t,Wp.x,Wp.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Yn.fromBufferAttribute(this,t),Yn.applyMatrix3(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Yn.fromBufferAttribute(this,t),Yn.applyMatrix4(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Yn.fromBufferAttribute(this,t),Yn.applyNormalMatrix(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Yn.fromBufferAttribute(this,t),Yn.transformDirection(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=Po(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=hn(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Po(t,this.array)),t}setX(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Po(t,this.array)),t}setY(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Po(t,this.array)),t}setZ(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Po(t,this.array)),t}setW(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),r=hn(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),r=hn(r,this.array),i=hn(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),r=hn(r,this.array),i=hn(i,this.array),s=hn(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==gE&&(e.usage=this.usage),e}}class kL extends $i{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class UL extends $i{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Ri extends $i{constructor(e,t,r){super(new Float32Array(e),t,r)}}let T7=0;const Vi=new Un,Yy=new zr,nu=new oe,xi=new gf,Yh=new gf,ur=new oe;class Xi extends oh{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:T7++}),this.uuid=Ga(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(CL(e)?UL:kL)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Gt().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Vi.makeRotationFromQuaternion(e),this.applyMatrix4(Vi),this}rotateX(e){return Vi.makeRotationX(e),this.applyMatrix4(Vi),this}rotateY(e){return Vi.makeRotationY(e),this.applyMatrix4(Vi),this}rotateZ(e){return Vi.makeRotationZ(e),this.applyMatrix4(Vi),this}translate(e,t,r){return Vi.makeTranslation(e,t,r),this.applyMatrix4(Vi),this}scale(e,t,r){return Vi.makeScale(e,t,r),this.applyMatrix4(Vi),this}lookAt(e){return Yy.lookAt(e),Yy.updateMatrix(),this.applyMatrix4(Yy.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(nu).negate(),this.translate(nu.x,nu.y,nu.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ri(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gf);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new oe(-1/0,-1/0,-1/0),new oe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];xi.setFromBufferAttribute(s),this.morphTargetsRelative?(ur.addVectors(this.boundingBox.min,xi.min),this.boundingBox.expandByPoint(ur),ur.addVectors(this.boundingBox.max,xi.max),this.boundingBox.expandByPoint(ur)):(this.boundingBox.expandByPoint(xi.min),this.boundingBox.expandByPoint(xi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new u_);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new oe,1/0);return}if(e){const r=this.boundingSphere.center;if(xi.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const c=t[s];Yh.setFromBufferAttribute(c),this.morphTargetsRelative?(ur.addVectors(xi.min,Yh.min),xi.expandByPoint(ur),ur.addVectors(xi.max,Yh.max),xi.expandByPoint(ur)):(xi.expandByPoint(Yh.min),xi.expandByPoint(Yh.max))}xi.getCenter(r);let i=0;for(let s=0,a=e.count;s<a;s++)ur.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(ur));if(t)for(let s=0,a=t.length;s<a;s++){const c=t[s],u=this.morphTargetsRelative;for(let h=0,f=c.count;h<f;h++)ur.fromBufferAttribute(c,h),u&&(nu.fromBufferAttribute(e,h),ur.add(nu)),i=Math.max(i,r.distanceToSquared(ur))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=t.position.array,s=t.normal.array,a=t.uv.array,c=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new $i(new Float32Array(4*c),4));const u=this.getAttribute("tangent").array,h=[],f=[];for(let C=0;C<c;C++)h[C]=new oe,f[C]=new oe;const m=new oe,_=new oe,v=new oe,T=new Ft,A=new Ft,E=new Ft,S=new oe,D=new oe;function b(C,N,W){m.fromArray(i,C*3),_.fromArray(i,N*3),v.fromArray(i,W*3),T.fromArray(a,C*2),A.fromArray(a,N*2),E.fromArray(a,W*2),_.sub(m),v.sub(m),A.sub(T),E.sub(T);const F=1/(A.x*E.y-E.x*A.y);isFinite(F)&&(S.copy(_).multiplyScalar(E.y).addScaledVector(v,-A.y).multiplyScalar(F),D.copy(v).multiplyScalar(A.x).addScaledVector(_,-E.x).multiplyScalar(F),h[C].add(S),h[N].add(S),h[W].add(S),f[C].add(D),f[N].add(D),f[W].add(D))}let k=this.groups;k.length===0&&(k=[{start:0,count:r.length}]);for(let C=0,N=k.length;C<N;++C){const W=k[C],F=W.start,Y=W.count;for(let ue=F,ye=F+Y;ue<ye;ue+=3)b(r[ue+0],r[ue+1],r[ue+2])}const V=new oe,H=new oe,P=new oe,I=new oe;function M(C){P.fromArray(s,C*3),I.copy(P);const N=h[C];V.copy(N),V.sub(P.multiplyScalar(P.dot(N))).normalize(),H.crossVectors(I,N);const F=H.dot(f[C])<0?-1:1;u[C*4]=V.x,u[C*4+1]=V.y,u[C*4+2]=V.z,u[C*4+3]=F}for(let C=0,N=k.length;C<N;++C){const W=k[C],F=W.start,Y=W.count;for(let ue=F,ye=F+Y;ue<ye;ue+=3)M(r[ue+0]),M(r[ue+1]),M(r[ue+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new $i(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let _=0,v=r.count;_<v;_++)r.setXYZ(_,0,0,0);const i=new oe,s=new oe,a=new oe,c=new oe,u=new oe,h=new oe,f=new oe,m=new oe;if(e)for(let _=0,v=e.count;_<v;_+=3){const T=e.getX(_+0),A=e.getX(_+1),E=e.getX(_+2);i.fromBufferAttribute(t,T),s.fromBufferAttribute(t,A),a.fromBufferAttribute(t,E),f.subVectors(a,s),m.subVectors(i,s),f.cross(m),c.fromBufferAttribute(r,T),u.fromBufferAttribute(r,A),h.fromBufferAttribute(r,E),c.add(f),u.add(f),h.add(f),r.setXYZ(T,c.x,c.y,c.z),r.setXYZ(A,u.x,u.y,u.z),r.setXYZ(E,h.x,h.y,h.z)}else for(let _=0,v=t.count;_<v;_+=3)i.fromBufferAttribute(t,_+0),s.fromBufferAttribute(t,_+1),a.fromBufferAttribute(t,_+2),f.subVectors(a,s),m.subVectors(i,s),f.cross(m),r.setXYZ(_+0,f.x,f.y,f.z),r.setXYZ(_+1,f.x,f.y,f.z),r.setXYZ(_+2,f.x,f.y,f.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)ur.fromBufferAttribute(e,t),ur.normalize(),e.setXYZ(t,ur.x,ur.y,ur.z)}toNonIndexed(){function e(c,u){const h=c.array,f=c.itemSize,m=c.normalized,_=new h.constructor(u.length*f);let v=0,T=0;for(let A=0,E=u.length;A<E;A++){c.isInterleavedBufferAttribute?v=u[A]*c.data.stride+c.offset:v=u[A]*f;for(let S=0;S<f;S++)_[T++]=h[v++]}return new $i(_,f,m)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Xi,r=this.index.array,i=this.attributes;for(const c in i){const u=i[c],h=e(u,r);t.setAttribute(c,h)}const s=this.morphAttributes;for(const c in s){const u=[],h=s[c];for(let f=0,m=h.length;f<m;f++){const _=h[f],v=e(_,r);u.push(v)}t.morphAttributes[c]=u}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let c=0,u=a.length;c<u;c++){const h=a[c];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const h in u)u[h]!==void 0&&(e[h]=u[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const u in r){const h=r[u];e.data.attributes[u]=h.toJSON(e.data)}const i={};let s=!1;for(const u in this.morphAttributes){const h=this.morphAttributes[u],f=[];for(let m=0,_=h.length;m<_;m++){const v=h[m];f.push(v.toJSON(e.data))}f.length>0&&(i[u]=f,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const h in i){const f=i[h];this.setAttribute(h,f.clone(t))}const s=e.morphAttributes;for(const h in s){const f=[],m=s[h];for(let _=0,v=m.length;_<v;_++)f.push(m[_].clone(t));this.morphAttributes[h]=f}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let h=0,f=a.length;h<f;h++){const m=a[h];this.addGroup(m.start,m.count,m.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _R=new Un,Rl=new LL,$p=new u_,vR=new oe,ru=new oe,iu=new oe,su=new oe,Zy=new oe,qp=new oe,Xp=new Ft,Kp=new Ft,Yp=new Ft,yR=new oe,ER=new oe,SR=new oe,Zp=new oe,Qp=new oe;class ps extends zr{constructor(e=new Xi,t=new wT){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const c=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const c=this.morphTargetInfluences;if(s&&c){qp.set(0,0,0);for(let u=0,h=s.length;u<h;u++){const f=c[u],m=s[u];f!==0&&(Zy.fromBufferAttribute(m,e),a?qp.addScaledVector(Zy,f):qp.addScaledVector(Zy.sub(t),f))}t.add(qp)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),$p.copy(r.boundingSphere),$p.applyMatrix4(s),Rl.copy(e.ray).recast(e.near),!($p.containsPoint(Rl.origin)===!1&&(Rl.intersectSphere($p,vR)===null||Rl.origin.distanceToSquared(vR)>(e.far-e.near)**2))&&(_R.copy(s).invert(),Rl.copy(e.ray).applyMatrix4(_R),!(r.boundingBox!==null&&Rl.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,Rl)))}_computeIntersections(e,t,r){let i;const s=this.geometry,a=this.material,c=s.index,u=s.attributes.position,h=s.attributes.uv,f=s.attributes.uv1,m=s.attributes.normal,_=s.groups,v=s.drawRange;if(c!==null)if(Array.isArray(a))for(let T=0,A=_.length;T<A;T++){const E=_[T],S=a[E.materialIndex],D=Math.max(E.start,v.start),b=Math.min(c.count,Math.min(E.start+E.count,v.start+v.count));for(let k=D,V=b;k<V;k+=3){const H=c.getX(k),P=c.getX(k+1),I=c.getX(k+2);i=Jp(this,S,e,r,h,f,m,H,P,I),i&&(i.faceIndex=Math.floor(k/3),i.face.materialIndex=E.materialIndex,t.push(i))}}else{const T=Math.max(0,v.start),A=Math.min(c.count,v.start+v.count);for(let E=T,S=A;E<S;E+=3){const D=c.getX(E),b=c.getX(E+1),k=c.getX(E+2);i=Jp(this,a,e,r,h,f,m,D,b,k),i&&(i.faceIndex=Math.floor(E/3),t.push(i))}}else if(u!==void 0)if(Array.isArray(a))for(let T=0,A=_.length;T<A;T++){const E=_[T],S=a[E.materialIndex],D=Math.max(E.start,v.start),b=Math.min(u.count,Math.min(E.start+E.count,v.start+v.count));for(let k=D,V=b;k<V;k+=3){const H=k,P=k+1,I=k+2;i=Jp(this,S,e,r,h,f,m,H,P,I),i&&(i.faceIndex=Math.floor(k/3),i.face.materialIndex=E.materialIndex,t.push(i))}}else{const T=Math.max(0,v.start),A=Math.min(u.count,v.start+v.count);for(let E=T,S=A;E<S;E+=3){const D=E,b=E+1,k=E+2;i=Jp(this,a,e,r,h,f,m,D,b,k),i&&(i.faceIndex=Math.floor(E/3),t.push(i))}}}}function x7(n,e,t,r,i,s,a,c){let u;if(e.side===fi?u=r.intersectTriangle(a,s,i,!0,c):u=r.intersectTriangle(i,s,a,e.side===Qa,c),u===null)return null;Qp.copy(c),Qp.applyMatrix4(n.matrixWorld);const h=t.ray.origin.distanceTo(Qp);return h<t.near||h>t.far?null:{distance:h,point:Qp.clone(),object:n}}function Jp(n,e,t,r,i,s,a,c,u,h){n.getVertexPosition(c,ru),n.getVertexPosition(u,iu),n.getVertexPosition(h,su);const f=x7(n,e,t,r,ru,iu,su,Zp);if(f){i&&(Xp.fromBufferAttribute(i,c),Kp.fromBufferAttribute(i,u),Yp.fromBufferAttribute(i,h),f.uv=Hi.getInterpolation(Zp,ru,iu,su,Xp,Kp,Yp,new Ft)),s&&(Xp.fromBufferAttribute(s,c),Kp.fromBufferAttribute(s,u),Yp.fromBufferAttribute(s,h),f.uv1=Hi.getInterpolation(Zp,ru,iu,su,Xp,Kp,Yp,new Ft),f.uv2=f.uv1),a&&(yR.fromBufferAttribute(a,c),ER.fromBufferAttribute(a,u),SR.fromBufferAttribute(a,h),f.normal=Hi.getInterpolation(Zp,ru,iu,su,yR,ER,SR,new oe),f.normal.dot(r.direction)>0&&f.normal.multiplyScalar(-1));const m={a:c,b:u,c:h,normal:new oe,materialIndex:0};Hi.getNormal(ru,iu,su,m.normal),f.face=m}return f}class _f extends Xi{constructor(e=1,t=1,r=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:a};const c=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const u=[],h=[],f=[],m=[];let _=0,v=0;T("z","y","x",-1,-1,r,t,e,a,s,0),T("z","y","x",1,-1,r,t,-e,a,s,1),T("x","z","y",1,1,e,r,t,i,a,2),T("x","z","y",1,-1,e,r,-t,i,a,3),T("x","y","z",1,-1,e,t,r,i,s,4),T("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(u),this.setAttribute("position",new Ri(h,3)),this.setAttribute("normal",new Ri(f,3)),this.setAttribute("uv",new Ri(m,2));function T(A,E,S,D,b,k,V,H,P,I,M){const C=k/P,N=V/I,W=k/2,F=V/2,Y=H/2,ue=P+1,ye=I+1;let ge=0,Q=0;const re=new oe;for(let ie=0;ie<ye;ie++){const $=ie*N-F;for(let ne=0;ne<ue;ne++){const te=ne*C-W;re[A]=te*D,re[E]=$*b,re[S]=Y,h.push(re.x,re.y,re.z),re[A]=0,re[E]=0,re[S]=H>0?1:-1,f.push(re.x,re.y,re.z),m.push(ne/P),m.push(1-ie/I),ge+=1}}for(let ie=0;ie<I;ie++)for(let $=0;$<P;$++){const ne=_+$+ue*ie,te=_+$+ue*(ie+1),_e=_+($+1)+ue*(ie+1),Ee=_+($+1)+ue*ie;u.push(ne,te,Ee),u.push(te,_e,Ee),Q+=6}c.addGroup(v,Q,M),v+=Q,_+=ge}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _f(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ku(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function Xr(n){const e={};for(let t=0;t<n.length;t++){const r=Ku(n[t]);for(const i in r)e[i]=r[i]}return e}function w7(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function FL(n){return n.getRenderTarget()===null?n.outputColorSpace:ln.workingColorSpace}const A7={clone:Ku,merge:Xr};var M7=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,b7=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class nc extends fc{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=M7,this.fragmentShader=b7,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ku(e.uniforms),this.uniformsGroups=w7(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?t.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[i]={type:"m4",value:a.toArray()}:t.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class VL extends zr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Un,this.projectionMatrix=new Un,this.projectionMatrixInverse=new Un,this.coordinateSystem=Lo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Ai extends VL{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=vE*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Ny*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return vE*2*Math.atan(Math.tan(Ny*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Ny*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const u=a.fullWidth,h=a.fullHeight;s+=a.offsetX*i/u,t-=a.offsetY*r/h,i*=a.width/u,r*=a.height/h}const c=this.filmOffset;c!==0&&(s+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const ou=-90,au=1;class R7 extends zr{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Ai(ou,au,e,t);i.layers=this.layers,this.add(i);const s=new Ai(ou,au,e,t);s.layers=this.layers,this.add(s);const a=new Ai(ou,au,e,t);a.layers=this.layers,this.add(a);const c=new Ai(ou,au,e,t);c.layers=this.layers,this.add(c);const u=new Ai(ou,au,e,t);u.layers=this.layers,this.add(u);const h=new Ai(ou,au,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,a,c,u]=t;for(const h of t)this.remove(h);if(e===Lo)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(e===hg)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,c,u,h,f]=this.children,m=e.getRenderTarget(),_=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),T=e.xr.enabled;e.xr.enabled=!1;const A=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,a),e.setRenderTarget(r,2,i),e.render(t,c),e.setRenderTarget(r,3,i),e.render(t,u),e.setRenderTarget(r,4,i),e.render(t,h),r.texture.generateMipmaps=A,e.setRenderTarget(r,5,i),e.render(t,f),e.setRenderTarget(m,_,v),e.xr.enabled=T,r.texture.needsPMREMUpdate=!0}}class zL extends pi{constructor(e,t,r,i,s,a,c,u,h,f){e=e!==void 0?e:[],t=t!==void 0?t:$u,super(e,t,r,i,s,a,c,u,h,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class C7 extends tc{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];t.encoding!==void 0&&(Cd("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Ha?Tr:ji),this.texture=new zL(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Bi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new _f(5,5,5),s=new nc({name:"CubemapFromEquirect",uniforms:Ku(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:fi,blending:Va});s.uniforms.tEquirect.value=t;const a=new ps(i,s),c=t.minFilter;return t.minFilter===$d&&(t.minFilter=Bi),new R7(1,10,this).update(e,a),t.minFilter=c,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,r,i){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,r,i);e.setRenderTarget(s)}}const Qy=new oe,P7=new oe,I7=new Gt;class Ll{constructor(e=new oe(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=Qy.subVectors(r,t).cross(P7.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(Qy),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||I7.getNormalMatrix(e),i=this.coplanarPoint(Qy).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Cl=new u_,em=new oe;class AT{constructor(e=new Ll,t=new Ll,r=new Ll,i=new Ll,s=new Ll,a=new Ll){this.planes=[e,t,r,i,s,a]}set(e,t,r,i,s,a){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(r),c[3].copy(i),c[4].copy(s),c[5].copy(a),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=Lo){const r=this.planes,i=e.elements,s=i[0],a=i[1],c=i[2],u=i[3],h=i[4],f=i[5],m=i[6],_=i[7],v=i[8],T=i[9],A=i[10],E=i[11],S=i[12],D=i[13],b=i[14],k=i[15];if(r[0].setComponents(u-s,_-h,E-v,k-S).normalize(),r[1].setComponents(u+s,_+h,E+v,k+S).normalize(),r[2].setComponents(u+a,_+f,E+T,k+D).normalize(),r[3].setComponents(u-a,_-f,E-T,k-D).normalize(),r[4].setComponents(u-c,_-m,E-A,k-b).normalize(),t===Lo)r[5].setComponents(u+c,_+m,E+A,k+b).normalize();else if(t===hg)r[5].setComponents(c,m,A,b).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Cl.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Cl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Cl)}intersectsSprite(e){return Cl.center.set(0,0,0),Cl.radius=.7071067811865476,Cl.applyMatrix4(e.matrixWorld),this.intersectsSphere(Cl)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(em.x=i.normal.x>0?e.max.x:e.min.x,em.y=i.normal.y>0?e.max.y:e.min.y,em.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(em)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function BL(){let n=null,e=!1,t=null,r=null;function i(s,a){t(s,a),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function D7(n,e){const t=e.isWebGL2,r=new WeakMap;function i(h,f){const m=h.array,_=h.usage,v=m.byteLength,T=n.createBuffer();n.bindBuffer(f,T),n.bufferData(f,m,_),h.onUploadCallback();let A;if(m instanceof Float32Array)A=n.FLOAT;else if(m instanceof Uint16Array)if(h.isFloat16BufferAttribute)if(t)A=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else A=n.UNSIGNED_SHORT;else if(m instanceof Int16Array)A=n.SHORT;else if(m instanceof Uint32Array)A=n.UNSIGNED_INT;else if(m instanceof Int32Array)A=n.INT;else if(m instanceof Int8Array)A=n.BYTE;else if(m instanceof Uint8Array)A=n.UNSIGNED_BYTE;else if(m instanceof Uint8ClampedArray)A=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+m);return{buffer:T,type:A,bytesPerElement:m.BYTES_PER_ELEMENT,version:h.version,size:v}}function s(h,f,m){const _=f.array,v=f._updateRange,T=f.updateRanges;if(n.bindBuffer(m,h),v.count===-1&&T.length===0&&n.bufferSubData(m,0,_),T.length!==0){for(let A=0,E=T.length;A<E;A++){const S=T[A];t?n.bufferSubData(m,S.start*_.BYTES_PER_ELEMENT,_,S.start,S.count):n.bufferSubData(m,S.start*_.BYTES_PER_ELEMENT,_.subarray(S.start,S.start+S.count))}f.clearUpdateRanges()}v.count!==-1&&(t?n.bufferSubData(m,v.offset*_.BYTES_PER_ELEMENT,_,v.offset,v.count):n.bufferSubData(m,v.offset*_.BYTES_PER_ELEMENT,_.subarray(v.offset,v.offset+v.count)),v.count=-1),f.onUploadCallback()}function a(h){return h.isInterleavedBufferAttribute&&(h=h.data),r.get(h)}function c(h){h.isInterleavedBufferAttribute&&(h=h.data);const f=r.get(h);f&&(n.deleteBuffer(f.buffer),r.delete(h))}function u(h,f){if(h.isGLBufferAttribute){const _=r.get(h);(!_||_.version<h.version)&&r.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);const m=r.get(h);if(m===void 0)r.set(h,i(h,f));else if(m.version<h.version){if(m.size!==h.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(m.buffer,h,f),m.version=h.version}}return{get:a,remove:c,update:u}}class MT extends Xi{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,a=t/2,c=Math.floor(r),u=Math.floor(i),h=c+1,f=u+1,m=e/c,_=t/u,v=[],T=[],A=[],E=[];for(let S=0;S<f;S++){const D=S*_-a;for(let b=0;b<h;b++){const k=b*m-s;T.push(k,-D,0),A.push(0,0,1),E.push(b/c),E.push(1-S/u)}}for(let S=0;S<u;S++)for(let D=0;D<c;D++){const b=D+h*S,k=D+h*(S+1),V=D+1+h*(S+1),H=D+1+h*S;v.push(b,k,H),v.push(k,V,H)}this.setIndex(v),this.setAttribute("position",new Ri(T,3)),this.setAttribute("normal",new Ri(A,3)),this.setAttribute("uv",new Ri(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new MT(e.width,e.height,e.widthSegments,e.heightSegments)}}var L7=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,N7=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,O7=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,k7=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,U7=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,F7=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,V7=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,z7=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,B7=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,H7=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,G7=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,j7=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,W7=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,$7=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,q7=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,X7=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,K7=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Y7=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Z7=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Q7=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,J7=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,e$=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,t$=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,n$=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,r$=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,i$=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,s$=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,o$=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,a$=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,l$=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,c$="gl_FragColor = linearToOutputTexel( gl_FragColor );",u$=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,h$=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,d$=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,f$=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,p$=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,m$=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,g$=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,_$=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,v$=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,y$=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,E$=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,S$=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,T$=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,x$=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,w$=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,A$=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,M$=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,b$=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,R$=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,C$=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,P$=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,I$=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,D$=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,L$=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,N$=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,O$=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,k$=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,U$=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,F$=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,V$=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,z$=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,B$=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,H$=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,G$=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,j$=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,W$=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,$$=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,q$=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,X$=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,K$=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Y$=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Z$=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Q$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,J$=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,eq=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,tq=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,nq=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,rq=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,iq=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,sq=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,oq=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,aq=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,lq=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,cq=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,uq=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,hq=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,dq=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,fq=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,pq=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,mq=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,gq=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,_q=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,vq=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,yq=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Eq=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Sq=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Tq=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,xq=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,wq=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Aq=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Mq=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,bq=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Rq=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Cq=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Pq=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Iq=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Dq=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Lq=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Nq=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Oq=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,kq=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Uq=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Fq=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Vq=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,zq=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Bq=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Hq=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Gq=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,jq=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Wq=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$q=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,qq=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Xq=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Kq=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Yq=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Zq=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Qq=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Jq=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,eX=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,tX=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nX=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,rX=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iX=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sX=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oX=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,aX=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,lX=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cX=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,uX=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,hX=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Ut={alphahash_fragment:L7,alphahash_pars_fragment:N7,alphamap_fragment:O7,alphamap_pars_fragment:k7,alphatest_fragment:U7,alphatest_pars_fragment:F7,aomap_fragment:V7,aomap_pars_fragment:z7,batching_pars_vertex:B7,batching_vertex:H7,begin_vertex:G7,beginnormal_vertex:j7,bsdfs:W7,iridescence_fragment:$7,bumpmap_pars_fragment:q7,clipping_planes_fragment:X7,clipping_planes_pars_fragment:K7,clipping_planes_pars_vertex:Y7,clipping_planes_vertex:Z7,color_fragment:Q7,color_pars_fragment:J7,color_pars_vertex:e$,color_vertex:t$,common:n$,cube_uv_reflection_fragment:r$,defaultnormal_vertex:i$,displacementmap_pars_vertex:s$,displacementmap_vertex:o$,emissivemap_fragment:a$,emissivemap_pars_fragment:l$,colorspace_fragment:c$,colorspace_pars_fragment:u$,envmap_fragment:h$,envmap_common_pars_fragment:d$,envmap_pars_fragment:f$,envmap_pars_vertex:p$,envmap_physical_pars_fragment:M$,envmap_vertex:m$,fog_vertex:g$,fog_pars_vertex:_$,fog_fragment:v$,fog_pars_fragment:y$,gradientmap_pars_fragment:E$,lightmap_fragment:S$,lightmap_pars_fragment:T$,lights_lambert_fragment:x$,lights_lambert_pars_fragment:w$,lights_pars_begin:A$,lights_toon_fragment:b$,lights_toon_pars_fragment:R$,lights_phong_fragment:C$,lights_phong_pars_fragment:P$,lights_physical_fragment:I$,lights_physical_pars_fragment:D$,lights_fragment_begin:L$,lights_fragment_maps:N$,lights_fragment_end:O$,logdepthbuf_fragment:k$,logdepthbuf_pars_fragment:U$,logdepthbuf_pars_vertex:F$,logdepthbuf_vertex:V$,map_fragment:z$,map_pars_fragment:B$,map_particle_fragment:H$,map_particle_pars_fragment:G$,metalnessmap_fragment:j$,metalnessmap_pars_fragment:W$,morphcolor_vertex:$$,morphnormal_vertex:q$,morphtarget_pars_vertex:X$,morphtarget_vertex:K$,normal_fragment_begin:Y$,normal_fragment_maps:Z$,normal_pars_fragment:Q$,normal_pars_vertex:J$,normal_vertex:eq,normalmap_pars_fragment:tq,clearcoat_normal_fragment_begin:nq,clearcoat_normal_fragment_maps:rq,clearcoat_pars_fragment:iq,iridescence_pars_fragment:sq,opaque_fragment:oq,packing:aq,premultiplied_alpha_fragment:lq,project_vertex:cq,dithering_fragment:uq,dithering_pars_fragment:hq,roughnessmap_fragment:dq,roughnessmap_pars_fragment:fq,shadowmap_pars_fragment:pq,shadowmap_pars_vertex:mq,shadowmap_vertex:gq,shadowmask_pars_fragment:_q,skinbase_vertex:vq,skinning_pars_vertex:yq,skinning_vertex:Eq,skinnormal_vertex:Sq,specularmap_fragment:Tq,specularmap_pars_fragment:xq,tonemapping_fragment:wq,tonemapping_pars_fragment:Aq,transmission_fragment:Mq,transmission_pars_fragment:bq,uv_pars_fragment:Rq,uv_pars_vertex:Cq,uv_vertex:Pq,worldpos_vertex:Iq,background_vert:Dq,background_frag:Lq,backgroundCube_vert:Nq,backgroundCube_frag:Oq,cube_vert:kq,cube_frag:Uq,depth_vert:Fq,depth_frag:Vq,distanceRGBA_vert:zq,distanceRGBA_frag:Bq,equirect_vert:Hq,equirect_frag:Gq,linedashed_vert:jq,linedashed_frag:Wq,meshbasic_vert:$q,meshbasic_frag:qq,meshlambert_vert:Xq,meshlambert_frag:Kq,meshmatcap_vert:Yq,meshmatcap_frag:Zq,meshnormal_vert:Qq,meshnormal_frag:Jq,meshphong_vert:eX,meshphong_frag:tX,meshphysical_vert:nX,meshphysical_frag:rX,meshtoon_vert:iX,meshtoon_frag:sX,points_vert:oX,points_frag:aX,shadow_vert:lX,shadow_frag:cX,sprite_vert:uX,sprite_frag:hX},je={common:{diffuse:{value:new en(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Gt},alphaMap:{value:null},alphaMapTransform:{value:new Gt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Gt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Gt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Gt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Gt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Gt},normalScale:{value:new Ft(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Gt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Gt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Gt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Gt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new en(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new en(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Gt},alphaTest:{value:0},uvTransform:{value:new Gt}},sprite:{diffuse:{value:new en(16777215)},opacity:{value:1},center:{value:new Ft(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Gt},alphaMap:{value:null},alphaMapTransform:{value:new Gt},alphaTest:{value:0}}},Vs={basic:{uniforms:Xr([je.common,je.specularmap,je.envmap,je.aomap,je.lightmap,je.fog]),vertexShader:Ut.meshbasic_vert,fragmentShader:Ut.meshbasic_frag},lambert:{uniforms:Xr([je.common,je.specularmap,je.envmap,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.fog,je.lights,{emissive:{value:new en(0)}}]),vertexShader:Ut.meshlambert_vert,fragmentShader:Ut.meshlambert_frag},phong:{uniforms:Xr([je.common,je.specularmap,je.envmap,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.fog,je.lights,{emissive:{value:new en(0)},specular:{value:new en(1118481)},shininess:{value:30}}]),vertexShader:Ut.meshphong_vert,fragmentShader:Ut.meshphong_frag},standard:{uniforms:Xr([je.common,je.envmap,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.roughnessmap,je.metalnessmap,je.fog,je.lights,{emissive:{value:new en(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ut.meshphysical_vert,fragmentShader:Ut.meshphysical_frag},toon:{uniforms:Xr([je.common,je.aomap,je.lightmap,je.emissivemap,je.bumpmap,je.normalmap,je.displacementmap,je.gradientmap,je.fog,je.lights,{emissive:{value:new en(0)}}]),vertexShader:Ut.meshtoon_vert,fragmentShader:Ut.meshtoon_frag},matcap:{uniforms:Xr([je.common,je.bumpmap,je.normalmap,je.displacementmap,je.fog,{matcap:{value:null}}]),vertexShader:Ut.meshmatcap_vert,fragmentShader:Ut.meshmatcap_frag},points:{uniforms:Xr([je.points,je.fog]),vertexShader:Ut.points_vert,fragmentShader:Ut.points_frag},dashed:{uniforms:Xr([je.common,je.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ut.linedashed_vert,fragmentShader:Ut.linedashed_frag},depth:{uniforms:Xr([je.common,je.displacementmap]),vertexShader:Ut.depth_vert,fragmentShader:Ut.depth_frag},normal:{uniforms:Xr([je.common,je.bumpmap,je.normalmap,je.displacementmap,{opacity:{value:1}}]),vertexShader:Ut.meshnormal_vert,fragmentShader:Ut.meshnormal_frag},sprite:{uniforms:Xr([je.sprite,je.fog]),vertexShader:Ut.sprite_vert,fragmentShader:Ut.sprite_frag},background:{uniforms:{uvTransform:{value:new Gt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ut.background_vert,fragmentShader:Ut.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Ut.backgroundCube_vert,fragmentShader:Ut.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ut.cube_vert,fragmentShader:Ut.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ut.equirect_vert,fragmentShader:Ut.equirect_frag},distanceRGBA:{uniforms:Xr([je.common,je.displacementmap,{referencePosition:{value:new oe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ut.distanceRGBA_vert,fragmentShader:Ut.distanceRGBA_frag},shadow:{uniforms:Xr([je.lights,je.fog,{color:{value:new en(0)},opacity:{value:1}}]),vertexShader:Ut.shadow_vert,fragmentShader:Ut.shadow_frag}};Vs.physical={uniforms:Xr([Vs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Gt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Gt},clearcoatNormalScale:{value:new Ft(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Gt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Gt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Gt},sheen:{value:0},sheenColor:{value:new en(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Gt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Gt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Gt},transmissionSamplerSize:{value:new Ft},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Gt},attenuationDistance:{value:0},attenuationColor:{value:new en(0)},specularColor:{value:new en(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Gt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Gt},anisotropyVector:{value:new Ft},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Gt}}]),vertexShader:Ut.meshphysical_vert,fragmentShader:Ut.meshphysical_frag};const tm={r:0,b:0,g:0};function dX(n,e,t,r,i,s,a){const c=new en(0);let u=s===!0?0:1,h,f,m=null,_=0,v=null;function T(E,S){let D=!1,b=S.isScene===!0?S.background:null;b&&b.isTexture&&(b=(S.backgroundBlurriness>0?t:e).get(b)),b===null?A(c,u):b&&b.isColor&&(A(b,1),D=!0);const k=n.xr.getEnvironmentBlendMode();k==="additive"?r.buffers.color.setClear(0,0,0,1,a):k==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,a),(n.autoClear||D)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),b&&(b.isCubeTexture||b.mapping===l_)?(f===void 0&&(f=new ps(new _f(1,1,1),new nc({name:"BackgroundCubeMaterial",uniforms:Ku(Vs.backgroundCube.uniforms),vertexShader:Vs.backgroundCube.vertexShader,fragmentShader:Vs.backgroundCube.fragmentShader,side:fi,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(V,H,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(f)),f.material.uniforms.envMap.value=b,f.material.uniforms.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=S.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,f.material.toneMapped=ln.getTransfer(b.colorSpace)!==vn,(m!==b||_!==b.version||v!==n.toneMapping)&&(f.material.needsUpdate=!0,m=b,_=b.version,v=n.toneMapping),f.layers.enableAll(),E.unshift(f,f.geometry,f.material,0,0,null)):b&&b.isTexture&&(h===void 0&&(h=new ps(new MT(2,2),new nc({name:"BackgroundMaterial",uniforms:Ku(Vs.background.uniforms),vertexShader:Vs.background.vertexShader,fragmentShader:Vs.background.fragmentShader,side:Qa,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(h)),h.material.uniforms.t2D.value=b,h.material.uniforms.backgroundIntensity.value=S.backgroundIntensity,h.material.toneMapped=ln.getTransfer(b.colorSpace)!==vn,b.matrixAutoUpdate===!0&&b.updateMatrix(),h.material.uniforms.uvTransform.value.copy(b.matrix),(m!==b||_!==b.version||v!==n.toneMapping)&&(h.material.needsUpdate=!0,m=b,_=b.version,v=n.toneMapping),h.layers.enableAll(),E.unshift(h,h.geometry,h.material,0,0,null))}function A(E,S){E.getRGB(tm,FL(n)),r.buffers.color.setClear(tm.r,tm.g,tm.b,S,a)}return{getClearColor:function(){return c},setClearColor:function(E,S=1){c.set(E),u=S,A(c,u)},getClearAlpha:function(){return u},setClearAlpha:function(E){u=E,A(c,u)},render:T}}function fX(n,e,t,r){const i=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),a=r.isWebGL2||s!==null,c={},u=E(null);let h=u,f=!1;function m(Y,ue,ye,ge,Q){let re=!1;if(a){const ie=A(ge,ye,ue);h!==ie&&(h=ie,v(h.object)),re=S(Y,ge,ye,Q),re&&D(Y,ge,ye,Q)}else{const ie=ue.wireframe===!0;(h.geometry!==ge.id||h.program!==ye.id||h.wireframe!==ie)&&(h.geometry=ge.id,h.program=ye.id,h.wireframe=ie,re=!0)}Q!==null&&t.update(Q,n.ELEMENT_ARRAY_BUFFER),(re||f)&&(f=!1,I(Y,ue,ye,ge),Q!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(Q).buffer))}function _(){return r.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function v(Y){return r.isWebGL2?n.bindVertexArray(Y):s.bindVertexArrayOES(Y)}function T(Y){return r.isWebGL2?n.deleteVertexArray(Y):s.deleteVertexArrayOES(Y)}function A(Y,ue,ye){const ge=ye.wireframe===!0;let Q=c[Y.id];Q===void 0&&(Q={},c[Y.id]=Q);let re=Q[ue.id];re===void 0&&(re={},Q[ue.id]=re);let ie=re[ge];return ie===void 0&&(ie=E(_()),re[ge]=ie),ie}function E(Y){const ue=[],ye=[],ge=[];for(let Q=0;Q<i;Q++)ue[Q]=0,ye[Q]=0,ge[Q]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ue,enabledAttributes:ye,attributeDivisors:ge,object:Y,attributes:{},index:null}}function S(Y,ue,ye,ge){const Q=h.attributes,re=ue.attributes;let ie=0;const $=ye.getAttributes();for(const ne in $)if($[ne].location>=0){const _e=Q[ne];let Ee=re[ne];if(Ee===void 0&&(ne==="instanceMatrix"&&Y.instanceMatrix&&(Ee=Y.instanceMatrix),ne==="instanceColor"&&Y.instanceColor&&(Ee=Y.instanceColor)),_e===void 0||_e.attribute!==Ee||Ee&&_e.data!==Ee.data)return!0;ie++}return h.attributesNum!==ie||h.index!==ge}function D(Y,ue,ye,ge){const Q={},re=ue.attributes;let ie=0;const $=ye.getAttributes();for(const ne in $)if($[ne].location>=0){let _e=re[ne];_e===void 0&&(ne==="instanceMatrix"&&Y.instanceMatrix&&(_e=Y.instanceMatrix),ne==="instanceColor"&&Y.instanceColor&&(_e=Y.instanceColor));const Ee={};Ee.attribute=_e,_e&&_e.data&&(Ee.data=_e.data),Q[ne]=Ee,ie++}h.attributes=Q,h.attributesNum=ie,h.index=ge}function b(){const Y=h.newAttributes;for(let ue=0,ye=Y.length;ue<ye;ue++)Y[ue]=0}function k(Y){V(Y,0)}function V(Y,ue){const ye=h.newAttributes,ge=h.enabledAttributes,Q=h.attributeDivisors;ye[Y]=1,ge[Y]===0&&(n.enableVertexAttribArray(Y),ge[Y]=1),Q[Y]!==ue&&((r.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Y,ue),Q[Y]=ue)}function H(){const Y=h.newAttributes,ue=h.enabledAttributes;for(let ye=0,ge=ue.length;ye<ge;ye++)ue[ye]!==Y[ye]&&(n.disableVertexAttribArray(ye),ue[ye]=0)}function P(Y,ue,ye,ge,Q,re,ie){ie===!0?n.vertexAttribIPointer(Y,ue,ye,Q,re):n.vertexAttribPointer(Y,ue,ye,ge,Q,re)}function I(Y,ue,ye,ge){if(r.isWebGL2===!1&&(Y.isInstancedMesh||ge.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;b();const Q=ge.attributes,re=ye.getAttributes(),ie=ue.defaultAttributeValues;for(const $ in re){const ne=re[$];if(ne.location>=0){let te=Q[$];if(te===void 0&&($==="instanceMatrix"&&Y.instanceMatrix&&(te=Y.instanceMatrix),$==="instanceColor"&&Y.instanceColor&&(te=Y.instanceColor)),te!==void 0){const _e=te.normalized,Ee=te.itemSize,Pe=t.get(te);if(Pe===void 0)continue;const we=Pe.buffer,ke=Pe.type,We=Pe.bytesPerElement,Ye=r.isWebGL2===!0&&(ke===n.INT||ke===n.UNSIGNED_INT||te.gpuType===yL);if(te.isInterleavedBufferAttribute){const It=te.data,fe=It.stride,nn=te.offset;if(It.isInstancedInterleavedBuffer){for(let st=0;st<ne.locationSize;st++)V(ne.location+st,It.meshPerAttribute);Y.isInstancedMesh!==!0&&ge._maxInstanceCount===void 0&&(ge._maxInstanceCount=It.meshPerAttribute*It.count)}else for(let st=0;st<ne.locationSize;st++)k(ne.location+st);n.bindBuffer(n.ARRAY_BUFFER,we);for(let st=0;st<ne.locationSize;st++)P(ne.location+st,Ee/ne.locationSize,ke,_e,fe*We,(nn+Ee/ne.locationSize*st)*We,Ye)}else{if(te.isInstancedBufferAttribute){for(let It=0;It<ne.locationSize;It++)V(ne.location+It,te.meshPerAttribute);Y.isInstancedMesh!==!0&&ge._maxInstanceCount===void 0&&(ge._maxInstanceCount=te.meshPerAttribute*te.count)}else for(let It=0;It<ne.locationSize;It++)k(ne.location+It);n.bindBuffer(n.ARRAY_BUFFER,we);for(let It=0;It<ne.locationSize;It++)P(ne.location+It,Ee/ne.locationSize,ke,_e,Ee*We,Ee/ne.locationSize*It*We,Ye)}}else if(ie!==void 0){const _e=ie[$];if(_e!==void 0)switch(_e.length){case 2:n.vertexAttrib2fv(ne.location,_e);break;case 3:n.vertexAttrib3fv(ne.location,_e);break;case 4:n.vertexAttrib4fv(ne.location,_e);break;default:n.vertexAttrib1fv(ne.location,_e)}}}}H()}function M(){W();for(const Y in c){const ue=c[Y];for(const ye in ue){const ge=ue[ye];for(const Q in ge)T(ge[Q].object),delete ge[Q];delete ue[ye]}delete c[Y]}}function C(Y){if(c[Y.id]===void 0)return;const ue=c[Y.id];for(const ye in ue){const ge=ue[ye];for(const Q in ge)T(ge[Q].object),delete ge[Q];delete ue[ye]}delete c[Y.id]}function N(Y){for(const ue in c){const ye=c[ue];if(ye[Y.id]===void 0)continue;const ge=ye[Y.id];for(const Q in ge)T(ge[Q].object),delete ge[Q];delete ye[Y.id]}}function W(){F(),f=!0,h!==u&&(h=u,v(h.object))}function F(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:m,reset:W,resetDefaultState:F,dispose:M,releaseStatesOfGeometry:C,releaseStatesOfProgram:N,initAttributes:b,enableAttribute:k,disableUnusedAttributes:H}}function pX(n,e,t,r){const i=r.isWebGL2;let s;function a(f){s=f}function c(f,m){n.drawArrays(s,f,m),t.update(m,s,1)}function u(f,m,_){if(_===0)return;let v,T;if(i)v=n,T="drawArraysInstanced";else if(v=e.get("ANGLE_instanced_arrays"),T="drawArraysInstancedANGLE",v===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[T](s,f,m,_),t.update(m,s,_)}function h(f,m,_){if(_===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let T=0;T<_;T++)this.render(f[T],m[T]);else{v.multiDrawArraysWEBGL(s,f,0,m,0,_);let T=0;for(let A=0;A<_;A++)T+=m[A];t.update(T,s,1)}}this.setMode=a,this.render=c,this.renderInstances=u,this.renderMultiDraw=h}function mX(n,e,t){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const P=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(P){if(P==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";P="mediump"}return P==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const a=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let c=t.precision!==void 0?t.precision:"highp";const u=s(c);u!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const h=a||e.has("WEBGL_draw_buffers"),f=t.logarithmicDepthBuffer===!0,m=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),_=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),v=n.getParameter(n.MAX_TEXTURE_SIZE),T=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),A=n.getParameter(n.MAX_VERTEX_ATTRIBS),E=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),S=n.getParameter(n.MAX_VARYING_VECTORS),D=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),b=_>0,k=a||e.has("OES_texture_float"),V=b&&k,H=a?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:a,drawBuffers:h,getMaxAnisotropy:i,getMaxPrecision:s,precision:c,logarithmicDepthBuffer:f,maxTextures:m,maxVertexTextures:_,maxTextureSize:v,maxCubemapSize:T,maxAttributes:A,maxVertexUniforms:E,maxVaryings:S,maxFragmentUniforms:D,vertexTextures:b,floatFragmentTextures:k,floatVertexTextures:V,maxSamples:H}}function gX(n){const e=this;let t=null,r=0,i=!1,s=!1;const a=new Ll,c=new Gt,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(m,_){const v=m.length!==0||_||r!==0||i;return i=_,r=m.length,v},this.beginShadows=function(){s=!0,f(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(m,_){t=f(m,_,0)},this.setState=function(m,_,v){const T=m.clippingPlanes,A=m.clipIntersection,E=m.clipShadows,S=n.get(m);if(!i||T===null||T.length===0||s&&!E)s?f(null):h();else{const D=s?0:r,b=D*4;let k=S.clippingState||null;u.value=k,k=f(T,_,b,v);for(let V=0;V!==b;++V)k[V]=t[V];S.clippingState=k,this.numIntersection=A?this.numPlanes:0,this.numPlanes+=D}};function h(){u.value!==t&&(u.value=t,u.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function f(m,_,v,T){const A=m!==null?m.length:0;let E=null;if(A!==0){if(E=u.value,T!==!0||E===null){const S=v+A*4,D=_.matrixWorldInverse;c.getNormalMatrix(D),(E===null||E.length<S)&&(E=new Float32Array(S));for(let b=0,k=v;b!==A;++b,k+=4)a.copy(m[b]).applyMatrix4(D,c),a.normal.toArray(E,k),E[k+3]=a.constant}u.value=E,u.needsUpdate=!0}return e.numPlanes=A,e.numIntersection=0,E}}function _X(n){let e=new WeakMap;function t(a,c){return c===dE?a.mapping=$u:c===fE&&(a.mapping=qu),a}function r(a){if(a&&a.isTexture){const c=a.mapping;if(c===dE||c===fE)if(e.has(a)){const u=e.get(a).texture;return t(u,a.mapping)}else{const u=a.image;if(u&&u.height>0){const h=new C7(u.height/2);return h.fromEquirectangularTexture(n,a),e.set(a,h),a.addEventListener("dispose",i),t(h.texture,a.mapping)}else return null}}return a}function i(a){const c=a.target;c.removeEventListener("dispose",i);const u=e.get(c);u!==void 0&&(e.delete(c),u.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class vX extends VL{constructor(e=-1,t=1,r=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,a=r+e,c=i+t,u=i-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,a=s+h*this.view.width,c-=f*this.view.offsetY,u=c-f*this.view.height}this.projectionMatrix.makeOrthographic(s,a,c,u,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Au=4,TR=[.125,.215,.35,.446,.526,.582],kl=20,Jy=new vX,xR=new en;let e0=null,t0=0,n0=0;const Nl=(1+Math.sqrt(5))/2,lu=1/Nl,wR=[new oe(1,1,1),new oe(-1,1,1),new oe(1,1,-1),new oe(-1,1,-1),new oe(0,Nl,lu),new oe(0,Nl,-lu),new oe(lu,0,Nl),new oe(-lu,0,Nl),new oe(Nl,lu,0),new oe(-Nl,lu,0)];class AR{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){e0=this._renderer.getRenderTarget(),t0=this._renderer.getActiveCubeFace(),n0=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=RR(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=bR(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(e0,t0,n0),e.scissorTest=!1,nm(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===$u||e.mapping===qu?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),e0=this._renderer.getRenderTarget(),t0=this._renderer.getActiveCubeFace(),n0=this._renderer.getActiveMipmapLevel();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Bi,minFilter:Bi,generateMipmaps:!1,type:qd,format:ds,colorSpace:jo,depthBuffer:!1},i=MR(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=MR(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=yX(s)),this._blurMaterial=EX(s,e,t)}return i}_compileMaterial(e){const t=new ps(this._lodPlanes[0],e);this._renderer.compile(t,Jy)}_sceneToCubeUV(e,t,r,i){const c=new Ai(90,1,t,r),u=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],f=this._renderer,m=f.autoClear,_=f.toneMapping;f.getClearColor(xR),f.toneMapping=za,f.autoClear=!1;const v=new wT({name:"PMREM.Background",side:fi,depthWrite:!1,depthTest:!1}),T=new ps(new _f,v);let A=!1;const E=e.background;E?E.isColor&&(v.color.copy(E),e.background=null,A=!0):(v.color.copy(xR),A=!0);for(let S=0;S<6;S++){const D=S%3;D===0?(c.up.set(0,u[S],0),c.lookAt(h[S],0,0)):D===1?(c.up.set(0,0,u[S]),c.lookAt(0,h[S],0)):(c.up.set(0,u[S],0),c.lookAt(0,0,h[S]));const b=this._cubeSize;nm(i,D*b,S>2?b:0,b,b),f.setRenderTarget(i),A&&f.render(T,c),f.render(e,c)}T.geometry.dispose(),T.material.dispose(),f.toneMapping=_,f.autoClear=m,e.background=E}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===$u||e.mapping===qu;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=RR()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=bR());const s=i?this._cubemapMaterial:this._equirectMaterial,a=new ps(this._lodPlanes[0],s),c=s.uniforms;c.envMap.value=e;const u=this._cubeSize;nm(t,0,0,3*u,2*u),r.setRenderTarget(t),r.render(a,Jy)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),a=wR[(i-1)%wR.length];this._blur(e,i-1,i,s,a)}t.autoClear=r}_blur(e,t,r,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,i,"latitudinal",s),this._halfBlur(a,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,a,c){const u=this._renderer,h=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,m=new ps(this._lodPlanes[i],h),_=h.uniforms,v=this._sizeLods[r]-1,T=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*kl-1),A=s/T,E=isFinite(s)?1+Math.floor(f*A):kl;E>kl&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${kl}`);const S=[];let D=0;for(let P=0;P<kl;++P){const I=P/A,M=Math.exp(-I*I/2);S.push(M),P===0?D+=M:P<E&&(D+=2*M)}for(let P=0;P<S.length;P++)S[P]=S[P]/D;_.envMap.value=e.texture,_.samples.value=E,_.weights.value=S,_.latitudinal.value=a==="latitudinal",c&&(_.poleAxis.value=c);const{_lodMax:b}=this;_.dTheta.value=T,_.mipInt.value=b-r;const k=this._sizeLods[i],V=3*k*(i>b-Au?i-b+Au:0),H=4*(this._cubeSize-k);nm(t,V,H,3*k,2*k),u.setRenderTarget(t),u.render(m,Jy)}}function yX(n){const e=[],t=[],r=[];let i=n;const s=n-Au+1+TR.length;for(let a=0;a<s;a++){const c=Math.pow(2,i);t.push(c);let u=1/c;a>n-Au?u=TR[a-n+Au-1]:a===0&&(u=0),r.push(u);const h=1/(c-2),f=-h,m=1+h,_=[f,f,m,f,m,m,f,f,m,m,f,m],v=6,T=6,A=3,E=2,S=1,D=new Float32Array(A*T*v),b=new Float32Array(E*T*v),k=new Float32Array(S*T*v);for(let H=0;H<v;H++){const P=H%3*2/3-1,I=H>2?0:-1,M=[P,I,0,P+2/3,I,0,P+2/3,I+1,0,P,I,0,P+2/3,I+1,0,P,I+1,0];D.set(M,A*T*H),b.set(_,E*T*H);const C=[H,H,H,H,H,H];k.set(C,S*T*H)}const V=new Xi;V.setAttribute("position",new $i(D,A)),V.setAttribute("uv",new $i(b,E)),V.setAttribute("faceIndex",new $i(k,S)),e.push(V),i>Au&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function MR(n,e,t){const r=new tc(n,e,t);return r.texture.mapping=l_,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function nm(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function EX(n,e,t){const r=new Float32Array(kl),i=new oe(0,1,0);return new nc({name:"SphericalGaussianBlur",defines:{n:kl,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:bT(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Va,depthTest:!1,depthWrite:!1})}function bR(){return new nc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:bT(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Va,depthTest:!1,depthWrite:!1})}function RR(){return new nc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:bT(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Va,depthTest:!1,depthWrite:!1})}function bT(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function SX(n){let e=new WeakMap,t=null;function r(c){if(c&&c.isTexture){const u=c.mapping,h=u===dE||u===fE,f=u===$u||u===qu;if(h||f)if(c.isRenderTargetTexture&&c.needsPMREMUpdate===!0){c.needsPMREMUpdate=!1;let m=e.get(c);return t===null&&(t=new AR(n)),m=h?t.fromEquirectangular(c,m):t.fromCubemap(c,m),e.set(c,m),m.texture}else{if(e.has(c))return e.get(c).texture;{const m=c.image;if(h&&m&&m.height>0||f&&m&&i(m)){t===null&&(t=new AR(n));const _=h?t.fromEquirectangular(c):t.fromCubemap(c);return e.set(c,_),c.addEventListener("dispose",s),_.texture}else return null}}}return c}function i(c){let u=0;const h=6;for(let f=0;f<h;f++)c[f]!==void 0&&u++;return u===h}function s(c){const u=c.target;u.removeEventListener("dispose",s);const h=e.get(u);h!==void 0&&(e.delete(u),h.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:a}}function TX(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const i=t(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function xX(n,e,t,r){const i={},s=new WeakMap;function a(m){const _=m.target;_.index!==null&&e.remove(_.index);for(const T in _.attributes)e.remove(_.attributes[T]);for(const T in _.morphAttributes){const A=_.morphAttributes[T];for(let E=0,S=A.length;E<S;E++)e.remove(A[E])}_.removeEventListener("dispose",a),delete i[_.id];const v=s.get(_);v&&(e.remove(v),s.delete(_)),r.releaseStatesOfGeometry(_),_.isInstancedBufferGeometry===!0&&delete _._maxInstanceCount,t.memory.geometries--}function c(m,_){return i[_.id]===!0||(_.addEventListener("dispose",a),i[_.id]=!0,t.memory.geometries++),_}function u(m){const _=m.attributes;for(const T in _)e.update(_[T],n.ARRAY_BUFFER);const v=m.morphAttributes;for(const T in v){const A=v[T];for(let E=0,S=A.length;E<S;E++)e.update(A[E],n.ARRAY_BUFFER)}}function h(m){const _=[],v=m.index,T=m.attributes.position;let A=0;if(v!==null){const D=v.array;A=v.version;for(let b=0,k=D.length;b<k;b+=3){const V=D[b+0],H=D[b+1],P=D[b+2];_.push(V,H,H,P,P,V)}}else if(T!==void 0){const D=T.array;A=T.version;for(let b=0,k=D.length/3-1;b<k;b+=3){const V=b+0,H=b+1,P=b+2;_.push(V,H,H,P,P,V)}}else return;const E=new(CL(_)?UL:kL)(_,1);E.version=A;const S=s.get(m);S&&e.remove(S),s.set(m,E)}function f(m){const _=s.get(m);if(_){const v=m.index;v!==null&&_.version<v.version&&h(m)}else h(m);return s.get(m)}return{get:c,update:u,getWireframeAttribute:f}}function wX(n,e,t,r){const i=r.isWebGL2;let s;function a(v){s=v}let c,u;function h(v){c=v.type,u=v.bytesPerElement}function f(v,T){n.drawElements(s,T,c,v*u),t.update(T,s,1)}function m(v,T,A){if(A===0)return;let E,S;if(i)E=n,S="drawElementsInstanced";else if(E=e.get("ANGLE_instanced_arrays"),S="drawElementsInstancedANGLE",E===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}E[S](s,T,c,v*u,A),t.update(T,s,A)}function _(v,T,A){if(A===0)return;const E=e.get("WEBGL_multi_draw");if(E===null)for(let S=0;S<A;S++)this.render(v[S]/u,T[S]);else{E.multiDrawElementsWEBGL(s,T,0,c,v,0,A);let S=0;for(let D=0;D<A;D++)S+=T[D];t.update(S,s,1)}}this.setMode=a,this.setIndex=h,this.render=f,this.renderInstances=m,this.renderMultiDraw=_}function AX(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,a,c){switch(t.calls++,a){case n.TRIANGLES:t.triangles+=c*(s/3);break;case n.LINES:t.lines+=c*(s/2);break;case n.LINE_STRIP:t.lines+=c*(s-1);break;case n.LINE_LOOP:t.lines+=c*s;break;case n.POINTS:t.points+=c*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function MX(n,e){return n[0]-e[0]}function bX(n,e){return Math.abs(e[1])-Math.abs(n[1])}function RX(n,e,t){const r={},i=new Float32Array(8),s=new WeakMap,a=new Sn,c=[];for(let h=0;h<8;h++)c[h]=[h,0];function u(h,f,m){const _=h.morphTargetInfluences;if(e.isWebGL2===!0){const v=f.morphAttributes.position||f.morphAttributes.normal||f.morphAttributes.color,T=v!==void 0?v.length:0;let A=s.get(f);if(A===void 0||A.count!==T){let Y=function(){W.dispose(),s.delete(f),f.removeEventListener("dispose",Y)};A!==void 0&&A.texture.dispose();const D=f.morphAttributes.position!==void 0,b=f.morphAttributes.normal!==void 0,k=f.morphAttributes.color!==void 0,V=f.morphAttributes.position||[],H=f.morphAttributes.normal||[],P=f.morphAttributes.color||[];let I=0;D===!0&&(I=1),b===!0&&(I=2),k===!0&&(I=3);let M=f.attributes.position.count*I,C=1;M>e.maxTextureSize&&(C=Math.ceil(M/e.maxTextureSize),M=e.maxTextureSize);const N=new Float32Array(M*C*4*T),W=new DL(N,M,C,T);W.type=Na,W.needsUpdate=!0;const F=I*4;for(let ue=0;ue<T;ue++){const ye=V[ue],ge=H[ue],Q=P[ue],re=M*C*4*ue;for(let ie=0;ie<ye.count;ie++){const $=ie*F;D===!0&&(a.fromBufferAttribute(ye,ie),N[re+$+0]=a.x,N[re+$+1]=a.y,N[re+$+2]=a.z,N[re+$+3]=0),b===!0&&(a.fromBufferAttribute(ge,ie),N[re+$+4]=a.x,N[re+$+5]=a.y,N[re+$+6]=a.z,N[re+$+7]=0),k===!0&&(a.fromBufferAttribute(Q,ie),N[re+$+8]=a.x,N[re+$+9]=a.y,N[re+$+10]=a.z,N[re+$+11]=Q.itemSize===4?a.w:1)}}A={count:T,texture:W,size:new Ft(M,C)},s.set(f,A),f.addEventListener("dispose",Y)}let E=0;for(let D=0;D<_.length;D++)E+=_[D];const S=f.morphTargetsRelative?1:1-E;m.getUniforms().setValue(n,"morphTargetBaseInfluence",S),m.getUniforms().setValue(n,"morphTargetInfluences",_),m.getUniforms().setValue(n,"morphTargetsTexture",A.texture,t),m.getUniforms().setValue(n,"morphTargetsTextureSize",A.size)}else{const v=_===void 0?0:_.length;let T=r[f.id];if(T===void 0||T.length!==v){T=[];for(let b=0;b<v;b++)T[b]=[b,0];r[f.id]=T}for(let b=0;b<v;b++){const k=T[b];k[0]=b,k[1]=_[b]}T.sort(bX);for(let b=0;b<8;b++)b<v&&T[b][1]?(c[b][0]=T[b][0],c[b][1]=T[b][1]):(c[b][0]=Number.MAX_SAFE_INTEGER,c[b][1]=0);c.sort(MX);const A=f.morphAttributes.position,E=f.morphAttributes.normal;let S=0;for(let b=0;b<8;b++){const k=c[b],V=k[0],H=k[1];V!==Number.MAX_SAFE_INTEGER&&H?(A&&f.getAttribute("morphTarget"+b)!==A[V]&&f.setAttribute("morphTarget"+b,A[V]),E&&f.getAttribute("morphNormal"+b)!==E[V]&&f.setAttribute("morphNormal"+b,E[V]),i[b]=H,S+=H):(A&&f.hasAttribute("morphTarget"+b)===!0&&f.deleteAttribute("morphTarget"+b),E&&f.hasAttribute("morphNormal"+b)===!0&&f.deleteAttribute("morphNormal"+b),i[b]=0)}const D=f.morphTargetsRelative?1:1-S;m.getUniforms().setValue(n,"morphTargetBaseInfluence",D),m.getUniforms().setValue(n,"morphTargetInfluences",i)}}return{update:u}}function CX(n,e,t,r){let i=new WeakMap;function s(u){const h=r.render.frame,f=u.geometry,m=e.get(u,f);if(i.get(m)!==h&&(e.update(m),i.set(m,h)),u.isInstancedMesh&&(u.hasEventListener("dispose",c)===!1&&u.addEventListener("dispose",c),i.get(u)!==h&&(t.update(u.instanceMatrix,n.ARRAY_BUFFER),u.instanceColor!==null&&t.update(u.instanceColor,n.ARRAY_BUFFER),i.set(u,h))),u.isSkinnedMesh){const _=u.skeleton;i.get(_)!==h&&(_.update(),i.set(_,h))}return m}function a(){i=new WeakMap}function c(u){const h=u.target;h.removeEventListener("dispose",c),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:s,dispose:a}}class HL extends pi{constructor(e,t,r,i,s,a,c,u,h,f){if(f=f!==void 0?f:$l,f!==$l&&f!==Xu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&f===$l&&(r=La),r===void 0&&f===Xu&&(r=Wl),super(null,i,s,a,c,u,f,r,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=c!==void 0?c:Kr,this.minFilter=u!==void 0?u:Kr,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const GL=new pi,jL=new HL(1,1);jL.compareFunction=RL;const WL=new DL,$L=new d7,qL=new zL,CR=[],PR=[],IR=new Float32Array(16),DR=new Float32Array(9),LR=new Float32Array(4);function ah(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=CR[i];if(s===void 0&&(s=new Float32Array(i),CR[i]=s),e!==0){r.toArray(s,0);for(let a=1,c=0;a!==e;++a)c+=t,n[a].toArray(s,c)}return s}function ir(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function sr(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function d_(n,e){let t=PR[e];t===void 0&&(t=new Int32Array(e),PR[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function PX(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function IX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ir(t,e))return;n.uniform2fv(this.addr,e),sr(t,e)}}function DX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ir(t,e))return;n.uniform3fv(this.addr,e),sr(t,e)}}function LX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ir(t,e))return;n.uniform4fv(this.addr,e),sr(t,e)}}function NX(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ir(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),sr(t,e)}else{if(ir(t,r))return;LR.set(r),n.uniformMatrix2fv(this.addr,!1,LR),sr(t,r)}}function OX(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ir(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),sr(t,e)}else{if(ir(t,r))return;DR.set(r),n.uniformMatrix3fv(this.addr,!1,DR),sr(t,r)}}function kX(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ir(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),sr(t,e)}else{if(ir(t,r))return;IR.set(r),n.uniformMatrix4fv(this.addr,!1,IR),sr(t,r)}}function UX(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function FX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ir(t,e))return;n.uniform2iv(this.addr,e),sr(t,e)}}function VX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ir(t,e))return;n.uniform3iv(this.addr,e),sr(t,e)}}function zX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ir(t,e))return;n.uniform4iv(this.addr,e),sr(t,e)}}function BX(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function HX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ir(t,e))return;n.uniform2uiv(this.addr,e),sr(t,e)}}function GX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ir(t,e))return;n.uniform3uiv(this.addr,e),sr(t,e)}}function jX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ir(t,e))return;n.uniform4uiv(this.addr,e),sr(t,e)}}function WX(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);const s=this.type===n.SAMPLER_2D_SHADOW?jL:GL;t.setTexture2D(e||s,i)}function $X(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||$L,i)}function qX(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||qL,i)}function XX(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||WL,i)}function KX(n){switch(n){case 5126:return PX;case 35664:return IX;case 35665:return DX;case 35666:return LX;case 35674:return NX;case 35675:return OX;case 35676:return kX;case 5124:case 35670:return UX;case 35667:case 35671:return FX;case 35668:case 35672:return VX;case 35669:case 35673:return zX;case 5125:return BX;case 36294:return HX;case 36295:return GX;case 36296:return jX;case 35678:case 36198:case 36298:case 36306:case 35682:return WX;case 35679:case 36299:case 36307:return $X;case 35680:case 36300:case 36308:case 36293:return qX;case 36289:case 36303:case 36311:case 36292:return XX}}function YX(n,e){n.uniform1fv(this.addr,e)}function ZX(n,e){const t=ah(e,this.size,2);n.uniform2fv(this.addr,t)}function QX(n,e){const t=ah(e,this.size,3);n.uniform3fv(this.addr,t)}function JX(n,e){const t=ah(e,this.size,4);n.uniform4fv(this.addr,t)}function eK(n,e){const t=ah(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function tK(n,e){const t=ah(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function nK(n,e){const t=ah(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function rK(n,e){n.uniform1iv(this.addr,e)}function iK(n,e){n.uniform2iv(this.addr,e)}function sK(n,e){n.uniform3iv(this.addr,e)}function oK(n,e){n.uniform4iv(this.addr,e)}function aK(n,e){n.uniform1uiv(this.addr,e)}function lK(n,e){n.uniform2uiv(this.addr,e)}function cK(n,e){n.uniform3uiv(this.addr,e)}function uK(n,e){n.uniform4uiv(this.addr,e)}function hK(n,e,t){const r=this.cache,i=e.length,s=d_(t,i);ir(r,s)||(n.uniform1iv(this.addr,s),sr(r,s));for(let a=0;a!==i;++a)t.setTexture2D(e[a]||GL,s[a])}function dK(n,e,t){const r=this.cache,i=e.length,s=d_(t,i);ir(r,s)||(n.uniform1iv(this.addr,s),sr(r,s));for(let a=0;a!==i;++a)t.setTexture3D(e[a]||$L,s[a])}function fK(n,e,t){const r=this.cache,i=e.length,s=d_(t,i);ir(r,s)||(n.uniform1iv(this.addr,s),sr(r,s));for(let a=0;a!==i;++a)t.setTextureCube(e[a]||qL,s[a])}function pK(n,e,t){const r=this.cache,i=e.length,s=d_(t,i);ir(r,s)||(n.uniform1iv(this.addr,s),sr(r,s));for(let a=0;a!==i;++a)t.setTexture2DArray(e[a]||WL,s[a])}function mK(n){switch(n){case 5126:return YX;case 35664:return ZX;case 35665:return QX;case 35666:return JX;case 35674:return eK;case 35675:return tK;case 35676:return nK;case 5124:case 35670:return rK;case 35667:case 35671:return iK;case 35668:case 35672:return sK;case 35669:case 35673:return oK;case 5125:return aK;case 36294:return lK;case 36295:return cK;case 36296:return uK;case 35678:case 36198:case 36298:case 36306:case 35682:return hK;case 35679:case 36299:case 36307:return dK;case 35680:case 36300:case 36308:case 36293:return fK;case 36289:case 36303:case 36311:case 36292:return pK}}class gK{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=KX(t.type)}}class _K{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=mK(t.type)}}class vK{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const c=i[s];c.setValue(e,t[c.id],r)}}}const r0=/(\w+)(\])?(\[|\.)?/g;function NR(n,e){n.seq.push(e),n.map[e.id]=e}function yK(n,e,t){const r=n.name,i=r.length;for(r0.lastIndex=0;;){const s=r0.exec(r),a=r0.lastIndex;let c=s[1];const u=s[2]==="]",h=s[3];if(u&&(c=c|0),h===void 0||h==="["&&a+2===i){NR(t,h===void 0?new gK(c,n,e):new _K(c,n,e));break}else{let m=t.map[c];m===void 0&&(m=new vK(c),NR(t,m)),t=m}}}class Pm{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),a=e.getUniformLocation(t,s.name);yK(s,a,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,a=t.length;s!==a;++s){const c=t[s],u=r[c.id];u.needsUpdate!==!1&&c.setValue(e,u.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in t&&r.push(a)}return r}}function OR(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const EK=37297;let SK=0;function TK(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=i;a<s;a++){const c=a+1;r.push(`${c===e?">":" "} ${c}: ${t[a]}`)}return r.join(`
`)}function xK(n){const e=ln.getPrimaries(ln.workingColorSpace),t=ln.getPrimaries(n);let r;switch(e===t?r="":e===ug&&t===cg?r="LinearDisplayP3ToLinearSRGB":e===cg&&t===ug&&(r="LinearSRGBToLinearDisplayP3"),n){case jo:case c_:return[r,"LinearTransferOETF"];case Tr:case xT:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[r,"LinearTransferOETF"]}}function kR(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const a=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+TK(n.getShaderSource(e),a)}else return i}function wK(n,e){const t=xK(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function AK(n,e){let t;switch(e){case O8:t="Linear";break;case k8:t="Reinhard";break;case U8:t="OptimizedCineon";break;case F8:t="ACESFilmic";break;case z8:t="AgX";break;case V8:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function MK(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Mu).join(`
`)}function bK(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(Mu).join(`
`)}function RK(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function CK(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),a=s.name;let c=1;s.type===n.FLOAT_MAT2&&(c=2),s.type===n.FLOAT_MAT3&&(c=3),s.type===n.FLOAT_MAT4&&(c=4),t[a]={type:s.type,location:n.getAttribLocation(e,a),locationSize:c}}return t}function Mu(n){return n!==""}function UR(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function FR(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const PK=/^[ \t]*#include +<([\w\d./]+)>/gm;function EE(n){return n.replace(PK,DK)}const IK=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function DK(n,e){let t=Ut[e];if(t===void 0){const r=IK.get(e);if(r!==void 0)t=Ut[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return EE(t)}const LK=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function VR(n){return n.replace(LK,NK)}function NK(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function zR(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function OK(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===gL?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===c8?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===bo&&(e="SHADOWMAP_TYPE_VSM"),e}function kK(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case $u:case qu:e="ENVMAP_TYPE_CUBE";break;case l_:e="ENVMAP_TYPE_CUBE_UV";break}return e}function UK(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===qu&&(e="ENVMAP_MODE_REFRACTION"),e}function FK(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case _L:e="ENVMAP_BLENDING_MULTIPLY";break;case L8:e="ENVMAP_BLENDING_MIX";break;case N8:e="ENVMAP_BLENDING_ADD";break}return e}function VK(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:r,maxMip:t}}function zK(n,e,t,r){const i=n.getContext(),s=t.defines;let a=t.vertexShader,c=t.fragmentShader;const u=OK(t),h=kK(t),f=UK(t),m=FK(t),_=VK(t),v=t.isWebGL2?"":MK(t),T=bK(t),A=RK(s),E=i.createProgram();let S,D,b=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(S=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(Mu).join(`
`),S.length>0&&(S+=`
`),D=[v,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(Mu).join(`
`),D.length>0&&(D+=`
`)):(S=[zR(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Mu).join(`
`),D=[v,zR(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+f:"",t.envMap?"#define "+m:"",_?"#define CUBEUV_TEXEL_WIDTH "+_.texelWidth:"",_?"#define CUBEUV_TEXEL_HEIGHT "+_.texelHeight:"",_?"#define CUBEUV_MAX_MIP "+_.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==za?"#define TONE_MAPPING":"",t.toneMapping!==za?Ut.tonemapping_pars_fragment:"",t.toneMapping!==za?AK("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Ut.colorspace_pars_fragment,wK("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Mu).join(`
`)),a=EE(a),a=UR(a,t),a=FR(a,t),c=EE(c),c=UR(c,t),c=FR(c,t),a=VR(a),c=VR(c),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(b=`#version 300 es
`,S=[T,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+S,D=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===iR?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===iR?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+D);const k=b+S+a,V=b+D+c,H=OR(i,i.VERTEX_SHADER,k),P=OR(i,i.FRAGMENT_SHADER,V);i.attachShader(E,H),i.attachShader(E,P),t.index0AttributeName!==void 0?i.bindAttribLocation(E,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(E,0,"position"),i.linkProgram(E);function I(W){if(n.debug.checkShaderErrors){const F=i.getProgramInfoLog(E).trim(),Y=i.getShaderInfoLog(H).trim(),ue=i.getShaderInfoLog(P).trim();let ye=!0,ge=!0;if(i.getProgramParameter(E,i.LINK_STATUS)===!1)if(ye=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,E,H,P);else{const Q=kR(i,H,"vertex"),re=kR(i,P,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(E,i.VALIDATE_STATUS)+`

Program Info Log: `+F+`
`+Q+`
`+re)}else F!==""?console.warn("THREE.WebGLProgram: Program Info Log:",F):(Y===""||ue==="")&&(ge=!1);ge&&(W.diagnostics={runnable:ye,programLog:F,vertexShader:{log:Y,prefix:S},fragmentShader:{log:ue,prefix:D}})}i.deleteShader(H),i.deleteShader(P),M=new Pm(i,E),C=CK(i,E)}let M;this.getUniforms=function(){return M===void 0&&I(this),M};let C;this.getAttributes=function(){return C===void 0&&I(this),C};let N=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return N===!1&&(N=i.getProgramParameter(E,EK)),N},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(E),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=SK++,this.cacheKey=e,this.usedTimes=1,this.program=E,this.vertexShader=H,this.fragmentShader=P,this}let BK=0;class HK{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new GK(e),t.set(e,r)),r}}class GK{constructor(e){this.id=BK++,this.code=e,this.usedTimes=0}}function jK(n,e,t,r,i,s,a){const c=new NL,u=new HK,h=[],f=i.isWebGL2,m=i.logarithmicDepthBuffer,_=i.vertexTextures;let v=i.precision;const T={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function A(M){return M===0?"uv":`uv${M}`}function E(M,C,N,W,F){const Y=W.fog,ue=F.geometry,ye=M.isMeshStandardMaterial?W.environment:null,ge=(M.isMeshStandardMaterial?t:e).get(M.envMap||ye),Q=ge&&ge.mapping===l_?ge.image.height:null,re=T[M.type];M.precision!==null&&(v=i.getMaxPrecision(M.precision),v!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",v,"instead."));const ie=ue.morphAttributes.position||ue.morphAttributes.normal||ue.morphAttributes.color,$=ie!==void 0?ie.length:0;let ne=0;ue.morphAttributes.position!==void 0&&(ne=1),ue.morphAttributes.normal!==void 0&&(ne=2),ue.morphAttributes.color!==void 0&&(ne=3);let te,_e,Ee,Pe;if(re){const xn=Vs[re];te=xn.vertexShader,_e=xn.fragmentShader}else te=M.vertexShader,_e=M.fragmentShader,u.update(M),Ee=u.getVertexShaderID(M),Pe=u.getFragmentShaderID(M);const we=n.getRenderTarget(),ke=F.isInstancedMesh===!0,We=F.isBatchedMesh===!0,Ye=!!M.map,It=!!M.matcap,fe=!!ge,nn=!!M.aoMap,st=!!M.lightMap,ft=!!M.bumpMap,Qe=!!M.normalMap,Xt=!!M.displacementMap,mt=!!M.emissiveMap,G=!!M.metalnessMap,U=!!M.roughnessMap,de=M.anisotropy>0,Ie=M.clearcoat>0,Re=M.iridescence>0,De=M.sheen>0,Xe=M.transmission>0,ze=de&&!!M.anisotropyMap,Ge=Ie&&!!M.clearcoatMap,ot=Ie&&!!M.clearcoatNormalMap,xt=Ie&&!!M.clearcoatRoughnessMap,Ae=Re&&!!M.iridescenceMap,Nt=Re&&!!M.iridescenceThicknessMap,bt=De&&!!M.sheenColorMap,ut=De&&!!M.sheenRoughnessMap,rt=!!M.specularMap,$e=!!M.specularColorMap,ct=!!M.specularIntensityMap,Ot=Xe&&!!M.transmissionMap,Kt=Xe&&!!M.thicknessMap,wt=!!M.gradientMap,Oe=!!M.alphaMap,K=M.alphaTest>0,Le=!!M.alphaHash,Ve=!!M.extensions,ht=!!ue.attributes.uv1,at=!!ue.attributes.uv2,vt=!!ue.attributes.uv3;let Vt=za;return M.toneMapped&&(we===null||we.isXRRenderTarget===!0)&&(Vt=n.toneMapping),{isWebGL2:f,shaderID:re,shaderType:M.type,shaderName:M.name,vertexShader:te,fragmentShader:_e,defines:M.defines,customVertexShaderID:Ee,customFragmentShaderID:Pe,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:v,batching:We,instancing:ke,instancingColor:ke&&F.instanceColor!==null,supportsVertexTextures:_,outputColorSpace:we===null?n.outputColorSpace:we.isXRRenderTarget===!0?we.texture.colorSpace:jo,map:Ye,matcap:It,envMap:fe,envMapMode:fe&&ge.mapping,envMapCubeUVHeight:Q,aoMap:nn,lightMap:st,bumpMap:ft,normalMap:Qe,displacementMap:_&&Xt,emissiveMap:mt,normalMapObjectSpace:Qe&&M.normalMapType===Q8,normalMapTangentSpace:Qe&&M.normalMapType===bL,metalnessMap:G,roughnessMap:U,anisotropy:de,anisotropyMap:ze,clearcoat:Ie,clearcoatMap:Ge,clearcoatNormalMap:ot,clearcoatRoughnessMap:xt,iridescence:Re,iridescenceMap:Ae,iridescenceThicknessMap:Nt,sheen:De,sheenColorMap:bt,sheenRoughnessMap:ut,specularMap:rt,specularColorMap:$e,specularIntensityMap:ct,transmission:Xe,transmissionMap:Ot,thicknessMap:Kt,gradientMap:wt,opaque:M.transparent===!1&&M.blending===Du,alphaMap:Oe,alphaTest:K,alphaHash:Le,combine:M.combine,mapUv:Ye&&A(M.map.channel),aoMapUv:nn&&A(M.aoMap.channel),lightMapUv:st&&A(M.lightMap.channel),bumpMapUv:ft&&A(M.bumpMap.channel),normalMapUv:Qe&&A(M.normalMap.channel),displacementMapUv:Xt&&A(M.displacementMap.channel),emissiveMapUv:mt&&A(M.emissiveMap.channel),metalnessMapUv:G&&A(M.metalnessMap.channel),roughnessMapUv:U&&A(M.roughnessMap.channel),anisotropyMapUv:ze&&A(M.anisotropyMap.channel),clearcoatMapUv:Ge&&A(M.clearcoatMap.channel),clearcoatNormalMapUv:ot&&A(M.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:xt&&A(M.clearcoatRoughnessMap.channel),iridescenceMapUv:Ae&&A(M.iridescenceMap.channel),iridescenceThicknessMapUv:Nt&&A(M.iridescenceThicknessMap.channel),sheenColorMapUv:bt&&A(M.sheenColorMap.channel),sheenRoughnessMapUv:ut&&A(M.sheenRoughnessMap.channel),specularMapUv:rt&&A(M.specularMap.channel),specularColorMapUv:$e&&A(M.specularColorMap.channel),specularIntensityMapUv:ct&&A(M.specularIntensityMap.channel),transmissionMapUv:Ot&&A(M.transmissionMap.channel),thicknessMapUv:Kt&&A(M.thicknessMap.channel),alphaMapUv:Oe&&A(M.alphaMap.channel),vertexTangents:!!ue.attributes.tangent&&(Qe||de),vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!ue.attributes.color&&ue.attributes.color.itemSize===4,vertexUv1s:ht,vertexUv2s:at,vertexUv3s:vt,pointsUvs:F.isPoints===!0&&!!ue.attributes.uv&&(Ye||Oe),fog:!!Y,useFog:M.fog===!0,fogExp2:Y&&Y.isFogExp2,flatShading:M.flatShading===!0,sizeAttenuation:M.sizeAttenuation===!0,logarithmicDepthBuffer:m,skinning:F.isSkinnedMesh===!0,morphTargets:ue.morphAttributes.position!==void 0,morphNormals:ue.morphAttributes.normal!==void 0,morphColors:ue.morphAttributes.color!==void 0,morphTargetsCount:$,morphTextureStride:ne,numDirLights:C.directional.length,numPointLights:C.point.length,numSpotLights:C.spot.length,numSpotLightMaps:C.spotLightMap.length,numRectAreaLights:C.rectArea.length,numHemiLights:C.hemi.length,numDirLightShadows:C.directionalShadowMap.length,numPointLightShadows:C.pointShadowMap.length,numSpotLightShadows:C.spotShadowMap.length,numSpotLightShadowsWithMaps:C.numSpotLightShadowsWithMaps,numLightProbes:C.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:M.dithering,shadowMapEnabled:n.shadowMap.enabled&&N.length>0,shadowMapType:n.shadowMap.type,toneMapping:Vt,useLegacyLights:n._useLegacyLights,decodeVideoTexture:Ye&&M.map.isVideoTexture===!0&&ln.getTransfer(M.map.colorSpace)===vn,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===Co,flipSided:M.side===fi,useDepthPacking:M.depthPacking>=0,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:Ve&&M.extensions.derivatives===!0,extensionFragDepth:Ve&&M.extensions.fragDepth===!0,extensionDrawBuffers:Ve&&M.extensions.drawBuffers===!0,extensionShaderTextureLOD:Ve&&M.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Ve&&M.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:f||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:f||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:f||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:M.customProgramCacheKey()}}function S(M){const C=[];if(M.shaderID?C.push(M.shaderID):(C.push(M.customVertexShaderID),C.push(M.customFragmentShaderID)),M.defines!==void 0)for(const N in M.defines)C.push(N),C.push(M.defines[N]);return M.isRawShaderMaterial===!1&&(D(C,M),b(C,M),C.push(n.outputColorSpace)),C.push(M.customProgramCacheKey),C.join()}function D(M,C){M.push(C.precision),M.push(C.outputColorSpace),M.push(C.envMapMode),M.push(C.envMapCubeUVHeight),M.push(C.mapUv),M.push(C.alphaMapUv),M.push(C.lightMapUv),M.push(C.aoMapUv),M.push(C.bumpMapUv),M.push(C.normalMapUv),M.push(C.displacementMapUv),M.push(C.emissiveMapUv),M.push(C.metalnessMapUv),M.push(C.roughnessMapUv),M.push(C.anisotropyMapUv),M.push(C.clearcoatMapUv),M.push(C.clearcoatNormalMapUv),M.push(C.clearcoatRoughnessMapUv),M.push(C.iridescenceMapUv),M.push(C.iridescenceThicknessMapUv),M.push(C.sheenColorMapUv),M.push(C.sheenRoughnessMapUv),M.push(C.specularMapUv),M.push(C.specularColorMapUv),M.push(C.specularIntensityMapUv),M.push(C.transmissionMapUv),M.push(C.thicknessMapUv),M.push(C.combine),M.push(C.fogExp2),M.push(C.sizeAttenuation),M.push(C.morphTargetsCount),M.push(C.morphAttributeCount),M.push(C.numDirLights),M.push(C.numPointLights),M.push(C.numSpotLights),M.push(C.numSpotLightMaps),M.push(C.numHemiLights),M.push(C.numRectAreaLights),M.push(C.numDirLightShadows),M.push(C.numPointLightShadows),M.push(C.numSpotLightShadows),M.push(C.numSpotLightShadowsWithMaps),M.push(C.numLightProbes),M.push(C.shadowMapType),M.push(C.toneMapping),M.push(C.numClippingPlanes),M.push(C.numClipIntersection),M.push(C.depthPacking)}function b(M,C){c.disableAll(),C.isWebGL2&&c.enable(0),C.supportsVertexTextures&&c.enable(1),C.instancing&&c.enable(2),C.instancingColor&&c.enable(3),C.matcap&&c.enable(4),C.envMap&&c.enable(5),C.normalMapObjectSpace&&c.enable(6),C.normalMapTangentSpace&&c.enable(7),C.clearcoat&&c.enable(8),C.iridescence&&c.enable(9),C.alphaTest&&c.enable(10),C.vertexColors&&c.enable(11),C.vertexAlphas&&c.enable(12),C.vertexUv1s&&c.enable(13),C.vertexUv2s&&c.enable(14),C.vertexUv3s&&c.enable(15),C.vertexTangents&&c.enable(16),C.anisotropy&&c.enable(17),C.alphaHash&&c.enable(18),C.batching&&c.enable(19),M.push(c.mask),c.disableAll(),C.fog&&c.enable(0),C.useFog&&c.enable(1),C.flatShading&&c.enable(2),C.logarithmicDepthBuffer&&c.enable(3),C.skinning&&c.enable(4),C.morphTargets&&c.enable(5),C.morphNormals&&c.enable(6),C.morphColors&&c.enable(7),C.premultipliedAlpha&&c.enable(8),C.shadowMapEnabled&&c.enable(9),C.useLegacyLights&&c.enable(10),C.doubleSided&&c.enable(11),C.flipSided&&c.enable(12),C.useDepthPacking&&c.enable(13),C.dithering&&c.enable(14),C.transmission&&c.enable(15),C.sheen&&c.enable(16),C.opaque&&c.enable(17),C.pointsUvs&&c.enable(18),C.decodeVideoTexture&&c.enable(19),M.push(c.mask)}function k(M){const C=T[M.type];let N;if(C){const W=Vs[C];N=A7.clone(W.uniforms)}else N=M.uniforms;return N}function V(M,C){let N;for(let W=0,F=h.length;W<F;W++){const Y=h[W];if(Y.cacheKey===C){N=Y,++N.usedTimes;break}}return N===void 0&&(N=new zK(n,C,M,s),h.push(N)),N}function H(M){if(--M.usedTimes===0){const C=h.indexOf(M);h[C]=h[h.length-1],h.pop(),M.destroy()}}function P(M){u.remove(M)}function I(){u.dispose()}return{getParameters:E,getProgramCacheKey:S,getUniforms:k,acquireProgram:V,releaseProgram:H,releaseShaderCache:P,programs:h,dispose:I}}function WK(){let n=new WeakMap;function e(s){let a=n.get(s);return a===void 0&&(a={},n.set(s,a)),a}function t(s){n.delete(s)}function r(s,a,c){n.get(s)[a]=c}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function $K(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function BR(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function HR(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function a(m,_,v,T,A,E){let S=n[e];return S===void 0?(S={id:m.id,object:m,geometry:_,material:v,groupOrder:T,renderOrder:m.renderOrder,z:A,group:E},n[e]=S):(S.id=m.id,S.object=m,S.geometry=_,S.material=v,S.groupOrder=T,S.renderOrder=m.renderOrder,S.z=A,S.group=E),e++,S}function c(m,_,v,T,A,E){const S=a(m,_,v,T,A,E);v.transmission>0?r.push(S):v.transparent===!0?i.push(S):t.push(S)}function u(m,_,v,T,A,E){const S=a(m,_,v,T,A,E);v.transmission>0?r.unshift(S):v.transparent===!0?i.unshift(S):t.unshift(S)}function h(m,_){t.length>1&&t.sort(m||$K),r.length>1&&r.sort(_||BR),i.length>1&&i.sort(_||BR)}function f(){for(let m=e,_=n.length;m<_;m++){const v=n[m];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:c,unshift:u,finish:f,sort:h}}function qK(){let n=new WeakMap;function e(r,i){const s=n.get(r);let a;return s===void 0?(a=new HR,n.set(r,[a])):i>=s.length?(a=new HR,s.push(a)):a=s[i],a}function t(){n=new WeakMap}return{get:e,dispose:t}}function XK(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new oe,color:new en};break;case"SpotLight":t={position:new oe,direction:new oe,color:new en,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new oe,color:new en,distance:0,decay:0};break;case"HemisphereLight":t={direction:new oe,skyColor:new en,groundColor:new en};break;case"RectAreaLight":t={color:new en,position:new oe,halfWidth:new oe,halfHeight:new oe};break}return n[e.id]=t,t}}}function KK(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ft};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ft};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ft,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let YK=0;function ZK(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function QK(n,e){const t=new XK,r=KK(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let f=0;f<9;f++)i.probe.push(new oe);const s=new oe,a=new Un,c=new Un;function u(f,m){let _=0,v=0,T=0;for(let W=0;W<9;W++)i.probe[W].set(0,0,0);let A=0,E=0,S=0,D=0,b=0,k=0,V=0,H=0,P=0,I=0,M=0;f.sort(ZK);const C=m===!0?Math.PI:1;for(let W=0,F=f.length;W<F;W++){const Y=f[W],ue=Y.color,ye=Y.intensity,ge=Y.distance,Q=Y.shadow&&Y.shadow.map?Y.shadow.map.texture:null;if(Y.isAmbientLight)_+=ue.r*ye*C,v+=ue.g*ye*C,T+=ue.b*ye*C;else if(Y.isLightProbe){for(let re=0;re<9;re++)i.probe[re].addScaledVector(Y.sh.coefficients[re],ye);M++}else if(Y.isDirectionalLight){const re=t.get(Y);if(re.color.copy(Y.color).multiplyScalar(Y.intensity*C),Y.castShadow){const ie=Y.shadow,$=r.get(Y);$.shadowBias=ie.bias,$.shadowNormalBias=ie.normalBias,$.shadowRadius=ie.radius,$.shadowMapSize=ie.mapSize,i.directionalShadow[A]=$,i.directionalShadowMap[A]=Q,i.directionalShadowMatrix[A]=Y.shadow.matrix,k++}i.directional[A]=re,A++}else if(Y.isSpotLight){const re=t.get(Y);re.position.setFromMatrixPosition(Y.matrixWorld),re.color.copy(ue).multiplyScalar(ye*C),re.distance=ge,re.coneCos=Math.cos(Y.angle),re.penumbraCos=Math.cos(Y.angle*(1-Y.penumbra)),re.decay=Y.decay,i.spot[S]=re;const ie=Y.shadow;if(Y.map&&(i.spotLightMap[P]=Y.map,P++,ie.updateMatrices(Y),Y.castShadow&&I++),i.spotLightMatrix[S]=ie.matrix,Y.castShadow){const $=r.get(Y);$.shadowBias=ie.bias,$.shadowNormalBias=ie.normalBias,$.shadowRadius=ie.radius,$.shadowMapSize=ie.mapSize,i.spotShadow[S]=$,i.spotShadowMap[S]=Q,H++}S++}else if(Y.isRectAreaLight){const re=t.get(Y);re.color.copy(ue).multiplyScalar(ye),re.halfWidth.set(Y.width*.5,0,0),re.halfHeight.set(0,Y.height*.5,0),i.rectArea[D]=re,D++}else if(Y.isPointLight){const re=t.get(Y);if(re.color.copy(Y.color).multiplyScalar(Y.intensity*C),re.distance=Y.distance,re.decay=Y.decay,Y.castShadow){const ie=Y.shadow,$=r.get(Y);$.shadowBias=ie.bias,$.shadowNormalBias=ie.normalBias,$.shadowRadius=ie.radius,$.shadowMapSize=ie.mapSize,$.shadowCameraNear=ie.camera.near,$.shadowCameraFar=ie.camera.far,i.pointShadow[E]=$,i.pointShadowMap[E]=Q,i.pointShadowMatrix[E]=Y.shadow.matrix,V++}i.point[E]=re,E++}else if(Y.isHemisphereLight){const re=t.get(Y);re.skyColor.copy(Y.color).multiplyScalar(ye*C),re.groundColor.copy(Y.groundColor).multiplyScalar(ye*C),i.hemi[b]=re,b++}}D>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=je.LTC_FLOAT_1,i.rectAreaLTC2=je.LTC_FLOAT_2):(i.rectAreaLTC1=je.LTC_HALF_1,i.rectAreaLTC2=je.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=je.LTC_FLOAT_1,i.rectAreaLTC2=je.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=je.LTC_HALF_1,i.rectAreaLTC2=je.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=_,i.ambient[1]=v,i.ambient[2]=T;const N=i.hash;(N.directionalLength!==A||N.pointLength!==E||N.spotLength!==S||N.rectAreaLength!==D||N.hemiLength!==b||N.numDirectionalShadows!==k||N.numPointShadows!==V||N.numSpotShadows!==H||N.numSpotMaps!==P||N.numLightProbes!==M)&&(i.directional.length=A,i.spot.length=S,i.rectArea.length=D,i.point.length=E,i.hemi.length=b,i.directionalShadow.length=k,i.directionalShadowMap.length=k,i.pointShadow.length=V,i.pointShadowMap.length=V,i.spotShadow.length=H,i.spotShadowMap.length=H,i.directionalShadowMatrix.length=k,i.pointShadowMatrix.length=V,i.spotLightMatrix.length=H+P-I,i.spotLightMap.length=P,i.numSpotLightShadowsWithMaps=I,i.numLightProbes=M,N.directionalLength=A,N.pointLength=E,N.spotLength=S,N.rectAreaLength=D,N.hemiLength=b,N.numDirectionalShadows=k,N.numPointShadows=V,N.numSpotShadows=H,N.numSpotMaps=P,N.numLightProbes=M,i.version=YK++)}function h(f,m){let _=0,v=0,T=0,A=0,E=0;const S=m.matrixWorldInverse;for(let D=0,b=f.length;D<b;D++){const k=f[D];if(k.isDirectionalLight){const V=i.directional[_];V.direction.setFromMatrixPosition(k.matrixWorld),s.setFromMatrixPosition(k.target.matrixWorld),V.direction.sub(s),V.direction.transformDirection(S),_++}else if(k.isSpotLight){const V=i.spot[T];V.position.setFromMatrixPosition(k.matrixWorld),V.position.applyMatrix4(S),V.direction.setFromMatrixPosition(k.matrixWorld),s.setFromMatrixPosition(k.target.matrixWorld),V.direction.sub(s),V.direction.transformDirection(S),T++}else if(k.isRectAreaLight){const V=i.rectArea[A];V.position.setFromMatrixPosition(k.matrixWorld),V.position.applyMatrix4(S),c.identity(),a.copy(k.matrixWorld),a.premultiply(S),c.extractRotation(a),V.halfWidth.set(k.width*.5,0,0),V.halfHeight.set(0,k.height*.5,0),V.halfWidth.applyMatrix4(c),V.halfHeight.applyMatrix4(c),A++}else if(k.isPointLight){const V=i.point[v];V.position.setFromMatrixPosition(k.matrixWorld),V.position.applyMatrix4(S),v++}else if(k.isHemisphereLight){const V=i.hemi[E];V.direction.setFromMatrixPosition(k.matrixWorld),V.direction.transformDirection(S),E++}}}return{setup:u,setupView:h,state:i}}function GR(n,e){const t=new QK(n,e),r=[],i=[];function s(){r.length=0,i.length=0}function a(m){r.push(m)}function c(m){i.push(m)}function u(m){t.setup(r,m)}function h(m){t.setupView(r,m)}return{init:s,state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:u,setupLightsView:h,pushLight:a,pushShadow:c}}function JK(n,e){let t=new WeakMap;function r(s,a=0){const c=t.get(s);let u;return c===void 0?(u=new GR(n,e),t.set(s,[u])):a>=c.length?(u=new GR(n,e),c.push(u)):u=c[a],u}function i(){t=new WeakMap}return{get:r,dispose:i}}class eY extends fc{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Y8,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class tY extends fc{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const nY=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,rY=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function iY(n,e,t){let r=new AT;const i=new Ft,s=new Ft,a=new Sn,c=new eY({depthPacking:Z8}),u=new tY,h={},f=t.maxTextureSize,m={[Qa]:fi,[fi]:Qa,[Co]:Co},_=new nc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ft},radius:{value:4}},vertexShader:nY,fragmentShader:rY}),v=_.clone();v.defines.HORIZONTAL_PASS=1;const T=new Xi;T.setAttribute("position",new $i(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const A=new ps(T,_),E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=gL;let S=this.type;this.render=function(H,P,I){if(E.enabled===!1||E.autoUpdate===!1&&E.needsUpdate===!1||H.length===0)return;const M=n.getRenderTarget(),C=n.getActiveCubeFace(),N=n.getActiveMipmapLevel(),W=n.state;W.setBlending(Va),W.buffers.color.setClear(1,1,1,1),W.buffers.depth.setTest(!0),W.setScissorTest(!1);const F=S!==bo&&this.type===bo,Y=S===bo&&this.type!==bo;for(let ue=0,ye=H.length;ue<ye;ue++){const ge=H[ue],Q=ge.shadow;if(Q===void 0){console.warn("THREE.WebGLShadowMap:",ge,"has no shadow.");continue}if(Q.autoUpdate===!1&&Q.needsUpdate===!1)continue;i.copy(Q.mapSize);const re=Q.getFrameExtents();if(i.multiply(re),s.copy(Q.mapSize),(i.x>f||i.y>f)&&(i.x>f&&(s.x=Math.floor(f/re.x),i.x=s.x*re.x,Q.mapSize.x=s.x),i.y>f&&(s.y=Math.floor(f/re.y),i.y=s.y*re.y,Q.mapSize.y=s.y)),Q.map===null||F===!0||Y===!0){const $=this.type!==bo?{minFilter:Kr,magFilter:Kr}:{};Q.map!==null&&Q.map.dispose(),Q.map=new tc(i.x,i.y,$),Q.map.texture.name=ge.name+".shadowMap",Q.camera.updateProjectionMatrix()}n.setRenderTarget(Q.map),n.clear();const ie=Q.getViewportCount();for(let $=0;$<ie;$++){const ne=Q.getViewport($);a.set(s.x*ne.x,s.y*ne.y,s.x*ne.z,s.y*ne.w),W.viewport(a),Q.updateMatrices(ge,$),r=Q.getFrustum(),k(P,I,Q.camera,ge,this.type)}Q.isPointLightShadow!==!0&&this.type===bo&&D(Q,I),Q.needsUpdate=!1}S=this.type,E.needsUpdate=!1,n.setRenderTarget(M,C,N)};function D(H,P){const I=e.update(A);_.defines.VSM_SAMPLES!==H.blurSamples&&(_.defines.VSM_SAMPLES=H.blurSamples,v.defines.VSM_SAMPLES=H.blurSamples,_.needsUpdate=!0,v.needsUpdate=!0),H.mapPass===null&&(H.mapPass=new tc(i.x,i.y)),_.uniforms.shadow_pass.value=H.map.texture,_.uniforms.resolution.value=H.mapSize,_.uniforms.radius.value=H.radius,n.setRenderTarget(H.mapPass),n.clear(),n.renderBufferDirect(P,null,I,_,A,null),v.uniforms.shadow_pass.value=H.mapPass.texture,v.uniforms.resolution.value=H.mapSize,v.uniforms.radius.value=H.radius,n.setRenderTarget(H.map),n.clear(),n.renderBufferDirect(P,null,I,v,A,null)}function b(H,P,I,M){let C=null;const N=I.isPointLight===!0?H.customDistanceMaterial:H.customDepthMaterial;if(N!==void 0)C=N;else if(C=I.isPointLight===!0?u:c,n.localClippingEnabled&&P.clipShadows===!0&&Array.isArray(P.clippingPlanes)&&P.clippingPlanes.length!==0||P.displacementMap&&P.displacementScale!==0||P.alphaMap&&P.alphaTest>0||P.map&&P.alphaTest>0){const W=C.uuid,F=P.uuid;let Y=h[W];Y===void 0&&(Y={},h[W]=Y);let ue=Y[F];ue===void 0&&(ue=C.clone(),Y[F]=ue,P.addEventListener("dispose",V)),C=ue}if(C.visible=P.visible,C.wireframe=P.wireframe,M===bo?C.side=P.shadowSide!==null?P.shadowSide:P.side:C.side=P.shadowSide!==null?P.shadowSide:m[P.side],C.alphaMap=P.alphaMap,C.alphaTest=P.alphaTest,C.map=P.map,C.clipShadows=P.clipShadows,C.clippingPlanes=P.clippingPlanes,C.clipIntersection=P.clipIntersection,C.displacementMap=P.displacementMap,C.displacementScale=P.displacementScale,C.displacementBias=P.displacementBias,C.wireframeLinewidth=P.wireframeLinewidth,C.linewidth=P.linewidth,I.isPointLight===!0&&C.isMeshDistanceMaterial===!0){const W=n.properties.get(C);W.light=I}return C}function k(H,P,I,M,C){if(H.visible===!1)return;if(H.layers.test(P.layers)&&(H.isMesh||H.isLine||H.isPoints)&&(H.castShadow||H.receiveShadow&&C===bo)&&(!H.frustumCulled||r.intersectsObject(H))){H.modelViewMatrix.multiplyMatrices(I.matrixWorldInverse,H.matrixWorld);const F=e.update(H),Y=H.material;if(Array.isArray(Y)){const ue=F.groups;for(let ye=0,ge=ue.length;ye<ge;ye++){const Q=ue[ye],re=Y[Q.materialIndex];if(re&&re.visible){const ie=b(H,re,M,C);H.onBeforeShadow(n,H,P,I,F,ie,Q),n.renderBufferDirect(I,null,F,ie,H,Q),H.onAfterShadow(n,H,P,I,F,ie,Q)}}}else if(Y.visible){const ue=b(H,Y,M,C);H.onBeforeShadow(n,H,P,I,F,ue,null),n.renderBufferDirect(I,null,F,ue,H,null),H.onAfterShadow(n,H,P,I,F,ue,null)}}const W=H.children;for(let F=0,Y=W.length;F<Y;F++)k(W[F],P,I,M,C)}function V(H){H.target.removeEventListener("dispose",V);for(const I in h){const M=h[I],C=H.target.uuid;C in M&&(M[C].dispose(),delete M[C])}}}function sY(n,e,t){const r=t.isWebGL2;function i(){let K=!1;const Le=new Sn;let Ve=null;const ht=new Sn(0,0,0,0);return{setMask:function(at){Ve!==at&&!K&&(n.colorMask(at,at,at,at),Ve=at)},setLocked:function(at){K=at},setClear:function(at,vt,Vt,rn,xn){xn===!0&&(at*=rn,vt*=rn,Vt*=rn),Le.set(at,vt,Vt,rn),ht.equals(Le)===!1&&(n.clearColor(at,vt,Vt,rn),ht.copy(Le))},reset:function(){K=!1,Ve=null,ht.set(-1,0,0,0)}}}function s(){let K=!1,Le=null,Ve=null,ht=null;return{setTest:function(at){at?We(n.DEPTH_TEST):Ye(n.DEPTH_TEST)},setMask:function(at){Le!==at&&!K&&(n.depthMask(at),Le=at)},setFunc:function(at){if(Ve!==at){switch(at){case M8:n.depthFunc(n.NEVER);break;case b8:n.depthFunc(n.ALWAYS);break;case R8:n.depthFunc(n.LESS);break;case ag:n.depthFunc(n.LEQUAL);break;case C8:n.depthFunc(n.EQUAL);break;case P8:n.depthFunc(n.GEQUAL);break;case I8:n.depthFunc(n.GREATER);break;case D8:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Ve=at}},setLocked:function(at){K=at},setClear:function(at){ht!==at&&(n.clearDepth(at),ht=at)},reset:function(){K=!1,Le=null,Ve=null,ht=null}}}function a(){let K=!1,Le=null,Ve=null,ht=null,at=null,vt=null,Vt=null,rn=null,xn=null;return{setTest:function(zt){K||(zt?We(n.STENCIL_TEST):Ye(n.STENCIL_TEST))},setMask:function(zt){Le!==zt&&!K&&(n.stencilMask(zt),Le=zt)},setFunc:function(zt,cn,Dn){(Ve!==zt||ht!==cn||at!==Dn)&&(n.stencilFunc(zt,cn,Dn),Ve=zt,ht=cn,at=Dn)},setOp:function(zt,cn,Dn){(vt!==zt||Vt!==cn||rn!==Dn)&&(n.stencilOp(zt,cn,Dn),vt=zt,Vt=cn,rn=Dn)},setLocked:function(zt){K=zt},setClear:function(zt){xn!==zt&&(n.clearStencil(zt),xn=zt)},reset:function(){K=!1,Le=null,Ve=null,ht=null,at=null,vt=null,Vt=null,rn=null,xn=null}}}const c=new i,u=new s,h=new a,f=new WeakMap,m=new WeakMap;let _={},v={},T=new WeakMap,A=[],E=null,S=!1,D=null,b=null,k=null,V=null,H=null,P=null,I=null,M=new en(0,0,0),C=0,N=!1,W=null,F=null,Y=null,ue=null,ye=null;const ge=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Q=!1,re=0;const ie=n.getParameter(n.VERSION);ie.indexOf("WebGL")!==-1?(re=parseFloat(/^WebGL (\d)/.exec(ie)[1]),Q=re>=1):ie.indexOf("OpenGL ES")!==-1&&(re=parseFloat(/^OpenGL ES (\d)/.exec(ie)[1]),Q=re>=2);let $=null,ne={};const te=n.getParameter(n.SCISSOR_BOX),_e=n.getParameter(n.VIEWPORT),Ee=new Sn().fromArray(te),Pe=new Sn().fromArray(_e);function we(K,Le,Ve,ht){const at=new Uint8Array(4),vt=n.createTexture();n.bindTexture(K,vt),n.texParameteri(K,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(K,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Vt=0;Vt<Ve;Vt++)r&&(K===n.TEXTURE_3D||K===n.TEXTURE_2D_ARRAY)?n.texImage3D(Le,0,n.RGBA,1,1,ht,0,n.RGBA,n.UNSIGNED_BYTE,at):n.texImage2D(Le+Vt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,at);return vt}const ke={};ke[n.TEXTURE_2D]=we(n.TEXTURE_2D,n.TEXTURE_2D,1),ke[n.TEXTURE_CUBE_MAP]=we(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(ke[n.TEXTURE_2D_ARRAY]=we(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),ke[n.TEXTURE_3D]=we(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),c.setClear(0,0,0,1),u.setClear(1),h.setClear(0),We(n.DEPTH_TEST),u.setFunc(ag),mt(!1),G(A1),We(n.CULL_FACE),Qe(Va);function We(K){_[K]!==!0&&(n.enable(K),_[K]=!0)}function Ye(K){_[K]!==!1&&(n.disable(K),_[K]=!1)}function It(K,Le){return v[K]!==Le?(n.bindFramebuffer(K,Le),v[K]=Le,r&&(K===n.DRAW_FRAMEBUFFER&&(v[n.FRAMEBUFFER]=Le),K===n.FRAMEBUFFER&&(v[n.DRAW_FRAMEBUFFER]=Le)),!0):!1}function fe(K,Le){let Ve=A,ht=!1;if(K)if(Ve=T.get(Le),Ve===void 0&&(Ve=[],T.set(Le,Ve)),K.isWebGLMultipleRenderTargets){const at=K.texture;if(Ve.length!==at.length||Ve[0]!==n.COLOR_ATTACHMENT0){for(let vt=0,Vt=at.length;vt<Vt;vt++)Ve[vt]=n.COLOR_ATTACHMENT0+vt;Ve.length=at.length,ht=!0}}else Ve[0]!==n.COLOR_ATTACHMENT0&&(Ve[0]=n.COLOR_ATTACHMENT0,ht=!0);else Ve[0]!==n.BACK&&(Ve[0]=n.BACK,ht=!0);ht&&(t.isWebGL2?n.drawBuffers(Ve):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ve))}function nn(K){return E!==K?(n.useProgram(K),E=K,!0):!1}const st={[Ol]:n.FUNC_ADD,[h8]:n.FUNC_SUBTRACT,[d8]:n.FUNC_REVERSE_SUBTRACT};if(r)st[C1]=n.MIN,st[P1]=n.MAX;else{const K=e.get("EXT_blend_minmax");K!==null&&(st[C1]=K.MIN_EXT,st[P1]=K.MAX_EXT)}const ft={[f8]:n.ZERO,[p8]:n.ONE,[m8]:n.SRC_COLOR,[uE]:n.SRC_ALPHA,[S8]:n.SRC_ALPHA_SATURATE,[y8]:n.DST_COLOR,[_8]:n.DST_ALPHA,[g8]:n.ONE_MINUS_SRC_COLOR,[hE]:n.ONE_MINUS_SRC_ALPHA,[E8]:n.ONE_MINUS_DST_COLOR,[v8]:n.ONE_MINUS_DST_ALPHA,[T8]:n.CONSTANT_COLOR,[x8]:n.ONE_MINUS_CONSTANT_COLOR,[w8]:n.CONSTANT_ALPHA,[A8]:n.ONE_MINUS_CONSTANT_ALPHA};function Qe(K,Le,Ve,ht,at,vt,Vt,rn,xn,zt){if(K===Va){S===!0&&(Ye(n.BLEND),S=!1);return}if(S===!1&&(We(n.BLEND),S=!0),K!==u8){if(K!==D||zt!==N){if((b!==Ol||H!==Ol)&&(n.blendEquation(n.FUNC_ADD),b=Ol,H=Ol),zt)switch(K){case Du:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case M1:n.blendFunc(n.ONE,n.ONE);break;case b1:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case R1:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",K);break}else switch(K){case Du:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case M1:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case b1:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case R1:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",K);break}k=null,V=null,P=null,I=null,M.set(0,0,0),C=0,D=K,N=zt}return}at=at||Le,vt=vt||Ve,Vt=Vt||ht,(Le!==b||at!==H)&&(n.blendEquationSeparate(st[Le],st[at]),b=Le,H=at),(Ve!==k||ht!==V||vt!==P||Vt!==I)&&(n.blendFuncSeparate(ft[Ve],ft[ht],ft[vt],ft[Vt]),k=Ve,V=ht,P=vt,I=Vt),(rn.equals(M)===!1||xn!==C)&&(n.blendColor(rn.r,rn.g,rn.b,xn),M.copy(rn),C=xn),D=K,N=!1}function Xt(K,Le){K.side===Co?Ye(n.CULL_FACE):We(n.CULL_FACE);let Ve=K.side===fi;Le&&(Ve=!Ve),mt(Ve),K.blending===Du&&K.transparent===!1?Qe(Va):Qe(K.blending,K.blendEquation,K.blendSrc,K.blendDst,K.blendEquationAlpha,K.blendSrcAlpha,K.blendDstAlpha,K.blendColor,K.blendAlpha,K.premultipliedAlpha),u.setFunc(K.depthFunc),u.setTest(K.depthTest),u.setMask(K.depthWrite),c.setMask(K.colorWrite);const ht=K.stencilWrite;h.setTest(ht),ht&&(h.setMask(K.stencilWriteMask),h.setFunc(K.stencilFunc,K.stencilRef,K.stencilFuncMask),h.setOp(K.stencilFail,K.stencilZFail,K.stencilZPass)),de(K.polygonOffset,K.polygonOffsetFactor,K.polygonOffsetUnits),K.alphaToCoverage===!0?We(n.SAMPLE_ALPHA_TO_COVERAGE):Ye(n.SAMPLE_ALPHA_TO_COVERAGE)}function mt(K){W!==K&&(K?n.frontFace(n.CW):n.frontFace(n.CCW),W=K)}function G(K){K!==a8?(We(n.CULL_FACE),K!==F&&(K===A1?n.cullFace(n.BACK):K===l8?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Ye(n.CULL_FACE),F=K}function U(K){K!==Y&&(Q&&n.lineWidth(K),Y=K)}function de(K,Le,Ve){K?(We(n.POLYGON_OFFSET_FILL),(ue!==Le||ye!==Ve)&&(n.polygonOffset(Le,Ve),ue=Le,ye=Ve)):Ye(n.POLYGON_OFFSET_FILL)}function Ie(K){K?We(n.SCISSOR_TEST):Ye(n.SCISSOR_TEST)}function Re(K){K===void 0&&(K=n.TEXTURE0+ge-1),$!==K&&(n.activeTexture(K),$=K)}function De(K,Le,Ve){Ve===void 0&&($===null?Ve=n.TEXTURE0+ge-1:Ve=$);let ht=ne[Ve];ht===void 0&&(ht={type:void 0,texture:void 0},ne[Ve]=ht),(ht.type!==K||ht.texture!==Le)&&($!==Ve&&(n.activeTexture(Ve),$=Ve),n.bindTexture(K,Le||ke[K]),ht.type=K,ht.texture=Le)}function Xe(){const K=ne[$];K!==void 0&&K.type!==void 0&&(n.bindTexture(K.type,null),K.type=void 0,K.texture=void 0)}function ze(){try{n.compressedTexImage2D.apply(n,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Ge(){try{n.compressedTexImage3D.apply(n,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function ot(){try{n.texSubImage2D.apply(n,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function xt(){try{n.texSubImage3D.apply(n,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Ae(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Nt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function bt(){try{n.texStorage2D.apply(n,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function ut(){try{n.texStorage3D.apply(n,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function rt(){try{n.texImage2D.apply(n,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function $e(){try{n.texImage3D.apply(n,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function ct(K){Ee.equals(K)===!1&&(n.scissor(K.x,K.y,K.z,K.w),Ee.copy(K))}function Ot(K){Pe.equals(K)===!1&&(n.viewport(K.x,K.y,K.z,K.w),Pe.copy(K))}function Kt(K,Le){let Ve=m.get(Le);Ve===void 0&&(Ve=new WeakMap,m.set(Le,Ve));let ht=Ve.get(K);ht===void 0&&(ht=n.getUniformBlockIndex(Le,K.name),Ve.set(K,ht))}function wt(K,Le){const ht=m.get(Le).get(K);f.get(Le)!==ht&&(n.uniformBlockBinding(Le,ht,K.__bindingPointIndex),f.set(Le,ht))}function Oe(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),r===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),_={},$=null,ne={},v={},T=new WeakMap,A=[],E=null,S=!1,D=null,b=null,k=null,V=null,H=null,P=null,I=null,M=new en(0,0,0),C=0,N=!1,W=null,F=null,Y=null,ue=null,ye=null,Ee.set(0,0,n.canvas.width,n.canvas.height),Pe.set(0,0,n.canvas.width,n.canvas.height),c.reset(),u.reset(),h.reset()}return{buffers:{color:c,depth:u,stencil:h},enable:We,disable:Ye,bindFramebuffer:It,drawBuffers:fe,useProgram:nn,setBlending:Qe,setMaterial:Xt,setFlipSided:mt,setCullFace:G,setLineWidth:U,setPolygonOffset:de,setScissorTest:Ie,activeTexture:Re,bindTexture:De,unbindTexture:Xe,compressedTexImage2D:ze,compressedTexImage3D:Ge,texImage2D:rt,texImage3D:$e,updateUBOMapping:Kt,uniformBlockBinding:wt,texStorage2D:bt,texStorage3D:ut,texSubImage2D:ot,texSubImage3D:xt,compressedTexSubImage2D:Ae,compressedTexSubImage3D:Nt,scissor:ct,viewport:Ot,reset:Oe}}function oY(n,e,t,r,i,s,a){const c=i.isWebGL2,u=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap;let m;const _=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function T(G,U){return v?new OffscreenCanvas(G,U):dg("canvas")}function A(G,U,de,Ie){let Re=1;if((G.width>Ie||G.height>Ie)&&(Re=Ie/Math.max(G.width,G.height)),Re<1||U===!0)if(typeof HTMLImageElement<"u"&&G instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&G instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&G instanceof ImageBitmap){const De=U?yE:Math.floor,Xe=De(Re*G.width),ze=De(Re*G.height);m===void 0&&(m=T(Xe,ze));const Ge=de?T(Xe,ze):m;return Ge.width=Xe,Ge.height=ze,Ge.getContext("2d").drawImage(G,0,0,Xe,ze),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+G.width+"x"+G.height+") to ("+Xe+"x"+ze+")."),Ge}else return"data"in G&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+G.width+"x"+G.height+")."),G;return G}function E(G){return sR(G.width)&&sR(G.height)}function S(G){return c?!1:G.wrapS!==hs||G.wrapT!==hs||G.minFilter!==Kr&&G.minFilter!==Bi}function D(G,U){return G.generateMipmaps&&U&&G.minFilter!==Kr&&G.minFilter!==Bi}function b(G){n.generateMipmap(G)}function k(G,U,de,Ie,Re=!1){if(c===!1)return U;if(G!==null){if(n[G]!==void 0)return n[G];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+G+"'")}let De=U;if(U===n.RED&&(de===n.FLOAT&&(De=n.R32F),de===n.HALF_FLOAT&&(De=n.R16F),de===n.UNSIGNED_BYTE&&(De=n.R8)),U===n.RED_INTEGER&&(de===n.UNSIGNED_BYTE&&(De=n.R8UI),de===n.UNSIGNED_SHORT&&(De=n.R16UI),de===n.UNSIGNED_INT&&(De=n.R32UI),de===n.BYTE&&(De=n.R8I),de===n.SHORT&&(De=n.R16I),de===n.INT&&(De=n.R32I)),U===n.RG&&(de===n.FLOAT&&(De=n.RG32F),de===n.HALF_FLOAT&&(De=n.RG16F),de===n.UNSIGNED_BYTE&&(De=n.RG8)),U===n.RGBA){const Xe=Re?lg:ln.getTransfer(Ie);de===n.FLOAT&&(De=n.RGBA32F),de===n.HALF_FLOAT&&(De=n.RGBA16F),de===n.UNSIGNED_BYTE&&(De=Xe===vn?n.SRGB8_ALPHA8:n.RGBA8),de===n.UNSIGNED_SHORT_4_4_4_4&&(De=n.RGBA4),de===n.UNSIGNED_SHORT_5_5_5_1&&(De=n.RGB5_A1)}return(De===n.R16F||De===n.R32F||De===n.RG16F||De===n.RG32F||De===n.RGBA16F||De===n.RGBA32F)&&e.get("EXT_color_buffer_float"),De}function V(G,U,de){return D(G,de)===!0||G.isFramebufferTexture&&G.minFilter!==Kr&&G.minFilter!==Bi?Math.log2(Math.max(U.width,U.height))+1:G.mipmaps!==void 0&&G.mipmaps.length>0?G.mipmaps.length:G.isCompressedTexture&&Array.isArray(G.image)?U.mipmaps.length:1}function H(G){return G===Kr||G===I1||G===Ry?n.NEAREST:n.LINEAR}function P(G){const U=G.target;U.removeEventListener("dispose",P),M(U),U.isVideoTexture&&f.delete(U)}function I(G){const U=G.target;U.removeEventListener("dispose",I),N(U)}function M(G){const U=r.get(G);if(U.__webglInit===void 0)return;const de=G.source,Ie=_.get(de);if(Ie){const Re=Ie[U.__cacheKey];Re.usedTimes--,Re.usedTimes===0&&C(G),Object.keys(Ie).length===0&&_.delete(de)}r.remove(G)}function C(G){const U=r.get(G);n.deleteTexture(U.__webglTexture);const de=G.source,Ie=_.get(de);delete Ie[U.__cacheKey],a.memory.textures--}function N(G){const U=G.texture,de=r.get(G),Ie=r.get(U);if(Ie.__webglTexture!==void 0&&(n.deleteTexture(Ie.__webglTexture),a.memory.textures--),G.depthTexture&&G.depthTexture.dispose(),G.isWebGLCubeRenderTarget)for(let Re=0;Re<6;Re++){if(Array.isArray(de.__webglFramebuffer[Re]))for(let De=0;De<de.__webglFramebuffer[Re].length;De++)n.deleteFramebuffer(de.__webglFramebuffer[Re][De]);else n.deleteFramebuffer(de.__webglFramebuffer[Re]);de.__webglDepthbuffer&&n.deleteRenderbuffer(de.__webglDepthbuffer[Re])}else{if(Array.isArray(de.__webglFramebuffer))for(let Re=0;Re<de.__webglFramebuffer.length;Re++)n.deleteFramebuffer(de.__webglFramebuffer[Re]);else n.deleteFramebuffer(de.__webglFramebuffer);if(de.__webglDepthbuffer&&n.deleteRenderbuffer(de.__webglDepthbuffer),de.__webglMultisampledFramebuffer&&n.deleteFramebuffer(de.__webglMultisampledFramebuffer),de.__webglColorRenderbuffer)for(let Re=0;Re<de.__webglColorRenderbuffer.length;Re++)de.__webglColorRenderbuffer[Re]&&n.deleteRenderbuffer(de.__webglColorRenderbuffer[Re]);de.__webglDepthRenderbuffer&&n.deleteRenderbuffer(de.__webglDepthRenderbuffer)}if(G.isWebGLMultipleRenderTargets)for(let Re=0,De=U.length;Re<De;Re++){const Xe=r.get(U[Re]);Xe.__webglTexture&&(n.deleteTexture(Xe.__webglTexture),a.memory.textures--),r.remove(U[Re])}r.remove(U),r.remove(G)}let W=0;function F(){W=0}function Y(){const G=W;return G>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+G+" texture units while this GPU supports only "+i.maxTextures),W+=1,G}function ue(G){const U=[];return U.push(G.wrapS),U.push(G.wrapT),U.push(G.wrapR||0),U.push(G.magFilter),U.push(G.minFilter),U.push(G.anisotropy),U.push(G.internalFormat),U.push(G.format),U.push(G.type),U.push(G.generateMipmaps),U.push(G.premultiplyAlpha),U.push(G.flipY),U.push(G.unpackAlignment),U.push(G.colorSpace),U.join()}function ye(G,U){const de=r.get(G);if(G.isVideoTexture&&Xt(G),G.isRenderTargetTexture===!1&&G.version>0&&de.__version!==G.version){const Ie=G.image;if(Ie===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Ie.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ee(de,G,U);return}}t.bindTexture(n.TEXTURE_2D,de.__webglTexture,n.TEXTURE0+U)}function ge(G,U){const de=r.get(G);if(G.version>0&&de.__version!==G.version){Ee(de,G,U);return}t.bindTexture(n.TEXTURE_2D_ARRAY,de.__webglTexture,n.TEXTURE0+U)}function Q(G,U){const de=r.get(G);if(G.version>0&&de.__version!==G.version){Ee(de,G,U);return}t.bindTexture(n.TEXTURE_3D,de.__webglTexture,n.TEXTURE0+U)}function re(G,U){const de=r.get(G);if(G.version>0&&de.__version!==G.version){Pe(de,G,U);return}t.bindTexture(n.TEXTURE_CUBE_MAP,de.__webglTexture,n.TEXTURE0+U)}const ie={[pE]:n.REPEAT,[hs]:n.CLAMP_TO_EDGE,[mE]:n.MIRRORED_REPEAT},$={[Kr]:n.NEAREST,[I1]:n.NEAREST_MIPMAP_NEAREST,[Ry]:n.NEAREST_MIPMAP_LINEAR,[Bi]:n.LINEAR,[B8]:n.LINEAR_MIPMAP_NEAREST,[$d]:n.LINEAR_MIPMAP_LINEAR},ne={[J8]:n.NEVER,[s7]:n.ALWAYS,[e7]:n.LESS,[RL]:n.LEQUAL,[t7]:n.EQUAL,[i7]:n.GEQUAL,[n7]:n.GREATER,[r7]:n.NOTEQUAL};function te(G,U,de){if(de?(n.texParameteri(G,n.TEXTURE_WRAP_S,ie[U.wrapS]),n.texParameteri(G,n.TEXTURE_WRAP_T,ie[U.wrapT]),(G===n.TEXTURE_3D||G===n.TEXTURE_2D_ARRAY)&&n.texParameteri(G,n.TEXTURE_WRAP_R,ie[U.wrapR]),n.texParameteri(G,n.TEXTURE_MAG_FILTER,$[U.magFilter]),n.texParameteri(G,n.TEXTURE_MIN_FILTER,$[U.minFilter])):(n.texParameteri(G,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(G,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(G===n.TEXTURE_3D||G===n.TEXTURE_2D_ARRAY)&&n.texParameteri(G,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(U.wrapS!==hs||U.wrapT!==hs)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(G,n.TEXTURE_MAG_FILTER,H(U.magFilter)),n.texParameteri(G,n.TEXTURE_MIN_FILTER,H(U.minFilter)),U.minFilter!==Kr&&U.minFilter!==Bi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),U.compareFunction&&(n.texParameteri(G,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(G,n.TEXTURE_COMPARE_FUNC,ne[U.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Ie=e.get("EXT_texture_filter_anisotropic");if(U.magFilter===Kr||U.minFilter!==Ry&&U.minFilter!==$d||U.type===Na&&e.has("OES_texture_float_linear")===!1||c===!1&&U.type===qd&&e.has("OES_texture_half_float_linear")===!1)return;(U.anisotropy>1||r.get(U).__currentAnisotropy)&&(n.texParameterf(G,Ie.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(U.anisotropy,i.getMaxAnisotropy())),r.get(U).__currentAnisotropy=U.anisotropy)}}function _e(G,U){let de=!1;G.__webglInit===void 0&&(G.__webglInit=!0,U.addEventListener("dispose",P));const Ie=U.source;let Re=_.get(Ie);Re===void 0&&(Re={},_.set(Ie,Re));const De=ue(U);if(De!==G.__cacheKey){Re[De]===void 0&&(Re[De]={texture:n.createTexture(),usedTimes:0},a.memory.textures++,de=!0),Re[De].usedTimes++;const Xe=Re[G.__cacheKey];Xe!==void 0&&(Re[G.__cacheKey].usedTimes--,Xe.usedTimes===0&&C(U)),G.__cacheKey=De,G.__webglTexture=Re[De].texture}return de}function Ee(G,U,de){let Ie=n.TEXTURE_2D;(U.isDataArrayTexture||U.isCompressedArrayTexture)&&(Ie=n.TEXTURE_2D_ARRAY),U.isData3DTexture&&(Ie=n.TEXTURE_3D);const Re=_e(G,U),De=U.source;t.bindTexture(Ie,G.__webglTexture,n.TEXTURE0+de);const Xe=r.get(De);if(De.version!==Xe.__version||Re===!0){t.activeTexture(n.TEXTURE0+de);const ze=ln.getPrimaries(ln.workingColorSpace),Ge=U.colorSpace===ji?null:ln.getPrimaries(U.colorSpace),ot=U.colorSpace===ji||ze===Ge?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,U.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,U.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,U.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,ot);const xt=S(U)&&E(U.image)===!1;let Ae=A(U.image,xt,!1,i.maxTextureSize);Ae=mt(U,Ae);const Nt=E(Ae)||c,bt=s.convert(U.format,U.colorSpace);let ut=s.convert(U.type),rt=k(U.internalFormat,bt,ut,U.colorSpace,U.isVideoTexture);te(Ie,U,Nt);let $e;const ct=U.mipmaps,Ot=c&&U.isVideoTexture!==!0&&rt!==AL,Kt=Xe.__version===void 0||Re===!0,wt=V(U,Ae,Nt);if(U.isDepthTexture)rt=n.DEPTH_COMPONENT,c?U.type===Na?rt=n.DEPTH_COMPONENT32F:U.type===La?rt=n.DEPTH_COMPONENT24:U.type===Wl?rt=n.DEPTH24_STENCIL8:rt=n.DEPTH_COMPONENT16:U.type===Na&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),U.format===$l&&rt===n.DEPTH_COMPONENT&&U.type!==TT&&U.type!==La&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),U.type=La,ut=s.convert(U.type)),U.format===Xu&&rt===n.DEPTH_COMPONENT&&(rt=n.DEPTH_STENCIL,U.type!==Wl&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),U.type=Wl,ut=s.convert(U.type))),Kt&&(Ot?t.texStorage2D(n.TEXTURE_2D,1,rt,Ae.width,Ae.height):t.texImage2D(n.TEXTURE_2D,0,rt,Ae.width,Ae.height,0,bt,ut,null));else if(U.isDataTexture)if(ct.length>0&&Nt){Ot&&Kt&&t.texStorage2D(n.TEXTURE_2D,wt,rt,ct[0].width,ct[0].height);for(let Oe=0,K=ct.length;Oe<K;Oe++)$e=ct[Oe],Ot?t.texSubImage2D(n.TEXTURE_2D,Oe,0,0,$e.width,$e.height,bt,ut,$e.data):t.texImage2D(n.TEXTURE_2D,Oe,rt,$e.width,$e.height,0,bt,ut,$e.data);U.generateMipmaps=!1}else Ot?(Kt&&t.texStorage2D(n.TEXTURE_2D,wt,rt,Ae.width,Ae.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ae.width,Ae.height,bt,ut,Ae.data)):t.texImage2D(n.TEXTURE_2D,0,rt,Ae.width,Ae.height,0,bt,ut,Ae.data);else if(U.isCompressedTexture)if(U.isCompressedArrayTexture){Ot&&Kt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,wt,rt,ct[0].width,ct[0].height,Ae.depth);for(let Oe=0,K=ct.length;Oe<K;Oe++)$e=ct[Oe],U.format!==ds?bt!==null?Ot?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Oe,0,0,0,$e.width,$e.height,Ae.depth,bt,$e.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Oe,rt,$e.width,$e.height,Ae.depth,0,$e.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ot?t.texSubImage3D(n.TEXTURE_2D_ARRAY,Oe,0,0,0,$e.width,$e.height,Ae.depth,bt,ut,$e.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Oe,rt,$e.width,$e.height,Ae.depth,0,bt,ut,$e.data)}else{Ot&&Kt&&t.texStorage2D(n.TEXTURE_2D,wt,rt,ct[0].width,ct[0].height);for(let Oe=0,K=ct.length;Oe<K;Oe++)$e=ct[Oe],U.format!==ds?bt!==null?Ot?t.compressedTexSubImage2D(n.TEXTURE_2D,Oe,0,0,$e.width,$e.height,bt,$e.data):t.compressedTexImage2D(n.TEXTURE_2D,Oe,rt,$e.width,$e.height,0,$e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ot?t.texSubImage2D(n.TEXTURE_2D,Oe,0,0,$e.width,$e.height,bt,ut,$e.data):t.texImage2D(n.TEXTURE_2D,Oe,rt,$e.width,$e.height,0,bt,ut,$e.data)}else if(U.isDataArrayTexture)Ot?(Kt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,wt,rt,Ae.width,Ae.height,Ae.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ae.width,Ae.height,Ae.depth,bt,ut,Ae.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,rt,Ae.width,Ae.height,Ae.depth,0,bt,ut,Ae.data);else if(U.isData3DTexture)Ot?(Kt&&t.texStorage3D(n.TEXTURE_3D,wt,rt,Ae.width,Ae.height,Ae.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ae.width,Ae.height,Ae.depth,bt,ut,Ae.data)):t.texImage3D(n.TEXTURE_3D,0,rt,Ae.width,Ae.height,Ae.depth,0,bt,ut,Ae.data);else if(U.isFramebufferTexture){if(Kt)if(Ot)t.texStorage2D(n.TEXTURE_2D,wt,rt,Ae.width,Ae.height);else{let Oe=Ae.width,K=Ae.height;for(let Le=0;Le<wt;Le++)t.texImage2D(n.TEXTURE_2D,Le,rt,Oe,K,0,bt,ut,null),Oe>>=1,K>>=1}}else if(ct.length>0&&Nt){Ot&&Kt&&t.texStorage2D(n.TEXTURE_2D,wt,rt,ct[0].width,ct[0].height);for(let Oe=0,K=ct.length;Oe<K;Oe++)$e=ct[Oe],Ot?t.texSubImage2D(n.TEXTURE_2D,Oe,0,0,bt,ut,$e):t.texImage2D(n.TEXTURE_2D,Oe,rt,bt,ut,$e);U.generateMipmaps=!1}else Ot?(Kt&&t.texStorage2D(n.TEXTURE_2D,wt,rt,Ae.width,Ae.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,bt,ut,Ae)):t.texImage2D(n.TEXTURE_2D,0,rt,bt,ut,Ae);D(U,Nt)&&b(Ie),Xe.__version=De.version,U.onUpdate&&U.onUpdate(U)}G.__version=U.version}function Pe(G,U,de){if(U.image.length!==6)return;const Ie=_e(G,U),Re=U.source;t.bindTexture(n.TEXTURE_CUBE_MAP,G.__webglTexture,n.TEXTURE0+de);const De=r.get(Re);if(Re.version!==De.__version||Ie===!0){t.activeTexture(n.TEXTURE0+de);const Xe=ln.getPrimaries(ln.workingColorSpace),ze=U.colorSpace===ji?null:ln.getPrimaries(U.colorSpace),Ge=U.colorSpace===ji||Xe===ze?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,U.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,U.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,U.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ge);const ot=U.isCompressedTexture||U.image[0].isCompressedTexture,xt=U.image[0]&&U.image[0].isDataTexture,Ae=[];for(let Oe=0;Oe<6;Oe++)!ot&&!xt?Ae[Oe]=A(U.image[Oe],!1,!0,i.maxCubemapSize):Ae[Oe]=xt?U.image[Oe].image:U.image[Oe],Ae[Oe]=mt(U,Ae[Oe]);const Nt=Ae[0],bt=E(Nt)||c,ut=s.convert(U.format,U.colorSpace),rt=s.convert(U.type),$e=k(U.internalFormat,ut,rt,U.colorSpace),ct=c&&U.isVideoTexture!==!0,Ot=De.__version===void 0||Ie===!0;let Kt=V(U,Nt,bt);te(n.TEXTURE_CUBE_MAP,U,bt);let wt;if(ot){ct&&Ot&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Kt,$e,Nt.width,Nt.height);for(let Oe=0;Oe<6;Oe++){wt=Ae[Oe].mipmaps;for(let K=0;K<wt.length;K++){const Le=wt[K];U.format!==ds?ut!==null?ct?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,K,0,0,Le.width,Le.height,ut,Le.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,K,$e,Le.width,Le.height,0,Le.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ct?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,K,0,0,Le.width,Le.height,ut,rt,Le.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,K,$e,Le.width,Le.height,0,ut,rt,Le.data)}}}else{wt=U.mipmaps,ct&&Ot&&(wt.length>0&&Kt++,t.texStorage2D(n.TEXTURE_CUBE_MAP,Kt,$e,Ae[0].width,Ae[0].height));for(let Oe=0;Oe<6;Oe++)if(xt){ct?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,0,0,Ae[Oe].width,Ae[Oe].height,ut,rt,Ae[Oe].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,$e,Ae[Oe].width,Ae[Oe].height,0,ut,rt,Ae[Oe].data);for(let K=0;K<wt.length;K++){const Ve=wt[K].image[Oe].image;ct?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,K+1,0,0,Ve.width,Ve.height,ut,rt,Ve.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,K+1,$e,Ve.width,Ve.height,0,ut,rt,Ve.data)}}else{ct?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,0,0,ut,rt,Ae[Oe]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,$e,ut,rt,Ae[Oe]);for(let K=0;K<wt.length;K++){const Le=wt[K];ct?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,K+1,0,0,ut,rt,Le.image[Oe]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,K+1,$e,ut,rt,Le.image[Oe])}}}D(U,bt)&&b(n.TEXTURE_CUBE_MAP),De.__version=Re.version,U.onUpdate&&U.onUpdate(U)}G.__version=U.version}function we(G,U,de,Ie,Re,De){const Xe=s.convert(de.format,de.colorSpace),ze=s.convert(de.type),Ge=k(de.internalFormat,Xe,ze,de.colorSpace);if(!r.get(U).__hasExternalTextures){const xt=Math.max(1,U.width>>De),Ae=Math.max(1,U.height>>De);Re===n.TEXTURE_3D||Re===n.TEXTURE_2D_ARRAY?t.texImage3D(Re,De,Ge,xt,Ae,U.depth,0,Xe,ze,null):t.texImage2D(Re,De,Ge,xt,Ae,0,Xe,ze,null)}t.bindFramebuffer(n.FRAMEBUFFER,G),Qe(U)?u.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Ie,Re,r.get(de).__webglTexture,0,ft(U)):(Re===n.TEXTURE_2D||Re>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Re<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Ie,Re,r.get(de).__webglTexture,De),t.bindFramebuffer(n.FRAMEBUFFER,null)}function ke(G,U,de){if(n.bindRenderbuffer(n.RENDERBUFFER,G),U.depthBuffer&&!U.stencilBuffer){let Ie=c===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(de||Qe(U)){const Re=U.depthTexture;Re&&Re.isDepthTexture&&(Re.type===Na?Ie=n.DEPTH_COMPONENT32F:Re.type===La&&(Ie=n.DEPTH_COMPONENT24));const De=ft(U);Qe(U)?u.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,De,Ie,U.width,U.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,De,Ie,U.width,U.height)}else n.renderbufferStorage(n.RENDERBUFFER,Ie,U.width,U.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,G)}else if(U.depthBuffer&&U.stencilBuffer){const Ie=ft(U);de&&Qe(U)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ie,n.DEPTH24_STENCIL8,U.width,U.height):Qe(U)?u.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ie,n.DEPTH24_STENCIL8,U.width,U.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,U.width,U.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,G)}else{const Ie=U.isWebGLMultipleRenderTargets===!0?U.texture:[U.texture];for(let Re=0;Re<Ie.length;Re++){const De=Ie[Re],Xe=s.convert(De.format,De.colorSpace),ze=s.convert(De.type),Ge=k(De.internalFormat,Xe,ze,De.colorSpace),ot=ft(U);de&&Qe(U)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,ot,Ge,U.width,U.height):Qe(U)?u.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ot,Ge,U.width,U.height):n.renderbufferStorage(n.RENDERBUFFER,Ge,U.width,U.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function We(G,U){if(U&&U.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,G),!(U.depthTexture&&U.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(U.depthTexture).__webglTexture||U.depthTexture.image.width!==U.width||U.depthTexture.image.height!==U.height)&&(U.depthTexture.image.width=U.width,U.depthTexture.image.height=U.height,U.depthTexture.needsUpdate=!0),ye(U.depthTexture,0);const Ie=r.get(U.depthTexture).__webglTexture,Re=ft(U);if(U.depthTexture.format===$l)Qe(U)?u.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ie,0,Re):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ie,0);else if(U.depthTexture.format===Xu)Qe(U)?u.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ie,0,Re):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ie,0);else throw new Error("Unknown depthTexture format")}function Ye(G){const U=r.get(G),de=G.isWebGLCubeRenderTarget===!0;if(G.depthTexture&&!U.__autoAllocateDepthBuffer){if(de)throw new Error("target.depthTexture not supported in Cube render targets");We(U.__webglFramebuffer,G)}else if(de){U.__webglDepthbuffer=[];for(let Ie=0;Ie<6;Ie++)t.bindFramebuffer(n.FRAMEBUFFER,U.__webglFramebuffer[Ie]),U.__webglDepthbuffer[Ie]=n.createRenderbuffer(),ke(U.__webglDepthbuffer[Ie],G,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,U.__webglFramebuffer),U.__webglDepthbuffer=n.createRenderbuffer(),ke(U.__webglDepthbuffer,G,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function It(G,U,de){const Ie=r.get(G);U!==void 0&&we(Ie.__webglFramebuffer,G,G.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),de!==void 0&&Ye(G)}function fe(G){const U=G.texture,de=r.get(G),Ie=r.get(U);G.addEventListener("dispose",I),G.isWebGLMultipleRenderTargets!==!0&&(Ie.__webglTexture===void 0&&(Ie.__webglTexture=n.createTexture()),Ie.__version=U.version,a.memory.textures++);const Re=G.isWebGLCubeRenderTarget===!0,De=G.isWebGLMultipleRenderTargets===!0,Xe=E(G)||c;if(Re){de.__webglFramebuffer=[];for(let ze=0;ze<6;ze++)if(c&&U.mipmaps&&U.mipmaps.length>0){de.__webglFramebuffer[ze]=[];for(let Ge=0;Ge<U.mipmaps.length;Ge++)de.__webglFramebuffer[ze][Ge]=n.createFramebuffer()}else de.__webglFramebuffer[ze]=n.createFramebuffer()}else{if(c&&U.mipmaps&&U.mipmaps.length>0){de.__webglFramebuffer=[];for(let ze=0;ze<U.mipmaps.length;ze++)de.__webglFramebuffer[ze]=n.createFramebuffer()}else de.__webglFramebuffer=n.createFramebuffer();if(De)if(i.drawBuffers){const ze=G.texture;for(let Ge=0,ot=ze.length;Ge<ot;Ge++){const xt=r.get(ze[Ge]);xt.__webglTexture===void 0&&(xt.__webglTexture=n.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(c&&G.samples>0&&Qe(G)===!1){const ze=De?U:[U];de.__webglMultisampledFramebuffer=n.createFramebuffer(),de.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,de.__webglMultisampledFramebuffer);for(let Ge=0;Ge<ze.length;Ge++){const ot=ze[Ge];de.__webglColorRenderbuffer[Ge]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,de.__webglColorRenderbuffer[Ge]);const xt=s.convert(ot.format,ot.colorSpace),Ae=s.convert(ot.type),Nt=k(ot.internalFormat,xt,Ae,ot.colorSpace,G.isXRRenderTarget===!0),bt=ft(G);n.renderbufferStorageMultisample(n.RENDERBUFFER,bt,Nt,G.width,G.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ge,n.RENDERBUFFER,de.__webglColorRenderbuffer[Ge])}n.bindRenderbuffer(n.RENDERBUFFER,null),G.depthBuffer&&(de.__webglDepthRenderbuffer=n.createRenderbuffer(),ke(de.__webglDepthRenderbuffer,G,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Re){t.bindTexture(n.TEXTURE_CUBE_MAP,Ie.__webglTexture),te(n.TEXTURE_CUBE_MAP,U,Xe);for(let ze=0;ze<6;ze++)if(c&&U.mipmaps&&U.mipmaps.length>0)for(let Ge=0;Ge<U.mipmaps.length;Ge++)we(de.__webglFramebuffer[ze][Ge],G,U,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ze,Ge);else we(de.__webglFramebuffer[ze],G,U,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0);D(U,Xe)&&b(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(De){const ze=G.texture;for(let Ge=0,ot=ze.length;Ge<ot;Ge++){const xt=ze[Ge],Ae=r.get(xt);t.bindTexture(n.TEXTURE_2D,Ae.__webglTexture),te(n.TEXTURE_2D,xt,Xe),we(de.__webglFramebuffer,G,xt,n.COLOR_ATTACHMENT0+Ge,n.TEXTURE_2D,0),D(xt,Xe)&&b(n.TEXTURE_2D)}t.unbindTexture()}else{let ze=n.TEXTURE_2D;if((G.isWebGL3DRenderTarget||G.isWebGLArrayRenderTarget)&&(c?ze=G.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(ze,Ie.__webglTexture),te(ze,U,Xe),c&&U.mipmaps&&U.mipmaps.length>0)for(let Ge=0;Ge<U.mipmaps.length;Ge++)we(de.__webglFramebuffer[Ge],G,U,n.COLOR_ATTACHMENT0,ze,Ge);else we(de.__webglFramebuffer,G,U,n.COLOR_ATTACHMENT0,ze,0);D(U,Xe)&&b(ze),t.unbindTexture()}G.depthBuffer&&Ye(G)}function nn(G){const U=E(G)||c,de=G.isWebGLMultipleRenderTargets===!0?G.texture:[G.texture];for(let Ie=0,Re=de.length;Ie<Re;Ie++){const De=de[Ie];if(D(De,U)){const Xe=G.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,ze=r.get(De).__webglTexture;t.bindTexture(Xe,ze),b(Xe),t.unbindTexture()}}}function st(G){if(c&&G.samples>0&&Qe(G)===!1){const U=G.isWebGLMultipleRenderTargets?G.texture:[G.texture],de=G.width,Ie=G.height;let Re=n.COLOR_BUFFER_BIT;const De=[],Xe=G.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ze=r.get(G),Ge=G.isWebGLMultipleRenderTargets===!0;if(Ge)for(let ot=0;ot<U.length;ot++)t.bindFramebuffer(n.FRAMEBUFFER,ze.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ot,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,ze.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+ot,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,ze.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,ze.__webglFramebuffer);for(let ot=0;ot<U.length;ot++){De.push(n.COLOR_ATTACHMENT0+ot),G.depthBuffer&&De.push(Xe);const xt=ze.__ignoreDepthValues!==void 0?ze.__ignoreDepthValues:!1;if(xt===!1&&(G.depthBuffer&&(Re|=n.DEPTH_BUFFER_BIT),G.stencilBuffer&&(Re|=n.STENCIL_BUFFER_BIT)),Ge&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,ze.__webglColorRenderbuffer[ot]),xt===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Xe]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Xe])),Ge){const Ae=r.get(U[ot]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ae,0)}n.blitFramebuffer(0,0,de,Ie,0,0,de,Ie,Re,n.NEAREST),h&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,De)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Ge)for(let ot=0;ot<U.length;ot++){t.bindFramebuffer(n.FRAMEBUFFER,ze.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ot,n.RENDERBUFFER,ze.__webglColorRenderbuffer[ot]);const xt=r.get(U[ot]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,ze.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+ot,n.TEXTURE_2D,xt,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,ze.__webglMultisampledFramebuffer)}}function ft(G){return Math.min(i.maxSamples,G.samples)}function Qe(G){const U=r.get(G);return c&&G.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&U.__useRenderToTexture!==!1}function Xt(G){const U=a.render.frame;f.get(G)!==U&&(f.set(G,U),G.update())}function mt(G,U){const de=G.colorSpace,Ie=G.format,Re=G.type;return G.isCompressedTexture===!0||G.isVideoTexture===!0||G.format===_E||de!==jo&&de!==ji&&(ln.getTransfer(de)===vn?c===!1?e.has("EXT_sRGB")===!0&&Ie===ds?(G.format=_E,G.minFilter=Bi,G.generateMipmaps=!1):U=PL.sRGBToLinear(U):(Ie!==ds||Re!==Ba)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",de)),U}this.allocateTextureUnit=Y,this.resetTextureUnits=F,this.setTexture2D=ye,this.setTexture2DArray=ge,this.setTexture3D=Q,this.setTextureCube=re,this.rebindTextures=It,this.setupRenderTarget=fe,this.updateRenderTargetMipmap=nn,this.updateMultisampleRenderTarget=st,this.setupDepthRenderbuffer=Ye,this.setupFrameBufferTexture=we,this.useMultisampledRTT=Qe}function aY(n,e,t){const r=t.isWebGL2;function i(s,a=ji){let c;const u=ln.getTransfer(a);if(s===Ba)return n.UNSIGNED_BYTE;if(s===EL)return n.UNSIGNED_SHORT_4_4_4_4;if(s===SL)return n.UNSIGNED_SHORT_5_5_5_1;if(s===H8)return n.BYTE;if(s===G8)return n.SHORT;if(s===TT)return n.UNSIGNED_SHORT;if(s===yL)return n.INT;if(s===La)return n.UNSIGNED_INT;if(s===Na)return n.FLOAT;if(s===qd)return r?n.HALF_FLOAT:(c=e.get("OES_texture_half_float"),c!==null?c.HALF_FLOAT_OES:null);if(s===j8)return n.ALPHA;if(s===ds)return n.RGBA;if(s===W8)return n.LUMINANCE;if(s===$8)return n.LUMINANCE_ALPHA;if(s===$l)return n.DEPTH_COMPONENT;if(s===Xu)return n.DEPTH_STENCIL;if(s===_E)return c=e.get("EXT_sRGB"),c!==null?c.SRGB_ALPHA_EXT:null;if(s===q8)return n.RED;if(s===TL)return n.RED_INTEGER;if(s===X8)return n.RG;if(s===xL)return n.RG_INTEGER;if(s===wL)return n.RGBA_INTEGER;if(s===Cy||s===Py||s===Iy||s===Dy)if(u===vn)if(c=e.get("WEBGL_compressed_texture_s3tc_srgb"),c!==null){if(s===Cy)return c.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Py)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===Iy)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Dy)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(c=e.get("WEBGL_compressed_texture_s3tc"),c!==null){if(s===Cy)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Py)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Iy)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Dy)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===D1||s===L1||s===N1||s===O1)if(c=e.get("WEBGL_compressed_texture_pvrtc"),c!==null){if(s===D1)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===L1)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===N1)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===O1)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===AL)return c=e.get("WEBGL_compressed_texture_etc1"),c!==null?c.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===k1||s===U1)if(c=e.get("WEBGL_compressed_texture_etc"),c!==null){if(s===k1)return u===vn?c.COMPRESSED_SRGB8_ETC2:c.COMPRESSED_RGB8_ETC2;if(s===U1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:c.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===F1||s===V1||s===z1||s===B1||s===H1||s===G1||s===j1||s===W1||s===$1||s===q1||s===X1||s===K1||s===Y1||s===Z1)if(c=e.get("WEBGL_compressed_texture_astc"),c!==null){if(s===F1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:c.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===V1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:c.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===z1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:c.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===B1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:c.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===H1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:c.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===G1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:c.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===j1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:c.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===W1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:c.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===$1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:c.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===q1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:c.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===X1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:c.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===K1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:c.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===Y1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:c.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===Z1)return u===vn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:c.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Ly||s===Q1||s===J1)if(c=e.get("EXT_texture_compression_bptc"),c!==null){if(s===Ly)return u===vn?c.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:c.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===Q1)return c.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===J1)return c.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===K8||s===eR||s===tR||s===nR)if(c=e.get("EXT_texture_compression_rgtc"),c!==null){if(s===Ly)return c.COMPRESSED_RED_RGTC1_EXT;if(s===eR)return c.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===tR)return c.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===nR)return c.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Wl?r?n.UNSIGNED_INT_24_8:(c=e.get("WEBGL_depth_texture"),c!==null?c.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:i}}class lY extends Ai{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class rm extends zr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const cY={type:"move"};class i0{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new rm,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new rm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new oe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new oe),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new rm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new oe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new oe),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,a=null;const c=this._targetRay,u=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){a=!0;for(const A of e.hand.values()){const E=t.getJointPose(A,r),S=this._getHandJoint(h,A);E!==null&&(S.matrix.fromArray(E.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,S.jointRadius=E.radius),S.visible=E!==null}const f=h.joints["index-finger-tip"],m=h.joints["thumb-tip"],_=f.position.distanceTo(m.position),v=.02,T=.005;h.inputState.pinching&&_>v+T?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&_<=v-T&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(u.matrix.fromArray(s.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,s.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(s.linearVelocity)):u.hasLinearVelocity=!1,s.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(s.angularVelocity)):u.hasAngularVelocity=!1));c!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(c.matrix.fromArray(i.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,i.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(i.linearVelocity)):c.hasLinearVelocity=!1,i.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(i.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(cY)))}return c!==null&&(c.visible=i!==null),u!==null&&(u.visible=s!==null),h!==null&&(h.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new rm;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class uY extends oh{constructor(e,t){super();const r=this;let i=null,s=1,a=null,c="local-floor",u=1,h=null,f=null,m=null,_=null,v=null,T=null;const A=t.getContextAttributes();let E=null,S=null;const D=[],b=[],k=new Ft;let V=null;const H=new Ai;H.layers.enable(1),H.viewport=new Sn;const P=new Ai;P.layers.enable(2),P.viewport=new Sn;const I=[H,P],M=new lY;M.layers.enable(1),M.layers.enable(2);let C=null,N=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(te){let _e=D[te];return _e===void 0&&(_e=new i0,D[te]=_e),_e.getTargetRaySpace()},this.getControllerGrip=function(te){let _e=D[te];return _e===void 0&&(_e=new i0,D[te]=_e),_e.getGripSpace()},this.getHand=function(te){let _e=D[te];return _e===void 0&&(_e=new i0,D[te]=_e),_e.getHandSpace()};function W(te){const _e=b.indexOf(te.inputSource);if(_e===-1)return;const Ee=D[_e];Ee!==void 0&&(Ee.update(te.inputSource,te.frame,h||a),Ee.dispatchEvent({type:te.type,data:te.inputSource}))}function F(){i.removeEventListener("select",W),i.removeEventListener("selectstart",W),i.removeEventListener("selectend",W),i.removeEventListener("squeeze",W),i.removeEventListener("squeezestart",W),i.removeEventListener("squeezeend",W),i.removeEventListener("end",F),i.removeEventListener("inputsourceschange",Y);for(let te=0;te<D.length;te++){const _e=b[te];_e!==null&&(b[te]=null,D[te].disconnect(_e))}C=null,N=null,e.setRenderTarget(E),v=null,_=null,m=null,i=null,S=null,ne.stop(),r.isPresenting=!1,e.setPixelRatio(V),e.setSize(k.width,k.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(te){s=te,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(te){c=te,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||a},this.setReferenceSpace=function(te){h=te},this.getBaseLayer=function(){return _!==null?_:v},this.getBinding=function(){return m},this.getFrame=function(){return T},this.getSession=function(){return i},this.setSession=async function(te){if(i=te,i!==null){if(E=e.getRenderTarget(),i.addEventListener("select",W),i.addEventListener("selectstart",W),i.addEventListener("selectend",W),i.addEventListener("squeeze",W),i.addEventListener("squeezestart",W),i.addEventListener("squeezeend",W),i.addEventListener("end",F),i.addEventListener("inputsourceschange",Y),A.xrCompatible!==!0&&await t.makeXRCompatible(),V=e.getPixelRatio(),e.getSize(k),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const _e={antialias:i.renderState.layers===void 0?A.antialias:!0,alpha:!0,depth:A.depth,stencil:A.stencil,framebufferScaleFactor:s};v=new XRWebGLLayer(i,t,_e),i.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),S=new tc(v.framebufferWidth,v.framebufferHeight,{format:ds,type:Ba,colorSpace:e.outputColorSpace,stencilBuffer:A.stencil})}else{let _e=null,Ee=null,Pe=null;A.depth&&(Pe=A.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,_e=A.stencil?Xu:$l,Ee=A.stencil?Wl:La);const we={colorFormat:t.RGBA8,depthFormat:Pe,scaleFactor:s};m=new XRWebGLBinding(i,t),_=m.createProjectionLayer(we),i.updateRenderState({layers:[_]}),e.setPixelRatio(1),e.setSize(_.textureWidth,_.textureHeight,!1),S=new tc(_.textureWidth,_.textureHeight,{format:ds,type:Ba,depthTexture:new HL(_.textureWidth,_.textureHeight,Ee,void 0,void 0,void 0,void 0,void 0,void 0,_e),stencilBuffer:A.stencil,colorSpace:e.outputColorSpace,samples:A.antialias?4:0});const ke=e.properties.get(S);ke.__ignoreDepthValues=_.ignoreDepthValues}S.isXRRenderTarget=!0,this.setFoveation(u),h=null,a=await i.requestReferenceSpace(c),ne.setContext(i),ne.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode};function Y(te){for(let _e=0;_e<te.removed.length;_e++){const Ee=te.removed[_e],Pe=b.indexOf(Ee);Pe>=0&&(b[Pe]=null,D[Pe].disconnect(Ee))}for(let _e=0;_e<te.added.length;_e++){const Ee=te.added[_e];let Pe=b.indexOf(Ee);if(Pe===-1){for(let ke=0;ke<D.length;ke++)if(ke>=b.length){b.push(Ee),Pe=ke;break}else if(b[ke]===null){b[ke]=Ee,Pe=ke;break}if(Pe===-1)break}const we=D[Pe];we&&we.connect(Ee)}}const ue=new oe,ye=new oe;function ge(te,_e,Ee){ue.setFromMatrixPosition(_e.matrixWorld),ye.setFromMatrixPosition(Ee.matrixWorld);const Pe=ue.distanceTo(ye),we=_e.projectionMatrix.elements,ke=Ee.projectionMatrix.elements,We=we[14]/(we[10]-1),Ye=we[14]/(we[10]+1),It=(we[9]+1)/we[5],fe=(we[9]-1)/we[5],nn=(we[8]-1)/we[0],st=(ke[8]+1)/ke[0],ft=We*nn,Qe=We*st,Xt=Pe/(-nn+st),mt=Xt*-nn;_e.matrixWorld.decompose(te.position,te.quaternion,te.scale),te.translateX(mt),te.translateZ(Xt),te.matrixWorld.compose(te.position,te.quaternion,te.scale),te.matrixWorldInverse.copy(te.matrixWorld).invert();const G=We+Xt,U=Ye+Xt,de=ft-mt,Ie=Qe+(Pe-mt),Re=It*Ye/U*G,De=fe*Ye/U*G;te.projectionMatrix.makePerspective(de,Ie,Re,De,G,U),te.projectionMatrixInverse.copy(te.projectionMatrix).invert()}function Q(te,_e){_e===null?te.matrixWorld.copy(te.matrix):te.matrixWorld.multiplyMatrices(_e.matrixWorld,te.matrix),te.matrixWorldInverse.copy(te.matrixWorld).invert()}this.updateCamera=function(te){if(i===null)return;M.near=P.near=H.near=te.near,M.far=P.far=H.far=te.far,(C!==M.near||N!==M.far)&&(i.updateRenderState({depthNear:M.near,depthFar:M.far}),C=M.near,N=M.far);const _e=te.parent,Ee=M.cameras;Q(M,_e);for(let Pe=0;Pe<Ee.length;Pe++)Q(Ee[Pe],_e);Ee.length===2?ge(M,H,P):M.projectionMatrix.copy(H.projectionMatrix),re(te,M,_e)};function re(te,_e,Ee){Ee===null?te.matrix.copy(_e.matrixWorld):(te.matrix.copy(Ee.matrixWorld),te.matrix.invert(),te.matrix.multiply(_e.matrixWorld)),te.matrix.decompose(te.position,te.quaternion,te.scale),te.updateMatrixWorld(!0),te.projectionMatrix.copy(_e.projectionMatrix),te.projectionMatrixInverse.copy(_e.projectionMatrixInverse),te.isPerspectiveCamera&&(te.fov=vE*2*Math.atan(1/te.projectionMatrix.elements[5]),te.zoom=1)}this.getCamera=function(){return M},this.getFoveation=function(){if(!(_===null&&v===null))return u},this.setFoveation=function(te){u=te,_!==null&&(_.fixedFoveation=te),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=te)};let ie=null;function $(te,_e){if(f=_e.getViewerPose(h||a),T=_e,f!==null){const Ee=f.views;v!==null&&(e.setRenderTargetFramebuffer(S,v.framebuffer),e.setRenderTarget(S));let Pe=!1;Ee.length!==M.cameras.length&&(M.cameras.length=0,Pe=!0);for(let we=0;we<Ee.length;we++){const ke=Ee[we];let We=null;if(v!==null)We=v.getViewport(ke);else{const It=m.getViewSubImage(_,ke);We=It.viewport,we===0&&(e.setRenderTargetTextures(S,It.colorTexture,_.ignoreDepthValues?void 0:It.depthStencilTexture),e.setRenderTarget(S))}let Ye=I[we];Ye===void 0&&(Ye=new Ai,Ye.layers.enable(we),Ye.viewport=new Sn,I[we]=Ye),Ye.matrix.fromArray(ke.transform.matrix),Ye.matrix.decompose(Ye.position,Ye.quaternion,Ye.scale),Ye.projectionMatrix.fromArray(ke.projectionMatrix),Ye.projectionMatrixInverse.copy(Ye.projectionMatrix).invert(),Ye.viewport.set(We.x,We.y,We.width,We.height),we===0&&(M.matrix.copy(Ye.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),Pe===!0&&M.cameras.push(Ye)}}for(let Ee=0;Ee<D.length;Ee++){const Pe=b[Ee],we=D[Ee];Pe!==null&&we!==void 0&&we.update(Pe,_e,h||a)}ie&&ie(te,_e),_e.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:_e}),T=null}const ne=new BL;ne.setAnimationLoop($),this.setAnimationLoop=function(te){ie=te},this.dispose=function(){}}}function hY(n,e){function t(E,S){E.matrixAutoUpdate===!0&&E.updateMatrix(),S.value.copy(E.matrix)}function r(E,S){S.color.getRGB(E.fogColor.value,FL(n)),S.isFog?(E.fogNear.value=S.near,E.fogFar.value=S.far):S.isFogExp2&&(E.fogDensity.value=S.density)}function i(E,S,D,b,k){S.isMeshBasicMaterial||S.isMeshLambertMaterial?s(E,S):S.isMeshToonMaterial?(s(E,S),m(E,S)):S.isMeshPhongMaterial?(s(E,S),f(E,S)):S.isMeshStandardMaterial?(s(E,S),_(E,S),S.isMeshPhysicalMaterial&&v(E,S,k)):S.isMeshMatcapMaterial?(s(E,S),T(E,S)):S.isMeshDepthMaterial?s(E,S):S.isMeshDistanceMaterial?(s(E,S),A(E,S)):S.isMeshNormalMaterial?s(E,S):S.isLineBasicMaterial?(a(E,S),S.isLineDashedMaterial&&c(E,S)):S.isPointsMaterial?u(E,S,D,b):S.isSpriteMaterial?h(E,S):S.isShadowMaterial?(E.color.value.copy(S.color),E.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}function s(E,S){E.opacity.value=S.opacity,S.color&&E.diffuse.value.copy(S.color),S.emissive&&E.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(E.map.value=S.map,t(S.map,E.mapTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,t(S.alphaMap,E.alphaMapTransform)),S.bumpMap&&(E.bumpMap.value=S.bumpMap,t(S.bumpMap,E.bumpMapTransform),E.bumpScale.value=S.bumpScale,S.side===fi&&(E.bumpScale.value*=-1)),S.normalMap&&(E.normalMap.value=S.normalMap,t(S.normalMap,E.normalMapTransform),E.normalScale.value.copy(S.normalScale),S.side===fi&&E.normalScale.value.negate()),S.displacementMap&&(E.displacementMap.value=S.displacementMap,t(S.displacementMap,E.displacementMapTransform),E.displacementScale.value=S.displacementScale,E.displacementBias.value=S.displacementBias),S.emissiveMap&&(E.emissiveMap.value=S.emissiveMap,t(S.emissiveMap,E.emissiveMapTransform)),S.specularMap&&(E.specularMap.value=S.specularMap,t(S.specularMap,E.specularMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest);const D=e.get(S).envMap;if(D&&(E.envMap.value=D,E.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,E.reflectivity.value=S.reflectivity,E.ior.value=S.ior,E.refractionRatio.value=S.refractionRatio),S.lightMap){E.lightMap.value=S.lightMap;const b=n._useLegacyLights===!0?Math.PI:1;E.lightMapIntensity.value=S.lightMapIntensity*b,t(S.lightMap,E.lightMapTransform)}S.aoMap&&(E.aoMap.value=S.aoMap,E.aoMapIntensity.value=S.aoMapIntensity,t(S.aoMap,E.aoMapTransform))}function a(E,S){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,S.map&&(E.map.value=S.map,t(S.map,E.mapTransform))}function c(E,S){E.dashSize.value=S.dashSize,E.totalSize.value=S.dashSize+S.gapSize,E.scale.value=S.scale}function u(E,S,D,b){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,E.size.value=S.size*D,E.scale.value=b*.5,S.map&&(E.map.value=S.map,t(S.map,E.uvTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,t(S.alphaMap,E.alphaMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest)}function h(E,S){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,E.rotation.value=S.rotation,S.map&&(E.map.value=S.map,t(S.map,E.mapTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,t(S.alphaMap,E.alphaMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest)}function f(E,S){E.specular.value.copy(S.specular),E.shininess.value=Math.max(S.shininess,1e-4)}function m(E,S){S.gradientMap&&(E.gradientMap.value=S.gradientMap)}function _(E,S){E.metalness.value=S.metalness,S.metalnessMap&&(E.metalnessMap.value=S.metalnessMap,t(S.metalnessMap,E.metalnessMapTransform)),E.roughness.value=S.roughness,S.roughnessMap&&(E.roughnessMap.value=S.roughnessMap,t(S.roughnessMap,E.roughnessMapTransform)),e.get(S).envMap&&(E.envMapIntensity.value=S.envMapIntensity)}function v(E,S,D){E.ior.value=S.ior,S.sheen>0&&(E.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),E.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(E.sheenColorMap.value=S.sheenColorMap,t(S.sheenColorMap,E.sheenColorMapTransform)),S.sheenRoughnessMap&&(E.sheenRoughnessMap.value=S.sheenRoughnessMap,t(S.sheenRoughnessMap,E.sheenRoughnessMapTransform))),S.clearcoat>0&&(E.clearcoat.value=S.clearcoat,E.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(E.clearcoatMap.value=S.clearcoatMap,t(S.clearcoatMap,E.clearcoatMapTransform)),S.clearcoatRoughnessMap&&(E.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap,t(S.clearcoatRoughnessMap,E.clearcoatRoughnessMapTransform)),S.clearcoatNormalMap&&(E.clearcoatNormalMap.value=S.clearcoatNormalMap,t(S.clearcoatNormalMap,E.clearcoatNormalMapTransform),E.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),S.side===fi&&E.clearcoatNormalScale.value.negate())),S.iridescence>0&&(E.iridescence.value=S.iridescence,E.iridescenceIOR.value=S.iridescenceIOR,E.iridescenceThicknessMinimum.value=S.iridescenceThicknessRange[0],E.iridescenceThicknessMaximum.value=S.iridescenceThicknessRange[1],S.iridescenceMap&&(E.iridescenceMap.value=S.iridescenceMap,t(S.iridescenceMap,E.iridescenceMapTransform)),S.iridescenceThicknessMap&&(E.iridescenceThicknessMap.value=S.iridescenceThicknessMap,t(S.iridescenceThicknessMap,E.iridescenceThicknessMapTransform))),S.transmission>0&&(E.transmission.value=S.transmission,E.transmissionSamplerMap.value=D.texture,E.transmissionSamplerSize.value.set(D.width,D.height),S.transmissionMap&&(E.transmissionMap.value=S.transmissionMap,t(S.transmissionMap,E.transmissionMapTransform)),E.thickness.value=S.thickness,S.thicknessMap&&(E.thicknessMap.value=S.thicknessMap,t(S.thicknessMap,E.thicknessMapTransform)),E.attenuationDistance.value=S.attenuationDistance,E.attenuationColor.value.copy(S.attenuationColor)),S.anisotropy>0&&(E.anisotropyVector.value.set(S.anisotropy*Math.cos(S.anisotropyRotation),S.anisotropy*Math.sin(S.anisotropyRotation)),S.anisotropyMap&&(E.anisotropyMap.value=S.anisotropyMap,t(S.anisotropyMap,E.anisotropyMapTransform))),E.specularIntensity.value=S.specularIntensity,E.specularColor.value.copy(S.specularColor),S.specularColorMap&&(E.specularColorMap.value=S.specularColorMap,t(S.specularColorMap,E.specularColorMapTransform)),S.specularIntensityMap&&(E.specularIntensityMap.value=S.specularIntensityMap,t(S.specularIntensityMap,E.specularIntensityMapTransform))}function T(E,S){S.matcap&&(E.matcap.value=S.matcap)}function A(E,S){const D=e.get(S).light;E.referencePosition.value.setFromMatrixPosition(D.matrixWorld),E.nearDistance.value=D.shadow.camera.near,E.farDistance.value=D.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function dY(n,e,t,r){let i={},s={},a=[];const c=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function u(D,b){const k=b.program;r.uniformBlockBinding(D,k)}function h(D,b){let k=i[D.id];k===void 0&&(T(D),k=f(D),i[D.id]=k,D.addEventListener("dispose",E));const V=b.program;r.updateUBOMapping(D,V);const H=e.render.frame;s[D.id]!==H&&(_(D),s[D.id]=H)}function f(D){const b=m();D.__bindingPointIndex=b;const k=n.createBuffer(),V=D.__size,H=D.usage;return n.bindBuffer(n.UNIFORM_BUFFER,k),n.bufferData(n.UNIFORM_BUFFER,V,H),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,b,k),k}function m(){for(let D=0;D<c;D++)if(a.indexOf(D)===-1)return a.push(D),D;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function _(D){const b=i[D.id],k=D.uniforms,V=D.__cache;n.bindBuffer(n.UNIFORM_BUFFER,b);for(let H=0,P=k.length;H<P;H++){const I=Array.isArray(k[H])?k[H]:[k[H]];for(let M=0,C=I.length;M<C;M++){const N=I[M];if(v(N,H,M,V)===!0){const W=N.__offset,F=Array.isArray(N.value)?N.value:[N.value];let Y=0;for(let ue=0;ue<F.length;ue++){const ye=F[ue],ge=A(ye);typeof ye=="number"||typeof ye=="boolean"?(N.__data[0]=ye,n.bufferSubData(n.UNIFORM_BUFFER,W+Y,N.__data)):ye.isMatrix3?(N.__data[0]=ye.elements[0],N.__data[1]=ye.elements[1],N.__data[2]=ye.elements[2],N.__data[3]=0,N.__data[4]=ye.elements[3],N.__data[5]=ye.elements[4],N.__data[6]=ye.elements[5],N.__data[7]=0,N.__data[8]=ye.elements[6],N.__data[9]=ye.elements[7],N.__data[10]=ye.elements[8],N.__data[11]=0):(ye.toArray(N.__data,Y),Y+=ge.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,W,N.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function v(D,b,k,V){const H=D.value,P=b+"_"+k;if(V[P]===void 0)return typeof H=="number"||typeof H=="boolean"?V[P]=H:V[P]=H.clone(),!0;{const I=V[P];if(typeof H=="number"||typeof H=="boolean"){if(I!==H)return V[P]=H,!0}else if(I.equals(H)===!1)return I.copy(H),!0}return!1}function T(D){const b=D.uniforms;let k=0;const V=16;for(let P=0,I=b.length;P<I;P++){const M=Array.isArray(b[P])?b[P]:[b[P]];for(let C=0,N=M.length;C<N;C++){const W=M[C],F=Array.isArray(W.value)?W.value:[W.value];for(let Y=0,ue=F.length;Y<ue;Y++){const ye=F[Y],ge=A(ye),Q=k%V;Q!==0&&V-Q<ge.boundary&&(k+=V-Q),W.__data=new Float32Array(ge.storage/Float32Array.BYTES_PER_ELEMENT),W.__offset=k,k+=ge.storage}}}const H=k%V;return H>0&&(k+=V-H),D.__size=k,D.__cache={},this}function A(D){const b={boundary:0,storage:0};return typeof D=="number"||typeof D=="boolean"?(b.boundary=4,b.storage=4):D.isVector2?(b.boundary=8,b.storage=8):D.isVector3||D.isColor?(b.boundary=16,b.storage=12):D.isVector4?(b.boundary=16,b.storage=16):D.isMatrix3?(b.boundary=48,b.storage=48):D.isMatrix4?(b.boundary=64,b.storage=64):D.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",D),b}function E(D){const b=D.target;b.removeEventListener("dispose",E);const k=a.indexOf(b.__bindingPointIndex);a.splice(k,1),n.deleteBuffer(i[b.id]),delete i[b.id],delete s[b.id]}function S(){for(const D in i)n.deleteBuffer(i[D]);a=[],i={},s={}}return{bind:u,update:h,dispose:S}}class XL{constructor(e={}){const{canvas:t=a7(),context:r=null,depth:i=!0,stencil:s=!0,alpha:a=!1,antialias:c=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:h=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:m=!1}=e;this.isWebGLRenderer=!0;let _;r!==null?_=r.getContextAttributes().alpha:_=a;const v=new Uint32Array(4),T=new Int32Array(4);let A=null,E=null;const S=[],D=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Tr,this._useLegacyLights=!1,this.toneMapping=za,this.toneMappingExposure=1;const b=this;let k=!1,V=0,H=0,P=null,I=-1,M=null;const C=new Sn,N=new Sn;let W=null;const F=new en(0);let Y=0,ue=t.width,ye=t.height,ge=1,Q=null,re=null;const ie=new Sn(0,0,ue,ye),$=new Sn(0,0,ue,ye);let ne=!1;const te=new AT;let _e=!1,Ee=!1,Pe=null;const we=new Un,ke=new Ft,We=new oe,Ye={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function It(){return P===null?ge:1}let fe=r;function nn(j,se){for(let pe=0;pe<j.length;pe++){const J=j[pe],O=t.getContext(J,se);if(O!==null)return O}return null}try{const j={alpha:!0,depth:i,stencil:s,antialias:c,premultipliedAlpha:u,preserveDrawingBuffer:h,powerPreference:f,failIfMajorPerformanceCaveat:m};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${ST}`),t.addEventListener("webglcontextlost",Oe,!1),t.addEventListener("webglcontextrestored",K,!1),t.addEventListener("webglcontextcreationerror",Le,!1),fe===null){const se=["webgl2","webgl","experimental-webgl"];if(b.isWebGL1Renderer===!0&&se.shift(),fe=nn(se,j),fe===null)throw nn(se)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&fe instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),fe.getShaderPrecisionFormat===void 0&&(fe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(j){throw console.error("THREE.WebGLRenderer: "+j.message),j}let st,ft,Qe,Xt,mt,G,U,de,Ie,Re,De,Xe,ze,Ge,ot,xt,Ae,Nt,bt,ut,rt,$e,ct,Ot;function Kt(){st=new TX(fe),ft=new mX(fe,st,e),st.init(ft),$e=new aY(fe,st,ft),Qe=new sY(fe,st,ft),Xt=new AX(fe),mt=new WK,G=new oY(fe,st,Qe,mt,ft,$e,Xt),U=new _X(b),de=new SX(b),Ie=new D7(fe,ft),ct=new fX(fe,st,Ie,ft),Re=new xX(fe,Ie,Xt,ct),De=new CX(fe,Re,Ie,Xt),bt=new RX(fe,ft,G),xt=new gX(mt),Xe=new jK(b,U,de,st,ft,ct,xt),ze=new hY(b,mt),Ge=new qK,ot=new JK(st,ft),Nt=new dX(b,U,de,Qe,De,_,u),Ae=new iY(b,De,ft),Ot=new dY(fe,Xt,ft,Qe),ut=new pX(fe,st,Xt,ft),rt=new wX(fe,st,Xt,ft),Xt.programs=Xe.programs,b.capabilities=ft,b.extensions=st,b.properties=mt,b.renderLists=Ge,b.shadowMap=Ae,b.state=Qe,b.info=Xt}Kt();const wt=new uY(b,fe);this.xr=wt,this.getContext=function(){return fe},this.getContextAttributes=function(){return fe.getContextAttributes()},this.forceContextLoss=function(){const j=st.get("WEBGL_lose_context");j&&j.loseContext()},this.forceContextRestore=function(){const j=st.get("WEBGL_lose_context");j&&j.restoreContext()},this.getPixelRatio=function(){return ge},this.setPixelRatio=function(j){j!==void 0&&(ge=j,this.setSize(ue,ye,!1))},this.getSize=function(j){return j.set(ue,ye)},this.setSize=function(j,se,pe=!0){if(wt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ue=j,ye=se,t.width=Math.floor(j*ge),t.height=Math.floor(se*ge),pe===!0&&(t.style.width=j+"px",t.style.height=se+"px"),this.setViewport(0,0,j,se)},this.getDrawingBufferSize=function(j){return j.set(ue*ge,ye*ge).floor()},this.setDrawingBufferSize=function(j,se,pe){ue=j,ye=se,ge=pe,t.width=Math.floor(j*pe),t.height=Math.floor(se*pe),this.setViewport(0,0,j,se)},this.getCurrentViewport=function(j){return j.copy(C)},this.getViewport=function(j){return j.copy(ie)},this.setViewport=function(j,se,pe,J){j.isVector4?ie.set(j.x,j.y,j.z,j.w):ie.set(j,se,pe,J),Qe.viewport(C.copy(ie).multiplyScalar(ge).floor())},this.getScissor=function(j){return j.copy($)},this.setScissor=function(j,se,pe,J){j.isVector4?$.set(j.x,j.y,j.z,j.w):$.set(j,se,pe,J),Qe.scissor(N.copy($).multiplyScalar(ge).floor())},this.getScissorTest=function(){return ne},this.setScissorTest=function(j){Qe.setScissorTest(ne=j)},this.setOpaqueSort=function(j){Q=j},this.setTransparentSort=function(j){re=j},this.getClearColor=function(j){return j.copy(Nt.getClearColor())},this.setClearColor=function(){Nt.setClearColor.apply(Nt,arguments)},this.getClearAlpha=function(){return Nt.getClearAlpha()},this.setClearAlpha=function(){Nt.setClearAlpha.apply(Nt,arguments)},this.clear=function(j=!0,se=!0,pe=!0){let J=0;if(j){let O=!1;if(P!==null){const ae=P.texture.format;O=ae===wL||ae===xL||ae===TL}if(O){const ae=P.texture.type,Se=ae===Ba||ae===La||ae===TT||ae===Wl||ae===EL||ae===SL,Be=Nt.getClearColor(),Fe=Nt.getClearAlpha(),et=Be.r,tt=Be.g,dt=Be.b;Se?(v[0]=et,v[1]=tt,v[2]=dt,v[3]=Fe,fe.clearBufferuiv(fe.COLOR,0,v)):(T[0]=et,T[1]=tt,T[2]=dt,T[3]=Fe,fe.clearBufferiv(fe.COLOR,0,T))}else J|=fe.COLOR_BUFFER_BIT}se&&(J|=fe.DEPTH_BUFFER_BIT),pe&&(J|=fe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),fe.clear(J)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Oe,!1),t.removeEventListener("webglcontextrestored",K,!1),t.removeEventListener("webglcontextcreationerror",Le,!1),Ge.dispose(),ot.dispose(),mt.dispose(),U.dispose(),de.dispose(),De.dispose(),ct.dispose(),Ot.dispose(),Xe.dispose(),wt.dispose(),wt.removeEventListener("sessionstart",xn),wt.removeEventListener("sessionend",zt),Pe&&(Pe.dispose(),Pe=null),cn.stop()};function Oe(j){j.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),k=!0}function K(){console.log("THREE.WebGLRenderer: Context Restored."),k=!1;const j=Xt.autoReset,se=Ae.enabled,pe=Ae.autoUpdate,J=Ae.needsUpdate,O=Ae.type;Kt(),Xt.autoReset=j,Ae.enabled=se,Ae.autoUpdate=pe,Ae.needsUpdate=J,Ae.type=O}function Le(j){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",j.statusMessage)}function Ve(j){const se=j.target;se.removeEventListener("dispose",Ve),ht(se)}function ht(j){at(j),mt.remove(j)}function at(j){const se=mt.get(j).programs;se!==void 0&&(se.forEach(function(pe){Xe.releaseProgram(pe)}),j.isShaderMaterial&&Xe.releaseShaderCache(j))}this.renderBufferDirect=function(j,se,pe,J,O,ae){se===null&&(se=Ye);const Se=O.isMesh&&O.matrixWorld.determinant()<0,Be=pr(j,se,pe,J,O);Qe.setMaterial(J,Se);let Fe=pe.index,et=1;if(J.wireframe===!0){if(Fe=Re.getWireframeAttribute(pe),Fe===void 0)return;et=2}const tt=pe.drawRange,dt=pe.attributes.position;let jt=tt.start*et,An=(tt.start+tt.count)*et;ae!==null&&(jt=Math.max(jt,ae.start*et),An=Math.min(An,(ae.start+ae.count)*et)),Fe!==null?(jt=Math.max(jt,0),An=Math.min(An,Fe.count)):dt!=null&&(jt=Math.max(jt,0),An=Math.min(An,dt.count));const Dt=An-jt;if(Dt<0||Dt===1/0)return;ct.setup(O,J,Be,pe,Fe);let Wn,kt=ut;if(Fe!==null&&(Wn=Ie.get(Fe),kt=rt,kt.setIndex(Wn)),O.isMesh)J.wireframe===!0?(Qe.setLineWidth(J.wireframeLinewidth*It()),kt.setMode(fe.LINES)):kt.setMode(fe.TRIANGLES);else if(O.isLine){let Lt=J.linewidth;Lt===void 0&&(Lt=1),Qe.setLineWidth(Lt*It()),O.isLineSegments?kt.setMode(fe.LINES):O.isLineLoop?kt.setMode(fe.LINE_LOOP):kt.setMode(fe.LINE_STRIP)}else O.isPoints?kt.setMode(fe.POINTS):O.isSprite&&kt.setMode(fe.TRIANGLES);if(O.isBatchedMesh)kt.renderMultiDraw(O._multiDrawStarts,O._multiDrawCounts,O._multiDrawCount);else if(O.isInstancedMesh)kt.renderInstances(jt,Dt,O.count);else if(pe.isInstancedBufferGeometry){const Lt=pe._maxInstanceCount!==void 0?pe._maxInstanceCount:1/0,mr=Math.min(pe.instanceCount,Lt);kt.renderInstances(jt,Dt,mr)}else kt.render(jt,Dt)};function vt(j,se,pe){j.transparent===!0&&j.side===Co&&j.forceSinglePass===!1?(j.side=fi,j.needsUpdate=!0,jn(j,se,pe),j.side=Qa,j.needsUpdate=!0,jn(j,se,pe),j.side=Co):jn(j,se,pe)}this.compile=function(j,se,pe=null){pe===null&&(pe=j),E=ot.get(pe),E.init(),D.push(E),pe.traverseVisible(function(O){O.isLight&&O.layers.test(se.layers)&&(E.pushLight(O),O.castShadow&&E.pushShadow(O))}),j!==pe&&j.traverseVisible(function(O){O.isLight&&O.layers.test(se.layers)&&(E.pushLight(O),O.castShadow&&E.pushShadow(O))}),E.setupLights(b._useLegacyLights);const J=new Set;return j.traverse(function(O){const ae=O.material;if(ae)if(Array.isArray(ae))for(let Se=0;Se<ae.length;Se++){const Be=ae[Se];vt(Be,pe,O),J.add(Be)}else vt(ae,pe,O),J.add(ae)}),D.pop(),E=null,J},this.compileAsync=function(j,se,pe=null){const J=this.compile(j,se,pe);return new Promise(O=>{function ae(){if(J.forEach(function(Se){mt.get(Se).currentProgram.isReady()&&J.delete(Se)}),J.size===0){O(j);return}setTimeout(ae,10)}st.get("KHR_parallel_shader_compile")!==null?ae():setTimeout(ae,10)})};let Vt=null;function rn(j){Vt&&Vt(j)}function xn(){cn.stop()}function zt(){cn.start()}const cn=new BL;cn.setAnimationLoop(rn),typeof self<"u"&&cn.setContext(self),this.setAnimationLoop=function(j){Vt=j,wt.setAnimationLoop(j),j===null?cn.stop():cn.start()},wt.addEventListener("sessionstart",xn),wt.addEventListener("sessionend",zt),this.render=function(j,se){if(se!==void 0&&se.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(k===!0)return;j.matrixWorldAutoUpdate===!0&&j.updateMatrixWorld(),se.parent===null&&se.matrixWorldAutoUpdate===!0&&se.updateMatrixWorld(),wt.enabled===!0&&wt.isPresenting===!0&&(wt.cameraAutoUpdate===!0&&wt.updateCamera(se),se=wt.getCamera()),j.isScene===!0&&j.onBeforeRender(b,j,se,P),E=ot.get(j,D.length),E.init(),D.push(E),we.multiplyMatrices(se.projectionMatrix,se.matrixWorldInverse),te.setFromProjectionMatrix(we),Ee=this.localClippingEnabled,_e=xt.init(this.clippingPlanes,Ee),A=Ge.get(j,S.length),A.init(),S.push(A),Dn(j,se,0,b.sortObjects),A.finish(),b.sortObjects===!0&&A.sort(Q,re),this.info.render.frame++,_e===!0&&xt.beginShadows();const pe=E.state.shadowsArray;if(Ae.render(pe,j,se),_e===!0&&xt.endShadows(),this.info.autoReset===!0&&this.info.reset(),Nt.render(A,j),E.setupLights(b._useLegacyLights),se.isArrayCamera){const J=se.cameras;for(let O=0,ae=J.length;O<ae;O++){const Se=J[O];so(A,j,Se,Se.viewport)}}else so(A,j,se);P!==null&&(G.updateMultisampleRenderTarget(P),G.updateRenderTargetMipmap(P)),j.isScene===!0&&j.onAfterRender(b,j,se),ct.resetDefaultState(),I=-1,M=null,D.pop(),D.length>0?E=D[D.length-1]:E=null,S.pop(),S.length>0?A=S[S.length-1]:A=null};function Dn(j,se,pe,J){if(j.visible===!1)return;if(j.layers.test(se.layers)){if(j.isGroup)pe=j.renderOrder;else if(j.isLOD)j.autoUpdate===!0&&j.update(se);else if(j.isLight)E.pushLight(j),j.castShadow&&E.pushShadow(j);else if(j.isSprite){if(!j.frustumCulled||te.intersectsSprite(j)){J&&We.setFromMatrixPosition(j.matrixWorld).applyMatrix4(we);const Se=De.update(j),Be=j.material;Be.visible&&A.push(j,Se,Be,pe,We.z,null)}}else if((j.isMesh||j.isLine||j.isPoints)&&(!j.frustumCulled||te.intersectsObject(j))){const Se=De.update(j),Be=j.material;if(J&&(j.boundingSphere!==void 0?(j.boundingSphere===null&&j.computeBoundingSphere(),We.copy(j.boundingSphere.center)):(Se.boundingSphere===null&&Se.computeBoundingSphere(),We.copy(Se.boundingSphere.center)),We.applyMatrix4(j.matrixWorld).applyMatrix4(we)),Array.isArray(Be)){const Fe=Se.groups;for(let et=0,tt=Fe.length;et<tt;et++){const dt=Fe[et],jt=Be[dt.materialIndex];jt&&jt.visible&&A.push(j,Se,jt,pe,We.z,dt)}}else Be.visible&&A.push(j,Se,Be,pe,We.z,null)}}const ae=j.children;for(let Se=0,Be=ae.length;Se<Be;Se++)Dn(ae[Se],se,pe,J)}function so(j,se,pe,J){const O=j.opaque,ae=j.transmissive,Se=j.transparent;E.setupLightsView(pe),_e===!0&&xt.setGlobalState(b.clippingPlanes,pe),ae.length>0&&Ln(O,ae,se,pe),J&&Qe.viewport(C.copy(J)),O.length>0&&wn(O,se,pe),ae.length>0&&wn(ae,se,pe),Se.length>0&&wn(Se,se,pe),Qe.buffers.depth.setTest(!0),Qe.buffers.depth.setMask(!0),Qe.buffers.color.setMask(!0),Qe.setPolygonOffset(!1)}function Ln(j,se,pe,J){if((pe.isScene===!0?pe.overrideMaterial:null)!==null)return;const ae=ft.isWebGL2;Pe===null&&(Pe=new tc(1,1,{generateMipmaps:!0,type:st.has("EXT_color_buffer_half_float")?qd:Ba,minFilter:$d,samples:ae?4:0})),b.getDrawingBufferSize(ke),ae?Pe.setSize(ke.x,ke.y):Pe.setSize(yE(ke.x),yE(ke.y));const Se=b.getRenderTarget();b.setRenderTarget(Pe),b.getClearColor(F),Y=b.getClearAlpha(),Y<1&&b.setClearColor(16777215,.5),b.clear();const Be=b.toneMapping;b.toneMapping=za,wn(j,pe,J),G.updateMultisampleRenderTarget(Pe),G.updateRenderTargetMipmap(Pe);let Fe=!1;for(let et=0,tt=se.length;et<tt;et++){const dt=se[et],jt=dt.object,An=dt.geometry,Dt=dt.material,Wn=dt.group;if(Dt.side===Co&&jt.layers.test(J.layers)){const kt=Dt.side;Dt.side=fi,Dt.needsUpdate=!0,Pi(jt,pe,J,An,Dt,Wn),Dt.side=kt,Dt.needsUpdate=!0,Fe=!0}}Fe===!0&&(G.updateMultisampleRenderTarget(Pe),G.updateRenderTargetMipmap(Pe)),b.setRenderTarget(Se),b.setClearColor(F,Y),b.toneMapping=Be}function wn(j,se,pe){const J=se.isScene===!0?se.overrideMaterial:null;for(let O=0,ae=j.length;O<ae;O++){const Se=j[O],Be=Se.object,Fe=Se.geometry,et=J===null?Se.material:J,tt=Se.group;Be.layers.test(pe.layers)&&Pi(Be,se,pe,Fe,et,tt)}}function Pi(j,se,pe,J,O,ae){j.onBeforeRender(b,se,pe,J,O,ae),j.modelViewMatrix.multiplyMatrices(pe.matrixWorldInverse,j.matrixWorld),j.normalMatrix.getNormalMatrix(j.modelViewMatrix),O.onBeforeRender(b,se,pe,J,j,ae),O.transparent===!0&&O.side===Co&&O.forceSinglePass===!1?(O.side=fi,O.needsUpdate=!0,b.renderBufferDirect(pe,se,J,O,j,ae),O.side=Qa,O.needsUpdate=!0,b.renderBufferDirect(pe,se,J,O,j,ae),O.side=Co):b.renderBufferDirect(pe,se,J,O,j,ae),j.onAfterRender(b,se,pe,J,O,ae)}function jn(j,se,pe){se.isScene!==!0&&(se=Ye);const J=mt.get(j),O=E.state.lights,ae=E.state.shadowsArray,Se=O.state.version,Be=Xe.getParameters(j,O.state,ae,se,pe),Fe=Xe.getProgramCacheKey(Be);let et=J.programs;J.environment=j.isMeshStandardMaterial?se.environment:null,J.fog=se.fog,J.envMap=(j.isMeshStandardMaterial?de:U).get(j.envMap||J.environment),et===void 0&&(j.addEventListener("dispose",Ve),et=new Map,J.programs=et);let tt=et.get(Fe);if(tt!==void 0){if(J.currentProgram===tt&&J.lightsStateVersion===Se)return vs(j,Be),tt}else Be.uniforms=Xe.getUniforms(j),j.onBuild(pe,Be,b),j.onBeforeCompile(Be,b),tt=Xe.acquireProgram(Be,Fe),et.set(Fe,tt),J.uniforms=Be.uniforms;const dt=J.uniforms;return(!j.isShaderMaterial&&!j.isRawShaderMaterial||j.clipping===!0)&&(dt.clippingPlanes=xt.uniform),vs(j,Be),J.needsLights=ys(j),J.lightsStateVersion=Se,J.needsLights&&(dt.ambientLightColor.value=O.state.ambient,dt.lightProbe.value=O.state.probe,dt.directionalLights.value=O.state.directional,dt.directionalLightShadows.value=O.state.directionalShadow,dt.spotLights.value=O.state.spot,dt.spotLightShadows.value=O.state.spotShadow,dt.rectAreaLights.value=O.state.rectArea,dt.ltc_1.value=O.state.rectAreaLTC1,dt.ltc_2.value=O.state.rectAreaLTC2,dt.pointLights.value=O.state.point,dt.pointLightShadows.value=O.state.pointShadow,dt.hemisphereLights.value=O.state.hemi,dt.directionalShadowMap.value=O.state.directionalShadowMap,dt.directionalShadowMatrix.value=O.state.directionalShadowMatrix,dt.spotShadowMap.value=O.state.spotShadowMap,dt.spotLightMatrix.value=O.state.spotLightMatrix,dt.spotLightMap.value=O.state.spotLightMap,dt.pointShadowMap.value=O.state.pointShadowMap,dt.pointShadowMatrix.value=O.state.pointShadowMatrix),J.currentProgram=tt,J.uniformsList=null,tt}function Yi(j){if(j.uniformsList===null){const se=j.currentProgram.getUniforms();j.uniformsList=Pm.seqWithValue(se.seq,j.uniforms)}return j.uniformsList}function vs(j,se){const pe=mt.get(j);pe.outputColorSpace=se.outputColorSpace,pe.batching=se.batching,pe.instancing=se.instancing,pe.instancingColor=se.instancingColor,pe.skinning=se.skinning,pe.morphTargets=se.morphTargets,pe.morphNormals=se.morphNormals,pe.morphColors=se.morphColors,pe.morphTargetsCount=se.morphTargetsCount,pe.numClippingPlanes=se.numClippingPlanes,pe.numIntersection=se.numClipIntersection,pe.vertexAlphas=se.vertexAlphas,pe.vertexTangents=se.vertexTangents,pe.toneMapping=se.toneMapping}function pr(j,se,pe,J,O){se.isScene!==!0&&(se=Ye),G.resetTextureUnits();const ae=se.fog,Se=J.isMeshStandardMaterial?se.environment:null,Be=P===null?b.outputColorSpace:P.isXRRenderTarget===!0?P.texture.colorSpace:jo,Fe=(J.isMeshStandardMaterial?de:U).get(J.envMap||Se),et=J.vertexColors===!0&&!!pe.attributes.color&&pe.attributes.color.itemSize===4,tt=!!pe.attributes.tangent&&(!!J.normalMap||J.anisotropy>0),dt=!!pe.morphAttributes.position,jt=!!pe.morphAttributes.normal,An=!!pe.morphAttributes.color;let Dt=za;J.toneMapped&&(P===null||P.isXRRenderTarget===!0)&&(Dt=b.toneMapping);const Wn=pe.morphAttributes.position||pe.morphAttributes.normal||pe.morphAttributes.color,kt=Wn!==void 0?Wn.length:0,Lt=mt.get(J),mr=E.state.lights;if(_e===!0&&(Ee===!0||j!==M)){const qn=j===M&&J.id===I;xt.setState(J,j,qn)}let Qt=!1;J.version===Lt.__version?(Lt.needsLights&&Lt.lightsStateVersion!==mr.state.version||Lt.outputColorSpace!==Be||O.isBatchedMesh&&Lt.batching===!1||!O.isBatchedMesh&&Lt.batching===!0||O.isInstancedMesh&&Lt.instancing===!1||!O.isInstancedMesh&&Lt.instancing===!0||O.isSkinnedMesh&&Lt.skinning===!1||!O.isSkinnedMesh&&Lt.skinning===!0||O.isInstancedMesh&&Lt.instancingColor===!0&&O.instanceColor===null||O.isInstancedMesh&&Lt.instancingColor===!1&&O.instanceColor!==null||Lt.envMap!==Fe||J.fog===!0&&Lt.fog!==ae||Lt.numClippingPlanes!==void 0&&(Lt.numClippingPlanes!==xt.numPlanes||Lt.numIntersection!==xt.numIntersection)||Lt.vertexAlphas!==et||Lt.vertexTangents!==tt||Lt.morphTargets!==dt||Lt.morphNormals!==jt||Lt.morphColors!==An||Lt.toneMapping!==Dt||ft.isWebGL2===!0&&Lt.morphTargetsCount!==kt)&&(Qt=!0):(Qt=!0,Lt.__version=J.version);let $n=Lt.currentProgram;Qt===!0&&($n=jn(J,se,O));let Es=!1,br=!1,Ii=!1;const Tt=$n.getUniforms(),gr=Lt.uniforms;if(Qe.useProgram($n.program)&&(Es=!0,br=!0,Ii=!0),J.id!==I&&(I=J.id,br=!0),Es||M!==j){Tt.setValue(fe,"projectionMatrix",j.projectionMatrix),Tt.setValue(fe,"viewMatrix",j.matrixWorldInverse);const qn=Tt.map.cameraPosition;qn!==void 0&&qn.setValue(fe,We.setFromMatrixPosition(j.matrixWorld)),ft.logarithmicDepthBuffer&&Tt.setValue(fe,"logDepthBufFC",2/(Math.log(j.far+1)/Math.LN2)),(J.isMeshPhongMaterial||J.isMeshToonMaterial||J.isMeshLambertMaterial||J.isMeshBasicMaterial||J.isMeshStandardMaterial||J.isShaderMaterial)&&Tt.setValue(fe,"isOrthographic",j.isOrthographicCamera===!0),M!==j&&(M=j,br=!0,Ii=!0)}if(O.isSkinnedMesh){Tt.setOptional(fe,O,"bindMatrix"),Tt.setOptional(fe,O,"bindMatrixInverse");const qn=O.skeleton;qn&&(ft.floatVertexTextures?(qn.boneTexture===null&&qn.computeBoneTexture(),Tt.setValue(fe,"boneTexture",qn.boneTexture,G)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}O.isBatchedMesh&&(Tt.setOptional(fe,O,"batchingTexture"),Tt.setValue(fe,"batchingTexture",O._matricesTexture,G));const Zi=pe.morphAttributes;if((Zi.position!==void 0||Zi.normal!==void 0||Zi.color!==void 0&&ft.isWebGL2===!0)&&bt.update(O,pe,$n),(br||Lt.receiveShadow!==O.receiveShadow)&&(Lt.receiveShadow=O.receiveShadow,Tt.setValue(fe,"receiveShadow",O.receiveShadow)),J.isMeshGouraudMaterial&&J.envMap!==null&&(gr.envMap.value=Fe,gr.flipEnvMap.value=Fe.isCubeTexture&&Fe.isRenderTargetTexture===!1?-1:1),br&&(Tt.setValue(fe,"toneMappingExposure",b.toneMappingExposure),Lt.needsLights&&Mr(gr,Ii),ae&&J.fog===!0&&ze.refreshFogUniforms(gr,ae),ze.refreshMaterialUniforms(gr,J,ge,ye,Pe),Pm.upload(fe,Yi(Lt),gr,G)),J.isShaderMaterial&&J.uniformsNeedUpdate===!0&&(Pm.upload(fe,Yi(Lt),gr,G),J.uniformsNeedUpdate=!1),J.isSpriteMaterial&&Tt.setValue(fe,"center",O.center),Tt.setValue(fe,"modelViewMatrix",O.modelViewMatrix),Tt.setValue(fe,"normalMatrix",O.normalMatrix),Tt.setValue(fe,"modelMatrix",O.matrixWorld),J.isShaderMaterial||J.isRawShaderMaterial){const qn=J.uniformsGroups;for(let oo=0,ol=qn.length;oo<ol;oo++)if(ft.isWebGL2){const Yo=qn[oo];Ot.update(Yo,$n),Ot.bind(Yo,$n)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return $n}function Mr(j,se){j.ambientLightColor.needsUpdate=se,j.lightProbe.needsUpdate=se,j.directionalLights.needsUpdate=se,j.directionalLightShadows.needsUpdate=se,j.pointLights.needsUpdate=se,j.pointLightShadows.needsUpdate=se,j.spotLights.needsUpdate=se,j.spotLightShadows.needsUpdate=se,j.rectAreaLights.needsUpdate=se,j.hemisphereLights.needsUpdate=se}function ys(j){return j.isMeshLambertMaterial||j.isMeshToonMaterial||j.isMeshPhongMaterial||j.isMeshStandardMaterial||j.isShadowMaterial||j.isShaderMaterial&&j.lights===!0}this.getActiveCubeFace=function(){return V},this.getActiveMipmapLevel=function(){return H},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(j,se,pe){mt.get(j.texture).__webglTexture=se,mt.get(j.depthTexture).__webglTexture=pe;const J=mt.get(j);J.__hasExternalTextures=!0,J.__hasExternalTextures&&(J.__autoAllocateDepthBuffer=pe===void 0,J.__autoAllocateDepthBuffer||st.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),J.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(j,se){const pe=mt.get(j);pe.__webglFramebuffer=se,pe.__useDefaultFramebuffer=se===void 0},this.setRenderTarget=function(j,se=0,pe=0){P=j,V=se,H=pe;let J=!0,O=null,ae=!1,Se=!1;if(j){const Fe=mt.get(j);Fe.__useDefaultFramebuffer!==void 0?(Qe.bindFramebuffer(fe.FRAMEBUFFER,null),J=!1):Fe.__webglFramebuffer===void 0?G.setupRenderTarget(j):Fe.__hasExternalTextures&&G.rebindTextures(j,mt.get(j.texture).__webglTexture,mt.get(j.depthTexture).__webglTexture);const et=j.texture;(et.isData3DTexture||et.isDataArrayTexture||et.isCompressedArrayTexture)&&(Se=!0);const tt=mt.get(j).__webglFramebuffer;j.isWebGLCubeRenderTarget?(Array.isArray(tt[se])?O=tt[se][pe]:O=tt[se],ae=!0):ft.isWebGL2&&j.samples>0&&G.useMultisampledRTT(j)===!1?O=mt.get(j).__webglMultisampledFramebuffer:Array.isArray(tt)?O=tt[pe]:O=tt,C.copy(j.viewport),N.copy(j.scissor),W=j.scissorTest}else C.copy(ie).multiplyScalar(ge).floor(),N.copy($).multiplyScalar(ge).floor(),W=ne;if(Qe.bindFramebuffer(fe.FRAMEBUFFER,O)&&ft.drawBuffers&&J&&Qe.drawBuffers(j,O),Qe.viewport(C),Qe.scissor(N),Qe.setScissorTest(W),ae){const Fe=mt.get(j.texture);fe.framebufferTexture2D(fe.FRAMEBUFFER,fe.COLOR_ATTACHMENT0,fe.TEXTURE_CUBE_MAP_POSITIVE_X+se,Fe.__webglTexture,pe)}else if(Se){const Fe=mt.get(j.texture),et=se||0;fe.framebufferTextureLayer(fe.FRAMEBUFFER,fe.COLOR_ATTACHMENT0,Fe.__webglTexture,pe||0,et)}I=-1},this.readRenderTargetPixels=function(j,se,pe,J,O,ae,Se){if(!(j&&j.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Be=mt.get(j).__webglFramebuffer;if(j.isWebGLCubeRenderTarget&&Se!==void 0&&(Be=Be[Se]),Be){Qe.bindFramebuffer(fe.FRAMEBUFFER,Be);try{const Fe=j.texture,et=Fe.format,tt=Fe.type;if(et!==ds&&$e.convert(et)!==fe.getParameter(fe.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const dt=tt===qd&&(st.has("EXT_color_buffer_half_float")||ft.isWebGL2&&st.has("EXT_color_buffer_float"));if(tt!==Ba&&$e.convert(tt)!==fe.getParameter(fe.IMPLEMENTATION_COLOR_READ_TYPE)&&!(tt===Na&&(ft.isWebGL2||st.has("OES_texture_float")||st.has("WEBGL_color_buffer_float")))&&!dt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}se>=0&&se<=j.width-J&&pe>=0&&pe<=j.height-O&&fe.readPixels(se,pe,J,O,$e.convert(et),$e.convert(tt),ae)}finally{const Fe=P!==null?mt.get(P).__webglFramebuffer:null;Qe.bindFramebuffer(fe.FRAMEBUFFER,Fe)}}},this.copyFramebufferToTexture=function(j,se,pe=0){const J=Math.pow(2,-pe),O=Math.floor(se.image.width*J),ae=Math.floor(se.image.height*J);G.setTexture2D(se,0),fe.copyTexSubImage2D(fe.TEXTURE_2D,pe,0,0,j.x,j.y,O,ae),Qe.unbindTexture()},this.copyTextureToTexture=function(j,se,pe,J=0){const O=se.image.width,ae=se.image.height,Se=$e.convert(pe.format),Be=$e.convert(pe.type);G.setTexture2D(pe,0),fe.pixelStorei(fe.UNPACK_FLIP_Y_WEBGL,pe.flipY),fe.pixelStorei(fe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,pe.premultiplyAlpha),fe.pixelStorei(fe.UNPACK_ALIGNMENT,pe.unpackAlignment),se.isDataTexture?fe.texSubImage2D(fe.TEXTURE_2D,J,j.x,j.y,O,ae,Se,Be,se.image.data):se.isCompressedTexture?fe.compressedTexSubImage2D(fe.TEXTURE_2D,J,j.x,j.y,se.mipmaps[0].width,se.mipmaps[0].height,Se,se.mipmaps[0].data):fe.texSubImage2D(fe.TEXTURE_2D,J,j.x,j.y,Se,Be,se.image),J===0&&pe.generateMipmaps&&fe.generateMipmap(fe.TEXTURE_2D),Qe.unbindTexture()},this.copyTextureToTexture3D=function(j,se,pe,J,O=0){if(b.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const ae=j.max.x-j.min.x+1,Se=j.max.y-j.min.y+1,Be=j.max.z-j.min.z+1,Fe=$e.convert(J.format),et=$e.convert(J.type);let tt;if(J.isData3DTexture)G.setTexture3D(J,0),tt=fe.TEXTURE_3D;else if(J.isDataArrayTexture||J.isCompressedArrayTexture)G.setTexture2DArray(J,0),tt=fe.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}fe.pixelStorei(fe.UNPACK_FLIP_Y_WEBGL,J.flipY),fe.pixelStorei(fe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,J.premultiplyAlpha),fe.pixelStorei(fe.UNPACK_ALIGNMENT,J.unpackAlignment);const dt=fe.getParameter(fe.UNPACK_ROW_LENGTH),jt=fe.getParameter(fe.UNPACK_IMAGE_HEIGHT),An=fe.getParameter(fe.UNPACK_SKIP_PIXELS),Dt=fe.getParameter(fe.UNPACK_SKIP_ROWS),Wn=fe.getParameter(fe.UNPACK_SKIP_IMAGES),kt=pe.isCompressedTexture?pe.mipmaps[O]:pe.image;fe.pixelStorei(fe.UNPACK_ROW_LENGTH,kt.width),fe.pixelStorei(fe.UNPACK_IMAGE_HEIGHT,kt.height),fe.pixelStorei(fe.UNPACK_SKIP_PIXELS,j.min.x),fe.pixelStorei(fe.UNPACK_SKIP_ROWS,j.min.y),fe.pixelStorei(fe.UNPACK_SKIP_IMAGES,j.min.z),pe.isDataTexture||pe.isData3DTexture?fe.texSubImage3D(tt,O,se.x,se.y,se.z,ae,Se,Be,Fe,et,kt.data):pe.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),fe.compressedTexSubImage3D(tt,O,se.x,se.y,se.z,ae,Se,Be,Fe,kt.data)):fe.texSubImage3D(tt,O,se.x,se.y,se.z,ae,Se,Be,Fe,et,kt),fe.pixelStorei(fe.UNPACK_ROW_LENGTH,dt),fe.pixelStorei(fe.UNPACK_IMAGE_HEIGHT,jt),fe.pixelStorei(fe.UNPACK_SKIP_PIXELS,An),fe.pixelStorei(fe.UNPACK_SKIP_ROWS,Dt),fe.pixelStorei(fe.UNPACK_SKIP_IMAGES,Wn),O===0&&J.generateMipmaps&&fe.generateMipmap(tt),Qe.unbindTexture()},this.initTexture=function(j){j.isCubeTexture?G.setTextureCube(j,0):j.isData3DTexture?G.setTexture3D(j,0):j.isDataArrayTexture||j.isCompressedArrayTexture?G.setTexture2DArray(j,0):G.setTexture2D(j,0),Qe.unbindTexture()},this.resetState=function(){V=0,H=0,P=null,Qe.reset(),ct.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Lo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===xT?"display-p3":"srgb",t.unpackColorSpace=ln.workingColorSpace===c_?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Tr?Ha:ML}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Ha?Tr:jo}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class fY extends XL{}fY.prototype.isWebGL1Renderer=!0;class pY extends zr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class mY{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=gE,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Ga()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ga()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ga()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Wr=new oe;class fg{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Wr.fromBufferAttribute(this,t),Wr.applyMatrix4(e),this.setXYZ(t,Wr.x,Wr.y,Wr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Wr.fromBufferAttribute(this,t),Wr.applyNormalMatrix(e),this.setXYZ(t,Wr.x,Wr.y,Wr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Wr.fromBufferAttribute(this,t),Wr.transformDirection(e),this.setXYZ(t,Wr.x,Wr.y,Wr.z);return this}setX(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Po(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Po(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Po(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Po(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),r=hn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),r=hn(r,this.array),i=hn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),r=hn(r,this.array),i=hn(i,this.array),s=hn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new $i(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new fg(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class KL extends fc{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new en(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let cu;const Zh=new oe,uu=new oe,hu=new oe,du=new Ft,Qh=new Ft,YL=new Un,im=new oe,Jh=new oe,sm=new oe,jR=new Ft,s0=new Ft,WR=new Ft;class gY extends zr{constructor(e=new KL){if(super(),this.isSprite=!0,this.type="Sprite",cu===void 0){cu=new Xi;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new mY(t,5);cu.setIndex([0,1,2,0,2,3]),cu.setAttribute("position",new fg(r,3,0,!1)),cu.setAttribute("uv",new fg(r,2,3,!1))}this.geometry=cu,this.material=e,this.center=new Ft(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),uu.setFromMatrixScale(this.matrixWorld),YL.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),hu.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&uu.multiplyScalar(-hu.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const a=this.center;om(im.set(-.5,-.5,0),hu,a,uu,i,s),om(Jh.set(.5,-.5,0),hu,a,uu,i,s),om(sm.set(.5,.5,0),hu,a,uu,i,s),jR.set(0,0),s0.set(1,0),WR.set(1,1);let c=e.ray.intersectTriangle(im,Jh,sm,!1,Zh);if(c===null&&(om(Jh.set(-.5,.5,0),hu,a,uu,i,s),s0.set(0,1),c=e.ray.intersectTriangle(im,sm,Jh,!1,Zh),c===null))return;const u=e.ray.origin.distanceTo(Zh);u<e.near||u>e.far||t.push({distance:u,point:Zh.clone(),uv:Hi.getInterpolation(Zh,im,Jh,sm,jR,s0,WR,new Ft),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function om(n,e,t,r,i,s){du.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(Qh.x=s*du.x-i*du.y,Qh.y=i*du.x+s*du.y):Qh.copy(du),n.copy(e),n.x+=Qh.x,n.y+=Qh.y,n.applyMatrix4(YL)}class ZL extends fc{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new en(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const $R=new Un,SE=new LL,am=new u_,lm=new oe;class _Y extends zr{constructor(e=new Xi,t=new ZL){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),am.copy(r.boundingSphere),am.applyMatrix4(i),am.radius+=s,e.ray.intersectsSphere(am)===!1)return;$R.copy(i).invert(),SE.copy(e.ray).applyMatrix4($R);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,h=r.index,m=r.attributes.position;if(h!==null){const _=Math.max(0,a.start),v=Math.min(h.count,a.start+a.count);for(let T=_,A=v;T<A;T++){const E=h.getX(T);lm.fromBufferAttribute(m,E),qR(lm,E,u,i,e,t,this)}}else{const _=Math.max(0,a.start),v=Math.min(m.count,a.start+a.count);for(let T=_,A=v;T<A;T++)lm.fromBufferAttribute(m,T),qR(lm,T,u,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const c=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}}function qR(n,e,t,r,i,s,a){const c=SE.distanceSqToPoint(n);if(c<t){const u=new oe;SE.closestPointToPoint(n,u),u.applyMatrix4(r);const h=i.ray.origin.distanceTo(u);if(h<i.near||h>i.far)return;s.push({distance:h,distanceToRay:Math.sqrt(c),point:u,index:e,face:null,object:a})}}class vY extends pi{constructor(e,t,r,i,s,a,c,u,h){super(e,t,r,i,s,a,c,u,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class RT extends Xi{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,a=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:a,thetaLength:c},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const u=Math.min(a+c,Math.PI);let h=0;const f=[],m=new oe,_=new oe,v=[],T=[],A=[],E=[];for(let S=0;S<=r;S++){const D=[],b=S/r;let k=0;S===0&&a===0?k=.5/t:S===r&&u===Math.PI&&(k=-.5/t);for(let V=0;V<=t;V++){const H=V/t;m.x=-e*Math.cos(i+H*s)*Math.sin(a+b*c),m.y=e*Math.cos(a+b*c),m.z=e*Math.sin(i+H*s)*Math.sin(a+b*c),T.push(m.x,m.y,m.z),_.copy(m).normalize(),A.push(_.x,_.y,_.z),E.push(H+k,1-b),D.push(h++)}f.push(D)}for(let S=0;S<r;S++)for(let D=0;D<t;D++){const b=f[S][D+1],k=f[S][D],V=f[S+1][D],H=f[S+1][D+1];(S!==0||a>0)&&v.push(b,k,H),(S!==r-1||u<Math.PI)&&v.push(k,V,H)}this.setIndex(v),this.setAttribute("position",new Ri(T,3)),this.setAttribute("normal",new Ri(A,3)),this.setAttribute("uv",new Ri(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new RT(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class pg extends Xi{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const a=[],c=[],u=[],h=[],f=new oe,m=new oe,_=new oe;for(let v=0;v<=r;v++)for(let T=0;T<=i;T++){const A=T/i*s,E=v/r*Math.PI*2;m.x=(e+t*Math.cos(E))*Math.cos(A),m.y=(e+t*Math.cos(E))*Math.sin(A),m.z=t*Math.sin(E),c.push(m.x,m.y,m.z),f.x=e*Math.cos(A),f.y=e*Math.sin(A),_.subVectors(m,f).normalize(),u.push(_.x,_.y,_.z),h.push(T/i),h.push(v/r)}for(let v=1;v<=r;v++)for(let T=1;T<=i;T++){const A=(i+1)*v+T-1,E=(i+1)*(v-1)+T-1,S=(i+1)*(v-1)+T,D=(i+1)*v+T;a.push(A,E,D),a.push(E,S,D)}this.setIndex(a),this.setAttribute("position",new Ri(c,3)),this.setAttribute("normal",new Ri(u,3)),this.setAttribute("uv",new Ri(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pg(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class XR extends fc{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new en(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new en(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bL,this.normalScale=new Ft(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class QL extends zr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new en(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}const o0=new Un,KR=new oe,YR=new oe;class yY{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ft(512,512),this.map=null,this.mapPass=null,this.matrix=new Un,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new AT,this._frameExtents=new Ft(1,1),this._viewportCount=1,this._viewports=[new Sn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;KR.setFromMatrixPosition(e.matrixWorld),t.position.copy(KR),YR.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(YR),t.updateMatrixWorld(),o0.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o0),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(o0)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const ZR=new Un,ed=new oe,a0=new oe;class EY extends yY{constructor(){super(new Ai(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ft(4,2),this._viewportCount=6,this._viewports=[new Sn(2,1,1,1),new Sn(0,1,1,1),new Sn(3,1,1,1),new Sn(1,1,1,1),new Sn(3,0,1,1),new Sn(1,0,1,1)],this._cubeDirections=[new oe(1,0,0),new oe(-1,0,0),new oe(0,0,1),new oe(0,0,-1),new oe(0,1,0),new oe(0,-1,0)],this._cubeUps=[new oe(0,1,0),new oe(0,1,0),new oe(0,1,0),new oe(0,1,0),new oe(0,0,1),new oe(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),ed.setFromMatrixPosition(e.matrixWorld),r.position.copy(ed),a0.copy(r.position),a0.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(a0),r.updateMatrixWorld(),i.makeTranslation(-ed.x,-ed.y,-ed.z),ZR.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ZR)}}class SY extends QL{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new EY}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class TY extends QL{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ST}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ST);function xY(){const[n,e]=X.useState(!1);return X.useEffect(()=>{const t=window.matchMedia("(prefers-reduced-motion: reduce)");e(t.matches);const r=i=>e(i.matches);return t.addEventListener?t.addEventListener("change",r):t.addListener(r),()=>t.removeEventListener?t.removeEventListener("change",r):t.removeListener(r)},[]),n}function wY(){const[n,e]=X.useState(!0);return X.useEffect(()=>{const t=()=>e(!document.hidden);return document.addEventListener("visibilitychange",t),()=>document.removeEventListener("visibilitychange",t)},[]),n}function AY(n=.02){const e=X.useRef({x:0,y:0});return X.useEffect(()=>{const t=r=>{const{innerWidth:i,innerHeight:s}=window;e.current.x=(r.clientX-i/2)*n,e.current.y=(r.clientY-s/2)*n};return window.addEventListener("mousemove",t),()=>window.removeEventListener("mousemove",t)},[n]),e}function MY(){const e=document.createElement("canvas");e.width=e.height=256;const t=e.getContext("2d"),r=t.createRadialGradient(256/2,256/2,6,256/2,256/2,256/2);r.addColorStop(0,"rgba(255,190,120,0.65)"),r.addColorStop(.3,"rgba(255,160,95,0.40)"),r.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=r,t.fillRect(0,0,256,256);const i=new vY(e);return i.encoding=Ha,i}function bY({intensity:n=1}){const e=X.useRef(null),t=X.useRef(0),r=X.useRef(null),i=xY(),s=wY(),a=AY(.02);return X.useEffect(()=>{const c=e.current;if(!c)return;if(!(()=>{try{return!!document.createElement("canvas").getContext("webgl")}catch{return!1}})()){c.style.background="radial-gradient(300px 300px at 75% 50%, rgba(255,180,110,0.25), transparent 60%)";return}const h=new pY,f=new Ai(60,c.clientWidth/c.clientHeight,.1,1e3);f.position.set(0,.8,8);const m=new XL({antialias:!0,alpha:!0});m.setPixelRatio(Math.min(2,window.devicePixelRatio)),m.setSize(c.clientWidth,c.clientHeight),r.current=m,c.appendChild(m.domElement);const _=new Xi,v=i?600:1600,T=new Float32Array(v*3);for(let M=0;M<v;M++){const C=(i?60:90)*Math.pow(Math.random(),.35),N=Math.random()*Math.PI*2,W=Math.acos(2*Math.random()-1);T[M*3]=C*Math.sin(W)*Math.cos(N),T[M*3+1]=C*Math.sin(W)*Math.sin(N),T[M*3+2]=C*Math.cos(W)}_.setAttribute("position",new $i(T,3));const A=new _Y(_,new ZL({color:16777215,size:.015}));h.add(A);const E=new ps(new RT(1.1,64,64),new XR({color:0,roughness:1}));h.add(E);const S=new TY(16777215,.32),D=new SY(16752736,2,60);D.position.set(6,2,6),h.add(S,D);const b=new ps(new pg(2.3,.5,64,256),new XR({color:2234896,emissive:16750672,emissiveIntensity:1.5*n,roughness:.45,metalness:.65}));b.rotation.x=Math.PI/2.35,h.add(b);const k=new ps(new pg(3.2,.14,16,256),new wT({color:16757611,transparent:!0,opacity:.25}));k.rotation.x=Math.PI/2.35,h.add(k);const V=new gY(new KL({map:MY(),depthWrite:!1,depthTest:!1}));V.scale.set(10,10,1),V.position.set(1.2,0,0),h.add(V);const H=()=>{f.aspect=c.clientWidth/c.clientHeight,f.updateProjectionMatrix(),m.setSize(c.clientWidth,c.clientHeight)};window.addEventListener("resize",H);let P=0;const I=(M=0)=>{const C=M-P;if(P=M,s){const N=a.current?.x||0,W=a.current?.y||0;f.position.x=N,f.position.y=.8+W*.2,f.lookAt(0,0,0),i||(A.rotation.y+=7e-4*(C/16),b.rotation.z+=.004*(C/16),k.rotation.z-=.002*(C/16),V.material.rotation+=8e-4*(C/16)),m.render(h,f)}t.current=requestAnimationFrame(I)};return I(),()=>{cancelAnimationFrame(t.current),window.removeEventListener("resize",H),r.current&&(r.current.dispose(),c.removeChild(r.current.domElement)),h.traverse(M=>{M.geometry&&M.geometry.dispose?.();const C=M.material;C&&(Array.isArray(C)?C.forEach(N=>N.dispose?.()):C.dispose?.())})}},[i,s]),B.jsx("div",{ref:e,className:"absolute inset-0"})}function Ta({title:n,subtitle:e,children:t,className:r=""}){return B.jsxs("div",{className:`glass p-5 ${r}`,children:[B.jsxs("div",{className:"mb-3",children:[B.jsx("h3",{className:"text-lg font-semibold",children:n}),e&&B.jsx("p",{className:"text-sm text-zinc-400",children:e})]}),B.jsx("div",{className:"text-zinc-200",children:t})]})}function ks({children:n,strength:e=.25,className:t=""}){const r=X.useRef(null);return X.useEffect(()=>{const i=r.current;if(!i)return;let s=0,a=!1,c=0,u=0,h=0,f=0;const m=()=>i.getBoundingClientRect(),_=E=>{if(!a)return;const S=m(),D=S.left+S.width/2,b=S.top+S.height/2,k=E.clientX-D,V=E.clientY-b;c=k*e*.2,u=V*e*.2,s||(s=requestAnimationFrame(A))},v=()=>{a=!0},T=()=>{a=!1,c=u=0,s||(s=requestAnimationFrame(A))},A=()=>{h+=(c-h)*.18,f+=(u-f)*.18,i.style.transform=`translate3d(${h}px, ${f}px, 0)`,i.style.transition="transform 0s",s=a||Math.abs(h)>.2||Math.abs(f)>.2?requestAnimationFrame(A):0};return window.addEventListener("mousemove",_),i.addEventListener("mouseenter",v),i.addEventListener("mouseleave",T),()=>{window.removeEventListener("mousemove",_),i.removeEventListener("mouseenter",v),i.removeEventListener("mouseleave",T),s&&cancelAnimationFrame(s),i.style.transform=""}},[e]),B.jsx("div",{ref:r,className:t,style:{willChange:"transform",display:"inline-block"},children:n})}function RY({seed:n=42}){const r=X.useMemo(()=>{let s=n;const a=()=>(s=s*16807%2147483647)/2147483647,c=Array.from({length:53},()=>Array.from({length:7},()=>Math.floor(Math.pow(a(),.55)*5)));for(let u=0;u<53;u++){const h=u>45?1:0;for(let f=0;f<7;f++)c[u][f]=Math.min(4,c[u][f]+h)}return c},[n]),i=s=>{switch(s){case 0:return"bg-zinc-800/60";case 1:return"bg-brand-300/30";case 2:return"bg-brand-400/50";case 3:return"bg-brand-500/70";default:return"bg-brand-600"}};return B.jsxs("div",{className:"glass p-5",children:[B.jsxs("div",{className:"flex items-center justify-between mb-3",children:[B.jsx("h3",{className:"text-lg font-semibold",children:"Streak Heatmap"}),B.jsxs("div",{className:"flex items-center gap-2 text-xs text-zinc-400",children:[B.jsx("span",{children:"Less"}),[0,1,2,3,4].map(s=>B.jsx("span",{className:`w-3 h-3 rounded-sm ${i(s)}`},s)),B.jsx("span",{children:"More"})]})]}),B.jsx("div",{className:"flex gap-[3px] overflow-x-auto pr-1","aria-hidden":"true",children:r.map((s,a)=>B.jsx("div",{className:"flex flex-col gap-[3px]",children:s.map((c,u)=>B.jsx("div",{className:`w-3 h-3 sm:w-3.5 sm:h-3.5 md:w-4 md:h-4 rounded-sm ${i(c)}`},u))},a))})]})}function CY(){const{scrollYProgress:n}=J4(),e=ly(n,[0,.25,1],[1,1.35,1.6]),t=ly(n,[0,.25],[0,-30]),r=ly(n,[0,.35],[1,.85]);return B.jsxs("section",{className:"relative overflow-hidden",children:[B.jsx(us.div,{style:{opacity:r},children:B.jsx(bY,{intensity:e})}),B.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/10 via-black/40 to-black"}),B.jsx("div",{className:"pointer-events-none absolute right-0 top-0 w-1/2 h-full bg-[radial-gradient(600px_420px_at_right_center,rgba(255,179,107,0.08),transparent_60%)]"}),B.jsxs("div",{className:"relative z-10 mx-auto max-w-7xl px-4 pt-16 pb-16",children:[B.jsxs("div",{className:"grid lg:grid-cols-2 gap-10 items-center",children:[B.jsxs(us.div,{style:{y:t},children:[B.jsxs(us.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-5xl md:text-6xl font-extrabold leading-tight",children:["Turn intent into progress ",B.jsx("br",{className:"hidden md:block"}),"join pods, ship tiny proofs,",B.jsx("br",{className:"hidden md:block"}),"grow together."]}),B.jsx(us.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.65,delay:.05},className:"mt-4 text-lg text-zinc-300 max-w-2xl",children:"PeerLearn makes self-learning social and credible. Pick a poddo 2-minute daily actions, and share proof of work to earn feedback and momentum."}),B.jsxs(us.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.7,delay:.1},className:"mt-8 flex items-center gap-4",children:[B.jsx(ks,{children:B.jsx("a",{href:"#/pods",className:"btn-primary focus-out",children:"Explore Pods"})}),B.jsx(ks,{children:B.jsx("a",{href:"#/matches",className:"btn-ghost focus-out",children:"Find Peers"})})]})]}),B.jsx("div",{className:"relative min-h-[440px]"})]}),B.jsxs("div",{className:"mt-12 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[B.jsx(ks,{className:"block",children:B.jsx(Ta,{title:"Retrieval Check (1 min)",children:B.jsxs("ul",{className:"space-y-2 text-sm text-zinc-300",children:[B.jsx("li",{className:"glass px-3 py-2 rounded-lg",children:"Short-term cramming"}),B.jsx("li",{className:"glass px-3 py-2 rounded-lg",children:"Long-term retention"}),B.jsx("li",{className:"glass px-3 py-2 rounded-lg",children:"Note neatness"}),B.jsx("li",{className:"glass px-3 py-2 rounded-lg",children:"Reading speed"})]})})}),B.jsx(ks,{className:"block",children:B.jsxs(Ta,{title:"If-Then Habit",children:[B.jsx("p",{className:"text-sm text-zinc-300",children:"Two tiny cue-linked actions to stay consistent."}),B.jsxs("div",{className:"mt-3 flex gap-3",children:[B.jsx("button",{className:"btn-primary text-sm",children:"Start 2 min"}),B.jsx("button",{className:"btn-ghost text-sm",children:"Freeze"})]})]})}),B.jsx(ks,{className:"block",children:B.jsxs(Ta,{title:"Guided Next Steps",className:"relative",children:[B.jsx("div",{className:"absolute -inset-px rounded-2xl pointer-events-none",style:{boxShadow:"0 0 60px rgba(255,179,107,0.25)"}}),B.jsx("p",{className:"text-sm text-zinc-300",children:"Join 2 Pods based on your goal"})]})}),B.jsx(ks,{className:"block",children:B.jsxs(Ta,{title:"Gicced Next Steps",className:"relative",children:[B.jsx("div",{className:"absolute -inset-px rounded-2xl pointer-events-none",style:{boxShadow:"0 0 60px rgba(255,179,107,0.18)"}}),B.jsx("p",{className:"text-sm text-zinc-300",children:"Join 2 Pods based on your goal  Send 1 warm intro  RSVP to 1 event"})]})})]}),B.jsxs("div",{className:"mt-4 sm:mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[B.jsx(ks,{className:"block",children:B.jsx(Ta,{title:"Proof & Feedback",children:B.jsx("p",{className:"text-sm text-zinc-300",children:"Earn likes, warm-intros, critiques."})})}),B.jsx(ks,{className:"block",children:B.jsx(Ta,{title:"Mood Label",children:B.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:["Calm","Focused","Stressed","Anxious","Happy","Tired"].map(i=>B.jsx("span",{className:"pill",children:i},i))})})}),B.jsx(ks,{className:"block",children:B.jsx(Ta,{title:"Journal",children:B.jsx("p",{className:"text-sm text-zinc-300",children:"Note your day in 120 seconds."})})}),B.jsx(ks,{className:"block",children:B.jsx(Ta,{title:"Todays Event",children:B.jsx("p",{className:"text-sm text-zinc-300",children:"1 community call at 7 PM."})})})]}),B.jsx("div",{className:"mt-8",children:B.jsx(RY,{})})]})]})}let PY={data:""},IY=n=>{if(typeof window=="object"){let e=(n?n.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(n||document.head).appendChild(e),e.firstChild}return n||PY},DY=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,LY=/\/\*[^]*?\*\/|  +/g,QR=/\n+/g,Pa=(n,e)=>{let t="",r="",i="";for(let s in n){let a=n[s];s[0]=="@"?s[1]=="i"?t=s+" "+a+";":r+=s[1]=="f"?Pa(a,s):s+"{"+Pa(a,s[1]=="k"?"":e)+"}":typeof a=="object"?r+=Pa(a,e?e.replace(/([^,])+/g,c=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,c):c?c+" "+u:u)):s):a!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Pa.p?Pa.p(s,a):s+":"+a+";")}return t+(e&&i?e+"{"+i+"}":i)+r},Mo={},JL=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+JL(n[t]);return e}return n},NY=(n,e,t,r,i)=>{let s=JL(n),a=Mo[s]||(Mo[s]=(u=>{let h=0,f=11;for(;h<u.length;)f=101*f+u.charCodeAt(h++)>>>0;return"go"+f})(s));if(!Mo[a]){let u=s!==n?n:(h=>{let f,m,_=[{}];for(;f=DY.exec(h.replace(LY,""));)f[4]?_.shift():f[3]?(m=f[3].replace(QR," ").trim(),_.unshift(_[0][m]=_[0][m]||{})):_[0][f[1]]=f[2].replace(QR," ").trim();return _[0]})(n);Mo[a]=Pa(i?{["@keyframes "+a]:u}:u,t?"":"."+a)}let c=t&&Mo.g?Mo.g:null;return t&&(Mo.g=Mo[a]),((u,h,f,m)=>{m?h.data=h.data.replace(m,u):h.data.indexOf(u)===-1&&(h.data=f?u+h.data:h.data+u)})(Mo[a],e,r,c),a},OY=(n,e,t)=>n.reduce((r,i,s)=>{let a=e[s];if(a&&a.call){let c=a(t),u=c&&c.props&&c.props.className||/^go/.test(c)&&c;a=u?"."+u:c&&typeof c=="object"?c.props?"":Pa(c,""):c===!1?"":c}return r+i+(a??"")},"");function f_(n){let e=this||{},t=n.call?n(e.p):n;return NY(t.unshift?t.raw?OY(t,[].slice.call(arguments,1),e.p):t.reduce((r,i)=>Object.assign(r,i&&i.call?i(e.p):i),{}):t,IY(e.target),e.g,e.o,e.k)}let eN,TE,xE;f_.bind({g:1});let Wo=f_.bind({k:1});function kY(n,e,t,r){Pa.p=e,eN=n,TE=t,xE=r}function il(n,e){let t=this||{};return function(){let r=arguments;function i(s,a){let c=Object.assign({},s),u=c.className||i.className;t.p=Object.assign({theme:TE&&TE()},c),t.o=/ *go\d+/.test(u),c.className=f_.apply(t,r)+(u?" "+u:"");let h=n;return n[0]&&(h=c.as||n,delete c.as),xE&&h[0]&&xE(c),eN(h,c)}return i}}var UY=n=>typeof n=="function",mg=(n,e)=>UY(n)?n(e):n,FY=(()=>{let n=0;return()=>(++n).toString()})(),tN=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),VY=20,CT="default",nN=(n,e)=>{let{toastLimit:t}=n.settings;switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,t)};case 1:return{...n,toasts:n.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:r}=e;return nN(n,{type:n.toasts.find(a=>a.id===r.id)?1:0,toast:r});case 3:let{toastId:i}=e;return{...n,toasts:n.toasts.map(a=>a.id===i||i===void 0?{...a,dismissed:!0,visible:!1}:a)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let s=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+s}))}}},Im=[],rN={toasts:[],pausedAt:void 0,settings:{toastLimit:VY}},Hs={},iN=(n,e=CT)=>{Hs[e]=nN(Hs[e]||rN,n),Im.forEach(([t,r])=>{t===e&&r(Hs[e])})},sN=n=>Object.keys(Hs).forEach(e=>iN(n,e)),zY=n=>Object.keys(Hs).find(e=>Hs[e].toasts.some(t=>t.id===n)),p_=(n=CT)=>e=>{iN(e,n)},BY={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},HY=(n={},e=CT)=>{let[t,r]=X.useState(Hs[e]||rN),i=X.useRef(Hs[e]);X.useEffect(()=>(i.current!==Hs[e]&&r(Hs[e]),Im.push([e,r]),()=>{let a=Im.findIndex(([c])=>c===e);a>-1&&Im.splice(a,1)}),[e]);let s=t.toasts.map(a=>{var c,u,h;return{...n,...n[a.type],...a,removeDelay:a.removeDelay||((c=n[a.type])==null?void 0:c.removeDelay)||n?.removeDelay,duration:a.duration||((u=n[a.type])==null?void 0:u.duration)||n?.duration||BY[a.type],style:{...n.style,...(h=n[a.type])==null?void 0:h.style,...a.style}}});return{...t,toasts:s}},GY=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:t?.id||FY()}),vf=n=>(e,t)=>{let r=GY(e,n,t);return p_(r.toasterId||zY(r.id))({type:2,toast:r}),r.id},nr=(n,e)=>vf("blank")(n,e);nr.error=vf("error");nr.success=vf("success");nr.loading=vf("loading");nr.custom=vf("custom");nr.dismiss=(n,e)=>{let t={type:3,toastId:n};e?p_(e)(t):sN(t)};nr.dismissAll=n=>nr.dismiss(void 0,n);nr.remove=(n,e)=>{let t={type:4,toastId:n};e?p_(e)(t):sN(t)};nr.removeAll=n=>nr.remove(void 0,n);nr.promise=(n,e,t)=>{let r=nr.loading(e.loading,{...t,...t?.loading});return typeof n=="function"&&(n=n()),n.then(i=>{let s=e.success?mg(e.success,i):void 0;return s?nr.success(s,{id:r,...t,...t?.success}):nr.dismiss(r),i}).catch(i=>{let s=e.error?mg(e.error,i):void 0;s?nr.error(s,{id:r,...t,...t?.error}):nr.dismiss(r)}),n};var jY=1e3,WY=(n,e="default")=>{let{toasts:t,pausedAt:r}=HY(n,e),i=X.useRef(new Map).current,s=X.useCallback((m,_=jY)=>{if(i.has(m))return;let v=setTimeout(()=>{i.delete(m),a({type:4,toastId:m})},_);i.set(m,v)},[]);X.useEffect(()=>{if(r)return;let m=Date.now(),_=t.map(v=>{if(v.duration===1/0)return;let T=(v.duration||0)+v.pauseDuration-(m-v.createdAt);if(T<0){v.visible&&nr.dismiss(v.id);return}return setTimeout(()=>nr.dismiss(v.id,e),T)});return()=>{_.forEach(v=>v&&clearTimeout(v))}},[t,r,e]);let a=X.useCallback(p_(e),[e]),c=X.useCallback(()=>{a({type:5,time:Date.now()})},[a]),u=X.useCallback((m,_)=>{a({type:1,toast:{id:m,height:_}})},[a]),h=X.useCallback(()=>{r&&a({type:6,time:Date.now()})},[r,a]),f=X.useCallback((m,_)=>{let{reverseOrder:v=!1,gutter:T=8,defaultPosition:A}=_||{},E=t.filter(b=>(b.position||A)===(m.position||A)&&b.height),S=E.findIndex(b=>b.id===m.id),D=E.filter((b,k)=>k<S&&b.visible).length;return E.filter(b=>b.visible).slice(...v?[D+1]:[0,D]).reduce((b,k)=>b+(k.height||0)+T,0)},[t]);return X.useEffect(()=>{t.forEach(m=>{if(m.dismissed)s(m.id,m.removeDelay);else{let _=i.get(m.id);_&&(clearTimeout(_),i.delete(m.id))}})},[t,s]),{toasts:t,handlers:{updateHeight:u,startPause:c,endPause:h,calculateOffset:f}}},$Y=Wo`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,qY=Wo`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,XY=Wo`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,KY=il("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${$Y} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${qY} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${XY} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,YY=Wo`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,ZY=il("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${YY} 1s linear infinite;
`,QY=Wo`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,JY=Wo`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,eZ=il("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${QY} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${JY} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,tZ=il("div")`
  position: absolute;
`,nZ=il("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,rZ=Wo`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,iZ=il("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${rZ} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,sZ=({toast:n})=>{let{icon:e,type:t,iconTheme:r}=n;return e!==void 0?typeof e=="string"?X.createElement(iZ,null,e):e:t==="blank"?null:X.createElement(nZ,null,X.createElement(ZY,{...r}),t!=="loading"&&X.createElement(tZ,null,t==="error"?X.createElement(KY,{...r}):X.createElement(eZ,{...r})))},oZ=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,aZ=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,lZ="0%{opacity:0;} 100%{opacity:1;}",cZ="0%{opacity:1;} 100%{opacity:0;}",uZ=il("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,hZ=il("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,dZ=(n,e)=>{let t=n.includes("top")?1:-1,[r,i]=tN()?[lZ,cZ]:[oZ(t),aZ(t)];return{animation:e?`${Wo(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Wo(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},fZ=X.memo(({toast:n,position:e,style:t,children:r})=>{let i=n.height?dZ(n.position||e||"top-center",n.visible):{opacity:0},s=X.createElement(sZ,{toast:n}),a=X.createElement(hZ,{...n.ariaProps},mg(n.message,n));return X.createElement(uZ,{className:n.className,style:{...i,...t,...n.style}},typeof r=="function"?r({icon:s,message:a}):X.createElement(X.Fragment,null,s,a))});kY(X.createElement);var pZ=({id:n,className:e,style:t,onHeightUpdate:r,children:i})=>{let s=X.useCallback(a=>{if(a){let c=()=>{let u=a.getBoundingClientRect().height;r(n,u)};c(),new MutationObserver(c).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[n,r]);return X.createElement("div",{ref:s,className:e,style:t},i)},mZ=(n,e)=>{let t=n.includes("top"),r=t?{top:0}:{bottom:0},i=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:tN()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...r,...i}},gZ=f_`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,cm=16,_Z=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:r,children:i,toasterId:s,containerStyle:a,containerClassName:c})=>{let{toasts:u,handlers:h}=WY(t,s);return X.createElement("div",{"data-rht-toaster":s||"",style:{position:"fixed",zIndex:9999,top:cm,left:cm,right:cm,bottom:cm,pointerEvents:"none",...a},className:c,onMouseEnter:h.startPause,onMouseLeave:h.endPause},u.map(f=>{let m=f.position||e,_=h.calculateOffset(f,{reverseOrder:n,gutter:r,defaultPosition:e}),v=mZ(m,_);return X.createElement(pZ,{id:f.id,key:f.id,onHeightUpdate:h.updateHeight,className:f.visible?gZ:"",style:v},f.type==="custom"?mg(f.message,f):i?i(f):X.createElement(fZ,{toast:f,position:m}))}))},Ro=nr;const{entries:oN,setPrototypeOf:JR,isFrozen:vZ,getPrototypeOf:yZ,getOwnPropertyDescriptor:EZ}=Object;let{freeze:Zr,seal:qi,create:wE}=Object,{apply:AE,construct:ME}=typeof Reflect<"u"&&Reflect;Zr||(Zr=function(e){return e});qi||(qi=function(e){return e});AE||(AE=function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return e.apply(t,i)});ME||(ME=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return new e(...r)});const um=Qr(Array.prototype.forEach),SZ=Qr(Array.prototype.lastIndexOf),eC=Qr(Array.prototype.pop),td=Qr(Array.prototype.push),TZ=Qr(Array.prototype.splice),Dm=Qr(String.prototype.toLowerCase),l0=Qr(String.prototype.toString),c0=Qr(String.prototype.match),nd=Qr(String.prototype.replace),xZ=Qr(String.prototype.indexOf),wZ=Qr(String.prototype.trim),cs=Qr(Object.prototype.hasOwnProperty),$r=Qr(RegExp.prototype.test),rd=AZ(TypeError);function Qr(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return AE(n,e,r)}}function AZ(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ME(n,t)}}function Ht(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Dm;JR&&JR(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const s=t(i);s!==i&&(vZ(e)||(e[r]=s),i=s)}n[i]=!0}return n}function MZ(n){for(let e=0;e<n.length;e++)cs(n,e)||(n[e]=null);return n}function Us(n){const e=wE(null);for(const[t,r]of oN(n))cs(n,t)&&(Array.isArray(r)?e[t]=MZ(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=Us(r):e[t]=r);return e}function id(n,e){for(;n!==null;){const r=EZ(n,e);if(r){if(r.get)return Qr(r.get);if(typeof r.value=="function")return Qr(r.value)}n=yZ(n)}function t(){return null}return t}const tC=Zr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),u0=Zr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),h0=Zr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),bZ=Zr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),d0=Zr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),RZ=Zr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),nC=Zr(["#text"]),rC=Zr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),f0=Zr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),iC=Zr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),hm=Zr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),CZ=qi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),PZ=qi(/<%[\w\W]*|[\w\W]*%>/gm),IZ=qi(/\$\{[\w\W]*/gm),DZ=qi(/^data-[\-\w.\u00B7-\uFFFF]+$/),LZ=qi(/^aria-[\-\w]+$/),aN=qi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),NZ=qi(/^(?:\w+script|data):/i),OZ=qi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),lN=qi(/^html$/i),kZ=qi(/^[a-z][.\w]*(-[.\w]+)+$/i);var sC=Object.freeze({__proto__:null,ARIA_ATTR:LZ,ATTR_WHITESPACE:OZ,CUSTOM_ELEMENT:kZ,DATA_ATTR:DZ,DOCTYPE_NAME:lN,ERB_EXPR:PZ,IS_ALLOWED_URI:aN,IS_SCRIPT_OR_DATA:NZ,MUSTACHE_EXPR:CZ,TMPLIT_EXPR:IZ});const sd={element:1,text:3,progressingInstruction:7,comment:8,document:9},UZ=function(){return typeof window>"u"?null:window},FZ=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},oC=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function cN(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:UZ();const e=J=>cN(J);if(e.version="3.3.1",e.removed=[],!n||!n.document||n.document.nodeType!==sd.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:c,Element:u,NodeFilter:h,NamedNodeMap:f=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:m,DOMParser:_,trustedTypes:v}=n,T=u.prototype,A=id(T,"cloneNode"),E=id(T,"remove"),S=id(T,"nextSibling"),D=id(T,"childNodes"),b=id(T,"parentNode");if(typeof a=="function"){const J=t.createElement("template");J.content&&J.content.ownerDocument&&(t=J.content.ownerDocument)}let k,V="";const{implementation:H,createNodeIterator:P,createDocumentFragment:I,getElementsByTagName:M}=t,{importNode:C}=r;let N=oC();e.isSupported=typeof oN=="function"&&typeof b=="function"&&H&&H.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:W,ERB_EXPR:F,TMPLIT_EXPR:Y,DATA_ATTR:ue,ARIA_ATTR:ye,IS_SCRIPT_OR_DATA:ge,ATTR_WHITESPACE:Q,CUSTOM_ELEMENT:re}=sC;let{IS_ALLOWED_URI:ie}=sC,$=null;const ne=Ht({},[...tC,...u0,...h0,...d0,...nC]);let te=null;const _e=Ht({},[...rC,...f0,...iC,...hm]);let Ee=Object.seal(wE(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Pe=null,we=null;const ke=Object.seal(wE(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let We=!0,Ye=!0,It=!1,fe=!0,nn=!1,st=!0,ft=!1,Qe=!1,Xt=!1,mt=!1,G=!1,U=!1,de=!0,Ie=!1;const Re="user-content-";let De=!0,Xe=!1,ze={},Ge=null;const ot=Ht({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let xt=null;const Ae=Ht({},["audio","video","img","source","image","track"]);let Nt=null;const bt=Ht({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ut="http://www.w3.org/1998/Math/MathML",rt="http://www.w3.org/2000/svg",$e="http://www.w3.org/1999/xhtml";let ct=$e,Ot=!1,Kt=null;const wt=Ht({},[ut,rt,$e],l0);let Oe=Ht({},["mi","mo","mn","ms","mtext"]),K=Ht({},["annotation-xml"]);const Le=Ht({},["title","style","font","a","script"]);let Ve=null;const ht=["application/xhtml+xml","text/html"],at="text/html";let vt=null,Vt=null;const rn=t.createElement("form"),xn=function(O){return O instanceof RegExp||O instanceof Function},zt=function(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Vt&&Vt===O)){if((!O||typeof O!="object")&&(O={}),O=Us(O),Ve=ht.indexOf(O.PARSER_MEDIA_TYPE)===-1?at:O.PARSER_MEDIA_TYPE,vt=Ve==="application/xhtml+xml"?l0:Dm,$=cs(O,"ALLOWED_TAGS")?Ht({},O.ALLOWED_TAGS,vt):ne,te=cs(O,"ALLOWED_ATTR")?Ht({},O.ALLOWED_ATTR,vt):_e,Kt=cs(O,"ALLOWED_NAMESPACES")?Ht({},O.ALLOWED_NAMESPACES,l0):wt,Nt=cs(O,"ADD_URI_SAFE_ATTR")?Ht(Us(bt),O.ADD_URI_SAFE_ATTR,vt):bt,xt=cs(O,"ADD_DATA_URI_TAGS")?Ht(Us(Ae),O.ADD_DATA_URI_TAGS,vt):Ae,Ge=cs(O,"FORBID_CONTENTS")?Ht({},O.FORBID_CONTENTS,vt):ot,Pe=cs(O,"FORBID_TAGS")?Ht({},O.FORBID_TAGS,vt):Us({}),we=cs(O,"FORBID_ATTR")?Ht({},O.FORBID_ATTR,vt):Us({}),ze=cs(O,"USE_PROFILES")?O.USE_PROFILES:!1,We=O.ALLOW_ARIA_ATTR!==!1,Ye=O.ALLOW_DATA_ATTR!==!1,It=O.ALLOW_UNKNOWN_PROTOCOLS||!1,fe=O.ALLOW_SELF_CLOSE_IN_ATTR!==!1,nn=O.SAFE_FOR_TEMPLATES||!1,st=O.SAFE_FOR_XML!==!1,ft=O.WHOLE_DOCUMENT||!1,mt=O.RETURN_DOM||!1,G=O.RETURN_DOM_FRAGMENT||!1,U=O.RETURN_TRUSTED_TYPE||!1,Xt=O.FORCE_BODY||!1,de=O.SANITIZE_DOM!==!1,Ie=O.SANITIZE_NAMED_PROPS||!1,De=O.KEEP_CONTENT!==!1,Xe=O.IN_PLACE||!1,ie=O.ALLOWED_URI_REGEXP||aN,ct=O.NAMESPACE||$e,Oe=O.MATHML_TEXT_INTEGRATION_POINTS||Oe,K=O.HTML_INTEGRATION_POINTS||K,Ee=O.CUSTOM_ELEMENT_HANDLING||{},O.CUSTOM_ELEMENT_HANDLING&&xn(O.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ee.tagNameCheck=O.CUSTOM_ELEMENT_HANDLING.tagNameCheck),O.CUSTOM_ELEMENT_HANDLING&&xn(O.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ee.attributeNameCheck=O.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),O.CUSTOM_ELEMENT_HANDLING&&typeof O.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ee.allowCustomizedBuiltInElements=O.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),nn&&(Ye=!1),G&&(mt=!0),ze&&($=Ht({},nC),te=[],ze.html===!0&&(Ht($,tC),Ht(te,rC)),ze.svg===!0&&(Ht($,u0),Ht(te,f0),Ht(te,hm)),ze.svgFilters===!0&&(Ht($,h0),Ht(te,f0),Ht(te,hm)),ze.mathMl===!0&&(Ht($,d0),Ht(te,iC),Ht(te,hm))),O.ADD_TAGS&&(typeof O.ADD_TAGS=="function"?ke.tagCheck=O.ADD_TAGS:($===ne&&($=Us($)),Ht($,O.ADD_TAGS,vt))),O.ADD_ATTR&&(typeof O.ADD_ATTR=="function"?ke.attributeCheck=O.ADD_ATTR:(te===_e&&(te=Us(te)),Ht(te,O.ADD_ATTR,vt))),O.ADD_URI_SAFE_ATTR&&Ht(Nt,O.ADD_URI_SAFE_ATTR,vt),O.FORBID_CONTENTS&&(Ge===ot&&(Ge=Us(Ge)),Ht(Ge,O.FORBID_CONTENTS,vt)),O.ADD_FORBID_CONTENTS&&(Ge===ot&&(Ge=Us(Ge)),Ht(Ge,O.ADD_FORBID_CONTENTS,vt)),De&&($["#text"]=!0),ft&&Ht($,["html","head","body"]),$.table&&(Ht($,["tbody"]),delete Pe.tbody),O.TRUSTED_TYPES_POLICY){if(typeof O.TRUSTED_TYPES_POLICY.createHTML!="function")throw rd('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof O.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw rd('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=O.TRUSTED_TYPES_POLICY,V=k.createHTML("")}else k===void 0&&(k=FZ(v,i)),k!==null&&typeof V=="string"&&(V=k.createHTML(""));Zr&&Zr(O),Vt=O}},cn=Ht({},[...u0,...h0,...bZ]),Dn=Ht({},[...d0,...RZ]),so=function(O){let ae=b(O);(!ae||!ae.tagName)&&(ae={namespaceURI:ct,tagName:"template"});const Se=Dm(O.tagName),Be=Dm(ae.tagName);return Kt[O.namespaceURI]?O.namespaceURI===rt?ae.namespaceURI===$e?Se==="svg":ae.namespaceURI===ut?Se==="svg"&&(Be==="annotation-xml"||Oe[Be]):!!cn[Se]:O.namespaceURI===ut?ae.namespaceURI===$e?Se==="math":ae.namespaceURI===rt?Se==="math"&&K[Be]:!!Dn[Se]:O.namespaceURI===$e?ae.namespaceURI===rt&&!K[Be]||ae.namespaceURI===ut&&!Oe[Be]?!1:!Dn[Se]&&(Le[Se]||!cn[Se]):!!(Ve==="application/xhtml+xml"&&Kt[O.namespaceURI]):!1},Ln=function(O){td(e.removed,{element:O});try{b(O).removeChild(O)}catch{E(O)}},wn=function(O,ae){try{td(e.removed,{attribute:ae.getAttributeNode(O),from:ae})}catch{td(e.removed,{attribute:null,from:ae})}if(ae.removeAttribute(O),O==="is")if(mt||G)try{Ln(ae)}catch{}else try{ae.setAttribute(O,"")}catch{}},Pi=function(O){let ae=null,Se=null;if(Xt)O="<remove></remove>"+O;else{const et=c0(O,/^[\r\n\t ]+/);Se=et&&et[0]}Ve==="application/xhtml+xml"&&ct===$e&&(O='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+O+"</body></html>");const Be=k?k.createHTML(O):O;if(ct===$e)try{ae=new _().parseFromString(Be,Ve)}catch{}if(!ae||!ae.documentElement){ae=H.createDocument(ct,"template",null);try{ae.documentElement.innerHTML=Ot?V:Be}catch{}}const Fe=ae.body||ae.documentElement;return O&&Se&&Fe.insertBefore(t.createTextNode(Se),Fe.childNodes[0]||null),ct===$e?M.call(ae,ft?"html":"body")[0]:ft?ae.documentElement:Fe},jn=function(O){return P.call(O.ownerDocument||O,O,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},Yi=function(O){return O instanceof m&&(typeof O.nodeName!="string"||typeof O.textContent!="string"||typeof O.removeChild!="function"||!(O.attributes instanceof f)||typeof O.removeAttribute!="function"||typeof O.setAttribute!="function"||typeof O.namespaceURI!="string"||typeof O.insertBefore!="function"||typeof O.hasChildNodes!="function")},vs=function(O){return typeof c=="function"&&O instanceof c};function pr(J,O,ae){um(J,Se=>{Se.call(e,O,ae,Vt)})}const Mr=function(O){let ae=null;if(pr(N.beforeSanitizeElements,O,null),Yi(O))return Ln(O),!0;const Se=vt(O.nodeName);if(pr(N.uponSanitizeElement,O,{tagName:Se,allowedTags:$}),st&&O.hasChildNodes()&&!vs(O.firstElementChild)&&$r(/<[/\w!]/g,O.innerHTML)&&$r(/<[/\w!]/g,O.textContent)||O.nodeType===sd.progressingInstruction||st&&O.nodeType===sd.comment&&$r(/<[/\w]/g,O.data))return Ln(O),!0;if(!(ke.tagCheck instanceof Function&&ke.tagCheck(Se))&&(!$[Se]||Pe[Se])){if(!Pe[Se]&&j(Se)&&(Ee.tagNameCheck instanceof RegExp&&$r(Ee.tagNameCheck,Se)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(Se)))return!1;if(De&&!Ge[Se]){const Be=b(O)||O.parentNode,Fe=D(O)||O.childNodes;if(Fe&&Be){const et=Fe.length;for(let tt=et-1;tt>=0;--tt){const dt=A(Fe[tt],!0);dt.__removalCount=(O.__removalCount||0)+1,Be.insertBefore(dt,S(O))}}}return Ln(O),!0}return O instanceof u&&!so(O)||(Se==="noscript"||Se==="noembed"||Se==="noframes")&&$r(/<\/no(script|embed|frames)/i,O.innerHTML)?(Ln(O),!0):(nn&&O.nodeType===sd.text&&(ae=O.textContent,um([W,F,Y],Be=>{ae=nd(ae,Be," ")}),O.textContent!==ae&&(td(e.removed,{element:O.cloneNode()}),O.textContent=ae)),pr(N.afterSanitizeElements,O,null),!1)},ys=function(O,ae,Se){if(de&&(ae==="id"||ae==="name")&&(Se in t||Se in rn))return!1;if(!(Ye&&!we[ae]&&$r(ue,ae))){if(!(We&&$r(ye,ae))){if(!(ke.attributeCheck instanceof Function&&ke.attributeCheck(ae,O))){if(!te[ae]||we[ae]){if(!(j(O)&&(Ee.tagNameCheck instanceof RegExp&&$r(Ee.tagNameCheck,O)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(O))&&(Ee.attributeNameCheck instanceof RegExp&&$r(Ee.attributeNameCheck,ae)||Ee.attributeNameCheck instanceof Function&&Ee.attributeNameCheck(ae,O))||ae==="is"&&Ee.allowCustomizedBuiltInElements&&(Ee.tagNameCheck instanceof RegExp&&$r(Ee.tagNameCheck,Se)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(Se))))return!1}else if(!Nt[ae]){if(!$r(ie,nd(Se,Q,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&O!=="script"&&xZ(Se,"data:")===0&&xt[O])){if(!(It&&!$r(ge,nd(Se,Q,"")))){if(Se)return!1}}}}}}}return!0},j=function(O){return O!=="annotation-xml"&&c0(O,re)},se=function(O){pr(N.beforeSanitizeAttributes,O,null);const{attributes:ae}=O;if(!ae||Yi(O))return;const Se={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:te,forceKeepAttr:void 0};let Be=ae.length;for(;Be--;){const Fe=ae[Be],{name:et,namespaceURI:tt,value:dt}=Fe,jt=vt(et),An=dt;let Dt=et==="value"?An:wZ(An);if(Se.attrName=jt,Se.attrValue=Dt,Se.keepAttr=!0,Se.forceKeepAttr=void 0,pr(N.uponSanitizeAttribute,O,Se),Dt=Se.attrValue,Ie&&(jt==="id"||jt==="name")&&(wn(et,O),Dt=Re+Dt),st&&$r(/((--!?|])>)|<\/(style|title|textarea)/i,Dt)){wn(et,O);continue}if(jt==="attributename"&&c0(Dt,"href")){wn(et,O);continue}if(Se.forceKeepAttr)continue;if(!Se.keepAttr){wn(et,O);continue}if(!fe&&$r(/\/>/i,Dt)){wn(et,O);continue}nn&&um([W,F,Y],kt=>{Dt=nd(Dt,kt," ")});const Wn=vt(O.nodeName);if(!ys(Wn,jt,Dt)){wn(et,O);continue}if(k&&typeof v=="object"&&typeof v.getAttributeType=="function"&&!tt)switch(v.getAttributeType(Wn,jt)){case"TrustedHTML":{Dt=k.createHTML(Dt);break}case"TrustedScriptURL":{Dt=k.createScriptURL(Dt);break}}if(Dt!==An)try{tt?O.setAttributeNS(tt,et,Dt):O.setAttribute(et,Dt),Yi(O)?Ln(O):eC(e.removed)}catch{wn(et,O)}}pr(N.afterSanitizeAttributes,O,null)},pe=function J(O){let ae=null;const Se=jn(O);for(pr(N.beforeSanitizeShadowDOM,O,null);ae=Se.nextNode();)pr(N.uponSanitizeShadowNode,ae,null),Mr(ae),se(ae),ae.content instanceof s&&J(ae.content);pr(N.afterSanitizeShadowDOM,O,null)};return e.sanitize=function(J){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae=null,Se=null,Be=null,Fe=null;if(Ot=!J,Ot&&(J="<!-->"),typeof J!="string"&&!vs(J))if(typeof J.toString=="function"){if(J=J.toString(),typeof J!="string")throw rd("dirty is not a string, aborting")}else throw rd("toString is not a function");if(!e.isSupported)return J;if(Qe||zt(O),e.removed=[],typeof J=="string"&&(Xe=!1),Xe){if(J.nodeName){const dt=vt(J.nodeName);if(!$[dt]||Pe[dt])throw rd("root node is forbidden and cannot be sanitized in-place")}}else if(J instanceof c)ae=Pi("<!---->"),Se=ae.ownerDocument.importNode(J,!0),Se.nodeType===sd.element&&Se.nodeName==="BODY"||Se.nodeName==="HTML"?ae=Se:ae.appendChild(Se);else{if(!mt&&!nn&&!ft&&J.indexOf("<")===-1)return k&&U?k.createHTML(J):J;if(ae=Pi(J),!ae)return mt?null:U?V:""}ae&&Xt&&Ln(ae.firstChild);const et=jn(Xe?J:ae);for(;Be=et.nextNode();)Mr(Be),se(Be),Be.content instanceof s&&pe(Be.content);if(Xe)return J;if(mt){if(G)for(Fe=I.call(ae.ownerDocument);ae.firstChild;)Fe.appendChild(ae.firstChild);else Fe=ae;return(te.shadowroot||te.shadowrootmode)&&(Fe=C.call(r,Fe,!0)),Fe}let tt=ft?ae.outerHTML:ae.innerHTML;return ft&&$["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&$r(lN,ae.ownerDocument.doctype.name)&&(tt="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+tt),nn&&um([W,F,Y],dt=>{tt=nd(tt,dt," ")}),k&&U?k.createHTML(tt):tt},e.setConfig=function(){let J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};zt(J),Qe=!0},e.clearConfig=function(){Vt=null,Qe=!1},e.isValidAttribute=function(J,O,ae){Vt||zt({});const Se=vt(J),Be=vt(O);return ys(Se,Be,ae)},e.addHook=function(J,O){typeof O=="function"&&td(N[J],O)},e.removeHook=function(J,O){if(O!==void 0){const ae=SZ(N[J],O);return ae===-1?void 0:TZ(N[J],ae,1)[0]}return eC(N[J])},e.removeHooks=function(J){N[J]=[]},e.removeAllHooks=function(){N=oC()},e}var VZ=cN();function Me(n,e,t){function r(c,u){if(c._zod||Object.defineProperty(c,"_zod",{value:{def:u,constr:a,traits:new Set},enumerable:!1}),c._zod.traits.has(n))return;c._zod.traits.add(n),e(c,u);const h=a.prototype,f=Object.keys(h);for(let m=0;m<f.length;m++){const _=f[m];_ in c||(c[_]=h[_].bind(c))}}const i=t?.Parent??Object;class s extends i{}Object.defineProperty(s,"name",{value:n});function a(c){var u;const h=t?.Parent?new s:this;r(h,c),(u=h._zod).deferred??(u.deferred=[]);for(const f of h._zod.deferred)f();return h}return Object.defineProperty(a,"init",{value:r}),Object.defineProperty(a,Symbol.hasInstance,{value:c=>t?.Parent&&c instanceof t.Parent?!0:c?._zod?.traits?.has(n)}),Object.defineProperty(a,"name",{value:n}),a}class Nu extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class uN extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const hN={};function rc(n){return hN}function dN(n){const e=Object.values(n).filter(r=>typeof r=="number");return Object.entries(n).filter(([r,i])=>e.indexOf(+r)===-1).map(([r,i])=>i)}function bE(n,e){return typeof e=="bigint"?e.toString():e}function PT(n){return{get value(){{const e=n();return Object.defineProperty(this,"value",{value:e}),e}}}}function IT(n){return n==null}function DT(n){const e=n.startsWith("^")?1:0,t=n.endsWith("$")?n.length-1:n.length;return n.slice(e,t)}const aC=Symbol("evaluating");function mn(n,e,t){let r;Object.defineProperty(n,e,{get(){if(r!==aC)return r===void 0&&(r=aC,r=t()),r},set(i){Object.defineProperty(n,e,{value:i})},configurable:!0})}function pc(n,e,t){Object.defineProperty(n,e,{value:t,writable:!0,enumerable:!0,configurable:!0})}function mc(...n){const e={};for(const t of n){const r=Object.getOwnPropertyDescriptors(t);Object.assign(e,r)}return Object.defineProperties({},e)}function lC(n){return JSON.stringify(n)}function zZ(n){return n.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const fN="captureStackTrace"in Error?Error.captureStackTrace:(...n)=>{};function gg(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}const BZ=PT(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const n=Function;return new n(""),!0}catch{return!1}});function Xd(n){if(gg(n)===!1)return!1;const e=n.constructor;if(e===void 0||typeof e!="function")return!0;const t=e.prototype;return!(gg(t)===!1||Object.prototype.hasOwnProperty.call(t,"isPrototypeOf")===!1)}function pN(n){return Xd(n)?{...n}:Array.isArray(n)?[...n]:n}const HZ=new Set(["string","number","symbol"]);function m_(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function sl(n,e,t){const r=new n._zod.constr(e??n._zod.def);return(!e||t?.parent)&&(r._zod.parent=n),r}function Mt(n){const e=n;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function GZ(n){return Object.keys(n).filter(e=>n[e]._zod.optin==="optional"&&n[e]._zod.optout==="optional")}function jZ(n,e){const t=n._zod.def,r=mc(n._zod.def,{get shape(){const i={};for(const s in e){if(!(s in t.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&(i[s]=t.shape[s])}return pc(this,"shape",i),i},checks:[]});return sl(n,r)}function WZ(n,e){const t=n._zod.def,r=mc(n._zod.def,{get shape(){const i={...n._zod.def.shape};for(const s in e){if(!(s in t.shape))throw new Error(`Unrecognized key: "${s}"`);e[s]&&delete i[s]}return pc(this,"shape",i),i},checks:[]});return sl(n,r)}function $Z(n,e){if(!Xd(e))throw new Error("Invalid input to extend: expected a plain object");const t=n._zod.def.checks;if(t&&t.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const i=mc(n._zod.def,{get shape(){const s={...n._zod.def.shape,...e};return pc(this,"shape",s),s},checks:[]});return sl(n,i)}function qZ(n,e){if(!Xd(e))throw new Error("Invalid input to safeExtend: expected a plain object");const t={...n._zod.def,get shape(){const r={...n._zod.def.shape,...e};return pc(this,"shape",r),r},checks:n._zod.def.checks};return sl(n,t)}function XZ(n,e){const t=mc(n._zod.def,{get shape(){const r={...n._zod.def.shape,...e._zod.def.shape};return pc(this,"shape",r),r},get catchall(){return e._zod.def.catchall},checks:[]});return sl(n,t)}function KZ(n,e,t){const r=mc(e._zod.def,{get shape(){const i=e._zod.def.shape,s={...i};if(t)for(const a in t){if(!(a in i))throw new Error(`Unrecognized key: "${a}"`);t[a]&&(s[a]=n?new n({type:"optional",innerType:i[a]}):i[a])}else for(const a in i)s[a]=n?new n({type:"optional",innerType:i[a]}):i[a];return pc(this,"shape",s),s},checks:[]});return sl(e,r)}function YZ(n,e,t){const r=mc(e._zod.def,{get shape(){const i=e._zod.def.shape,s={...i};if(t)for(const a in t){if(!(a in s))throw new Error(`Unrecognized key: "${a}"`);t[a]&&(s[a]=new n({type:"nonoptional",innerType:i[a]}))}else for(const a in i)s[a]=new n({type:"nonoptional",innerType:i[a]});return pc(this,"shape",s),s},checks:[]});return sl(e,r)}function bu(n,e=0){if(n.aborted===!0)return!0;for(let t=e;t<n.issues.length;t++)if(n.issues[t]?.continue!==!0)return!0;return!1}function mN(n,e){return e.map(t=>{var r;return(r=t).path??(r.path=[]),t.path.unshift(n),t})}function dm(n){return typeof n=="string"?n:n?.message}function ic(n,e,t){const r={...n,path:n.path??[]};if(!n.message){const i=dm(n.inst?._zod.def?.error?.(n))??dm(e?.error?.(n))??dm(t.customError?.(n))??dm(t.localeError?.(n))??"Invalid input";r.message=i}return delete r.inst,delete r.continue,e?.reportInput||delete r.input,r}function LT(n){return Array.isArray(n)?"array":typeof n=="string"?"string":"unknown"}function Kd(...n){const[e,t,r]=n;return typeof e=="string"?{message:e,code:"custom",input:t,inst:r}:{...e}}const gN=(n,e)=>{n.name="$ZodError",Object.defineProperty(n,"_zod",{value:n._zod,enumerable:!1}),Object.defineProperty(n,"issues",{value:e,enumerable:!1}),n.message=JSON.stringify(e,bE,2),Object.defineProperty(n,"toString",{value:()=>n.message,enumerable:!1})},_N=Me("$ZodError",gN),vN=Me("$ZodError",gN,{Parent:Error});function ZZ(n,e=t=>t.message){const t={},r=[];for(const i of n.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:t}}function QZ(n,e=t=>t.message){const t={_errors:[]},r=i=>{for(const s of i.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(a=>r({issues:a}));else if(s.code==="invalid_key")r({issues:s.issues});else if(s.code==="invalid_element")r({issues:s.issues});else if(s.path.length===0)t._errors.push(e(s));else{let a=t,c=0;for(;c<s.path.length;){const u=s.path[c];c===s.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(e(s))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return r(n),t}const NT=n=>(e,t,r,i)=>{const s=r?Object.assign(r,{async:!1}):{async:!1},a=e._zod.run({value:t,issues:[]},s);if(a instanceof Promise)throw new Nu;if(a.issues.length){const c=new(i?.Err??n)(a.issues.map(u=>ic(u,s,rc())));throw fN(c,i?.callee),c}return a.value},OT=n=>async(e,t,r,i)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let a=e._zod.run({value:t,issues:[]},s);if(a instanceof Promise&&(a=await a),a.issues.length){const c=new(i?.Err??n)(a.issues.map(u=>ic(u,s,rc())));throw fN(c,i?.callee),c}return a.value},g_=n=>(e,t,r)=>{const i=r?{...r,async:!1}:{async:!1},s=e._zod.run({value:t,issues:[]},i);if(s instanceof Promise)throw new Nu;return s.issues.length?{success:!1,error:new(n??_N)(s.issues.map(a=>ic(a,i,rc())))}:{success:!0,data:s.value}},JZ=g_(vN),__=n=>async(e,t,r)=>{const i=r?Object.assign(r,{async:!0}):{async:!0};let s=e._zod.run({value:t,issues:[]},i);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new n(s.issues.map(a=>ic(a,i,rc())))}:{success:!0,data:s.value}},eQ=__(vN),tQ=n=>(e,t,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return NT(n)(e,t,i)},nQ=n=>(e,t,r)=>NT(n)(e,t,r),rQ=n=>async(e,t,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return OT(n)(e,t,i)},iQ=n=>async(e,t,r)=>OT(n)(e,t,r),sQ=n=>(e,t,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return g_(n)(e,t,i)},oQ=n=>(e,t,r)=>g_(n)(e,t,r),aQ=n=>async(e,t,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return __(n)(e,t,i)},lQ=n=>async(e,t,r)=>__(n)(e,t,r),cQ=/^[cC][^\s-]{8,}$/,uQ=/^[0-9a-z]+$/,hQ=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,dQ=/^[0-9a-vA-V]{20}$/,fQ=/^[A-Za-z0-9]{27}$/,pQ=/^[a-zA-Z0-9_-]{21}$/,mQ=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,gQ=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,cC=n=>n?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${n}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,_Q=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,vQ="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function yQ(){return new RegExp(vQ,"u")}const EQ=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,SQ=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,TQ=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,xQ=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,wQ=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,yN=/^[A-Za-z0-9_-]*$/,AQ=/^\+(?:[0-9]){6,14}[0-9]$/,EN="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",MQ=new RegExp(`^${EN}$`);function SN(n){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof n.precision=="number"?n.precision===-1?`${e}`:n.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${n.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function bQ(n){return new RegExp(`^${SN(n)}$`)}function RQ(n){const e=SN({precision:n.precision}),t=["Z"];n.local&&t.push(""),n.offset&&t.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${e}(?:${t.join("|")})`;return new RegExp(`^${EN}T(?:${r})$`)}const CQ=n=>{const e=n?`[\\s\\S]{${n?.minimum??0},${n?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},PQ=/^[^A-Z]*$/,IQ=/^[^a-z]*$/,io=Me("$ZodCheck",(n,e)=>{var t;n._zod??(n._zod={}),n._zod.def=e,(t=n._zod).onattach??(t.onattach=[])}),DQ=Me("$ZodCheckMaxLength",(n,e)=>{var t;io.init(n,e),(t=n._zod.def).when??(t.when=r=>{const i=r.value;return!IT(i)&&i.length!==void 0}),n._zod.onattach.push(r=>{const i=r._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(r._zod.bag.maximum=e.maximum)}),n._zod.check=r=>{const i=r.value;if(i.length<=e.maximum)return;const a=LT(i);r.issues.push({origin:a,code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:n,continue:!e.abort})}}),LQ=Me("$ZodCheckMinLength",(n,e)=>{var t;io.init(n,e),(t=n._zod.def).when??(t.when=r=>{const i=r.value;return!IT(i)&&i.length!==void 0}),n._zod.onattach.push(r=>{const i=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(r._zod.bag.minimum=e.minimum)}),n._zod.check=r=>{const i=r.value;if(i.length>=e.minimum)return;const a=LT(i);r.issues.push({origin:a,code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:n,continue:!e.abort})}}),NQ=Me("$ZodCheckLengthEquals",(n,e)=>{var t;io.init(n,e),(t=n._zod.def).when??(t.when=r=>{const i=r.value;return!IT(i)&&i.length!==void 0}),n._zod.onattach.push(r=>{const i=r._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),n._zod.check=r=>{const i=r.value,s=i.length;if(s===e.length)return;const a=LT(i),c=s>e.length;r.issues.push({origin:a,...c?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:r.value,inst:n,continue:!e.abort})}}),v_=Me("$ZodCheckStringFormat",(n,e)=>{var t,r;io.init(n,e),n._zod.onattach.push(i=>{const s=i._zod.bag;s.format=e.format,e.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(e.pattern))}),e.pattern?(t=n._zod).check??(t.check=i=>{e.pattern.lastIndex=0,!e.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:n,continue:!e.abort})}):(r=n._zod).check??(r.check=()=>{})}),OQ=Me("$ZodCheckRegex",(n,e)=>{v_.init(n,e),n._zod.check=t=>{e.pattern.lastIndex=0,!e.pattern.test(t.value)&&t.issues.push({origin:"string",code:"invalid_format",format:"regex",input:t.value,pattern:e.pattern.toString(),inst:n,continue:!e.abort})}}),kQ=Me("$ZodCheckLowerCase",(n,e)=>{e.pattern??(e.pattern=PQ),v_.init(n,e)}),UQ=Me("$ZodCheckUpperCase",(n,e)=>{e.pattern??(e.pattern=IQ),v_.init(n,e)}),FQ=Me("$ZodCheckIncludes",(n,e)=>{io.init(n,e);const t=m_(e.includes),r=new RegExp(typeof e.position=="number"?`^.{${e.position}}${t}`:t);e.pattern=r,n._zod.onattach.push(i=>{const s=i._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(r)}),n._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:n,continue:!e.abort})}}),VQ=Me("$ZodCheckStartsWith",(n,e)=>{io.init(n,e);const t=new RegExp(`^${m_(e.prefix)}.*`);e.pattern??(e.pattern=t),n._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(t)}),n._zod.check=r=>{r.value.startsWith(e.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:r.value,inst:n,continue:!e.abort})}}),zQ=Me("$ZodCheckEndsWith",(n,e)=>{io.init(n,e);const t=new RegExp(`.*${m_(e.suffix)}$`);e.pattern??(e.pattern=t),n._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(t)}),n._zod.check=r=>{r.value.endsWith(e.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:r.value,inst:n,continue:!e.abort})}}),BQ=Me("$ZodCheckOverwrite",(n,e)=>{io.init(n,e),n._zod.check=t=>{t.value=e.tx(t.value)}});class HQ{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const r=e.split(`
`).filter(a=>a),i=Math.min(...r.map(a=>a.length-a.trimStart().length)),s=r.map(a=>a.slice(i)).map(a=>" ".repeat(this.indent*2)+a);for(const a of s)this.content.push(a)}compile(){const e=Function,t=this?.args,i=[...(this?.content??[""]).map(s=>`  ${s}`)];return new e(...t,i.join(`
`))}}const GQ={major:4,minor:2,patch:1},or=Me("$ZodType",(n,e)=>{var t;n??(n={}),n._zod.def=e,n._zod.bag=n._zod.bag||{},n._zod.version=GQ;const r=[...n._zod.def.checks??[]];n._zod.traits.has("$ZodCheck")&&r.unshift(n);for(const i of r)for(const s of i._zod.onattach)s(n);if(r.length===0)(t=n._zod).deferred??(t.deferred=[]),n._zod.deferred?.push(()=>{n._zod.run=n._zod.parse});else{const i=(a,c,u)=>{let h=bu(a),f;for(const m of c){if(m._zod.def.when){if(!m._zod.def.when(a))continue}else if(h)continue;const _=a.issues.length,v=m._zod.check(a);if(v instanceof Promise&&u?.async===!1)throw new Nu;if(f||v instanceof Promise)f=(f??Promise.resolve()).then(async()=>{await v,a.issues.length!==_&&(h||(h=bu(a,_)))});else{if(a.issues.length===_)continue;h||(h=bu(a,_))}}return f?f.then(()=>a):a},s=(a,c,u)=>{if(bu(a))return a.aborted=!0,a;const h=i(c,r,u);if(h instanceof Promise){if(u.async===!1)throw new Nu;return h.then(f=>n._zod.parse(f,u))}return n._zod.parse(h,u)};n._zod.run=(a,c)=>{if(c.skipChecks)return n._zod.parse(a,c);if(c.direction==="backward"){const h=n._zod.parse({value:a.value,issues:[]},{...c,skipChecks:!0});return h instanceof Promise?h.then(f=>s(f,a,c)):s(h,a,c)}const u=n._zod.parse(a,c);if(u instanceof Promise){if(c.async===!1)throw new Nu;return u.then(h=>i(h,r,c))}return i(u,r,c)}}n["~standard"]={validate:i=>{try{const s=JZ(n,i);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return eQ(n,i).then(a=>a.success?{value:a.data}:{issues:a.error?.issues})}},vendor:"zod",version:1}}),kT=Me("$ZodString",(n,e)=>{or.init(n,e),n._zod.pattern=[...n?._zod.bag?.patterns??[]].pop()??CQ(n._zod.bag),n._zod.parse=(t,r)=>{if(e.coerce)try{t.value=String(t.value)}catch{}return typeof t.value=="string"||t.issues.push({expected:"string",code:"invalid_type",input:t.value,inst:n}),t}}),Tn=Me("$ZodStringFormat",(n,e)=>{v_.init(n,e),kT.init(n,e)}),jQ=Me("$ZodGUID",(n,e)=>{e.pattern??(e.pattern=gQ),Tn.init(n,e)}),WQ=Me("$ZodUUID",(n,e)=>{if(e.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(r===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=cC(r))}else e.pattern??(e.pattern=cC());Tn.init(n,e)}),$Q=Me("$ZodEmail",(n,e)=>{e.pattern??(e.pattern=_Q),Tn.init(n,e)}),qQ=Me("$ZodURL",(n,e)=>{Tn.init(n,e),n._zod.check=t=>{try{const r=t.value.trim(),i=new URL(r);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(i.hostname)||t.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:e.hostname.source,input:t.value,inst:n,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||t.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:t.value,inst:n,continue:!e.abort})),e.normalize?t.value=i.href:t.value=r;return}catch{t.issues.push({code:"invalid_format",format:"url",input:t.value,inst:n,continue:!e.abort})}}}),XQ=Me("$ZodEmoji",(n,e)=>{e.pattern??(e.pattern=yQ()),Tn.init(n,e)}),KQ=Me("$ZodNanoID",(n,e)=>{e.pattern??(e.pattern=pQ),Tn.init(n,e)}),YQ=Me("$ZodCUID",(n,e)=>{e.pattern??(e.pattern=cQ),Tn.init(n,e)}),ZQ=Me("$ZodCUID2",(n,e)=>{e.pattern??(e.pattern=uQ),Tn.init(n,e)}),QQ=Me("$ZodULID",(n,e)=>{e.pattern??(e.pattern=hQ),Tn.init(n,e)}),JQ=Me("$ZodXID",(n,e)=>{e.pattern??(e.pattern=dQ),Tn.init(n,e)}),eJ=Me("$ZodKSUID",(n,e)=>{e.pattern??(e.pattern=fQ),Tn.init(n,e)}),tJ=Me("$ZodISODateTime",(n,e)=>{e.pattern??(e.pattern=RQ(e)),Tn.init(n,e)}),nJ=Me("$ZodISODate",(n,e)=>{e.pattern??(e.pattern=MQ),Tn.init(n,e)}),rJ=Me("$ZodISOTime",(n,e)=>{e.pattern??(e.pattern=bQ(e)),Tn.init(n,e)}),iJ=Me("$ZodISODuration",(n,e)=>{e.pattern??(e.pattern=mQ),Tn.init(n,e)}),sJ=Me("$ZodIPv4",(n,e)=>{e.pattern??(e.pattern=EQ),Tn.init(n,e),n._zod.bag.format="ipv4"}),oJ=Me("$ZodIPv6",(n,e)=>{e.pattern??(e.pattern=SQ),Tn.init(n,e),n._zod.bag.format="ipv6",n._zod.check=t=>{try{new URL(`http://[${t.value}]`)}catch{t.issues.push({code:"invalid_format",format:"ipv6",input:t.value,inst:n,continue:!e.abort})}}}),aJ=Me("$ZodCIDRv4",(n,e)=>{e.pattern??(e.pattern=TQ),Tn.init(n,e)}),lJ=Me("$ZodCIDRv6",(n,e)=>{e.pattern??(e.pattern=xQ),Tn.init(n,e),n._zod.check=t=>{const r=t.value.split("/");try{if(r.length!==2)throw new Error;const[i,s]=r;if(!s)throw new Error;const a=Number(s);if(`${a}`!==s)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${i}]`)}catch{t.issues.push({code:"invalid_format",format:"cidrv6",input:t.value,inst:n,continue:!e.abort})}}});function TN(n){if(n==="")return!0;if(n.length%4!==0)return!1;try{return atob(n),!0}catch{return!1}}const cJ=Me("$ZodBase64",(n,e)=>{e.pattern??(e.pattern=wQ),Tn.init(n,e),n._zod.bag.contentEncoding="base64",n._zod.check=t=>{TN(t.value)||t.issues.push({code:"invalid_format",format:"base64",input:t.value,inst:n,continue:!e.abort})}});function uJ(n){if(!yN.test(n))return!1;const e=n.replace(/[-_]/g,r=>r==="-"?"+":"/"),t=e.padEnd(Math.ceil(e.length/4)*4,"=");return TN(t)}const hJ=Me("$ZodBase64URL",(n,e)=>{e.pattern??(e.pattern=yN),Tn.init(n,e),n._zod.bag.contentEncoding="base64url",n._zod.check=t=>{uJ(t.value)||t.issues.push({code:"invalid_format",format:"base64url",input:t.value,inst:n,continue:!e.abort})}}),dJ=Me("$ZodE164",(n,e)=>{e.pattern??(e.pattern=AQ),Tn.init(n,e)});function fJ(n,e=null){try{const t=n.split(".");if(t.length!==3)return!1;const[r]=t;if(!r)return!1;const i=JSON.parse(atob(r));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||e&&(!("alg"in i)||i.alg!==e))}catch{return!1}}const pJ=Me("$ZodJWT",(n,e)=>{Tn.init(n,e),n._zod.check=t=>{fJ(t.value,e.alg)||t.issues.push({code:"invalid_format",format:"jwt",input:t.value,inst:n,continue:!e.abort})}}),mJ=Me("$ZodUnknown",(n,e)=>{or.init(n,e),n._zod.parse=t=>t}),gJ=Me("$ZodNever",(n,e)=>{or.init(n,e),n._zod.parse=(t,r)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:n}),t)});function uC(n,e,t){n.issues.length&&e.issues.push(...mN(t,n.issues)),e.value[t]=n.value}const _J=Me("$ZodArray",(n,e)=>{or.init(n,e),n._zod.parse=(t,r)=>{const i=t.value;if(!Array.isArray(i))return t.issues.push({expected:"array",code:"invalid_type",input:i,inst:n}),t;t.value=Array(i.length);const s=[];for(let a=0;a<i.length;a++){const c=i[a],u=e.element._zod.run({value:c,issues:[]},r);u instanceof Promise?s.push(u.then(h=>uC(h,t,a))):uC(u,t,a)}return s.length?Promise.all(s).then(()=>t):t}});function _g(n,e,t,r){n.issues.length&&e.issues.push(...mN(t,n.issues)),n.value===void 0?t in r&&(e.value[t]=void 0):e.value[t]=n.value}function xN(n){const e=Object.keys(n.shape);for(const r of e)if(!n.shape?.[r]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${r}": expected a Zod schema`);const t=GZ(n.shape);return{...n,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(t)}}function wN(n,e,t,r,i,s){const a=[],c=i.keySet,u=i.catchall._zod,h=u.def.type;for(const f in e){if(c.has(f))continue;if(h==="never"){a.push(f);continue}const m=u.run({value:e[f],issues:[]},r);m instanceof Promise?n.push(m.then(_=>_g(_,t,f,e))):_g(m,t,f,e)}return a.length&&t.issues.push({code:"unrecognized_keys",keys:a,input:e,inst:s}),n.length?Promise.all(n).then(()=>t):t}const vJ=Me("$ZodObject",(n,e)=>{if(or.init(n,e),!Object.getOwnPropertyDescriptor(e,"shape")?.get){const c=e.shape;Object.defineProperty(e,"shape",{get:()=>{const u={...c};return Object.defineProperty(e,"shape",{value:u}),u}})}const r=PT(()=>xN(e));mn(n._zod,"propValues",()=>{const c=e.shape,u={};for(const h in c){const f=c[h]._zod;if(f.values){u[h]??(u[h]=new Set);for(const m of f.values)u[h].add(m)}}return u});const i=gg,s=e.catchall;let a;n._zod.parse=(c,u)=>{a??(a=r.value);const h=c.value;if(!i(h))return c.issues.push({expected:"object",code:"invalid_type",input:h,inst:n}),c;c.value={};const f=[],m=a.shape;for(const _ of a.keys){const T=m[_]._zod.run({value:h[_],issues:[]},u);T instanceof Promise?f.push(T.then(A=>_g(A,c,_,h))):_g(T,c,_,h)}return s?wN(f,h,c,u,r.value,n):f.length?Promise.all(f).then(()=>c):c}}),yJ=Me("$ZodObjectJIT",(n,e)=>{vJ.init(n,e);const t=n._zod.parse,r=PT(()=>xN(e)),i=_=>{const v=new HQ(["shape","payload","ctx"]),T=r.value,A=b=>{const k=lC(b);return`shape[${k}]._zod.run({ value: input[${k}], issues: [] }, ctx)`};v.write("const input = payload.value;");const E=Object.create(null);let S=0;for(const b of T.keys)E[b]=`key_${S++}`;v.write("const newResult = {};");for(const b of T.keys){const k=E[b],V=lC(b);v.write(`const ${k} = ${A(b)};`),v.write(`
        if (${k}.issues.length) {
          payload.issues = payload.issues.concat(${k}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${V}, ...iss.path] : [${V}]
          })));
        }
        
        
        if (${k}.value === undefined) {
          if (${V} in input) {
            newResult[${V}] = undefined;
          }
        } else {
          newResult[${V}] = ${k}.value;
        }
        
      `)}v.write("payload.value = newResult;"),v.write("return payload;");const D=v.compile();return(b,k)=>D(_,b,k)};let s;const a=gg,c=!hN.jitless,h=c&&BZ.value,f=e.catchall;let m;n._zod.parse=(_,v)=>{m??(m=r.value);const T=_.value;return a(T)?c&&h&&v?.async===!1&&v.jitless!==!0?(s||(s=i(e.shape)),_=s(_,v),f?wN([],T,_,v,m,n):_):t(_,v):(_.issues.push({expected:"object",code:"invalid_type",input:T,inst:n}),_)}});function hC(n,e,t,r){for(const s of n)if(s.issues.length===0)return e.value=s.value,e;const i=n.filter(s=>!bu(s));return i.length===1?(e.value=i[0].value,i[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:t,errors:n.map(s=>s.issues.map(a=>ic(a,r,rc())))}),e)}const EJ=Me("$ZodUnion",(n,e)=>{or.init(n,e),mn(n._zod,"optin",()=>e.options.some(i=>i._zod.optin==="optional")?"optional":void 0),mn(n._zod,"optout",()=>e.options.some(i=>i._zod.optout==="optional")?"optional":void 0),mn(n._zod,"values",()=>{if(e.options.every(i=>i._zod.values))return new Set(e.options.flatMap(i=>Array.from(i._zod.values)))}),mn(n._zod,"pattern",()=>{if(e.options.every(i=>i._zod.pattern)){const i=e.options.map(s=>s._zod.pattern);return new RegExp(`^(${i.map(s=>DT(s.source)).join("|")})$`)}});const t=e.options.length===1,r=e.options[0]._zod.run;n._zod.parse=(i,s)=>{if(t)return r(i,s);let a=!1;const c=[];for(const u of e.options){const h=u._zod.run({value:i.value,issues:[]},s);if(h instanceof Promise)c.push(h),a=!0;else{if(h.issues.length===0)return h;c.push(h)}}return a?Promise.all(c).then(u=>hC(u,i,n,s)):hC(c,i,n,s)}}),SJ=Me("$ZodIntersection",(n,e)=>{or.init(n,e),n._zod.parse=(t,r)=>{const i=t.value,s=e.left._zod.run({value:i,issues:[]},r),a=e.right._zod.run({value:i,issues:[]},r);return s instanceof Promise||a instanceof Promise?Promise.all([s,a]).then(([u,h])=>dC(t,u,h)):dC(t,s,a)}});function RE(n,e){if(n===e)return{valid:!0,data:n};if(n instanceof Date&&e instanceof Date&&+n==+e)return{valid:!0,data:n};if(Xd(n)&&Xd(e)){const t=Object.keys(e),r=Object.keys(n).filter(s=>t.indexOf(s)!==-1),i={...n,...e};for(const s of r){const a=RE(n[s],e[s]);if(!a.valid)return{valid:!1,mergeErrorPath:[s,...a.mergeErrorPath]};i[s]=a.data}return{valid:!0,data:i}}if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return{valid:!1,mergeErrorPath:[]};const t=[];for(let r=0;r<n.length;r++){const i=n[r],s=e[r],a=RE(i,s);if(!a.valid)return{valid:!1,mergeErrorPath:[r,...a.mergeErrorPath]};t.push(a.data)}return{valid:!0,data:t}}return{valid:!1,mergeErrorPath:[]}}function dC(n,e,t){if(e.issues.length&&n.issues.push(...e.issues),t.issues.length&&n.issues.push(...t.issues),bu(n))return n;const r=RE(e.value,t.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return n.value=r.data,n}const TJ=Me("$ZodEnum",(n,e)=>{or.init(n,e);const t=dN(e.entries),r=new Set(t);n._zod.values=r,n._zod.pattern=new RegExp(`^(${t.filter(i=>HZ.has(typeof i)).map(i=>typeof i=="string"?m_(i):i.toString()).join("|")})$`),n._zod.parse=(i,s)=>{const a=i.value;return r.has(a)||i.issues.push({code:"invalid_value",values:t,input:a,inst:n}),i}}),xJ=Me("$ZodTransform",(n,e)=>{or.init(n,e),n._zod.parse=(t,r)=>{if(r.direction==="backward")throw new uN(n.constructor.name);const i=e.transform(t.value,t);if(r.async)return(i instanceof Promise?i:Promise.resolve(i)).then(a=>(t.value=a,t));if(i instanceof Promise)throw new Nu;return t.value=i,t}});function fC(n,e){return n.issues.length&&e===void 0?{issues:[],value:void 0}:n}const wJ=Me("$ZodOptional",(n,e)=>{or.init(n,e),n._zod.optin="optional",n._zod.optout="optional",mn(n._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),mn(n._zod,"pattern",()=>{const t=e.innerType._zod.pattern;return t?new RegExp(`^(${DT(t.source)})?$`):void 0}),n._zod.parse=(t,r)=>{if(e.innerType._zod.optin==="optional"){const i=e.innerType._zod.run(t,r);return i instanceof Promise?i.then(s=>fC(s,t.value)):fC(i,t.value)}return t.value===void 0?t:e.innerType._zod.run(t,r)}}),AJ=Me("$ZodNullable",(n,e)=>{or.init(n,e),mn(n._zod,"optin",()=>e.innerType._zod.optin),mn(n._zod,"optout",()=>e.innerType._zod.optout),mn(n._zod,"pattern",()=>{const t=e.innerType._zod.pattern;return t?new RegExp(`^(${DT(t.source)}|null)$`):void 0}),mn(n._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),n._zod.parse=(t,r)=>t.value===null?t:e.innerType._zod.run(t,r)}),MJ=Me("$ZodDefault",(n,e)=>{or.init(n,e),n._zod.optin="optional",mn(n._zod,"values",()=>e.innerType._zod.values),n._zod.parse=(t,r)=>{if(r.direction==="backward")return e.innerType._zod.run(t,r);if(t.value===void 0)return t.value=e.defaultValue,t;const i=e.innerType._zod.run(t,r);return i instanceof Promise?i.then(s=>pC(s,e)):pC(i,e)}});function pC(n,e){return n.value===void 0&&(n.value=e.defaultValue),n}const bJ=Me("$ZodPrefault",(n,e)=>{or.init(n,e),n._zod.optin="optional",mn(n._zod,"values",()=>e.innerType._zod.values),n._zod.parse=(t,r)=>(r.direction==="backward"||t.value===void 0&&(t.value=e.defaultValue),e.innerType._zod.run(t,r))}),RJ=Me("$ZodNonOptional",(n,e)=>{or.init(n,e),mn(n._zod,"values",()=>{const t=e.innerType._zod.values;return t?new Set([...t].filter(r=>r!==void 0)):void 0}),n._zod.parse=(t,r)=>{const i=e.innerType._zod.run(t,r);return i instanceof Promise?i.then(s=>mC(s,n)):mC(i,n)}});function mC(n,e){return!n.issues.length&&n.value===void 0&&n.issues.push({code:"invalid_type",expected:"nonoptional",input:n.value,inst:e}),n}const CJ=Me("$ZodCatch",(n,e)=>{or.init(n,e),mn(n._zod,"optin",()=>e.innerType._zod.optin),mn(n._zod,"optout",()=>e.innerType._zod.optout),mn(n._zod,"values",()=>e.innerType._zod.values),n._zod.parse=(t,r)=>{if(r.direction==="backward")return e.innerType._zod.run(t,r);const i=e.innerType._zod.run(t,r);return i instanceof Promise?i.then(s=>(t.value=s.value,s.issues.length&&(t.value=e.catchValue({...t,error:{issues:s.issues.map(a=>ic(a,r,rc()))},input:t.value}),t.issues=[]),t)):(t.value=i.value,i.issues.length&&(t.value=e.catchValue({...t,error:{issues:i.issues.map(s=>ic(s,r,rc()))},input:t.value}),t.issues=[]),t)}}),PJ=Me("$ZodPipe",(n,e)=>{or.init(n,e),mn(n._zod,"values",()=>e.in._zod.values),mn(n._zod,"optin",()=>e.in._zod.optin),mn(n._zod,"optout",()=>e.out._zod.optout),mn(n._zod,"propValues",()=>e.in._zod.propValues),n._zod.parse=(t,r)=>{if(r.direction==="backward"){const s=e.out._zod.run(t,r);return s instanceof Promise?s.then(a=>fm(a,e.in,r)):fm(s,e.in,r)}const i=e.in._zod.run(t,r);return i instanceof Promise?i.then(s=>fm(s,e.out,r)):fm(i,e.out,r)}});function fm(n,e,t){return n.issues.length?(n.aborted=!0,n):e._zod.run({value:n.value,issues:n.issues},t)}const IJ=Me("$ZodReadonly",(n,e)=>{or.init(n,e),mn(n._zod,"propValues",()=>e.innerType._zod.propValues),mn(n._zod,"values",()=>e.innerType._zod.values),mn(n._zod,"optin",()=>e.innerType?._zod?.optin),mn(n._zod,"optout",()=>e.innerType?._zod?.optout),n._zod.parse=(t,r)=>{if(r.direction==="backward")return e.innerType._zod.run(t,r);const i=e.innerType._zod.run(t,r);return i instanceof Promise?i.then(gC):gC(i)}});function gC(n){return n.value=Object.freeze(n.value),n}const DJ=Me("$ZodCustom",(n,e)=>{io.init(n,e),or.init(n,e),n._zod.parse=(t,r)=>t,n._zod.check=t=>{const r=t.value,i=e.fn(r);if(i instanceof Promise)return i.then(s=>_C(s,t,r,n));_C(i,t,r,n)}});function _C(n,e,t,r){if(!n){const i={code:"custom",input:t,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(i.params=r._zod.def.params),e.issues.push(Kd(i))}}var vC;class LJ{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...t){const r=t[0];if(this._map.set(e,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const t=this._map.get(e);return t&&typeof t=="object"&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){const t=e._zod.parent;if(t){const r={...this.get(t)??{}};delete r.id;const i={...r,...this._map.get(e)};return Object.keys(i).length?i:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function NJ(){return new LJ}(vC=globalThis).__zod_globalRegistry??(vC.__zod_globalRegistry=NJ());const md=globalThis.__zod_globalRegistry;function OJ(n,e){return new n({type:"string",...Mt(e)})}function kJ(n,e){return new n({type:"string",format:"email",check:"string_format",abort:!1,...Mt(e)})}function yC(n,e){return new n({type:"string",format:"guid",check:"string_format",abort:!1,...Mt(e)})}function UJ(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,...Mt(e)})}function FJ(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...Mt(e)})}function VJ(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...Mt(e)})}function zJ(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...Mt(e)})}function BJ(n,e){return new n({type:"string",format:"url",check:"string_format",abort:!1,...Mt(e)})}function HJ(n,e){return new n({type:"string",format:"emoji",check:"string_format",abort:!1,...Mt(e)})}function GJ(n,e){return new n({type:"string",format:"nanoid",check:"string_format",abort:!1,...Mt(e)})}function jJ(n,e){return new n({type:"string",format:"cuid",check:"string_format",abort:!1,...Mt(e)})}function WJ(n,e){return new n({type:"string",format:"cuid2",check:"string_format",abort:!1,...Mt(e)})}function $J(n,e){return new n({type:"string",format:"ulid",check:"string_format",abort:!1,...Mt(e)})}function qJ(n,e){return new n({type:"string",format:"xid",check:"string_format",abort:!1,...Mt(e)})}function XJ(n,e){return new n({type:"string",format:"ksuid",check:"string_format",abort:!1,...Mt(e)})}function KJ(n,e){return new n({type:"string",format:"ipv4",check:"string_format",abort:!1,...Mt(e)})}function YJ(n,e){return new n({type:"string",format:"ipv6",check:"string_format",abort:!1,...Mt(e)})}function ZJ(n,e){return new n({type:"string",format:"cidrv4",check:"string_format",abort:!1,...Mt(e)})}function QJ(n,e){return new n({type:"string",format:"cidrv6",check:"string_format",abort:!1,...Mt(e)})}function JJ(n,e){return new n({type:"string",format:"base64",check:"string_format",abort:!1,...Mt(e)})}function eee(n,e){return new n({type:"string",format:"base64url",check:"string_format",abort:!1,...Mt(e)})}function tee(n,e){return new n({type:"string",format:"e164",check:"string_format",abort:!1,...Mt(e)})}function nee(n,e){return new n({type:"string",format:"jwt",check:"string_format",abort:!1,...Mt(e)})}function ree(n,e){return new n({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...Mt(e)})}function iee(n,e){return new n({type:"string",format:"date",check:"string_format",...Mt(e)})}function see(n,e){return new n({type:"string",format:"time",check:"string_format",precision:null,...Mt(e)})}function oee(n,e){return new n({type:"string",format:"duration",check:"string_format",...Mt(e)})}function aee(n){return new n({type:"unknown"})}function lee(n,e){return new n({type:"never",...Mt(e)})}function AN(n,e){return new DQ({check:"max_length",...Mt(e),maximum:n})}function vg(n,e){return new LQ({check:"min_length",...Mt(e),minimum:n})}function MN(n,e){return new NQ({check:"length_equals",...Mt(e),length:n})}function cee(n,e){return new OQ({check:"string_format",format:"regex",...Mt(e),pattern:n})}function uee(n){return new kQ({check:"string_format",format:"lowercase",...Mt(n)})}function hee(n){return new UQ({check:"string_format",format:"uppercase",...Mt(n)})}function dee(n,e){return new FQ({check:"string_format",format:"includes",...Mt(e),includes:n})}function fee(n,e){return new VQ({check:"string_format",format:"starts_with",...Mt(e),prefix:n})}function pee(n,e){return new zQ({check:"string_format",format:"ends_with",...Mt(e),suffix:n})}function lh(n){return new BQ({check:"overwrite",tx:n})}function mee(n){return lh(e=>e.normalize(n))}function gee(){return lh(n=>n.trim())}function _ee(){return lh(n=>n.toLowerCase())}function vee(){return lh(n=>n.toUpperCase())}function yee(){return lh(n=>zZ(n))}function Eee(n,e,t){return new n({type:"array",element:e,...Mt(t)})}function See(n,e,t){return new n({type:"custom",check:"custom",fn:e,...Mt(t)})}function Tee(n){const e=xee(t=>(t.addIssue=r=>{if(typeof r=="string")t.issues.push(Kd(r,t.value,e._zod.def));else{const i=r;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=t.value),i.inst??(i.inst=e),i.continue??(i.continue=!e._zod.def.abort),t.issues.push(Kd(i))}},n(t.value,t)));return e}function xee(n,e){const t=new io({check:"custom",...Mt(e)});return t._zod.check=n,t}function bN(n){let e=n?.target??"draft-2020-12";return e==="draft-4"&&(e="draft-04"),e==="draft-7"&&(e="draft-07"),{processors:n.processors??{},metadataRegistry:n?.metadata??md,target:e,unrepresentable:n?.unrepresentable??"throw",override:n?.override??(()=>{}),io:n?.io??"output",counter:0,seen:new Map,cycles:n?.cycles??"ref",reused:n?.reused??"inline",external:n?.external??void 0}}function Ar(n,e,t={path:[],schemaPath:[]}){var r;const i=n._zod.def,s=e.seen.get(n);if(s)return s.count++,t.schemaPath.includes(n)&&(s.cycle=t.path),s.schema;const a={schema:{},count:1,cycle:void 0,path:t.path};e.seen.set(n,a);const c=n._zod.toJSONSchema?.();if(c)a.schema=c;else{const f={...t,schemaPath:[...t.schemaPath,n],path:t.path},m=n._zod.parent;if(m)a.ref=m,Ar(m,e,f),e.seen.get(m).isParent=!0;else if(n._zod.processJSONSchema)n._zod.processJSONSchema(e,a.schema,f);else{const _=a.schema,v=e.processors[i.type];if(!v)throw new Error(`[toJSONSchema]: Non-representable type encountered: ${i.type}`);v(n,e,_,f)}}const u=e.metadataRegistry.get(n);return u&&Object.assign(a.schema,u),e.io==="input"&&qr(n)&&(delete a.schema.examples,delete a.schema.default),e.io==="input"&&a.schema._prefault&&((r=a.schema).default??(r.default=a.schema._prefault)),delete a.schema._prefault,e.seen.get(n).schema}function RN(n,e){const t=n.seen.get(e);if(!t)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=s=>{const a=n.target==="draft-2020-12"?"$defs":"definitions";if(n.external){const f=n.external.registry.get(s[0])?.id,m=n.external.uri??(v=>v);if(f)return{ref:m(f)};const _=s[1].defId??s[1].schema.id??`schema${n.counter++}`;return s[1].defId=_,{defId:_,ref:`${m("__shared")}#/${a}/${_}`}}if(s[1]===t)return{ref:"#"};const u=`#/${a}/`,h=s[1].schema.id??`__schema${n.counter++}`;return{defId:h,ref:u+h}},i=s=>{if(s[1].schema.$ref)return;const a=s[1],{ref:c,defId:u}=r(s);a.def={...a.schema},u&&(a.defId=u);const h=a.schema;for(const f in h)delete h[f];h.$ref=c};if(n.cycles==="throw")for(const s of n.seen.entries()){const a=s[1];if(a.cycle)throw new Error(`Cycle detected: #/${a.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const s of n.seen.entries()){const a=s[1];if(e===s[0]){i(s);continue}if(n.external){const u=n.external.registry.get(s[0])?.id;if(e!==s[0]&&u){i(s);continue}}if(n.metadataRegistry.get(s[0])?.id){i(s);continue}if(a.cycle){i(s);continue}if(a.count>1&&n.reused==="ref"){i(s);continue}}}function CN(n,e){const t=n.seen.get(e);if(!t)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=a=>{const c=n.seen.get(a),u=c.def??c.schema,h={...u};if(c.ref===null)return;const f=c.ref;if(c.ref=null,f){r(f);const m=n.seen.get(f).schema;m.$ref&&(n.target==="draft-07"||n.target==="draft-04"||n.target==="openapi-3.0")?(u.allOf=u.allOf??[],u.allOf.push(m)):(Object.assign(u,m),Object.assign(u,h))}c.isParent||n.override({zodSchema:a,jsonSchema:u,path:c.path??[]})};for(const a of[...n.seen.entries()].reverse())r(a[0]);const i={};if(n.target==="draft-2020-12"?i.$schema="https://json-schema.org/draft/2020-12/schema":n.target==="draft-07"?i.$schema="http://json-schema.org/draft-07/schema#":n.target==="draft-04"?i.$schema="http://json-schema.org/draft-04/schema#":n.target,n.external?.uri){const a=n.external.registry.get(e)?.id;if(!a)throw new Error("Schema is missing an `id` property");i.$id=n.external.uri(a)}Object.assign(i,t.def??t.schema);const s=n.external?.defs??{};for(const a of n.seen.entries()){const c=a[1];c.def&&c.defId&&(s[c.defId]=c.def)}n.external||Object.keys(s).length>0&&(n.target==="draft-2020-12"?i.$defs=s:i.definitions=s);try{const a=JSON.parse(JSON.stringify(i));return Object.defineProperty(a,"~standard",{value:{...e["~standard"],jsonSchema:{input:yg(e,"input"),output:yg(e,"output")}},enumerable:!1,writable:!1}),a}catch{throw new Error("Error converting schema to JSON.")}}function qr(n,e){const t=e??{seen:new Set};if(t.seen.has(n))return!1;t.seen.add(n);const r=n._zod.def;if(r.type==="transform")return!0;if(r.type==="array")return qr(r.element,t);if(r.type==="set")return qr(r.valueType,t);if(r.type==="lazy")return qr(r.getter(),t);if(r.type==="promise"||r.type==="optional"||r.type==="nonoptional"||r.type==="nullable"||r.type==="readonly"||r.type==="default"||r.type==="prefault")return qr(r.innerType,t);if(r.type==="intersection")return qr(r.left,t)||qr(r.right,t);if(r.type==="record"||r.type==="map")return qr(r.keyType,t)||qr(r.valueType,t);if(r.type==="pipe")return qr(r.in,t)||qr(r.out,t);if(r.type==="object"){for(const i in r.shape)if(qr(r.shape[i],t))return!0;return!1}if(r.type==="union"){for(const i of r.options)if(qr(i,t))return!0;return!1}if(r.type==="tuple"){for(const i of r.items)if(qr(i,t))return!0;return!!(r.rest&&qr(r.rest,t))}return!1}const wee=(n,e={})=>t=>{const r=bN({...t,processors:e});return Ar(n,r),RN(r,n),CN(r,n)},yg=(n,e)=>t=>{const{libraryOptions:r,target:i}=t??{},s=bN({...r??{},target:i,io:e,processors:{}});return Ar(n,s),RN(s,n),CN(s,n)},Aee={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},Mee=(n,e,t,r)=>{const i=t;i.type="string";const{minimum:s,maximum:a,format:c,patterns:u,contentEncoding:h}=n._zod.bag;if(typeof s=="number"&&(i.minLength=s),typeof a=="number"&&(i.maxLength=a),c&&(i.format=Aee[c]??c,i.format===""&&delete i.format),h&&(i.contentEncoding=h),u&&u.size>0){const f=[...u];f.length===1?i.pattern=f[0].source:f.length>1&&(i.allOf=[...f.map(m=>({...e.target==="draft-07"||e.target==="draft-04"||e.target==="openapi-3.0"?{type:"string"}:{},pattern:m.source}))])}},bee=(n,e,t,r)=>{t.not={}},Ree=(n,e,t,r)=>{},Cee=(n,e,t,r)=>{const i=n._zod.def,s=dN(i.entries);s.every(a=>typeof a=="number")&&(t.type="number"),s.every(a=>typeof a=="string")&&(t.type="string"),t.enum=s},Pee=(n,e,t,r)=>{if(e.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema")},Iee=(n,e,t,r)=>{if(e.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema")},Dee=(n,e,t,r)=>{const i=t,s=n._zod.def,{minimum:a,maximum:c}=n._zod.bag;typeof a=="number"&&(i.minItems=a),typeof c=="number"&&(i.maxItems=c),i.type="array",i.items=Ar(s.element,e,{...r,path:[...r.path,"items"]})},Lee=(n,e,t,r)=>{const i=t,s=n._zod.def;i.type="object",i.properties={};const a=s.shape;for(const h in a)i.properties[h]=Ar(a[h],e,{...r,path:[...r.path,"properties",h]});const c=new Set(Object.keys(a)),u=new Set([...c].filter(h=>{const f=s.shape[h]._zod;return e.io==="input"?f.optin===void 0:f.optout===void 0}));u.size>0&&(i.required=Array.from(u)),s.catchall?._zod.def.type==="never"?i.additionalProperties=!1:s.catchall?s.catchall&&(i.additionalProperties=Ar(s.catchall,e,{...r,path:[...r.path,"additionalProperties"]})):e.io==="output"&&(i.additionalProperties=!1)},Nee=(n,e,t,r)=>{const i=n._zod.def,s=i.inclusive===!1,a=i.options.map((c,u)=>Ar(c,e,{...r,path:[...r.path,s?"oneOf":"anyOf",u]}));s?t.oneOf=a:t.anyOf=a},Oee=(n,e,t,r)=>{const i=n._zod.def,s=Ar(i.left,e,{...r,path:[...r.path,"allOf",0]}),a=Ar(i.right,e,{...r,path:[...r.path,"allOf",1]}),c=h=>"allOf"in h&&Object.keys(h).length===1,u=[...c(s)?s.allOf:[s],...c(a)?a.allOf:[a]];t.allOf=u},kee=(n,e,t,r)=>{const i=n._zod.def,s=Ar(i.innerType,e,r),a=e.seen.get(n);e.target==="openapi-3.0"?(a.ref=i.innerType,t.nullable=!0):t.anyOf=[s,{type:"null"}]},Uee=(n,e,t,r)=>{const i=n._zod.def;Ar(i.innerType,e,r);const s=e.seen.get(n);s.ref=i.innerType},Fee=(n,e,t,r)=>{const i=n._zod.def;Ar(i.innerType,e,r);const s=e.seen.get(n);s.ref=i.innerType,t.default=JSON.parse(JSON.stringify(i.defaultValue))},Vee=(n,e,t,r)=>{const i=n._zod.def;Ar(i.innerType,e,r);const s=e.seen.get(n);s.ref=i.innerType,e.io==="input"&&(t._prefault=JSON.parse(JSON.stringify(i.defaultValue)))},zee=(n,e,t,r)=>{const i=n._zod.def;Ar(i.innerType,e,r);const s=e.seen.get(n);s.ref=i.innerType;let a;try{a=i.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}t.default=a},Bee=(n,e,t,r)=>{const i=n._zod.def,s=e.io==="input"?i.in._zod.def.type==="transform"?i.out:i.in:i.out;Ar(s,e,r);const a=e.seen.get(n);a.ref=s},Hee=(n,e,t,r)=>{const i=n._zod.def;Ar(i.innerType,e,r);const s=e.seen.get(n);s.ref=i.innerType,t.readOnly=!0},Gee=(n,e,t,r)=>{const i=n._zod.def;Ar(i.innerType,e,r);const s=e.seen.get(n);s.ref=i.innerType},jee=Me("ZodISODateTime",(n,e)=>{tJ.init(n,e),In.init(n,e)});function Wee(n){return ree(jee,n)}const $ee=Me("ZodISODate",(n,e)=>{nJ.init(n,e),In.init(n,e)});function qee(n){return iee($ee,n)}const Xee=Me("ZodISOTime",(n,e)=>{rJ.init(n,e),In.init(n,e)});function Kee(n){return see(Xee,n)}const Yee=Me("ZodISODuration",(n,e)=>{iJ.init(n,e),In.init(n,e)});function Zee(n){return oee(Yee,n)}const PN=(n,e)=>{_N.init(n,e),n.name="ZodError",Object.defineProperties(n,{format:{value:t=>QZ(n,t)},flatten:{value:t=>ZZ(n,t)},addIssue:{value:t=>{n.issues.push(t),n.message=JSON.stringify(n.issues,bE,2)}},addIssues:{value:t=>{n.issues.push(...t),n.message=JSON.stringify(n.issues,bE,2)}},isEmpty:{get(){return n.issues.length===0}}})},Qee=Me("ZodError",PN),Ki=Me("ZodError",PN,{Parent:Error}),Jee=NT(Ki),ete=OT(Ki),tte=g_(Ki),nte=__(Ki),rte=tQ(Ki),ite=nQ(Ki),ste=rQ(Ki),ote=iQ(Ki),ate=sQ(Ki),lte=oQ(Ki),cte=aQ(Ki),ute=lQ(Ki),fr=Me("ZodType",(n,e)=>(or.init(n,e),Object.assign(n["~standard"],{jsonSchema:{input:yg(n,"input"),output:yg(n,"output")}}),n.toJSONSchema=wee(n,{}),n.def=e,n.type=e.type,Object.defineProperty(n,"_def",{value:e}),n.check=(...t)=>n.clone(mc(e,{checks:[...e.checks??[],...t.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]})),n.clone=(t,r)=>sl(n,t,r),n.brand=()=>n,n.register=((t,r)=>(t.add(n,r),n)),n.parse=(t,r)=>Jee(n,t,r,{callee:n.parse}),n.safeParse=(t,r)=>tte(n,t,r),n.parseAsync=async(t,r)=>ete(n,t,r,{callee:n.parseAsync}),n.safeParseAsync=async(t,r)=>nte(n,t,r),n.spa=n.safeParseAsync,n.encode=(t,r)=>rte(n,t,r),n.decode=(t,r)=>ite(n,t,r),n.encodeAsync=async(t,r)=>ste(n,t,r),n.decodeAsync=async(t,r)=>ote(n,t,r),n.safeEncode=(t,r)=>ate(n,t,r),n.safeDecode=(t,r)=>lte(n,t,r),n.safeEncodeAsync=async(t,r)=>cte(n,t,r),n.safeDecodeAsync=async(t,r)=>ute(n,t,r),n.refine=(t,r)=>n.check(Qte(t,r)),n.superRefine=t=>n.check(Jte(t)),n.overwrite=t=>n.check(lh(t)),n.optional=()=>TC(n),n.nullable=()=>xC(n),n.nullish=()=>TC(xC(n)),n.nonoptional=t=>Wte(n,t),n.array=()=>UT(n),n.or=t=>Ote([n,t]),n.and=t=>Ute(n,t),n.transform=t=>wC(n,Vte(t)),n.default=t=>Hte(n,t),n.prefault=t=>jte(n,t),n.catch=t=>qte(n,t),n.pipe=t=>wC(n,t),n.readonly=()=>Yte(n),n.describe=t=>{const r=n.clone();return md.add(r,{description:t}),r},Object.defineProperty(n,"description",{get(){return md.get(n)?.description},configurable:!0}),n.meta=(...t)=>{if(t.length===0)return md.get(n);const r=n.clone();return md.add(r,t[0]),r},n.isOptional=()=>n.safeParse(void 0).success,n.isNullable=()=>n.safeParse(null).success,n)),IN=Me("_ZodString",(n,e)=>{kT.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(r,i,s)=>Mee(n,r,i);const t=n._zod.bag;n.format=t.format??null,n.minLength=t.minimum??null,n.maxLength=t.maximum??null,n.regex=(...r)=>n.check(cee(...r)),n.includes=(...r)=>n.check(dee(...r)),n.startsWith=(...r)=>n.check(fee(...r)),n.endsWith=(...r)=>n.check(pee(...r)),n.min=(...r)=>n.check(vg(...r)),n.max=(...r)=>n.check(AN(...r)),n.length=(...r)=>n.check(MN(...r)),n.nonempty=(...r)=>n.check(vg(1,...r)),n.lowercase=r=>n.check(uee(r)),n.uppercase=r=>n.check(hee(r)),n.trim=()=>n.check(gee()),n.normalize=(...r)=>n.check(mee(...r)),n.toLowerCase=()=>n.check(_ee()),n.toUpperCase=()=>n.check(vee()),n.slugify=()=>n.check(yee())}),hte=Me("ZodString",(n,e)=>{kT.init(n,e),IN.init(n,e),n.email=t=>n.check(kJ(dte,t)),n.url=t=>n.check(BJ(fte,t)),n.jwt=t=>n.check(nee(Rte,t)),n.emoji=t=>n.check(HJ(pte,t)),n.guid=t=>n.check(yC(EC,t)),n.uuid=t=>n.check(UJ(pm,t)),n.uuidv4=t=>n.check(FJ(pm,t)),n.uuidv6=t=>n.check(VJ(pm,t)),n.uuidv7=t=>n.check(zJ(pm,t)),n.nanoid=t=>n.check(GJ(mte,t)),n.guid=t=>n.check(yC(EC,t)),n.cuid=t=>n.check(jJ(gte,t)),n.cuid2=t=>n.check(WJ(_te,t)),n.ulid=t=>n.check($J(vte,t)),n.base64=t=>n.check(JJ(Ate,t)),n.base64url=t=>n.check(eee(Mte,t)),n.xid=t=>n.check(qJ(yte,t)),n.ksuid=t=>n.check(XJ(Ete,t)),n.ipv4=t=>n.check(KJ(Ste,t)),n.ipv6=t=>n.check(YJ(Tte,t)),n.cidrv4=t=>n.check(ZJ(xte,t)),n.cidrv6=t=>n.check(QJ(wte,t)),n.e164=t=>n.check(tee(bte,t)),n.datetime=t=>n.check(Wee(t)),n.date=t=>n.check(qee(t)),n.time=t=>n.check(Kee(t)),n.duration=t=>n.check(Zee(t))});function hi(n){return OJ(hte,n)}const In=Me("ZodStringFormat",(n,e)=>{Tn.init(n,e),IN.init(n,e)}),dte=Me("ZodEmail",(n,e)=>{$Q.init(n,e),In.init(n,e)}),EC=Me("ZodGUID",(n,e)=>{jQ.init(n,e),In.init(n,e)}),pm=Me("ZodUUID",(n,e)=>{WQ.init(n,e),In.init(n,e)}),fte=Me("ZodURL",(n,e)=>{qQ.init(n,e),In.init(n,e)}),pte=Me("ZodEmoji",(n,e)=>{XQ.init(n,e),In.init(n,e)}),mte=Me("ZodNanoID",(n,e)=>{KQ.init(n,e),In.init(n,e)}),gte=Me("ZodCUID",(n,e)=>{YQ.init(n,e),In.init(n,e)}),_te=Me("ZodCUID2",(n,e)=>{ZQ.init(n,e),In.init(n,e)}),vte=Me("ZodULID",(n,e)=>{QQ.init(n,e),In.init(n,e)}),yte=Me("ZodXID",(n,e)=>{JQ.init(n,e),In.init(n,e)}),Ete=Me("ZodKSUID",(n,e)=>{eJ.init(n,e),In.init(n,e)}),Ste=Me("ZodIPv4",(n,e)=>{sJ.init(n,e),In.init(n,e)}),Tte=Me("ZodIPv6",(n,e)=>{oJ.init(n,e),In.init(n,e)}),xte=Me("ZodCIDRv4",(n,e)=>{aJ.init(n,e),In.init(n,e)}),wte=Me("ZodCIDRv6",(n,e)=>{lJ.init(n,e),In.init(n,e)}),Ate=Me("ZodBase64",(n,e)=>{cJ.init(n,e),In.init(n,e)}),Mte=Me("ZodBase64URL",(n,e)=>{hJ.init(n,e),In.init(n,e)}),bte=Me("ZodE164",(n,e)=>{dJ.init(n,e),In.init(n,e)}),Rte=Me("ZodJWT",(n,e)=>{pJ.init(n,e),In.init(n,e)}),Cte=Me("ZodUnknown",(n,e)=>{mJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Ree()});function SC(){return aee(Cte)}const Pte=Me("ZodNever",(n,e)=>{gJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>bee(n,t,r)});function Ite(n){return lee(Pte,n)}const Dte=Me("ZodArray",(n,e)=>{_J.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Dee(n,t,r,i),n.element=e.element,n.min=(t,r)=>n.check(vg(t,r)),n.nonempty=t=>n.check(vg(1,t)),n.max=(t,r)=>n.check(AN(t,r)),n.length=(t,r)=>n.check(MN(t,r)),n.unwrap=()=>n.element});function UT(n,e){return Eee(Dte,n,e)}const Lte=Me("ZodObject",(n,e)=>{yJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Lee(n,t,r,i),mn(n,"shape",()=>e.shape),n.keyof=()=>DN(Object.keys(n._zod.def.shape)),n.catchall=t=>n.clone({...n._zod.def,catchall:t}),n.passthrough=()=>n.clone({...n._zod.def,catchall:SC()}),n.loose=()=>n.clone({...n._zod.def,catchall:SC()}),n.strict=()=>n.clone({...n._zod.def,catchall:Ite()}),n.strip=()=>n.clone({...n._zod.def,catchall:void 0}),n.extend=t=>$Z(n,t),n.safeExtend=t=>qZ(n,t),n.merge=t=>XZ(n,t),n.pick=t=>jZ(n,t),n.omit=t=>WZ(n,t),n.partial=(...t)=>KZ(LN,n,t[0]),n.required=(...t)=>YZ(NN,n,t[0])});function ch(n,e){const t={type:"object",shape:n??{},...Mt(e)};return new Lte(t)}const Nte=Me("ZodUnion",(n,e)=>{EJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Nee(n,t,r,i),n.options=e.options});function Ote(n,e){return new Nte({type:"union",options:n,...Mt(e)})}const kte=Me("ZodIntersection",(n,e)=>{SJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Oee(n,t,r,i)});function Ute(n,e){return new kte({type:"intersection",left:n,right:e})}const CE=Me("ZodEnum",(n,e)=>{TJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(r,i,s)=>Cee(n,r,i),n.enum=e.entries,n.options=Object.values(e.entries);const t=new Set(Object.keys(e.entries));n.extract=(r,i)=>{const s={};for(const a of r)if(t.has(a))s[a]=e.entries[a];else throw new Error(`Key ${a} not found in enum`);return new CE({...e,checks:[],...Mt(i),entries:s})},n.exclude=(r,i)=>{const s={...e.entries};for(const a of r)if(t.has(a))delete s[a];else throw new Error(`Key ${a} not found in enum`);return new CE({...e,checks:[],...Mt(i),entries:s})}});function DN(n,e){const t=Array.isArray(n)?Object.fromEntries(n.map(r=>[r,r])):n;return new CE({type:"enum",entries:t,...Mt(e)})}const Fte=Me("ZodTransform",(n,e)=>{xJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Iee(n,t),n._zod.parse=(t,r)=>{if(r.direction==="backward")throw new uN(n.constructor.name);t.addIssue=s=>{if(typeof s=="string")t.issues.push(Kd(s,t.value,e));else{const a=s;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=t.value),a.inst??(a.inst=n),t.issues.push(Kd(a))}};const i=e.transform(t.value,t);return i instanceof Promise?i.then(s=>(t.value=s,t)):(t.value=i,t)}});function Vte(n){return new Fte({type:"transform",transform:n})}const LN=Me("ZodOptional",(n,e)=>{wJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Gee(n,t,r,i),n.unwrap=()=>n._zod.def.innerType});function TC(n){return new LN({type:"optional",innerType:n})}const zte=Me("ZodNullable",(n,e)=>{AJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>kee(n,t,r,i),n.unwrap=()=>n._zod.def.innerType});function xC(n){return new zte({type:"nullable",innerType:n})}const Bte=Me("ZodDefault",(n,e)=>{MJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Fee(n,t,r,i),n.unwrap=()=>n._zod.def.innerType,n.removeDefault=n.unwrap});function Hte(n,e){return new Bte({type:"default",innerType:n,get defaultValue(){return typeof e=="function"?e():pN(e)}})}const Gte=Me("ZodPrefault",(n,e)=>{bJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Vee(n,t,r,i),n.unwrap=()=>n._zod.def.innerType});function jte(n,e){return new Gte({type:"prefault",innerType:n,get defaultValue(){return typeof e=="function"?e():pN(e)}})}const NN=Me("ZodNonOptional",(n,e)=>{RJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Uee(n,t,r,i),n.unwrap=()=>n._zod.def.innerType});function Wte(n,e){return new NN({type:"nonoptional",innerType:n,...Mt(e)})}const $te=Me("ZodCatch",(n,e)=>{CJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>zee(n,t,r,i),n.unwrap=()=>n._zod.def.innerType,n.removeCatch=n.unwrap});function qte(n,e){return new $te({type:"catch",innerType:n,catchValue:typeof e=="function"?e:()=>e})}const Xte=Me("ZodPipe",(n,e)=>{PJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Bee(n,t,r,i),n.in=e.in,n.out=e.out});function wC(n,e){return new Xte({type:"pipe",in:n,out:e})}const Kte=Me("ZodReadonly",(n,e)=>{IJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Hee(n,t,r,i),n.unwrap=()=>n._zod.def.innerType});function Yte(n){return new Kte({type:"readonly",innerType:n})}const Zte=Me("ZodCustom",(n,e)=>{DJ.init(n,e),fr.init(n,e),n._zod.processJSONSchema=(t,r,i)=>Pee(n,t)});function Qte(n,e={}){return See(Zte,n,e)}function Jte(n){return Tee(n)}var p0,AC;function ene(){if(AC)return p0;AC=1;var n="Expected a function",e=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,c=parseInt,u=typeof Ep=="object"&&Ep&&Ep.Object===Object&&Ep,h=typeof self=="object"&&self&&self.Object===Object&&self,f=u||h||Function("return this")(),m=Object.prototype,_=m.toString,v=Math.max,T=Math.min,A=function(){return f.Date.now()};function E(V,H,P){var I,M,C,N,W,F,Y=0,ue=!1,ye=!1,ge=!0;if(typeof V!="function")throw new TypeError(n);H=k(H)||0,S(P)&&(ue=!!P.leading,ye="maxWait"in P,C=ye?v(k(P.maxWait)||0,H):C,ge="trailing"in P?!!P.trailing:ge);function Q(we){var ke=I,We=M;return I=M=void 0,Y=we,N=V.apply(We,ke),N}function re(we){return Y=we,W=setTimeout(ne,H),ue?Q(we):N}function ie(we){var ke=we-F,We=we-Y,Ye=H-ke;return ye?T(Ye,C-We):Ye}function $(we){var ke=we-F,We=we-Y;return F===void 0||ke>=H||ke<0||ye&&We>=C}function ne(){var we=A();if($(we))return te(we);W=setTimeout(ne,ie(we))}function te(we){return W=void 0,ge&&I?Q(we):(I=M=void 0,N)}function _e(){W!==void 0&&clearTimeout(W),Y=0,I=F=M=W=void 0}function Ee(){return W===void 0?N:te(A())}function Pe(){var we=A(),ke=$(we);if(I=arguments,M=this,F=we,ke){if(W===void 0)return re(F);if(ye)return W=setTimeout(ne,H),Q(F)}return W===void 0&&(W=setTimeout(ne,H)),N}return Pe.cancel=_e,Pe.flush=Ee,Pe}function S(V){var H=typeof V;return!!V&&(H=="object"||H=="function")}function D(V){return!!V&&typeof V=="object"}function b(V){return typeof V=="symbol"||D(V)&&_.call(V)==t}function k(V){if(typeof V=="number")return V;if(b(V))return e;if(S(V)){var H=typeof V.valueOf=="function"?V.valueOf():V;V=S(H)?H+"":H}if(typeof V!="string")return V===0?V:+V;V=V.replace(r,"");var P=s.test(V);return P||a.test(V)?c(V.slice(2),P?2:8):i.test(V)?e:+V}return p0=E,p0}var tne=ene();const $ne=PE(tne);function nne(n){return!n||typeof n!="string"?"":VZ.sanitize(n,{ALLOWED_TAGS:[],ALLOWED_ATTR:[]}).trim()}function qne(n){return Array.isArray(n)?n.map(e=>nne(e)).filter(Boolean):[]}const Xne=ch({displayName:hi().min(1,"Name is required").max(100,"Name must be less than 100 characters").refine(n=>n.trim().length>0,"Name cannot be empty"),bio:hi().max(500,"Bio must be less than 500 characters").optional().default(""),goals:UT(hi()).max(10,"Maximum 10 goals allowed").optional().default([])});ch({email:hi().email("Invalid email address").min(1,"Email is required")});ch({password:hi().min(6,"Password must be at least 6 characters").max(100,"Password too long"),confirmPassword:hi()}).refine(n=>n.password===n.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});ch({content:hi().min(1,"Content is required").max(5e3,"Content must be less than 5000 characters"),mood:DN(["Calm","Focused","Stressed","Anxious","Happy","Tired"],{errorMap:()=>({message:"Please select a mood"})}),tags:UT(hi()).max(10,"Maximum 10 tags allowed").optional().default([])});ch({displayName:hi().min(1,"Name is required").max(100,"Name too long").refine(n=>n.trim().length>0,"Name cannot be empty"),email:hi().email("Invalid email address").min(1,"Email is required"),password:hi().min(6,"Password must be at least 6 characters").max(100,"Password too long"),passwordConfirm:hi()}).refine(n=>n.password===n.passwordConfirm,{message:"Passwords don't match",path:["passwordConfirm"]});const rne=ch({email:hi().email("Invalid email address").min(1,"Email is required"),password:hi().min(1,"Password is required")});function ine(n,e){try{const t=n.parse(e);return{success:!0,errors:{},data:t}}catch(t){if(t instanceof Qee){const r={};return t.errors.forEach(i=>{const s=i.path.join(".");r[s]=i.message}),{success:!1,errors:r,data:null}}return{success:!1,errors:{general:"Validation failed"},data:null}}}function sne(){const[n,e]=X.useState(""),[t,r]=X.useState(""),[i,s]=X.useState({}),[a,c]=X.useState(!1),{login:u}=pf(),h=Zd();async function f(m){m.preventDefault(),s({});const _=ine(rne,{email:n.trim().toLowerCase(),password:t});if(!_.success){s(_.errors);const v=Object.values(_.errors)[0];Ro.error(v);return}c(!0);try{await u(_.data.email,_.data.password),Ro.success("Welcome back! "),h("/")}catch(v){console.error("Login error:",v);let T="Failed to log in";v.code==="auth/user-not-found"?T="No account found with this email":v.code==="auth/wrong-password"?T="Incorrect password":v.code==="auth/invalid-email"?T="Invalid email address":v.code==="auth/too-many-requests"?T="Too many failed attempts. Please try again later.":v.code==="auth/invalid-credential"?T="Invalid email or password":v.message&&(T=v.message),s({general:T}),Ro.error(T)}finally{c(!1)}}return B.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-12",children:B.jsx(us.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md",children:B.jsxs("div",{className:"glass-card p-8 rounded-2xl",children:[B.jsx("h2",{className:"text-3xl font-bold text-white mb-2 text-center",children:"Welcome Back"}),B.jsx("p",{className:"text-zinc-400 text-center mb-8",children:"Log in to continue your learning journey"}),i.general&&B.jsx("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-lg mb-6",children:i.general}),B.jsxs("form",{onSubmit:f,className:"space-y-6",children:[B.jsxs("div",{children:[B.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-zinc-300 mb-2",children:"Email"}),B.jsx("input",{id:"email",type:"email",value:n,onChange:m=>e(m.target.value),className:`w-full px-4 py-3 bg-night-800 border ${i.email?"border-red-500":"border-white/10"} rounded-lg text-white placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-brand-500`,placeholder:"your@email.com",disabled:a,autoComplete:"email",required:!0}),i.email&&B.jsx("p",{className:"text-red-400 text-sm mt-1",children:i.email})]}),B.jsxs("div",{children:[B.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-zinc-300 mb-2",children:"Password"}),B.jsx("input",{id:"password",type:"password",value:t,onChange:m=>r(m.target.value),className:`w-full px-4 py-3 bg-night-800 border ${i.password?"border-red-500":"border-white/10"} rounded-lg text-white placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-brand-500`,placeholder:"",disabled:a,autoComplete:"current-password",required:!0}),i.password&&B.jsx("p",{className:"text-red-400 text-sm mt-1",children:i.password})]}),B.jsx("button",{type:"submit",disabled:a,className:"w-full bg-gradient-to-r from-brand-500 to-brand-600 hover:from-brand-600 hover:to-brand-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:a?B.jsxs(B.Fragment,{children:[B.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[B.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),B.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging in..."]}):"Log In"})]}),B.jsxs("p",{className:"text-zinc-400 text-center mt-6",children:["Don't have an account?"," ",B.jsx(Ul,{to:"/signup",className:"text-brand-400 hover:text-brand-300 font-medium",children:"Sign up"})]})]})})})}function one(){const[n,e]=X.useState(""),[t,r]=X.useState(""),[i,s]=X.useState(""),[a,c]=X.useState(""),[u,h]=X.useState({}),[f,m]=X.useState(!1),{signup:_}=pf(),v=Zd();async function T(A){if(A.preventDefault(),h({}),!a.trim()){Ro.error("Name is required"),h({displayName:"Name is required"});return}if(!n.trim()){Ro.error("Email is required"),h({email:"Email is required"});return}if(t.length<6){Ro.error("Password must be at least 6 characters"),h({password:"Password must be at least 6 characters"});return}if(t!==i){Ro.error("Passwords don't match!"),h({passwordConfirm:"Passwords don't match"});return}m(!0);try{await _(n,t,a.trim()),Ro.success("Account created successfully! Welcome to Cosmos "),v("/")}catch(E){console.error("Signup error:",E);let S="Failed to create account";E.code==="auth/email-already-in-use"?S="Email already in use. Please try logging in.":E.code==="auth/invalid-email"?S="Invalid email address":E.code==="auth/weak-password"?S="Password is too weak":E.message&&(S=E.message),h({general:S}),Ro.error(S)}finally{m(!1)}}return B.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-12",children:B.jsx(us.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md",children:B.jsxs("div",{className:"glass-card p-8 rounded-2xl",children:[B.jsx("h2",{className:"text-3xl font-bold text-white mb-2 text-center",children:"Join Cosmos"}),B.jsx("p",{className:"text-zinc-400 text-center mb-8",children:"Start your learning journey today"}),u.general&&B.jsx("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-lg mb-6",children:u.general}),B.jsxs("form",{onSubmit:T,className:"space-y-6",children:[B.jsxs("div",{children:[B.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-zinc-300 mb-2",children:["Name ",B.jsx("span",{className:"text-red-400",children:"*"})]}),B.jsx("input",{id:"name",type:"text",value:a,onChange:A=>c(A.target.value),className:`w-full px-4 py-3 bg-night-800 border ${u.displayName?"border-red-500":"border-white/10"} rounded-lg text-white placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-brand-500`,placeholder:"Enter your name",disabled:f,required:!0}),u.displayName&&B.jsx("p",{className:"text-red-400 text-sm mt-1",children:u.displayName})]}),B.jsxs("div",{children:[B.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-zinc-300 mb-2",children:["Email ",B.jsx("span",{className:"text-red-400",children:"*"})]}),B.jsx("input",{id:"email",type:"email",value:n,onChange:A=>e(A.target.value),className:`w-full px-4 py-3 bg-night-800 border ${u.email?"border-red-500":"border-white/10"} rounded-lg text-white placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-brand-500`,placeholder:"your@email.com",disabled:f,required:!0}),u.email&&B.jsx("p",{className:"text-red-400 text-sm mt-1",children:u.email})]}),B.jsxs("div",{children:[B.jsxs("label",{htmlFor:"password",className:"block text-sm font-medium text-zinc-300 mb-2",children:["Password ",B.jsx("span",{className:"text-red-400",children:"*"})]}),B.jsx("input",{id:"password",type:"password",value:t,onChange:A=>r(A.target.value),className:`w-full px-4 py-3 bg-night-800 border ${u.password?"border-red-500":"border-white/10"} rounded-lg text-white placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-brand-500`,placeholder:"",disabled:f,required:!0}),u.password&&B.jsx("p",{className:"text-red-400 text-sm mt-1",children:u.password}),B.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Minimum 6 characters"})]}),B.jsxs("div",{children:[B.jsxs("label",{htmlFor:"passwordConfirm",className:"block text-sm font-medium text-zinc-300 mb-2",children:["Confirm Password ",B.jsx("span",{className:"text-red-400",children:"*"})]}),B.jsx("input",{id:"passwordConfirm",type:"password",value:i,onChange:A=>s(A.target.value),className:`w-full px-4 py-3 bg-night-800 border ${u.passwordConfirm?"border-red-500":"border-white/10"} rounded-lg text-white placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-brand-500`,placeholder:"",disabled:f,required:!0}),u.passwordConfirm&&B.jsx("p",{className:"text-red-400 text-sm mt-1",children:u.passwordConfirm})]}),B.jsx("button",{type:"submit",disabled:f,className:"w-full bg-gradient-to-r from-brand-500 to-brand-600 hover:from-brand-600 hover:to-brand-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:f?B.jsxs(B.Fragment,{children:[B.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[B.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),B.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating account..."]}):"Sign Up"})]}),B.jsxs("p",{className:"text-zinc-400 text-center mt-6",children:["Already have an account?"," ",B.jsx(Ul,{to:"/login",className:"text-brand-400 hover:text-brand-300 font-medium",children:"Log in"})]})]})})})}class ane extends Eg.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};handleGoHome=()=>{window.location.href="/"};render(){return this.state.hasError?B.jsx("div",{className:"min-h-screen flex items-center justify-center bg-night-900 px-4",children:B.jsx("div",{className:"max-w-md w-full",children:B.jsxs("div",{className:"glass-card p-8 rounded-2xl text-center",children:[B.jsx("div",{className:"flex justify-center mb-6",children:B.jsx("div",{className:"p-4 bg-red-500/10 rounded-full",children:B.jsx(JW,{className:"text-red-400",size:48})})}),B.jsx("h1",{className:"text-2xl font-bold text-white mb-3",children:"Oops! Something went wrong"}),B.jsx("p",{className:"text-zinc-400 mb-6",children:"We encountered an unexpected error. Don't worry, your data is safe."}),!1,B.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[B.jsxs("button",{onClick:this.handleReset,className:"flex-1 btn-primary flex items-center justify-center gap-2",children:[B.jsx(YW,{size:16}),"Try Again"]}),B.jsxs("button",{onClick:this.handleGoHome,className:"flex-1 px-4 py-2 border border-white/10 rounded-lg hover:bg-white/5 transition flex items-center justify-center gap-2",children:[B.jsx(ET,{size:16}),"Go Home"]})]}),B.jsx("p",{className:"text-xs text-zinc-500 mt-6",children:"If this problem persists, please contact support"})]})})}):this.props.children}}const lne=X.lazy(()=>to(()=>import("./Pods-Xn1rVwL1.js"),[])),cne=X.lazy(()=>to(()=>import("./PodForum-LifyRU_o.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),une=X.lazy(()=>to(()=>import("./Matches-BVqLxO7O.js"),__vite__mapDeps([8,9,10,11,12,6]))),hne=X.lazy(()=>to(()=>import("./Journal-DiW88g3Q.js"),__vite__mapDeps([13,2,14]))),dne=X.lazy(()=>to(()=>import("./Events-n93L1l6I.js"),__vite__mapDeps([15,7]))),fne=X.lazy(()=>to(()=>import("./Analytics-CL6Mj3qe.js"),__vite__mapDeps([16,11,5,17]))),pne=X.lazy(()=>to(()=>import("./Profile-DFq4Paqs.js"),__vite__mapDeps([18,9,3,12]))),mne=X.lazy(()=>to(()=>import("./Settings-Df_Yz60E.js"),__vite__mapDeps([19,1,20,14]))),gne=X.lazy(()=>to(()=>import("./Constitution-Dq32d_Uz.js"),__vite__mapDeps([21,20]))),_ne=X.lazy(()=>to(()=>import("./Chat-CZfngCHM.js"),__vite__mapDeps([22,9,10,4]))),vne={initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8}};function yne(){return B.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:B.jsx("div",{className:"relative",children:B.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-brand-500/20 border-t-brand-500 animate-spin"})})})}function wi({children:n}){return B.jsx(us.div,{variants:vne,initial:"initial",animate:"animate",exit:"exit",transition:{duration:.2,ease:"easeOut"},children:n})}function Ene(){const n=Xo(),{currentUser:e}=pf();return B.jsxs("div",{className:"min-h-screen flex flex-col grain",children:[B.jsx(o8,{}),B.jsx(n8,{}),B.jsx("main",{id:"content",className:`flex-1 ${e?"pb-20 md:pb-0":""}`,children:B.jsx(FC,{mode:"wait",children:B.jsx(X.Suspense,{fallback:B.jsx(yne,{}),children:B.jsxs(Gk,{location:n,children:[B.jsx(oi,{path:"/login",element:B.jsx(wi,{children:B.jsx(sne,{})})}),B.jsx(oi,{path:"/signup",element:B.jsx(wi,{children:B.jsx(one,{})})}),B.jsx(oi,{path:"/constitution",element:B.jsx(wi,{children:B.jsx(gne,{})})}),B.jsx(oi,{path:"/",element:B.jsx(Os,{children:B.jsx(wi,{children:B.jsx(CY,{})})})}),B.jsx(oi,{path:"/pods",element:B.jsx(Os,{children:B.jsx(wi,{children:B.jsx(lne,{})})})}),B.jsx(oi,{path:"/pods/:slug",element:B.jsx(Os,{children:B.jsx(wi,{children:B.jsx(cne,{})})})}),B.jsx(oi,{path:"/matches",element:B.jsx(Os,{children:B.jsx(wi,{children:B.jsx(une,{})})})}),B.jsx(oi,{path:"/journal",element:B.jsx(Os,{children:B.jsx(wi,{children:B.jsx(hne,{})})})}),B.jsx(oi,{path:"/events",element:B.jsx(Os,{children:B.jsx(wi,{children:B.jsx(dne,{})})})}),B.jsx(oi,{path:"/analytics",element:B.jsx(Os,{children:B.jsx(wi,{children:B.jsx(fne,{})})})}),B.jsx(oi,{path:"/profile",element:B.jsx(Os,{children:B.jsx(wi,{children:B.jsx(pne,{})})})}),B.jsx(oi,{path:"/settings",element:B.jsx(Os,{children:B.jsx(wi,{children:B.jsx(mne,{})})})}),B.jsx(oi,{path:"/chat/:chatId",element:B.jsx(Os,{children:B.jsx(wi,{children:B.jsx(_ne,{})})})})]},n.pathname)})})}),B.jsx(r8,{}),e&&B.jsx(s8,{})]})}function Sne(){return B.jsxs(B.Fragment,{children:[B.jsx(Ene,{}),B.jsx(_Z,{position:"top-center",toastOptions:{duration:3e3,style:{background:"#1a2340",color:"#fff",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"12px",padding:"12px 16px"},success:{iconTheme:{primary:"#667dff",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})}QO.createRoot(document.getElementById("root")).render(B.jsxs(Eg.StrictMode,{children:[B.jsxs(ane,{children:["                              ",B.jsx(Zk,{children:B.jsx(GW,{children:B.jsx(Sne,{})})})]}),"                             "]}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/cosmos/sw.js").catch(()=>{})});export{Xz as $,Lne as A,Une as B,Zd as C,Nne as D,Ro as E,qW as F,One as G,XW as H,PE as I,kW as J,Tne as K,Ul as L,qO as M,Yd as N,$ne as O,qne as P,nne as Q,Eg as R,ine as S,Xne as T,mL as U,Ws as V,Wa as W,e8 as X,Og as Y,nf as Z,Xl as _,pf as a,no as a0,Ane as a1,QW as a2,Mne as a3,Al as a4,us as a5,by as a6,wu as b,Jr as c,zl as d,jne as e,Wne as f,c1 as g,Hne as h,Gne as i,B as j,Fne as k,kne as l,Cne as m,lE as n,Bne as o,aL as p,zne as q,X as r,lL as s,Vne as t,_u as u,YW as v,xne as w,Pne as x,Ine as y,Dne as z};
